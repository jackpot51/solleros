     1                                  [BITS 16]
     2                                      %include 'source/menu.asm'
     3                              <1>     ; MENU.ASM
     4                              <1> prog:	
     5 00000000 8CC8                <1> 	    mov ax, cs
     6 00000002 E90400              <1> 	    jmp mainindex	;;this command gives the solleros user the location of mainindex
     7 00000005 4A525300            <1> 	    db "JRS",0	;;this gives the bootloader a key to look for
     8                              <1> mainindex:
     9 00000009 E90000              <1> 	    jmp mainindexdn	;;this gives the size of the index
    10                              <1> 	    ;not needed;dw 0405h,progstart,batchprogend,fileindex,fileindexend,variables,varend,nwcmd,int30h,physbaseptr,0
    11                              <1> mainindexdn:
    12 0000000C 8ED8                <1> 	mov ds, ax
    13 0000000E 8EC0                <1> 	mov es, ax
    14 00000010 8ED0                <1> 	mov ss, ax
    15 00000012 880E[2B00]          <1> 	mov [DriveNumber], cl
    16 00000016 668916[2C00]        <1> 	mov [lbaad], edx
    17 0000001B B800A0              <1> 	mov ax, 0xA000
    18 0000001E 8EE8                <1> 	mov gs, ax
    19 00000020 B81200              <1> 	mov ax, 12h
    20 00000023 BB0000              <1> 	mov bx, 0
    21 00000026 CD10                <1> 	int 10h
    22                              <1> ;	mov si, graphicstable
    23                              <1> ;	mov di, endbss
    24                              <1> ;	mov eax, 0
    25                              <1> ;initmemory:
    26                              <1> ;	mov [si], eax
    27                              <1> ;	add si, 4
    28                              <1> ;	cmp si, di
    29                              <1> ;	jb initmemory
    30 00000028 E90900              <1> 	jmp guiload
    31                              <1> 
    32 0000002B 00                  <1> DriveNumber db 0
    33 0000002C 00000000            <1> lbaad dd 0
    34                              <1> 	
    35 00000030 0000                <1> vesamode dw 0
    36 00000032 0000                <1> videomodecache dw 0
    37                              <1> 
    38                              <1> guiload:
    39 00000034 B8004F              <1> 	mov ax, 04F00h
    40 00000037 BF[1F6A]            <1> 	mov di, VBEMODEBLOCK
    41 0000003A CD10                <1> 	int 10h
    42 0000003C BE[416A]            <1> 	mov si, reserved
    43 0000003F 81EE0200            <1> 	sub si, 2
    44                              <1> findvideomodes:
    45 00000043 81C60200            <1> 	add si, 2
    46 00000047 8B0C                <1> 	mov cx, [si]
    47 00000049 81F9FFFF            <1> 	cmp cx, 0xFFFF
    48 0000004D 0F840A00            <1> 	je near nextvmode
    49 00000051 81FE[1F6B]          <1> 	cmp si, oemdata
    50 00000055 0F83EA00            <1> 	jae near guiload2	;;kill if no valid list is found
    51 00000059 EBE8                <1> 	jmp findvideomodes 	
    52                              <1> ;;debug,shows vmodes available
    53                              <1> nextvmode:
    54 0000005B 81EE0200            <1> 	sub si, 2
    55 0000005F 81FE[416A]          <1> 	cmp si, reserved
    56 00000063 0F82DC00            <1> 	jb near guiload2
    57 00000067 8B0C                <1> 	mov cx, [si]
    58 00000069 81F9FFFF            <1> 	cmp cx, 0xFFFF
    59 0000006D 0F84EAFF            <1> 	je near nextvmode
    60 00000071 81C10040            <1> 	add cx, 0x4000 		;;Linear Frame Buffer
    61 00000075 B8014F              <1> 	mov ax, 04F01h
    62 00000078 BF[1F6C]            <1> 	mov di, VBEMODEINFOBLOCK
    63 0000007B 890E[3000]          <1> 	mov [vesamode], cx
    64 0000007F CD10                <1> 	int 10h
    65 00000081 A0[386C]            <1> 	mov al, [bitsperpixel]
    66 00000084 3C10                <1> 	cmp al, 16
    67 00000086 75D3                <1> 	jne nextvmode
    68 00000088 8936[3200]          <1> 	mov [videomodecache], si
    69 0000008C 80FC00              <1> 	cmp ah, 0
    70 0000008F 0F842200            <1> 	je near setvesamode
    71 00000093 EBC6                <1> 	jmp nextvmode
    72 00000095 0A0D49732074686973- <1> isthisvideook db 10,13,"Is this video mode OK?(y/n)",13,10,0
    73 0000009E 20766964656F206D6F- <1>
    74 000000A7 6465204F4B3F28792F- <1>
    75 000000B0 6E290D0A00          <1>
    76                              <1> setvesamode:
    77 000000B5 8B0E[316C]          <1> 	mov cx, [xresolution]
    78 000000B9 E8D300              <1> 	call decshow
    79 000000BC B078                <1> 	mov al, "x"
    80 000000BE E83B01              <1> 	call char
    81 000000C1 8B0E[336C]          <1> 	mov cx, [yresolution]
    82 000000C5 E8C700              <1> 	call decshow
    83 000000C8 B040                <1> 	mov al, "@"
    84 000000CA E82F01              <1> 	call char
    85 000000CD 8A0E[386C]          <1> 	mov cl, [bitsperpixel]
    86 000000D1 E8BB00              <1> 	call decshow
    87 000000D4 BE[9500]            <1> 	mov si, isthisvideook
    88 000000D7 E89D00              <1> 	call printrm
    89 000000DA B80000              <1> 	mov ax, 0
    90 000000DD CD16                <1> 	int 16h
    91 000000DF 8B36[3200]          <1> 	mov si, [videomodecache]
    92 000000E3 3C79                <1> 	cmp al, "y"
    93 000000E5 0F8572FF            <1> 	jne near nextvmode
    94 000000E9 8B16[316C]          <1> 	mov dx, [xresolution]
    95 000000ED 8B0E[336C]          <1> 	mov cx, [yresolution]
    96 000000F1 8916[E236]          <1> 	mov [resolutionx], dx
    97 000000F5 890E[E036]          <1> 	mov [resolutiony], cx
    98 000000F9 01D2                <1> 	add dx, dx
    99 000000FB 8916[E436]          <1> 	mov [resolutionx2], dx
   100 000000FF BA0000              <1> 	mov dx, 0
   101 00000102 B90000              <1> 	mov cx, 0
   102 00000105 B8024F              <1> 	mov ax, 04F02h
   103 00000108 8B1E[3000]          <1> 	mov bx, [vesamode]
   104 0000010C CD10                <1> 	int 10h		;;enter VESA mode
   105 0000010E 668B3E[476C]        <1> 	mov edi, [physbaseptr]
   106 00000113 66B800000000        <1> 	mov eax, 0
   107 00000119 8CD8                <1> 	mov ax, ds
   108 0000011B 66C1E004            <1> 	shl eax, 4
   109 0000011F 6629C7              <1> 	sub edi, eax
   110 00000122 90                  <1> 	nop
   111 00000123 90                  <1> 	nop
   112 00000124 66893E[476C]        <1> 	mov [physbaseptr], edi
   113 00000129 C606[7601]00        <1> 	mov byte [guinodo], 0
   114 0000012E 6631C0              <1> 	xor eax, eax
   115 00000131 6631DB              <1> 	xor ebx, ebx
   116 00000134 6631C9              <1> 	xor ecx, ecx
   117 00000137 6631D2              <1> 	xor edx, edx
   118 0000013A 6631F6              <1> 	xor esi, esi
   119 0000013D 6631FF              <1> 	xor edi, edi	;;reset registers
   120 00000140 E91F01              <1> 	jmp pmode
   121                              <1> guiload2:
   122 00000143 B9E001              <1> 	mov cx, 480
   123 00000146 BA8002              <1> 	mov dx, 640
   124 00000149 8916[E236]          <1> 	mov [resolutionx], dx
   125 0000014D 01D2                <1> 	add dx, dx
   126 0000014F 8916[E436]          <1> 	mov [resolutionx2], dx
   127 00000153 890E[E036]          <1> 	mov [resolutiony], cx
   128 00000157 B81200              <1> 	mov ax, 12h
   129 0000015A BB0000              <1> 	mov bx, 0
   130 0000015D CD10                <1> 	int 10h
   131 0000015F C606[7601]01        <1> 	mov byte [guinodo], 1
   132 00000164 6631DB              <1> 	xor ebx, ebx
   133 00000167 6631C9              <1> 	xor ecx, ecx
   134 0000016A 6631D2              <1> 	xor edx, edx
   135 0000016D 6631F6              <1> 	xor esi, esi
   136 00000170 6631FF              <1> 	xor edi, edi
   137 00000173 E9EC00              <1> 	jmp pmode
   138                              <1> ;;	jmp gui ;;test vesa
   139                              <1> 
   140 00000176 00                  <1> guinodo db 0
   141                              <1> 
   142                              <1>     printrm:			; 'si' comes in with string address
   143 00000177 BB0700              <1> 	    mov bx,07		; write to display
   144 0000017A B40E                <1> 	    mov ah,0Eh		; screen function
   145 0000017C 8A04                <1>     prs2:    mov al,[si]         ; get next character
   146 0000017E 3C00                <1> 	    cmp al,0		; look for terminator 
   147 00000180 7405                <1>             je finpr2		; zero byte at end of string
   148 00000182 CD10                <1> 	    int 10h		; write character to screen.    
   149 00000184 46                  <1>      	    inc si	     	; move to next character
   150 00000185 EBF5                <1> 	    jmp prs2		; loop
   151 00000187 C3                  <1>     finpr2: ret
   152                              <1> 
   153 00000188 0000000000          <1> dcnm db 0,0,0,0,0
   154 0000018D 0000                <1> dcnmend db 0,0
   155                              <1> 
   156                              <1> 
   157                              <1> decshow:
   158 0000018F BE[8801]            <1> 	mov si, dcnm
   159                              <1> decclear:
   160 00000192 B030                <1> 	mov al, "0"
   161 00000194 8804                <1> 	mov [si], al
   162 00000196 46                  <1> 	inc si
   163 00000197 81FE[8D01]          <1> 	cmp si, dcnmend
   164 0000019B 76F5                <1> 	jbe decclear
   165 0000019D 4E                  <1> 	dec si
   166 0000019E E81500              <1> 	call convertrm
   167 000001A1 BE[8801]            <1> 	mov si, dcnm
   168                              <1> dectst:
   169 000001A4 8A04                <1> 	mov al, [si]
   170 000001A6 46                  <1> 	inc si
   171 000001A7 81FE[8D01]          <1> 	cmp si, dcnmend
   172 000001AB 7704                <1> 	ja dectstend
   173 000001AD 3C30                <1> 	cmp al, "0"
   174 000001AF 76F3                <1> 	jbe dectst
   175                              <1> dectstend:
   176 000001B1 4E                  <1> 	dec si
   177 000001B2 E8C2FF              <1> 	call printrm
   178 000001B5 C3                  <1> 	ret
   179                              <1> 	
   180                              <1> 	
   181                              <1> convertrm:
   182 000001B6 4E                  <1> 	dec si
   183 000001B7 89F3                <1> 	mov bx, si		;place to convert into must be in si, number to convert must be in cx
   184                              <1> cnvrtrm:
   185 000001B9 89DE                <1> 	mov si, bx
   186 000001BB 81EE0300            <1> 	sub si, 3
   187 000001BF 46                  <1> ten3rm:	inc si
   188 000001C0 81F9E803            <1> 	cmp cx, 1000
   189 000001C4 7208                <1> 	jb ten2rm
   190 000001C6 81E9E803            <1> 	sub cx, 1000
   191 000001CA FE04                <1> 	inc byte [si]
   192 000001CC EBEB                <1> 	jmp cnvrtrm
   193 000001CE 46                  <1> ten2rm:	inc si
   194 000001CF 81F96400            <1> 	cmp cx, 100
   195 000001D3 7208                <1> 	jb ten1rm
   196 000001D5 81E96400            <1> 	sub cx, 100
   197 000001D9 FE04                <1> 	inc byte [si]
   198 000001DB EBDC                <1> 	jmp cnvrtrm
   199 000001DD 46                  <1> ten1rm:	inc si
   200 000001DE 81F90A00            <1> 	cmp cx, 10
   201 000001E2 7208                <1> 	jb ten0rm
   202 000001E4 81E90A00            <1> 	sub cx, 10
   203 000001E8 FE04                <1> 	inc byte [si]
   204 000001EA EBCD                <1> 	jmp cnvrtrm
   205 000001EC 46                  <1> ten0rm:	inc si
   206 000001ED 81F90100            <1> 	cmp cx, 1
   207 000001F1 7208                <1> 	jb tendnrm
   208 000001F3 81E90100            <1> 	sub cx, 1
   209 000001F7 FE04                <1> 	inc byte [si]
   210 000001F9 EBBE                <1> 	jmp cnvrtrm
   211                              <1> tendnrm:
   212 000001FB C3                  <1> 	ret
   213                              <1> 
   214                              <1> 
   215                              <1> 
   216                              <1> 
   217                              <1>     char: 		    ;char must be in al
   218 000001FC BB0700              <1>            mov bx, 07
   219 000001FF B40E                <1> 	   mov ah, 0Eh
   220 00000201 CD10                <1> 	   int 10h
   221 00000203 C3                  <1> 	    ret
   222                              <1> 
   223                              <1> 		shutdown:
   224 00000204 E84B00              <1> 			call realmode	
   225 00000207 B80053              <1> 			MOV AX, 5300h	; Shuts down APM-Machines.
   226 0000020A 31DB                <1> 			XOR BX, BX	; Newer machines automatically
   227 0000020C CD15                <1> 			INT 15h		; shut down
   228 0000020E B80453              <1> 			MOV AX, 5304h
   229 00000211 31DB                <1> 			XOR BX, BX
   230 00000213 CD15                <1> 			INT 15h		; Interrupt 15h originally was
   231 00000215 B80153              <1> 			MOV AX, 5301h	; used for Cartridges (cassettes)
   232 00000218 31DB                <1> 			XOR BX, BX	; but is still in use for
   233 0000021A CD15                <1> 			INT 15h		; diverse things
   234 0000021C B80753              <1> 			MOV AX, 5307h
   235 0000021F BB0100              <1> 			MOV BX, 1
   236 00000222 B90300              <1> 			MOV CX, 3
   237 00000225 CD15                <1> 			INT 15h
   238 00000227 CF                  <1> 			IRET
   239                              <1> 
   240                              <1> 	coldboot:
   241 00000228 E82700              <1> 			call realmode
   242 0000022B B84000              <1> 			MOV AX, 0040h
   243 0000022E 8EC0                <1> 			MOV ES, AX
   244 00000230 26C70672000000      <1> 			MOV WORD [ES:00072h], 0h
   245 00000237 EA0000FFFF          <1> 			JMP 0FFFFh:0000h
   246 0000023C CF                  <1> 			IRET
   247                              <1> 
   248                              <1> 		warmboot:
   249 0000023D E81200              <1> 			call realmode
   250 00000240 B84000              <1> 			MOV AX, 0040h
   251 00000243 8EC0                <1> 			MOV ES, AX
   252 00000245 26C70672003412      <1> 			MOV WORD [ES:00072h], 01234h
   253 0000024C EA0000FFFF          <1> 			JMP 0FFFFh:0000h
   254 00000251 CF                  <1> 			IRET
   255                              <1> 
   256                              <1> 
   257                              <1> realmode:
   258 00000252 0F20C0              <1>    mov eax, cr0
   259 00000255 24FE                <1>    and al,0xFE     ; back to realmode
   260 00000257 0F22C0              <1>    mov  cr0, eax   ; by toggling bit again
   261 0000025A FB                  <1>    sti
   262                              <1> 
   263 0000025B 66B800000000        <1>    mov eax, 0
   264 00000261 C3                  <1>    ret
   265                                      %include 'source/pmode.asm'
   266                              <1> ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
   267                              <1> ;	16-bit real mode
   268                              <1> ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
   269                              <1> [BITS 16]
   270                              <1> pmode:
   271 00000262 BA9200              <1> 	mov dx, 0x92
   272 00000265 EC                  <1> 	in al, dx	;;A20
   273 00000266 0C02                <1> 	or al, 2
   274 00000268 EE                  <1> 	out dx, al
   275 00000269 6631DB              <1> 	xor ebx,ebx
   276 0000026C 8CCB                <1> 	mov bx,cs		; EBX=segment
   277 0000026E 66C1E304            <1> 	shl ebx,4		;	<< 4
   278 00000272 67668D03            <1> 	lea eax,[ebx]		; EAX=linear address of segment base
   279 00000276 A3[C706]            <1> 	mov [gdt2 + 2],ax
   280 00000279 A3[CF06]            <1> 	mov [gdt3 + 2],ax
   281 0000027C 66C1E810            <1> 	shr eax,16
   282 00000280 A2[C906]            <1> 	mov [gdt2 + 4],al
   283 00000283 A2[D106]            <1> 	mov [gdt3 + 4],al
   284 00000286 8826[CC06]          <1> 	mov [gdt2 + 7],ah
   285 0000028A 8826[D406]          <1> 	mov [gdt3 + 7],ah
   286                              <1> ; fix up gdt and idt
   287 0000028E 67668D83[B5060000]  <1> 	lea eax,[ebx + gdt]	; EAX=linear address of gdt
   288 00000296 66A3[AB06]          <1> 	mov [gdtr + 2],eax
   289 0000029A 67668D83[DA060000]  <1> 	lea eax,[ebx + idt]	; EAX=linear address of idt
   290 000002A2 66A3[B106]          <1> 	mov [idtr + 2],eax
   291 000002A6 FA                  <1> 	cli
   292 000002A7 0F0116[A906]        <1> 	lgdt [gdtr]
   293 000002AC 0F011E[AF06]        <1> 	lidt [idtr]
   294 000002B1 8CDB                <1> 	mov bx, ds
   295 000002B3 891E[EE02]          <1> 	mov [cscache], bx
   296 000002B7 0F20C0              <1> 	mov eax,cr0
   297 000002BA 0C01                <1> 	or al,1
   298 000002BC 0F22C0              <1> 	mov cr0,eax
   299 000002BF EA[C402]1000        <1> 	jmp SYS_CODE_SEL:do_pm
   300                              <1> [BITS 32]
   301                              <1> do_pm:
   302 000002C4 66B81800            <1> 	mov ax, SYS_DATA_SEL
   303 000002C8 8ED8                <1> 	mov ds,ax
   304 000002CA 8ED0                <1> 	mov ss,ax
   305 000002CC 90                  <1> 	nop
   306 000002CD 8EC0                <1> 	mov es,ax
   307 000002CF 8EE0                <1> 	mov fs,ax
   308 000002D1 8EE8                <1> 	mov gs,ax	
   309 000002D3 803D[76010000]00    <1> 	cmp byte [guinodo], 0
   310 000002DA 0F8405000000        <1> 	je near guido
   311 000002E0 E974090000          <1> 	jmp os
   312                              <1> 	
   313                              <1> guido:
   314 000002E5 E949230000          <1> 	jmp gui
   315                              <1> 	
   316 000002EA 00000000            <1> user2codepoint dw 0,0
   317 000002EE 0000                <1> cscache dw 0
   318                              <1> 
   319                              <1> handled:
   320 000002F0 C3                  <1> 	ret
   321                              <1> 
   322                              <1> unhand:	
   323                              <1> 	%assign i 0
   324                              <1> 	%rep 40
   325                              <1> 	cli
   326                              <1> 	mov byte [intprob], i
   327                              <1> 	jmp unhand2
   328                              <1> 	%assign i i+1
   329                              <1> 	%endrep
   330 000002F1 FA                  <2>  cli
   331 000002F2 C605[F2050000]00    <2>  mov byte [intprob], i
   332 000002F9 E9FB010000          <2>  jmp unhand2
   333                              <2>  %assign i i+1
   334 000002FE FA                  <2>  cli
   335 000002FF C605[F2050000]01    <2>  mov byte [intprob], i
   336 00000306 E9EE010000          <2>  jmp unhand2
   337                              <2>  %assign i i+1
   338 0000030B FA                  <2>  cli
   339 0000030C C605[F2050000]02    <2>  mov byte [intprob], i
   340 00000313 E9E1010000          <2>  jmp unhand2
   341                              <2>  %assign i i+1
   342 00000318 FA                  <2>  cli
   343 00000319 C605[F2050000]03    <2>  mov byte [intprob], i
   344 00000320 E9D4010000          <2>  jmp unhand2
   345                              <2>  %assign i i+1
   346 00000325 FA                  <2>  cli
   347 00000326 C605[F2050000]04    <2>  mov byte [intprob], i
   348 0000032D E9C7010000          <2>  jmp unhand2
   349                              <2>  %assign i i+1
   350 00000332 FA                  <2>  cli
   351 00000333 C605[F2050000]05    <2>  mov byte [intprob], i
   352 0000033A E9BA010000          <2>  jmp unhand2
   353                              <2>  %assign i i+1
   354 0000033F FA                  <2>  cli
   355 00000340 C605[F2050000]06    <2>  mov byte [intprob], i
   356 00000347 E9AD010000          <2>  jmp unhand2
   357                              <2>  %assign i i+1
   358 0000034C FA                  <2>  cli
   359 0000034D C605[F2050000]07    <2>  mov byte [intprob], i
   360 00000354 E9A0010000          <2>  jmp unhand2
   361                              <2>  %assign i i+1
   362 00000359 FA                  <2>  cli
   363 0000035A C605[F2050000]08    <2>  mov byte [intprob], i
   364 00000361 E993010000          <2>  jmp unhand2
   365                              <2>  %assign i i+1
   366 00000366 FA                  <2>  cli
   367 00000367 C605[F2050000]09    <2>  mov byte [intprob], i
   368 0000036E E986010000          <2>  jmp unhand2
   369                              <2>  %assign i i+1
   370 00000373 FA                  <2>  cli
   371 00000374 C605[F2050000]0A    <2>  mov byte [intprob], i
   372 0000037B E979010000          <2>  jmp unhand2
   373                              <2>  %assign i i+1
   374 00000380 FA                  <2>  cli
   375 00000381 C605[F2050000]0B    <2>  mov byte [intprob], i
   376 00000388 E96C010000          <2>  jmp unhand2
   377                              <2>  %assign i i+1
   378 0000038D FA                  <2>  cli
   379 0000038E C605[F2050000]0C    <2>  mov byte [intprob], i
   380 00000395 E95F010000          <2>  jmp unhand2
   381                              <2>  %assign i i+1
   382 0000039A FA                  <2>  cli
   383 0000039B C605[F2050000]0D    <2>  mov byte [intprob], i
   384 000003A2 E952010000          <2>  jmp unhand2
   385                              <2>  %assign i i+1
   386 000003A7 FA                  <2>  cli
   387 000003A8 C605[F2050000]0E    <2>  mov byte [intprob], i
   388 000003AF E945010000          <2>  jmp unhand2
   389                              <2>  %assign i i+1
   390 000003B4 FA                  <2>  cli
   391 000003B5 C605[F2050000]0F    <2>  mov byte [intprob], i
   392 000003BC E938010000          <2>  jmp unhand2
   393                              <2>  %assign i i+1
   394 000003C1 FA                  <2>  cli
   395 000003C2 C605[F2050000]10    <2>  mov byte [intprob], i
   396 000003C9 E92B010000          <2>  jmp unhand2
   397                              <2>  %assign i i+1
   398 000003CE FA                  <2>  cli
   399 000003CF C605[F2050000]11    <2>  mov byte [intprob], i
   400 000003D6 E91E010000          <2>  jmp unhand2
   401                              <2>  %assign i i+1
   402 000003DB FA                  <2>  cli
   403 000003DC C605[F2050000]12    <2>  mov byte [intprob], i
   404 000003E3 E911010000          <2>  jmp unhand2
   405                              <2>  %assign i i+1
   406 000003E8 FA                  <2>  cli
   407 000003E9 C605[F2050000]13    <2>  mov byte [intprob], i
   408 000003F0 E904010000          <2>  jmp unhand2
   409                              <2>  %assign i i+1
   410 000003F5 FA                  <2>  cli
   411 000003F6 C605[F2050000]14    <2>  mov byte [intprob], i
   412 000003FD E9F7000000          <2>  jmp unhand2
   413                              <2>  %assign i i+1
   414 00000402 FA                  <2>  cli
   415 00000403 C605[F2050000]15    <2>  mov byte [intprob], i
   416 0000040A E9EA000000          <2>  jmp unhand2
   417                              <2>  %assign i i+1
   418 0000040F FA                  <2>  cli
   419 00000410 C605[F2050000]16    <2>  mov byte [intprob], i
   420 00000417 E9DD000000          <2>  jmp unhand2
   421                              <2>  %assign i i+1
   422 0000041C FA                  <2>  cli
   423 0000041D C605[F2050000]17    <2>  mov byte [intprob], i
   424 00000424 E9D0000000          <2>  jmp unhand2
   425                              <2>  %assign i i+1
   426 00000429 FA                  <2>  cli
   427 0000042A C605[F2050000]18    <2>  mov byte [intprob], i
   428 00000431 E9C3000000          <2>  jmp unhand2
   429                              <2>  %assign i i+1
   430 00000436 FA                  <2>  cli
   431 00000437 C605[F2050000]19    <2>  mov byte [intprob], i
   432 0000043E E9B6000000          <2>  jmp unhand2
   433                              <2>  %assign i i+1
   434 00000443 FA                  <2>  cli
   435 00000444 C605[F2050000]1A    <2>  mov byte [intprob], i
   436 0000044B E9A9000000          <2>  jmp unhand2
   437                              <2>  %assign i i+1
   438 00000450 FA                  <2>  cli
   439 00000451 C605[F2050000]1B    <2>  mov byte [intprob], i
   440 00000458 E99C000000          <2>  jmp unhand2
   441                              <2>  %assign i i+1
   442 0000045D FA                  <2>  cli
   443 0000045E C605[F2050000]1C    <2>  mov byte [intprob], i
   444 00000465 E98F000000          <2>  jmp unhand2
   445                              <2>  %assign i i+1
   446 0000046A FA                  <2>  cli
   447 0000046B C605[F2050000]1D    <2>  mov byte [intprob], i
   448 00000472 E982000000          <2>  jmp unhand2
   449                              <2>  %assign i i+1
   450 00000477 FA                  <2>  cli
   451 00000478 C605[F2050000]1E    <2>  mov byte [intprob], i
   452 0000047F E975000000          <2>  jmp unhand2
   453                              <2>  %assign i i+1
   454 00000484 FA                  <2>  cli
   455 00000485 C605[F2050000]1F    <2>  mov byte [intprob], i
   456 0000048C E968000000          <2>  jmp unhand2
   457                              <2>  %assign i i+1
   458 00000491 FA                  <2>  cli
   459 00000492 C605[F2050000]20    <2>  mov byte [intprob], i
   460 00000499 E95B000000          <2>  jmp unhand2
   461                              <2>  %assign i i+1
   462 0000049E FA                  <2>  cli
   463 0000049F C605[F2050000]21    <2>  mov byte [intprob], i
   464 000004A6 E94E000000          <2>  jmp unhand2
   465                              <2>  %assign i i+1
   466 000004AB FA                  <2>  cli
   467 000004AC C605[F2050000]22    <2>  mov byte [intprob], i
   468 000004B3 E941000000          <2>  jmp unhand2
   469                              <2>  %assign i i+1
   470 000004B8 FA                  <2>  cli
   471 000004B9 C605[F2050000]23    <2>  mov byte [intprob], i
   472 000004C0 E934000000          <2>  jmp unhand2
   473                              <2>  %assign i i+1
   474 000004C5 FA                  <2>  cli
   475 000004C6 C605[F2050000]24    <2>  mov byte [intprob], i
   476 000004CD E927000000          <2>  jmp unhand2
   477                              <2>  %assign i i+1
   478 000004D2 FA                  <2>  cli
   479 000004D3 C605[F2050000]25    <2>  mov byte [intprob], i
   480 000004DA E91A000000          <2>  jmp unhand2
   481                              <2>  %assign i i+1
   482 000004DF FA                  <2>  cli
   483 000004E0 C605[F2050000]26    <2>  mov byte [intprob], i
   484 000004E7 E90D000000          <2>  jmp unhand2
   485                              <2>  %assign i i+1
   486 000004EC FA                  <2>  cli
   487 000004ED C605[F2050000]27    <2>  mov byte [intprob], i
   488 000004F4 E900000000          <2>  jmp unhand2
   489                              <2>  %assign i i+1
   490                              <1> unhand2:
   491 000004F9 60                  <1> 	pushad
   492 000004FA C705[EA020000]0000- <1> 	mov dword [user2codepoint], 0
   493 00000502 0000                <1>
   494 00000504 89E6                <1> 	mov esi, esp
   495 00000506 81C624000000        <1> 	add esi, 36
   496 0000050C 8935[E8050000]      <1> 	mov [esploc], esi
   497 00000512 BE[F3050000]        <1> 	mov esi, unhandmsg
   498 00000517 8935[EC050000]      <1> 	mov [esiloc], esi
   499 0000051D B900000000          <1> 	mov ecx, 0
   500 00000522 8A0D[F2050000]      <1> 	mov cl, [intprob]
   501 00000528 E856000000          <1> 	call expdump
   502                              <1> dumpstack:
   503 0000052D 8B35[E8050000]      <1> 	mov esi, [esploc]
   504 00000533 39E6                <1> 	cmp esi, esp
   505 00000535 7215                <1> 	jb donedump
   506 00000537 8B0E                <1> 	mov ecx, [esi]
   507 00000539 81EE04000000        <1> 	sub esi, 4
   508 0000053F 8935[E8050000]      <1> 	mov [esploc], esi
   509 00000545 E839000000          <1> 	call expdump
   510 0000054A EBE1                <1> 	jmp dumpstack
   511                              <1> donedump:
   512 0000054C 8B35[E8050000]      <1> 	mov esi, [esploc]
   513 00000552 8B7C2420            <1> 	mov edi, [esp + 32]
   514 00000556 8B4FFC              <1> 	mov ecx, [edi - 4]
   515 00000559 E825000000          <1> 	call expdump
   516 0000055E 8B35[E8050000]      <1> 	mov esi, [esploc]
   517 00000564 8B7C2420            <1> 	mov edi, [esp + 32]
   518 00000568 8B0F                <1> 	mov ecx, [edi]
   519 0000056A E814000000          <1> 	call expdump
   520 0000056F 8B35[E8050000]      <1> 	mov esi, [esploc]
   521 00000575 8B7C2420            <1> 	mov edi, [esp + 32]
   522 00000579 8B4F04              <1> 	mov ecx, [edi + 4]
   523 0000057C E802000000          <1> 	call expdump
   524 00000581 EBFE                <1> 	jmp $
   525                              <1> expdump:
   526 00000583 8B35[EC050000]      <1> 	mov esi, [esiloc]
   527 00000589 89F7                <1> 	mov edi, esi
   528 0000058B 81C70D000000        <1> 	add edi, 13
   529 00000591 81C604000000        <1> 	add esi, 4
   530 00000597 893D[EC050000]      <1> 	mov [esiloc], edi
   531 0000059D 4F                  <1> 	dec edi
   532 0000059E E89D0A0000          <1> 	call converthex
   533 000005A3 81EE04000000        <1> 	sub esi, 4
   534 000005A9 803D[C4280000]00    <1> 	cmp byte [guion], 0
   535 000005B0 0F8422000000        <1> 	je near expdumptext
   536 000005B6 668B0D[F0050000]    <1> 	mov cx, [locunhand]
   537 000005BD 668105[F0050000]10- <1> 	add word [locunhand], 16
   538 000005C5 00                  <1>
   539 000005C6 66BA0200            <1> 	mov dx, 2
   540 000005CA 66B80100            <1> 	mov ax, 1
   541 000005CE 66BB0000            <1> 	mov bx, 0
   542 000005D2 E8B12C0000          <1> 	call showstring
   543 000005D7 C3                  <1> 	ret
   544                              <1> expdumptext:
   545 000005D8 E8CF040000          <1> 	call print
   546 000005DD BE[C9400000]        <1> 	mov esi, line
   547 000005E2 E8C5040000          <1> 	call print
   548 000005E7 C3                  <1> 	ret
   549 000005E8 00000000            <1> esploc dd 0
   550 000005EC 00000000            <1> esiloc dd 0
   551 000005F0 0100                <1> locunhand dw 1
   552 000005F2 00                  <1> intprob db 0
   553 000005F3 494E54203030303030- <1> 	unhandmsg	db "INT 00000000",0
   554 000005FC 30303000            <1>
   555 00000600 43533A3D3030303030- <1> 			db "CS:=00000000",0
   556 00000609 30303000            <1>
   557 0000060D 4549503D3030303030- <1> 			db "EIP=00000000",0
   558 00000616 30303000            <1>
   559 0000061A 4541583D3030303030- <1> 			db "EAX=00000000",0
   560 00000623 30303000            <1>
   561 00000627 4543583D3030303030- <1> 			db "ECX=00000000",0
   562 00000630 30303000            <1>
   563 00000634 4544583D3030303030- <1> 			db "EDX=00000000",0
   564 0000063D 30303000            <1>
   565 00000641 4542583D3030303030- <1> 			db "EBX=00000000",0
   566 0000064A 30303000            <1>
   567 0000064E 4553503D3030303030- <1> 			db "ESP=00000000",0
   568 00000657 30303000            <1>
   569 0000065B 4542503D3030303030- <1> 			db "EBP=00000000",0
   570 00000664 30303000            <1>
   571 00000668 4553493D3030303030- <1> 			db "ESI=00000000",0
   572 00000671 30303000            <1>
   573 00000675 4544493D3030303030- <1> 			db "EDI=00000000",0
   574 0000067E 30303000            <1>
   575 00000682 434D443D3030303030- <1> 			db "CMD=00000000",0
   576 0000068B 30303000            <1>
   577 0000068F 434D443D3030303030- <1> 			db "CMD=00000000",0
   578 00000698 30303000            <1>
   579 0000069C 434D443D3030303030- <1> 			db "CMD=00000000",0
   580 000006A5 30303000            <1>
   581                              <1> unhandmsgend:
   582                              <1> 
   583                              <1> [BITS 16]
   584                              <1> ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
   585                              <1> ;	16-bit limit/32-bit linear base address of GDT and IDT
   586                              <1> ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
   587 000006A9 1F00                <1> gdtr:	dw gdt_end - gdt - 1	; GDT limit
   588 000006AB [B5060000]          <1> 	dd gdt			; linear, physical address of GDT
   589                              <1> 
   590 000006AF 8701                <1> idtr:	dw idt_end - idt - 1	; IDT limit
   591 000006B1 [DA060000]          <1> 	dd idt			; linear, physical address of IDT
   592                              <1> 
   593                              <1> 
   594 000006B5 0000                <1> gdt:	dw 0			; limit 15:0
   595 000006B7 0000                <1> 	dw 0			; base 15:0
   596 000006B9 00                  <1> 	db 0			; base 23:16
   597 000006BA 00                  <1> 	db 0			; type
   598 000006BB 00                  <1> 	db 0			; limit 19:16, flags
   599 000006BC 00                  <1> 	db 0			; base 31:24
   600                              <1> ; linear data segment descriptor
   601                              <1> LINEAR_SEL	equ	$-gdt
   602 000006BD FFFF                <1> 	dw 0xFFFF		; limit 0xFFFFF
   603 000006BF 0000                <1> 	dw 0			; base for this one is always 0
   604 000006C1 00                  <1> 	db 0
   605 000006C2 92                  <1> 	db 0x92			; present, ring 0, data, expand-up, writable
   606 000006C3 CF                  <1> 	db 0xCF			; page-granular, 32-bit
   607 000006C4 00                  <1> 	db 0
   608                              <1> ; code segment descriptor
   609                              <1> SYS_CODE_SEL	equ	$-gdt
   610 000006C5 FFFF                <1> gdt2:	dw 0xFFFF
   611 000006C7 0000                <1> 	dw 0			; (base gets set above)
   612 000006C9 00                  <1> 	db 0
   613 000006CA 9A                  <1> 	db 0x9A			; present, ring 0, code, non-conforming, readable
   614 000006CB CF                  <1> 	db 0xCF
   615 000006CC 00                  <1> 	db 0
   616                              <1> ; data segment descriptor
   617                              <1> SYS_DATA_SEL	equ	$-gdt
   618 000006CD FFFF                <1> gdt3:	dw 0xFFFF
   619 000006CF 0000                <1> 	dw 0			; (base gets set above)
   620 000006D1 00                  <1> 	db 0
   621 000006D2 92                  <1> 	db 0x92			; present, ring 0, data, expand-up, writable
   622 000006D3 CF                  <1> 	db 0xCF
   623 000006D4 00                  <1> 	db 0
   624                              <1> gdt_end:
   625                              <1> ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
   626                              <1> ;	interrupt descriptor table (IDT)
   627                              <1> ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
   628                              <1> ; 32 reserved interrupts:
   629 000006D5 494454              <1> db "IDT"
   630 000006D8 [F102]              <1> dw unhand
   631                              <1> idt:	
   632                              <1> %assign i 0 
   633                              <1> %rep    8
   634                              <1>         dw unhand + i*13,SYS_CODE_SEL,0x8E00,0
   635                              <1> %assign i i+1 
   636                              <1> %endrep
   637 000006DA [F102]1000008E0000  <2>  dw unhand + i*13,SYS_CODE_SEL,0x8E00,0
   638                              <2> %assign i i+1
   639 000006E2 [FE02]1000008E0000  <2>  dw unhand + i*13,SYS_CODE_SEL,0x8E00,0
   640                              <2> %assign i i+1
   641 000006EA [0B03]1000008E0000  <2>  dw unhand + i*13,SYS_CODE_SEL,0x8E00,0
   642                              <2> %assign i i+1
   643 000006F2 [1803]1000008E0000  <2>  dw unhand + i*13,SYS_CODE_SEL,0x8E00,0
   644                              <2> %assign i i+1
   645 000006FA [2503]1000008E0000  <2>  dw unhand + i*13,SYS_CODE_SEL,0x8E00,0
   646                              <2> %assign i i+1
   647 00000702 [3203]1000008E0000  <2>  dw unhand + i*13,SYS_CODE_SEL,0x8E00,0
   648                              <2> %assign i i+1
   649 0000070A [3F03]1000008E0000  <2>  dw unhand + i*13,SYS_CODE_SEL,0x8E00,0
   650                              <2> %assign i i+1
   651 00000712 [4C03]1000008E0000  <2>  dw unhand + i*13,SYS_CODE_SEL,0x8E00,0
   652                              <2> %assign i i+1
   653                              <1> 
   654 0000071A [F002]1000008E0000  <1> 	dw handled, SYS_CODE_SEL, 0x8E00, 0
   655                              <1> 
   656                              <1> %assign i 9
   657                              <1> %rep    39
   658                              <1>         dw unhand + i*13,SYS_CODE_SEL,0x8E00,0
   659                              <1> %assign i i+1 
   660                              <1> %endrep
   661 00000722 [6603]1000008E0000  <2>  dw unhand + i*13,SYS_CODE_SEL,0x8E00,0
   662                              <2> %assign i i+1
   663 0000072A [7303]1000008E0000  <2>  dw unhand + i*13,SYS_CODE_SEL,0x8E00,0
   664                              <2> %assign i i+1
   665 00000732 [8003]1000008E0000  <2>  dw unhand + i*13,SYS_CODE_SEL,0x8E00,0
   666                              <2> %assign i i+1
   667 0000073A [8D03]1000008E0000  <2>  dw unhand + i*13,SYS_CODE_SEL,0x8E00,0
   668                              <2> %assign i i+1
   669 00000742 [9A03]1000008E0000  <2>  dw unhand + i*13,SYS_CODE_SEL,0x8E00,0
   670                              <2> %assign i i+1
   671 0000074A [A703]1000008E0000  <2>  dw unhand + i*13,SYS_CODE_SEL,0x8E00,0
   672                              <2> %assign i i+1
   673 00000752 [B403]1000008E0000  <2>  dw unhand + i*13,SYS_CODE_SEL,0x8E00,0
   674                              <2> %assign i i+1
   675 0000075A [C103]1000008E0000  <2>  dw unhand + i*13,SYS_CODE_SEL,0x8E00,0
   676                              <2> %assign i i+1
   677 00000762 [CE03]1000008E0000  <2>  dw unhand + i*13,SYS_CODE_SEL,0x8E00,0
   678                              <2> %assign i i+1
   679 0000076A [DB03]1000008E0000  <2>  dw unhand + i*13,SYS_CODE_SEL,0x8E00,0
   680                              <2> %assign i i+1
   681 00000772 [E803]1000008E0000  <2>  dw unhand + i*13,SYS_CODE_SEL,0x8E00,0
   682                              <2> %assign i i+1
   683 0000077A [F503]1000008E0000  <2>  dw unhand + i*13,SYS_CODE_SEL,0x8E00,0
   684                              <2> %assign i i+1
   685 00000782 [0204]1000008E0000  <2>  dw unhand + i*13,SYS_CODE_SEL,0x8E00,0
   686                              <2> %assign i i+1
   687 0000078A [0F04]1000008E0000  <2>  dw unhand + i*13,SYS_CODE_SEL,0x8E00,0
   688                              <2> %assign i i+1
   689 00000792 [1C04]1000008E0000  <2>  dw unhand + i*13,SYS_CODE_SEL,0x8E00,0
   690                              <2> %assign i i+1
   691 0000079A [2904]1000008E0000  <2>  dw unhand + i*13,SYS_CODE_SEL,0x8E00,0
   692                              <2> %assign i i+1
   693 000007A2 [3604]1000008E0000  <2>  dw unhand + i*13,SYS_CODE_SEL,0x8E00,0
   694                              <2> %assign i i+1
   695 000007AA [4304]1000008E0000  <2>  dw unhand + i*13,SYS_CODE_SEL,0x8E00,0
   696                              <2> %assign i i+1
   697 000007B2 [5004]1000008E0000  <2>  dw unhand + i*13,SYS_CODE_SEL,0x8E00,0
   698                              <2> %assign i i+1
   699 000007BA [5D04]1000008E0000  <2>  dw unhand + i*13,SYS_CODE_SEL,0x8E00,0
   700                              <2> %assign i i+1
   701 000007C2 [6A04]1000008E0000  <2>  dw unhand + i*13,SYS_CODE_SEL,0x8E00,0
   702                              <2> %assign i i+1
   703 000007CA [7704]1000008E0000  <2>  dw unhand + i*13,SYS_CODE_SEL,0x8E00,0
   704                              <2> %assign i i+1
   705 000007D2 [8404]1000008E0000  <2>  dw unhand + i*13,SYS_CODE_SEL,0x8E00,0
   706                              <2> %assign i i+1
   707 000007DA [9104]1000008E0000  <2>  dw unhand + i*13,SYS_CODE_SEL,0x8E00,0
   708                              <2> %assign i i+1
   709 000007E2 [9E04]1000008E0000  <2>  dw unhand + i*13,SYS_CODE_SEL,0x8E00,0
   710                              <2> %assign i i+1
   711 000007EA [AB04]1000008E0000  <2>  dw unhand + i*13,SYS_CODE_SEL,0x8E00,0
   712                              <2> %assign i i+1
   713 000007F2 [B804]1000008E0000  <2>  dw unhand + i*13,SYS_CODE_SEL,0x8E00,0
   714                              <2> %assign i i+1
   715 000007FA [C504]1000008E0000  <2>  dw unhand + i*13,SYS_CODE_SEL,0x8E00,0
   716                              <2> %assign i i+1
   717 00000802 [D204]1000008E0000  <2>  dw unhand + i*13,SYS_CODE_SEL,0x8E00,0
   718                              <2> %assign i i+1
   719 0000080A [DF04]1000008E0000  <2>  dw unhand + i*13,SYS_CODE_SEL,0x8E00,0
   720                              <2> %assign i i+1
   721 00000812 [EC04]1000008E0000  <2>  dw unhand + i*13,SYS_CODE_SEL,0x8E00,0
   722                              <2> %assign i i+1
   723 0000081A [F904]1000008E0000  <2>  dw unhand + i*13,SYS_CODE_SEL,0x8E00,0
   724                              <2> %assign i i+1
   725 00000822 [0605]1000008E0000  <2>  dw unhand + i*13,SYS_CODE_SEL,0x8E00,0
   726                              <2> %assign i i+1
   727 0000082A [1305]1000008E0000  <2>  dw unhand + i*13,SYS_CODE_SEL,0x8E00,0
   728                              <2> %assign i i+1
   729 00000832 [2005]1000008E0000  <2>  dw unhand + i*13,SYS_CODE_SEL,0x8E00,0
   730                              <2> %assign i i+1
   731 0000083A [2D05]1000008E0000  <2>  dw unhand + i*13,SYS_CODE_SEL,0x8E00,0
   732                              <2> %assign i i+1
   733 00000842 [3A05]1000008E0000  <2>  dw unhand + i*13,SYS_CODE_SEL,0x8E00,0
   734                              <2> %assign i i+1
   735 0000084A [4705]1000008E0000  <2>  dw unhand + i*13,SYS_CODE_SEL,0x8E00,0
   736                              <2> %assign i i+1
   737 00000852 [5405]1000008E0000  <2>  dw unhand + i*13,SYS_CODE_SEL,0x8E00,0
   738                              <2> %assign i i+1
   739                              <1> 
   740                              <1> ;;INT 30h for os use and 3rd party use:
   741 0000085A [6208]1000008E0000  <1> 	dw newints,SYS_CODE_SEL,0x8E00,0
   742                              <1> idt_end:
   743                              <1> [BITS 32]
   744                                  [BITS 32]
   745                                      %include 'source/ints.asm'
   746                              <1> newints:	;;for great justice
   747 00000862 80FC00              <1> 	cmp ah, 0		;;originally 0
   748 00000865 0F8449000000        <1> 	je near intx0   ;;0=kills app
   749 0000086B 80FC01              <1> 	cmp ah, 1		;;originally 1
   750 0000086E 0F8445000000        <1> 	je near intx1   ;;3=print string
   751 00000874 80FC02              <1> 	cmp ah, 2		;;originally 2
   752 00000877 0F8442000000        <1> 	je near intx2	;;4=read string
   753 0000087D 80FC03              <1> 	cmp ah, 3		;;originally 3
   754 00000880 0F843F000000        <1> 	je near intx3	;;6=clear screen
   755 00000886 80FC04              <1> 	cmp ah, 4		;;originally 4
   756 00000889 0F843C000000        <1> 	je near intx4	;;5=read and print string
   757 0000088F 80FC05              <1> 	cmp ah, 5		;;originally 5		
   758 00000892 0F8439000000        <1> 	je near intx5	;;2=get char
   759 00000898 80FC06              <1> 	cmp ah, 6		;;originally 6
   760 0000089B 0F8436000000        <1> 	je near intx6	;;1=print char
   761 000008A1 80FC07              <1> 	cmp ah, 7
   762 000008A4 0F8433000000        <1> 	je near intx7	;;read file
   763 000008AA 80FC0A              <1> 	cmp ah, 10
   764 000008AD 0F8430000000        <1> 	je near intx10	;;create thread
   765 000008B3 C3                  <1> 	ret
   766                              <1> 	
   767                              <1> intx0:
   768 000008B4 E962040000          <1> 	jmp nwcmd
   769                              <1> intx1:
   770 000008B9 E8F6010000          <1> 	call int303
   771 000008BE C3                  <1> 	ret
   772                              <1> intx2:
   773 000008BF E80D020000          <1> 	call int304
   774 000008C4 C3                  <1> 	ret
   775                              <1> intx3:
   776 000008C5 E88E020000          <1> 	call int306
   777 000008CA C3                  <1> 	ret
   778                              <1> intx4:
   779 000008CB E825020000          <1> 	call int305
   780 000008D0 C3                  <1> 	ret
   781                              <1> intx5:
   782 000008D1 E8A6010000          <1> 	call int302
   783 000008D6 C3                  <1> 	ret
   784                              <1> intx6:
   785 000008D7 E812000000          <1> 	call int301
   786 000008DC C3                  <1> 	ret
   787                              <1> intx7:
   788 000008DD E8D5350000          <1> 	call loadfile
   789 000008E2 C3                  <1> 	ret
   790                              <1> intx10:
   791                              <1> ;	call thread
   792 000008E3 C3                  <1> 	ret
   793                              <1> 	
   794 000008E4 0000                <1> linebeginpos dw 0
   795 000008E6 0000                <1> videobufpos: dw 0
   796 000008E8 0000                <1> charpos db 0,0
   797 000008EA A01E                <1> charxy db 160,30
   798 000008EC 0000                <1> charbuf dw 0
   799                              <1> 
   800                              <1> int301:	;;print char, char in al, modifier in bl, will run videobuf2copy if called as is
   801 000008EE E807000000          <1> 	call int301prnt
   802 000008F3 E9A4020000          <1> 	jmp termcopy
   803 000008F8 00                  <1> termguion db 0
   804 000008F9 00                  <1> termcopyon db 0
   805                              <1> int301prnt:
   806 000008FA 88DC                <1> 	mov ah, bl
   807 000008FC 66A3[EC080000]      <1> 	mov [charbuf], ax
   808 00000902 BB00000000          <1> 	mov ebx, 0
   809 00000907 668B1D[E6080000]    <1> 	mov bx, [videobufpos]
   810 0000090E BF[97560000]        <1> 	mov edi, videobuf2
   811 00000913 01DF                <1> 	add edi, ebx
   812 00000915 BA00000000          <1> 	mov edx, 0
   813 0000091A 668B15[E8080000]    <1> 	mov dx, [charpos]
   814 00000921 B900000000          <1> 	mov ecx, 0
   815 00000926 668B0D[EA080000]    <1> 	mov cx, [charxy]
   816 0000092D 3C0D                <1> 	cmp al, 13
   817 0000092F 0F844B000000        <1> 	je near int301cr
   818 00000935 3C0A                <1> 	cmp al, 10
   819 00000937 0F8479000000        <1> 	je near int301nl
   820 0000093D 3C08                <1> 	cmp al, 8
   821 0000093F 0F8452000000        <1> 	je near int301bs
   822 00000945 668907              <1> 	mov [edi], ax
   823 00000948 81C702000000        <1> 	add edi, 2
   824 0000094E 80C202              <1> 	add dl, 2
   825                              <1> donecrnl:
   826 00000951 38CA                <1> 	cmp dl, cl
   827 00000953 0F838E000000        <1> 	jae near int301eol
   828                              <1> doneeol:
   829 00000959 38EE                <1> 	cmp dh, ch
   830 0000095B 0F83A4000000        <1> 	jae near int301scr	
   831                              <1> donescr:
   832 00000961 89FB                <1> 	mov ebx, edi
   833 00000963 81EB[97560000]      <1> 	sub ebx, videobuf2
   834 00000969 66891D[E6080000]    <1> 	mov [videobufpos], bx
   835 00000970 668915[E8080000]    <1> 	mov [charpos], dx
   836 00000977 66A1[EC080000]      <1> 	mov ax, [charbuf]
   837 0000097D 88E3                <1> 	mov bl, ah
   838 0000097F C3                  <1> 	ret
   839                              <1> 	
   840                              <1> 	int301cr:
   841 00000980 B200                <1> 		mov dl, 0
   842 00000982 BB00000000          <1> 		mov ebx, 0
   843 00000987 BF[97560000]        <1> 		mov edi, videobuf2
   844 0000098C 668B1D[E4080000]    <1> 		mov bx, [linebeginpos]
   845 00000993 01DF                <1> 		add edi, ebx
   846 00000995 EBBA                <1> 		jmp donecrnl
   847                              <1> 			
   848                              <1> 	int301bs:
   849 00000997 80FA00              <1> 		cmp dl, 0
   850 0000099A 740F                <1> 		je int301backline
   851                              <1> 	int301nobmr:
   852 0000099C 80EA02              <1> 		sub dl, 2
   853 0000099F 66B80000            <1> 		mov ax, 0
   854 000009A3 81EF02000000        <1> 		sub edi, 2
   855 000009A9 EBA6                <1> 		jmp donecrnl
   856                              <1> 	int301backline:
   857 000009AB 88CA                <1> 		mov dl, cl
   858 000009AD 80FE00              <1> 		cmp dh, 0
   859 000009B0 74EA                <1> 		je int301nobmr
   860 000009B2 FECE                <1> 		dec dh
   861 000009B4 EBE6                <1> 		jmp int301nobmr
   862                              <1> 		
   863                              <1> 	int301nl:
   864 000009B6 FEC6                <1> 		inc dh
   865 000009B8 BB00000000          <1> 		mov ebx, 0
   866 000009BD 88CB                <1> 		mov bl, cl
   867 000009BF BF[97560000]        <1> 		mov edi, videobuf2
   868 000009C4 66031D[E6080000]    <1> 		add bx, [videobufpos]
   869 000009CB 01DF                <1> 		add edi, ebx
   870 000009CD BB00000000          <1> 		mov ebx, 0
   871 000009D2 88CB                <1> 		mov bl, cl
   872 000009D4 66031D[E4080000]    <1> 		add bx, [linebeginpos]
   873 000009DB 66891D[E4080000]    <1> 		mov [linebeginpos], bx
   874 000009E2 E96AFFFFFF          <1> 		jmp donecrnl
   875                              <1> 		
   876                              <1> 	int301eol:
   877 000009E7 B200                <1> 		mov dl, 0
   878 000009E9 FEC6                <1> 		inc dh
   879 000009EB BB00000000          <1> 		mov ebx, 0
   880 000009F0 88CB                <1> 		mov bl, cl
   881 000009F2 66031D[E4080000]    <1> 		add bx, [linebeginpos]
   882 000009F9 66891D[E4080000]    <1> 		mov [linebeginpos], bx
   883 00000A00 E954FFFFFF          <1> 		jmp doneeol
   884                              <1> 		
   885                              <1> 	int301scr:
   886 00000A05 FECE                <1> 		dec dh
   887 00000A07 BF[97560000]        <1> 		mov edi, videobuf2
   888 00000A0C BB00000000          <1> 		mov ebx, 0
   889 00000A11 88CB                <1> 		mov bl, cl
   890 00000A13 01FB                <1> 		add ebx, edi
   891                              <1> 	intscrollloop:
   892 00000A15 668B03              <1> 		mov ax, [ebx]
   893 00000A18 668907              <1> 		mov [edi], ax
   894 00000A1B 81C702000000        <1> 		add edi, 2
   895 00000A21 81C302000000        <1> 		add ebx, 2
   896 00000A27 80E902              <1> 		sub cl, 2
   897 00000A2A 80F900              <1> 		cmp cl, 0
   898 00000A2D 75E6                <1> 		jne intscrollloop
   899 00000A2F 8A0D[EA080000]      <1> 		mov cl, [charxy]
   900 00000A35 FECD                <1> 		dec ch
   901 00000A37 80FD01              <1> 		cmp ch, 1
   902 00000A3A 77D9                <1> 		ja intscrollloop
   903 00000A3C 66B80000            <1> 		mov ax, 0
   904 00000A40 81EF[97560000]      <1> 		sub edi, videobuf2
   905 00000A46 66893D[E4080000]    <1> 		mov [linebeginpos], di
   906 00000A4D 81C7[97560000]      <1> 		add edi, videobuf2
   907 00000A53 89FB                <1> 		mov ebx, edi
   908                              <1> 	intloopclear:
   909 00000A55 668903              <1> 		mov [ebx], ax
   910 00000A58 81C302000000        <1> 		add ebx, 2
   911 00000A5E 80E902              <1> 		sub cl, 2
   912 00000A61 80F900              <1> 		cmp cl, 0
   913 00000A64 75EF                <1> 		jne intloopclear
   914 00000A66 FECD                <1> 		dec ch
   915 00000A68 80FD00              <1> 		cmp ch, 0
   916 00000A6B 75E8                <1> 		jne intloopclear
   917 00000A6D 668B0D[EA080000]    <1> 		mov cx, [charxy]
   918 00000A74 E9E8FEFFFF          <1> 		jmp donescr
   919                              <1> 		
   920                              <1> 		
   921 00000A79 0000                <1> lastkey db 0,0
   922 00000A7B 00                  <1> trans db 0
   923                              <1> 
   924                              <1> 	int302:		;;get char, if al is 0, wait for key
   925 00000A7C A2[7B0A0000]        <1> 		mov [trans], al
   926                              <1> 	transcheck:
   927 00000A81 E8C8170000          <1> 		call guistartin
   928 00000A86 8A3D[7B0A0000]      <1> 		mov bh, [trans]
   929 00000A8C 66A1[790A0000]      <1> 		mov ax, [lastkey]
   930 00000A92 80FC1C              <1> 		cmp ah, 1Ch
   931 00000A95 740C                <1> 		je int302enter
   932 00000A97 08C7                <1> 		or bh, al
   933 00000A99 80FF00              <1> 		cmp bh, 0
   934 00000A9C 74E3                <1> 		je transcheck
   935 00000A9E E907000000          <1> 		jmp int302end
   936                              <1> 	int302enter:
   937 00000AA3 B00D                <1> 		mov al, 13
   938 00000AA5 E900000000          <1> 		jmp int302end
   939                              <1> 	int302end:
   940 00000AAA C3                  <1> 		ret
   941                              <1> 	
   942 00000AAB 00                  <1> endkey303 db 0
   943                              <1>     print:
   944 00000AAC 66B80000            <1> 		mov ax, 0
   945 00000AB0 66BB0700            <1> 		mov bx, 7
   946                              <1> 	int303:	;;print line, al=last key,bl=modifier, esi=buffer
   947 00000AB4 A2[AB0A0000]        <1> 		mov [endkey303], al
   948                              <1> 	int303b:
   949 00000AB9 8A06                <1> 		mov al, [esi]
   950 00000ABB 3A05[AB0A0000]      <1> 		cmp al, [endkey303]
   951 00000AC1 7408                <1> 		je doneint303
   952 00000AC3 E832FEFFFF          <1> 		call int301prnt
   953 00000AC8 46                  <1> 		inc esi
   954 00000AC9 EBEE                <1> 		jmp int303b
   955                              <1> 	doneint303:
   956 00000ACB E9CC000000          <1> 		jmp termcopy
   957                              <1> 	
   958 00000AD0 00                  <1> endkey304 db 0
   959                              <1> 	int304:	;;get line, al=last key, esi = buffer
   960 00000AD1 A2[D00A0000]        <1> 		mov [endkey304], al
   961                              <1> 	int304b:
   962 00000AD6 56                  <1> 		push esi
   963 00000AD7 B000                <1> 		mov al, 0
   964 00000AD9 E89EFFFFFF          <1> 		call int302
   965 00000ADE 5E                  <1> 		pop esi
   966 00000ADF 8806                <1> 		mov [esi], al
   967 00000AE1 46                  <1> 		inc esi
   968 00000AE2 3A05[D00A0000]      <1> 		cmp al, [endkey304]
   969 00000AE8 75EC                <1> 		jne int304b
   970 00000AEA 4E                  <1> 		dec esi
   971 00000AEB C60600              <1> 		mov byte [esi], 0
   972 00000AEE C3                  <1> 	ret
   973                              <1> 	
   974 00000AEF 00                  <1> endkey305 db 0
   975 00000AF0 00                  <1> modkey305 db 0
   976 00000AF1 00000000            <1> firstesi305 dd 0
   977                              <1> 	int305:	;;print and get line, al=last key, bl=modifier, esi=buffer
   978 00000AF5 A2[EF0A0000]        <1> 		mov [endkey305], al
   979 00000AFA 881D[F00A0000]      <1> 		mov [modkey305], bl
   980 00000B00 8935[F10A0000]      <1> 		mov [firstesi305], esi
   981                              <1> 	int305b:
   982 00000B06 56                  <1> 		push esi
   983 00000B07 B000                <1> 		mov al, 0
   984 00000B09 E86EFFFFFF          <1> 		call int302
   985 00000B0E 5E                  <1> 		pop esi
   986 00000B0F 3C08                <1> 		cmp al, 8
   987 00000B11 0F841D000000        <1> 		je near int305bscheck
   988 00000B17 8806                <1> 		mov [esi], al
   989 00000B19 46                  <1> 		inc esi
   990                              <1> 	bscheckequal:
   991 00000B1A 8A1D[F00A0000]      <1> 		mov bl, [modkey305]
   992 00000B20 E8C9FDFFFF          <1> 		call int301
   993 00000B25 8A25[EF0A0000]      <1> 		mov ah, [endkey305]
   994 00000B2B 38E0                <1> 		cmp al, ah
   995 00000B2D 75D7                <1> 		jne int305b
   996 00000B2F 4E                  <1> 		dec esi
   997 00000B30 C60600              <1> 		mov byte [esi], 0
   998 00000B33 C3                  <1> 		ret
   999                              <1> 	
  1000                              <1> 	int305bscheck:
  1001 00000B34 3B35[F10A0000]      <1> 		cmp esi, [firstesi305]
  1002 00000B3A 7702                <1> 		ja goodbscheck
  1003 00000B3C EBC8                <1> 		jmp int305b
  1004                              <1> 	goodbscheck:
  1005 00000B3E 4E                  <1> 		dec esi
  1006 00000B3F C60600              <1> 		mov byte [esi], 0
  1007 00000B42 8A1D[F00A0000]      <1> 		mov bl, [modkey305]
  1008 00000B48 E8A1FDFFFF          <1> 		call int301
  1009 00000B4D B020                <1> 		mov al, " "
  1010 00000B4F E89AFDFFFF          <1> 		call int301
  1011 00000B54 B008                <1> 		mov al, 8
  1012 00000B56 EBC2                <1> 		jmp bscheckequal
  1013                              <1> 		
  1014                              <1> 	clear:		
  1015                              <1> 	
  1016                              <1> 	int306:	;;clear screen
  1017 00000B58 668B0D[EA080000]    <1> 		mov cx, [charxy]
  1018 00000B5F BF[97560000]        <1> 		mov edi, videobuf2
  1019 00000B64 66B80000            <1> 		mov ax, 0
  1020 00000B68 66A3[E4080000]      <1> 		mov [linebeginpos], ax
  1021 00000B6E 66A3[E6080000]      <1> 		mov [videobufpos], ax
  1022 00000B74 66BA0000            <1> 		mov dx, 0
  1023 00000B78 66A3[E8080000]      <1> 		mov [charpos], ax
  1024                              <1> 	int306b:
  1025 00000B7E 668907              <1> 		mov [edi], ax
  1026 00000B81 81C702000000        <1> 		add edi, 2
  1027 00000B87 80E902              <1> 		sub cl, 2
  1028 00000B8A 80F900              <1> 		cmp cl, 0
  1029 00000B8D 75EF                <1> 		jne int306b
  1030 00000B8F 8A0D[EA080000]      <1> 		mov cl, [charxy]
  1031 00000B95 FECD                <1> 		dec ch
  1032 00000B97 80FD00              <1> 		cmp ch, 0
  1033 00000B9A 75E2                <1> 		jne int306b
  1034                              <1> 	
  1035                              <1> termcopy:	
  1036 00000B9C 60                  <1> 	pusha
  1037 00000B9D C605[C3280000]00    <1> 	mov byte [mouseselecton], 0
  1038 00000BA4 C605[F9080000]01    <1> 	mov byte [termcopyon], 1
  1039 00000BAB 803D[C4280000]00    <1> 	cmp byte [guion], 0
  1040 00000BB2 0F840D000000        <1> 	je near nowincopy
  1041 00000BB8 803D[F8080000]01    <1> 	cmp byte [termguion], 1
  1042 00000BBF 0F84D6280000        <1> 	je near windowvideocopy
  1043                              <1> nowincopy:
  1044 00000BC5 BE00000A00          <1> 	mov esi, 0xA0000
  1045 00000BCA B800000000          <1> 	mov eax, 0
  1046 00000BCF 66A1[EE020000]      <1> 	mov ax, [cscache]
  1047 00000BD5 C1E004              <1> 	shl eax, 4
  1048 00000BD8 29C6                <1> 	sub esi, eax
  1049 00000BDA BF[97560000]        <1> 	mov edi, videobuf2
  1050 00000BDF B900000000          <1> 	mov ecx, 0
  1051 00000BE4 668B0D[EA080000]    <1> 	mov cx, [charxy]
  1052                              <1> nowincopy2:
  1053 00000BEB BB[72410000]        <1> 	mov ebx, fonts
  1054 00000BF0 B800000000          <1> 	mov eax, 0
  1055 00000BF5 8A07                <1> 	mov al, [edi]
  1056 00000BF7 C1E004              <1> 	shl eax, 4
  1057 00000BFA 01C3                <1> 	add ebx, eax
  1058 00000BFC 47                  <1> 	inc edi
  1059 00000BFD 8A27                <1> 	mov ah, [edi]
  1060 00000BFF BA00000000          <1> 	mov edx, 0
  1061 00000C04 8A15[EA080000]      <1> 	mov dl, [charxy]
  1062 00000C0A D1EA                <1> 	shr edx, 1
  1063 00000C0C C1C110              <1> 	rol ecx, 16
  1064 00000C0F B110                <1> 	mov cl, 16
  1065                              <1> nowinfont
  1066 00000C11 8A03                <1> 	mov al, [ebx]
  1067 00000C13 D0C8                <1> 	ror al, 1
  1068 00000C15 80FC07              <1> 	cmp ah, 7
  1069 00000C18 7602                <1> 	jbe notnotfont
  1070 00000C1A F6D0                <1> 	not al
  1071                              <1> notnotfont:
  1072 00000C1C 8806                <1> 	mov [esi], al
  1073 00000C1E 01D6                <1> 	add esi, edx
  1074 00000C20 43                  <1> 	inc ebx
  1075 00000C21 FEC9                <1> 	dec cl
  1076 00000C23 80F900              <1> 	cmp cl, 0
  1077 00000C26 75E9                <1> 	jne nowinfont
  1078 00000C28 C1E204              <1> 	shl edx, 4
  1079 00000C2B 29D6                <1> 	sub esi, edx
  1080 00000C2D C1C110              <1> 	rol ecx, 16
  1081                              <1> nopresentwinfont:
  1082 00000C30 47                  <1> 	inc edi
  1083 00000C31 46                  <1> 	inc esi
  1084 00000C32 80E902              <1> 	sub cl, 2
  1085 00000C35 80F900              <1> 	cmp cl, 0
  1086 00000C38 75B1                <1> 	jne nowincopy2
  1087 00000C3A 8A0D[EA080000]      <1> 	mov cl, [charxy]
  1088 00000C40 BA00000000          <1> 	mov edx, 0
  1089 00000C45 88CA                <1> 	mov dl, cl
  1090 00000C47 D1EA                <1> 	shr edx, 1
  1091 00000C49 29D6                <1> 	sub esi, edx
  1092 00000C4B C1E204              <1> 	shl edx, 4
  1093 00000C4E 01D6                <1> 	add esi, edx
  1094 00000C50 FECD                <1> 	dec ch
  1095 00000C52 80FD00              <1> 	cmp ch, 0
  1096 00000C55 7594                <1> 	jne nowincopy2
  1097 00000C57 61                  <1> 	popa
  1098 00000C58 C3                  <1> 	ret
  1099                                      %include 'source/solleros.asm'
  1100                              <1> 	;SOLLEROS.ASM
  1101                              <1> os:
  1102 00000C59 E844060000          <1> 	call indexfiles
  1103 00000C5E B403                <1> 	mov ah, 3
  1104 00000C60 CD30                <1> 	int 30h
  1105 00000C62 BE[98400000]        <1> 	mov esi, pwdask
  1106 00000C67 E840FEFFFF          <1> 	call print
  1107 00000C6C E8A2160000          <1> 	call cursorgui
  1108                              <1> passcheck:
  1109 00000C71 BE[82540000]        <1> 	mov esi, buftxt
  1110                              <1> passcheck2:
  1111 00000C76 B000                <1> 	mov al, 0
  1112 00000C78 B405                <1> 	mov ah, 5
  1113 00000C7A CD30                <1> 	int 30h
  1114 00000C7C 3C0D                <1> 	cmp al, 13
  1115 00000C7E 0F8434000000        <1> 	je near gotpass
  1116 00000C84 3C08                <1> 	cmp al, 8
  1117 00000C86 0F840B000000        <1> 	je near backpass
  1118 00000C8C 8806                <1> 	mov [esi], al
  1119 00000C8E 46                  <1> 	inc esi
  1120 00000C8F B02A                <1> 	mov al, '*'
  1121 00000C91 B406                <1> 	mov ah, 6
  1122 00000C93 CD30                <1> 	int 30h
  1123 00000C95 EBDF                <1> 	jmp passcheck2
  1124                              <1> backpass:
  1125 00000C97 81FE[82540000]      <1> 	cmp esi, buftxt
  1126 00000C9D 0F84D3FFFFFF        <1> 	je near passcheck2
  1127 00000CA3 4E                  <1> 	dec esi
  1128 00000CA4 B008                <1> 	mov al, 8
  1129 00000CA6 B406                <1> 	mov ah, 6
  1130 00000CA8 CD30                <1> 	int 30h
  1131 00000CAA B020                <1> 	mov al, " "
  1132 00000CAC B406                <1> 	mov ah, 6
  1133 00000CAE CD30                <1> 	int 30h
  1134 00000CB0 B008                <1> 	mov al, 8
  1135 00000CB2 B406                <1> 	mov ah, 6
  1136 00000CB4 CD30                <1> 	int 30h
  1137 00000CB6 EBBE                <1> 	jmp passcheck2
  1138                              <1> gotpass:
  1139 00000CB8 B000                <1> 	mov al,0
  1140 00000CBA 8806                <1> 	mov [esi], al
  1141 00000CBC BE[C9400000]        <1> 	mov esi, line
  1142 00000CC1 E8E6FDFFFF          <1> 	call print
  1143 00000CC6 BE[82540000]        <1> 	mov esi, buftxt
  1144 00000CCB BB[A8400000]        <1> 	mov ebx, pwd
  1145 00000CD0 E811010000          <1> 	call tester
  1146 00000CD5 3C01                <1> 	cmp al, 1
  1147 00000CD7 7405                <1> 	je pwdrgt
  1148 00000CD9 E97BFFFFFF          <1> 	jmp os
  1149 00000CDE E875FEFFFF          <1> pwdrgt:	call clear
  1150 00000CE3 66B90002            <1> 	mov cx, 200h
  1151 00000CE7 BE[82540000]        <1> 	mov esi, buftxt
  1152 00000CEC B000                <1> 	mov al, 0
  1153 00000CEE 8806                <1> bufclr:	mov [esi], al
  1154 00000CF0 46                  <1> 	inc esi
  1155 00000CF1 E2FB                <1> 	loop bufclr
  1156 00000CF3 E923000000          <1> 	jmp nwcmd
  1157                              <1> 
  1158                              <1> buftxtclear:
  1159 00000CF8 B000                <1> 	mov al, 0
  1160 00000CFA BE[82540000]        <1> 	mov esi, buftxt
  1161 00000CFF 81FE[82560000]      <1> clearbuftxt: cmp esi, buf2
  1162 00000D05 730E                <1> 	jae retbufclr
  1163 00000D07 8806                <1> 	mov [esi], al
  1164 00000D09 46                  <1> 	inc esi
  1165 00000D0A EBF3                <1> 	jmp clearbuftxt
  1166                              <1> 
  1167 00000D0C 39DE                <1> clearitbuf: cmp esi, ebx
  1168 00000D0E 7305                <1> 	jae retbufclr
  1169 00000D10 8806                <1> 	mov [esi], al
  1170 00000D12 46                  <1> 	inc esi
  1171 00000D13 EBF7                <1> 	jmp clearitbuf
  1172 00000D15 C3                  <1> retbufclr: ret
  1173                              <1> 
  1174 00000D16 E900000000          <1> full:	jmp nwcmd
  1175                              <1> 
  1176                              <1> 
  1177 00000D1B B001                <1> nwcmd:	mov al, 1
  1178 00000D1D 3805[7B4D0000]      <1> 	cmp [BATCHISON], al
  1179 00000D23 0F832D000000        <1> 	jae near batchran
  1180 00000D29 B000                <1> cancel:	mov al, 0
  1181 00000D2B A2[124D0000]        <1> 	mov [IFON], al
  1182 00000D30 A2[7B4D0000]        <1> 	mov [BATCHISON], al
  1183 00000D35 BE[B1400000]        <1> 	mov esi, cmd
  1184 00000D3A E86DFDFFFF          <1> 	call print
  1185 00000D3F E8B4FFFFFF          <1> 	call buftxtclear
  1186 00000D44 BE[82540000]        <1> 	mov esi, buftxt
  1187 00000D49 B00D                <1> 	mov al, 13
  1188 00000D4B B307                <1> 	mov bl, 7
  1189 00000D4D B404                <1> 	mov ah, 4
  1190 00000D4F CD30                <1> 	int 30h
  1191                              <1> gotcmd:	
  1192 00000D51 E914000000          <1> 	jmp run
  1193                              <1> 	
  1194                              <1> batchran:
  1195 00000D56 C3                  <1> 	ret
  1196                              <1> 
  1197 00000D57 E89CFFFFFF          <1> input:	call buftxtclear
  1198 00000D5C BE[82540000]        <1> 	mov esi, buftxt		;puts input into buftxt AND onto screen
  1199 00000D61 B00D                <1> stdin:	mov al, 13
  1200 00000D63 B307                <1> 	mov bl, 7
  1201 00000D65 B404                <1> 	mov ah, 4
  1202 00000D67 CD30                <1> 	int 30h
  1203 00000D69 C3                  <1> 	ret
  1204                              <1> 
  1205 00000D6A BE[C9400000]        <1> run:	mov esi, line
  1206 00000D6F E838FDFFFF          <1> 		call print
  1207                              <1> progtest:
  1208 00000D74 BE[82540000]        <1> 	mov esi, buftxt
  1209 00000D79 BB[814D0000]        <1> 	mov ebx, fileindex
  1210 00000D7E 668B03              <1> prgnxt:	mov ax, [ebx]
  1211 00000D81 B105                <1> 	mov cl, 5
  1212 00000D83 B504                <1> 	mov ch, 4
  1213 00000D85 6639C8              <1> 	cmp ax, cx
  1214 00000D88 740B                <1> 	je fndprg
  1215 00000D8A 43                  <1> 	inc ebx
  1216 00000D8B 81FB[814F0000]      <1> 	cmp ebx, fileindexend
  1217 00000D91 7330                <1> 	jae prgnf
  1218 00000D93 EBE9                <1> 	jmp prgnxt
  1219 00000D95 81C302000000        <1> fndprg: add ebx, 2
  1220 00000D9B BE[82540000]        <1> 	mov esi, buftxt
  1221 00000DA0 66B90000            <1> 	mov cx, 0
  1222 00000DA4 E877000000          <1> 	call cndtest
  1223 00000DA9 3C01                <1> 	cmp al, 1
  1224 00000DAB 7302                <1> 	jae prggood
  1225 00000DAD EBCF                <1> 	jmp prgnxt
  1226 00000DAF 81FB[814F0000]      <1> prggood: cmp ebx, fileindexend
  1227 00000DB5 732A                <1> 	jae prgdn
  1228 00000DB7 81C303000000        <1> 	add ebx, 3
  1229 00000DBD 8B3B                <1> 	mov edi, [ebx]
  1230 00000DBF 90                  <1> 	nop
  1231 00000DC0 90                  <1> 	nop
  1232 00000DC1 FFE7                <1> 	jmp edi
  1233 00000DC3 BE[7F400000]        <1> prgnf:	mov esi, notfound1
  1234 00000DC8 E8DFFCFFFF          <1> 	call print
  1235 00000DCD BE[82540000]        <1> 	mov esi, buftxt
  1236 00000DD2 E8D5FCFFFF          <1> 	call print
  1237 00000DD7 BE[89400000]        <1> 	mov esi, notfound2
  1238 00000DDC E8CBFCFFFF          <1> 	call print
  1239 00000DE1 E935FFFFFF          <1> prgdn:	jmp nwcmd
  1240                              <1> 
  1241                              <1> 
  1242                              <1> tester:			;si=user bx=prog returns 1 in al if true
  1243 00000DE6 B000                <1> 	mov al, 0
  1244 00000DE8 8A06                <1> retest:	mov al, [esi]
  1245 00000DEA 8A23                <1> 	mov ah, [ebx]
  1246 00000DEC 3C00                <1> 	cmp al, 0
  1247 00000DEE 7408                <1> 	je testtrue
  1248 00000DF0 38E0                <1> 	cmp al, ah
  1249 00000DF2 750C                <1> 	jne testfalse
  1250 00000DF4 43                  <1> 	inc ebx
  1251 00000DF5 46                  <1> 	inc esi
  1252 00000DF6 EBF0                <1> 	jmp retest
  1253                              <1> testtrue:
  1254 00000DF8 80FC00              <1> 	cmp ah, 0
  1255 00000DFB 7503                <1> 	jne testfalse
  1256 00000DFD B001                <1> 	mov al, 1
  1257 00000DFF C3                  <1> 	ret
  1258                              <1> testfalse:
  1259 00000E00 B000                <1> 	mov al, 0
  1260 00000E02 C3                  <1> 	ret
  1261                              <1> 
  1262                              <1> optest:			;si=user bx=prog returns 1 in al if true
  1263 00000E03 B000                <1> 	mov al, 0
  1264                              <1> opretest:
  1265 00000E05 8A06                <1> 	mov al, [esi]
  1266 00000E07 8A23                <1> 	mov ah, [ebx]
  1267 00000E09 38E0                <1> 	cmp al, ah
  1268 00000E0B 7510                <1> 	jne optestfalse
  1269 00000E0D 80FC00              <1> 	cmp ah, 0
  1270 00000E10 7404                <1> 	je optesttrue
  1271 00000E12 43                  <1> 	inc ebx
  1272 00000E13 46                  <1> 	inc esi
  1273 00000E14 EBEF                <1> 	jmp opretest
  1274                              <1> optesttrue:
  1275 00000E16 3C00                <1> 	cmp al, 0
  1276 00000E18 7503                <1> 	jne optestfalse
  1277 00000E1A B001                <1> 	mov al, 1
  1278 00000E1C C3                  <1> 	ret
  1279                              <1> optestfalse:
  1280 00000E1D B000                <1> 	mov al, 0
  1281 00000E1F C3                  <1> 	ret
  1282                              <1> 
  1283                              <1> cndtest:			;si=user bx=prog cl=endchar returns 1 in al if true
  1284 00000E20 B000                <1> 	mov al, 0
  1285 00000E22 8A06                <1> cndretest:	mov al, [esi]
  1286 00000E24 8A23                <1> 	mov ah, [ebx]
  1287 00000E26 38CC                <1> 	cmp ah, cl
  1288 00000E28 7408                <1> 	je cndtesttrue
  1289 00000E2A 38E0                <1> 	cmp al, ah
  1290 00000E2C 750B                <1> 	jne cndtestfalse
  1291 00000E2E 43                  <1> 	inc ebx
  1292 00000E2F 46                  <1> 	inc esi
  1293 00000E30 EBF0                <1> 	jmp cndretest
  1294                              <1> cndtesttrue:
  1295 00000E32 38C8                <1> 	cmp al, cl
  1296 00000E34 7506                <1> 	jne cndtestalmost
  1297 00000E36 B001                <1> 	mov al, 1
  1298 00000E38 C3                  <1> 	ret
  1299                              <1> cndtestfalse:
  1300 00000E39 B000                <1> 	mov al, 0
  1301 00000E3B C3                  <1> 	ret
  1302                              <1> cndtestalmost:
  1303 00000E3C B002                <1> 	mov al, 2
  1304 00000E3E C3                  <1> 	ret
  1305 00000E3F 00                  <1> currentdir db 0
  1306 00000E40 BE[814D0000]        <1> dir:	mov esi, fileindex
  1307 00000E45 8A06                <1> 	dirnxt:	mov al, [esi]
  1308 00000E47 B400                <1> 		mov ah, 0
  1309 00000E49 3C05                <1> 		cmp al, 5
  1310 00000E4B 744A                <1> 		je dirfnd
  1311 00000E4D 3C07                <1> 		cmp al, 7
  1312 00000E4F 743C                <1> 		je dirfnd3
  1313 00000E51 3C06                <1> 		cmp al, 6
  1314 00000E53 7438                <1> 		je dirfnd3
  1315 00000E55 46                  <1> 		inc esi
  1316 00000E56 81FE[814F0000]      <1> 		cmp esi,  fileindexend
  1317 00000E5C 737B                <1> 		jae dirdn
  1318 00000E5E EBE5                <1> 		jmp dirnxt
  1319 00000E60 060400626174636800- <1> 	typetable db 6,4,0,"batch",0,7,4,0,"document",0,10,4,0,"folder",0,5,4,0,"executable",0
  1320 00000E69 070400646F63756D65- <1>
  1321 00000E72 6E74000A0400666F6C- <1>
  1322 00000E7B 646572000504006578- <1>
  1323 00000E84 6563757461626C6500  <1>
  1324                              <1> 	dirfnd3:
  1325 00000E8D 46                  <1> 		inc esi
  1326 00000E8E 81FE[814F0000]      <1> 		cmp esi, fileindexend
  1327 00000E94 76AF                <1> 		jbe dirnxt
  1328 00000E96 4E                  <1> 		dec esi
  1329 00000E97 46                  <1> 	dirfnd:	inc esi
  1330 00000E98 8A06                <1> 		mov al, [esi]
  1331 00000E9A B400                <1> 		mov ah, 0
  1332 00000E9C 3C04                <1> 		cmp al, 4
  1333 00000E9E 740B                <1> 		je dirfnd2
  1334 00000EA0 46                  <1> 		inc esi
  1335 00000EA1 81FE[814F0000]      <1> 		cmp esi,  fileindexend
  1336 00000EA7 7330                <1> 		jae dirdn
  1337 00000EA9 EB9A                <1> 		jmp dirnxt
  1338 00000EAB 81C601000000        <1> 	dirfnd2: add esi, 1
  1339 00000EB1 E8F6FBFFFF          <1> 		call print
  1340 00000EB6 8935[DE0E0000]      <1> 		mov [esidir], esi
  1341 00000EBC BE[C9400000]        <1> 		mov esi, line
  1342 00000EC1 E8E6FBFFFF          <1> 		call print
  1343 00000EC6 8B35[DE0E0000]      <1> 		mov esi, [esidir]
  1344 00000ECC 81FE[814F0000]      <1> 		cmp esi,  fileindexend
  1345 00000ED2 7305                <1> 		jae dirdn
  1346 00000ED4 E96CFFFFFF          <1> 		jmp dirnxt
  1347 00000ED9 E93DFEFFFF          <1> 	dirdn:	jmp nwcmd
  1348 00000EDE 00000000            <1> esidir dd 0
  1349                              <1> 
  1350                              <1> array:				;arraystart in si, arrayend in bx, arrayseperator in cx
  1351                              <1> 		                ;ends if array seperator is found backwards after 0
  1352                              <1> 	arnxt:	      
  1353 00000EE2 88E8                <1> 		mov al, ch
  1354 00000EE4 88CC                <1> 		mov ah, cl        
  1355 00000EE6 663906              <1> 		cmp [esi], ax
  1356 00000EE9 744D                <1> 		je ardn
  1357 00000EEB 66390E              <1> 		cmp [esi], cx
  1358 00000EEE 7407                <1> 		je arfnd
  1359 00000EF0 46                  <1> 		inc esi
  1360 00000EF1 39DE                <1> 		cmp esi, ebx
  1361 00000EF3 7343                <1> 		jae ardn
  1362 00000EF5 EBEB                <1> 		jmp arnxt
  1363 00000EF7 81C602000000        <1> 	arfnd: add esi, 2
  1364 00000EFD 891D[390F0000]      <1> 		mov [arbx], ebx
  1365 00000F03 890D[3D0F0000]      <1> 		mov [arcx], ecx
  1366 00000F09 E89EFBFFFF          <1> 		call print
  1367 00000F0E 8935[3F0F0000]      <1> 		mov [arsi], esi
  1368 00000F14 BE[C9400000]        <1> 		mov esi, line
  1369 00000F19 E88EFBFFFF          <1> 		call print
  1370 00000F1E 8B1D[390F0000]      <1> 		mov ebx, [arbx]
  1371 00000F24 668B0D[3D0F0000]    <1> 		mov cx, [arcx]
  1372 00000F2B 8B35[3F0F0000]      <1> 		mov esi, [arsi]
  1373 00000F31 46                  <1> 		inc esi
  1374 00000F32 39DE                <1> 		cmp esi, ebx
  1375 00000F34 7302                <1> 		jae ardn
  1376 00000F36 EBAA                <1> 		jmp arnxt
  1377 00000F38 C3                  <1> 	ardn:	ret
  1378 00000F39 00000000            <1> arbx:	dw 0,0
  1379 00000F3D 0000                <1> arcx:	db 0,0
  1380 00000F3F 00000000            <1> arsi:	dw 0,0
  1381                              <1> 
  1382                              <1> clearbuffer:
  1383 00000F43 BE[82560000]        <1> 	mov esi, buf2
  1384 00000F48 B030                <1> 	mov al, '0'
  1385 00000F4A 81FE[96560000]      <1> clearbuf: cmp esi, numbuf
  1386 00000F50 7305                <1> 	jae doneclearbuff
  1387 00000F52 8806                <1> 	mov [esi], al
  1388 00000F54 46                  <1> 	inc esi
  1389 00000F55 EBF3                <1> 	jmp clearbuf
  1390                              <1> doneclearbuff: 
  1391 00000F57 C3                  <1> 		ret
  1392                              <1> 
  1393                              <1> convert:
  1394 00000F58 4E                  <1> 	dec esi
  1395 00000F59 89F3                <1> 	mov ebx, esi		;place to convert into must be in si, number to convert must be in cx
  1396                              <1> cnvrt:
  1397 00000F5B 89DE                <1> 	mov esi, ebx
  1398 00000F5D 81EE09000000        <1> 	sub esi, 9
  1399 00000F63 81F900CA9A3B        <1> 	cmp ecx, 1000000000
  1400 00000F69 720A                <1> 	jb ten8
  1401 00000F6B 81E900CA9A3B        <1> 	sub ecx, 1000000000
  1402 00000F71 FE06                <1> 	inc byte [esi]
  1403 00000F73 EBE6                <1> 	jmp cnvrt
  1404 00000F75 46                  <1> ten8:	inc esi
  1405 00000F76 81F900E1F505        <1> 	cmp ecx, 100000000
  1406 00000F7C 720A                <1> 	jb ten7
  1407 00000F7E 81E900E1F505        <1> 	sub ecx, 100000000
  1408 00000F84 FE06                <1> 	inc byte [esi]
  1409 00000F86 EBD3                <1> 	jmp cnvrt
  1410 00000F88 46                  <1> ten7:	inc esi
  1411 00000F89 81F980969800        <1> 	cmp ecx, 10000000
  1412 00000F8F 720A                <1> 	jb ten6
  1413 00000F91 81E980969800        <1> 	sub ecx, 10000000
  1414 00000F97 FE06                <1> 	inc byte [esi]
  1415 00000F99 EBC0                <1> 	jmp cnvrt
  1416 00000F9B 46                  <1> ten6:	inc esi
  1417 00000F9C 81F940420F00        <1> 	cmp ecx, 1000000
  1418 00000FA2 720A                <1> 	jb ten5
  1419 00000FA4 81E940420F00        <1> 	sub ecx, 1000000
  1420 00000FAA FE06                <1> 	inc byte [esi]
  1421 00000FAC EBAD                <1> 	jmp cnvrt
  1422 00000FAE 46                  <1> ten5:	inc esi
  1423 00000FAF 81F9A0860100        <1> 	cmp ecx, 100000
  1424 00000FB5 720A                <1> 	jb ten4
  1425 00000FB7 81E9A0860100        <1> 	sub ecx, 100000
  1426 00000FBD FE06                <1> 	inc byte [esi]
  1427 00000FBF EB9A                <1> 	jmp cnvrt
  1428 00000FC1 46                  <1> ten4:	inc esi
  1429 00000FC2 81F910270000        <1> 	cmp ecx, 10000
  1430 00000FC8 720A                <1> 	jb ten3
  1431 00000FCA 81E910270000        <1> 	sub ecx, 10000
  1432 00000FD0 FE06                <1> 	inc byte [esi]
  1433 00000FD2 EB87                <1> 	jmp cnvrt
  1434 00000FD4 46                  <1> ten3:	inc esi
  1435 00000FD5 81F9E8030000        <1> 	cmp ecx, 1000
  1436 00000FDB 720D                <1> 	jb ten2
  1437 00000FDD 81E9E8030000        <1> 	sub ecx, 1000
  1438 00000FE3 FE06                <1> 	inc byte [esi]
  1439 00000FE5 E971FFFFFF          <1> 	jmp cnvrt
  1440 00000FEA 46                  <1> ten2:	inc esi
  1441 00000FEB 81F964000000        <1> 	cmp ecx, 100
  1442 00000FF1 720D                <1> 	jb ten1
  1443 00000FF3 81E964000000        <1> 	sub ecx, 100
  1444 00000FF9 FE06                <1> 	inc byte [esi]
  1445 00000FFB E95BFFFFFF          <1> 	jmp cnvrt
  1446 00001000 46                  <1> ten1:	inc esi
  1447 00001001 81F90A000000        <1> 	cmp ecx, 10
  1448 00001007 720D                <1> 	jb ten0
  1449 00001009 81E90A000000        <1> 	sub ecx, 10
  1450 0000100F FE06                <1> 	inc byte [esi]
  1451 00001011 E945FFFFFF          <1> 	jmp cnvrt
  1452 00001016 46                  <1> ten0:	inc esi
  1453 00001017 81F901000000        <1> 	cmp ecx, 1
  1454 0000101D 720D                <1> 	jb tendn
  1455 0000101F 81E901000000        <1> 	sub ecx, 1
  1456 00001025 FE06                <1> 	inc byte [esi]
  1457 00001027 E92FFFFFFF          <1> 	jmp cnvrt
  1458                              <1> tendn:
  1459 0000102C C3                  <1> 	ret
  1460                              <1> 
  1461                              <1> 	
  1462                              <1> 
  1463 0000102D 00<rept>            <1> hexnumber times 8 db 0
  1464 00001035 202000              <1> hexnumberend db "  ",0
  1465                              <1> 
  1466                              <1> 
  1467 00001038 00000000            <1> sibuf dw 0,0
  1468 0000103C 00000000            <1> dibuf dw 0,0
  1469                              <1> 
  1470                              <1> converthex:
  1471                              <1> clearbufferhex:
  1472 00001040 B030                <1> 	mov al, '0'
  1473 00001042 8935[38100000]      <1> 	mov [sibuf], esi
  1474 00001048 893D[3C100000]      <1> 	mov [dibuf], edi
  1475 0000104E 39FE                <1> clearbufhex: cmp esi, edi
  1476 00001050 7305                <1> 	jae doneclearbuffhex
  1477 00001052 8806                <1> 	mov [esi], al
  1478 00001054 46                  <1> 	inc esi
  1479 00001055 EBF7                <1> 	jmp clearbufhex
  1480                              <1> doneclearbuffhex:
  1481 00001057 8B35[3C100000]      <1> 	mov esi, [dibuf]
  1482 0000105D 89CA                <1> 	mov edx, ecx
  1483 0000105F 81FA00000000        <1> 	cmp edx, 0
  1484 00001065 741F                <1> 	je donenxtephx
  1485                              <1> nxtexphx:	;0x10^x
  1486 00001067 4E                  <1> 	dec esi
  1487 00001068 89F7                <1> 	mov edi, esi		;;location of 0x10^x
  1488 0000106A 89D1                <1> 	mov ecx, edx
  1489 0000106C 81E10F000000        <1> 	and ecx, 0xF		;;just this digit
  1490 00001072 E81C000000          <1> 	call cnvrtexphx		;;get this digit
  1491 00001077 89FE                <1> 	mov esi, edi
  1492 00001079 C1EA04              <1> 	shr edx, 4		;;next digit
  1493 0000107C 81FA00000000        <1> 	cmp edx, 0
  1494 00001082 7402                <1> 	je donenxtephx
  1495 00001084 EBE1                <1> 	jmp nxtexphx
  1496                              <1> donenxtephx:
  1497 00001086 8B35[38100000]      <1> 	mov esi, [sibuf]
  1498 0000108C 8B3D[3C100000]      <1> 	mov edi, [dibuf]
  1499 00001092 C3                  <1> 	ret
  1500                              <1> cnvrtexphx:			;;convert this number
  1501 00001093 89F3                <1> 	mov ebx, esi		;place to convert to must be in si, number to convert must be in cx
  1502 00001095 81F900000000        <1> 	cmp ecx, 0
  1503 0000109B 7429                <1> 	je zerohx
  1504 0000109D 8A06                <1> cnvrthx:  mov al, [esi]
  1505 0000109F 3C39                <1> 	cmp al, '9'
  1506 000010A1 741B                <1> 	je lettershx
  1507 000010A3 3C46                <1> lttrhxdn: cmp al, 'F'
  1508 000010A5 741F                <1> 	je zerohx
  1509 000010A7 8A06                <1> 	mov al, [esi]
  1510 000010A9 FEC0                <1> 	inc al
  1511 000010AB 8806                <1> 	mov [esi], al
  1512 000010AD 89DE                <1> 	mov esi, ebx
  1513 000010AF 81E901000000        <1> cnvrtlphx: sub ecx, 1
  1514 000010B5 81F900000000        <1> 	cmp ecx, 0
  1515 000010BB 75E0                <1> 	jne cnvrthx
  1516 000010BD C3                  <1> 	ret
  1517                              <1> lettershx:
  1518 000010BE B041                <1> 	mov al, 'A'
  1519 000010C0 2C01                <1> 	sub al, 1
  1520 000010C2 8806                <1> 	mov [esi], al
  1521 000010C4 EBDD                <1> 	jmp lttrhxdn
  1522 000010C6 B030                <1> zerohx:	mov al, '0'
  1523 000010C8 8806                <1> 	mov [esi], al
  1524 000010CA 4E                  <1> 	dec esi
  1525 000010CB 8A06                <1> 	mov al, [esi]
  1526 000010CD 3C46                <1> 	cmp al, 'F'
  1527 000010CF 74F5                <1> 	je zerohx
  1528 000010D1 41                  <1> 	inc ecx
  1529 000010D2 EBDB                <1> 	jmp cnvrtlphx
  1530                              <1> 
  1531 000010D4 01                  <1> firsthexshown db 1
  1532                              <1> showhex:
  1533 000010D5 60                  <1> 	pusha
  1534 000010D6 BE[2D100000]        <1> 	mov esi, hexnumber
  1535 000010DB BF[35100000]        <1> 	mov edi, hexnumberend
  1536 000010E0 E85BFFFFFF          <1> 	call converthex
  1537 000010E5 803D[D4100000]01    <1> 	cmp byte [firsthexshown], 1
  1538 000010EC 7504                <1> 	jne showthathex
  1539 000010EE 66BA0000            <1> 	mov dx, 0
  1540                              <1> showthathex:
  1541 000010F2 803D[D4100000]03    <1> 	cmp byte [firsthexshown], 3
  1542 000010F9 750A                <1> 	jne nonewhexline
  1543 000010FB BE[C9400000]        <1> 	mov esi, line
  1544 00001100 E8A7F9FFFF          <1> 	call print
  1545                              <1> nonewhexline:
  1546 00001105 803D[D4100000]04    <1> 	cmp byte [firsthexshown], 4
  1547 0000110C 7527                <1> 	jne notabfixhex
  1548 0000110E B1A0                <1> 	mov cl, 160
  1549 00001110 28D1                <1> 	sub cl, dl
  1550 00001112 C0E905              <1> 	shr cl, 5
  1551 00001115 C0E105              <1> 	shl cl, 5
  1552 00001118 80F900              <1> 	cmp cl, 0
  1553 0000111B 750F                <1> 	jne nonewlinetabfixhex
  1554 0000111D BE[C9400000]        <1> 	mov esi, line
  1555 00001122 E885F9FFFF          <1> 	call print
  1556 00001127 E909000000          <1> 	jmp notabfixhex
  1557                              <1> nonewlinetabfixhex:
  1558 0000112C 80C20F              <1> 	add dl, 15
  1559 0000112F C0EA04              <1> 	shr dl, 4
  1560 00001132 C0E204              <1> 	shl dl, 4
  1561                              <1> notabfixhex:
  1562 00001135 BE[2D100000]        <1> 	mov esi, hexnumber
  1563 0000113A E86DF9FFFF          <1> 	call print
  1564 0000113F 803D[D4100000]02    <1> 	cmp byte [firsthexshown], 2
  1565 00001146 750A                <1> 	jne hexshown
  1566 00001148 BE[C9400000]        <1> 	mov esi, line
  1567 0000114D E85AF9FFFF          <1> 	call print
  1568                              <1> hexshown:
  1569 00001152 C605[D4100000]00    <1> 	mov byte [firsthexshown], 0
  1570 00001159 61                  <1> 	popa
  1571 0000115A C3                  <1> 	ret
  1572                              <1> 
  1573                              <1> 
  1574 0000115B 303030303030303030- <1> decnumber db "00000000000000"
  1575 00001164 3030303030          <1>
  1576 00001169 2000                <1> decnumberend: db " ",0
  1577                              <1> 
  1578                              <1> showdec: ;;same as showhex, just uses decimal conversion
  1579 0000116B 60                  <1> 	pusha
  1580 0000116C BF[5B110000]        <1> 	mov edi, decnumber
  1581 00001171 BE[69110000]        <1> 	mov esi, decnumberend
  1582                              <1> cleardecbuf:
  1583 00001176 C60730              <1> 	mov byte [edi], '0'
  1584 00001179 47                  <1> 	inc edi
  1585 0000117A 39F7                <1> 	cmp edi, esi
  1586 0000117C 72F8                <1> 	jb cleardecbuf
  1587 0000117E BF[5B110000]        <1> 	mov edi, decnumber
  1588 00001183 E8D0FDFFFF          <1> 	call convert
  1589 00001188 803D[D4100000]01    <1> 	cmp byte [firsthexshown], 1
  1590 0000118F 7504                <1> 	jne showthatdec
  1591 00001191 66BA0000            <1> 	mov dx, 0
  1592                              <1> showthatdec:
  1593 00001195 803D[D4100000]03    <1> 	cmp byte [firsthexshown], 3
  1594 0000119C 750A                <1> 	jne nonewdecline
  1595 0000119E BE[C9400000]        <1> 	mov esi, line
  1596 000011A3 E804F9FFFF          <1> 	call print
  1597                              <1> nonewdecline:
  1598 000011A8 803D[D4100000]04    <1> 	cmp byte [firsthexshown], 4
  1599 000011AF 7527                <1> 	jne notabfixdec
  1600 000011B1 B1A0                <1> 	mov cl, 160
  1601 000011B3 28D1                <1> 	sub cl, dl
  1602 000011B5 C0E905              <1> 	shr cl, 5
  1603 000011B8 C0E105              <1> 	shl cl, 5
  1604 000011BB 80F900              <1> 	cmp cl, 0
  1605 000011BE 750F                <1> 	jne nonewlinetabfixdec
  1606 000011C0 BE[C9400000]        <1> 	mov esi, line
  1607 000011C5 E8E2F8FFFF          <1> 	call print
  1608 000011CA E909000000          <1> 	jmp notabfixdec
  1609                              <1> nonewlinetabfixdec:
  1610 000011CF 80C20F              <1> 	add dl, 15
  1611 000011D2 C0EA04              <1> 	shr dl, 4
  1612 000011D5 C0E204              <1> 	shl dl, 4
  1613                              <1> notabfixdec:
  1614 000011D8 BE[5B110000]        <1> 	mov esi, decnumber
  1615 000011DD 4E                  <1> 	dec esi
  1616                              <1> sifind:
  1617 000011DE 46                  <1> 	inc esi
  1618 000011DF 803E30              <1> 	cmp byte [esi], '0'
  1619 000011E2 74FA                <1> 	je sifind
  1620 000011E4 E8C3F8FFFF          <1> 	call print
  1621 000011E9 803D[D4100000]02    <1> 	cmp byte [firsthexshown], 2
  1622 000011F0 750A                <1> 	jne decshown
  1623 000011F2 BE[C9400000]        <1> 	mov esi, line
  1624 000011F7 E8B0F8FFFF          <1> 	call print
  1625                              <1> decshown:
  1626 000011FC C605[D4100000]00    <1> 	mov byte [firsthexshown], 0
  1627 00001203 61                  <1> 	popa
  1628 00001204 C3                  <1> 	ret
  1629                              <1> 	
  1630                              <1> cnvrttxt: 
  1631 00001205 B900000000          <1> 	mov ecx, 0
  1632 0000120A B800000000          <1> 	mov eax, 0
  1633 0000120F BA00000000          <1> 	mov edx, 0
  1634 00001214 BB00000000          <1> 	mov ebx, 0
  1635 00001219 4E                  <1> 	dec esi
  1636                              <1> cnvrtlptxt:
  1637 0000121A 46                  <1> 	inc esi
  1638 0000121B 8A06                <1> 	mov al, [esi]
  1639 0000121D 3C00                <1> 	cmp al, 0
  1640 0000121F 75F9                <1> 	jne cnvrtlptxt
  1641 00001221 4E                  <1> 	dec esi
  1642 00001222 8A06                <1> 	mov al, [esi]
  1643 00001224 3C30                <1> 	cmp al, '0'
  1644 00001226 7504                <1> 	jne txtlp
  1645 00001228 39FE                <1> zerotest: cmp esi, edi
  1646 0000122A 745B                <1> 	je donecnvrt
  1647                              <1> txtlp:	
  1648 0000122C B800000000          <1> 	mov eax, 0
  1649 00001231 8A06                <1> 	mov al, [esi]
  1650 00001233 3C3D                <1> 	cmp al, '='
  1651 00001235 7450                <1> 	je donecnvrt
  1652 00001237 3C30                <1> 	cmp al, 48
  1653 00001239 724C                <1> 	jb donecnvrt
  1654 0000123B 3C23                <1> 	cmp al, '#'
  1655 0000123D 7448                <1> 	je donecnvrt
  1656 0000123F 39FE                <1> 	cmp esi, edi
  1657 00001241 7244                <1> 	jb donecnvrt
  1658 00001243 81F900000000        <1> 	cmp ecx, 0
  1659 00001249 7708                <1> 	ja exp
  1660 0000124B 2C30                <1> noexp:	sub al, 48
  1661 0000124D 01C2                <1> 	add edx, eax
  1662 0000124F 4E                  <1> 	dec esi
  1663 00001250 41                  <1> 	inc ecx
  1664 00001251 EBD9                <1> 	jmp txtlp
  1665 00001253 81F900000000        <1> exp:	cmp ecx, 0
  1666 00001259 74F0                <1> 	je noexp
  1667 0000125B 2C30                <1> 	sub al, 48
  1668 0000125D 51                  <1> 	push ecx
  1669 0000125E 89C3                <1> expmul:	mov ebx, eax
  1670 00001260 01D8                <1> 	add eax, ebx
  1671 00001262 01D8                <1> 	add eax, ebx
  1672 00001264 01D8                <1> 	add eax, ebx
  1673 00001266 01D8                <1> 	add eax, ebx
  1674 00001268 01D8                <1> 	add eax, ebx
  1675 0000126A 01D8                <1> 	add eax, ebx
  1676 0000126C 01D8                <1> 	add eax, ebx
  1677 0000126E 01D8                <1> 	add eax, ebx
  1678 00001270 01D8                <1> 	add eax, ebx
  1679 00001272 81E901000000        <1> 	sub ecx, 1
  1680 00001278 81F900000000        <1> 	cmp ecx, 0
  1681 0000127E 77DE                <1> 	ja expmul
  1682 00001280 01C2                <1> 	add edx, eax
  1683 00001282 59                  <1> 	pop ecx
  1684 00001283 4E                  <1> 	dec esi
  1685 00001284 41                  <1> 	inc ecx
  1686 00001285 EBA5                <1> 	jmp txtlp
  1687 00001287 89D1                <1> donecnvrt: mov ecx, edx
  1688 00001289 C3                  <1> 	ret
  1689                                      %include 'source/builtinprogs.asm'
  1690 0000128A 050406040704        <1> filetypes db 5,4,6,4,7,4
  1691                              <1> progstart:		;programs start here
  1692 00001290 0504696E64657800    <1> db 5,4,"index",0
  1693 00001298 E805000000          <1> 	call indexfiles
  1694 0000129D E979FAFFFF          <1> 	jmp nwcmd
  1695                              <1> indexfiles:
  1696 000012A2 BE[90120000]        <1> 	mov esi, progstart
  1697 000012A7 BB[814D0000]        <1> 	mov ebx, fileindex
  1698 000012AC BF[90120000]        <1> 	mov edi, progstart
  1699 000012B1 81EF02000000        <1> 	sub edi, 2
  1700                              <1> indexloop:
  1701 000012B7 668B0E              <1> 	mov cx, [esi]
  1702                              <1> 	indexloop2:
  1703 000012BA 663B0F              <1> 		cmp cx, [edi]
  1704 000012BD 7424                <1> 		je indexloop2done
  1705 000012BF 81EF02000000        <1> 		sub edi, 2
  1706 000012C5 81FF[8A120000]      <1> 		cmp edi, filetypes
  1707 000012CB 73ED                <1> 		jae indexloop2
  1708 000012CD BF[90120000]        <1> 	mov edi, progstart
  1709 000012D2 81EF02000000        <1> 	sub edi, 2
  1710 000012D8 46                  <1> 	inc esi
  1711 000012D9 81FE[D1210000]      <1> 	cmp esi, batchprogend
  1712 000012DF 734E                <1> 	jae indexloopdone
  1713 000012E1 EBD4                <1> 	jmp indexloop
  1714                              <1> indexloop2done:
  1715 000012E3 66890B              <1> 	mov [ebx], cx
  1716 000012E6 81C302000000        <1> 	add ebx, 2
  1717 000012EC 81C602000000        <1> 	add esi, 2
  1718                              <1> 	nameindex:
  1719 000012F2 8A0E                <1> 		mov cl, [esi]
  1720 000012F4 80F900              <1> 		cmp cl, 0
  1721 000012F7 7406                <1> 		je nameindexdone
  1722 000012F9 880B                <1> 		mov [ebx], cl
  1723 000012FB 46                  <1> 		inc esi
  1724 000012FC 43                  <1> 		inc ebx
  1725 000012FD EBF3                <1> 		jmp nameindex
  1726                              <1> 	nameindexdone:
  1727 000012FF 43                  <1> 		inc ebx
  1728 00001300 66C7030000          <1> 		mov word [ebx], 0
  1729 00001305 81C302000000        <1> 		add ebx, 2
  1730 0000130B 46                  <1> 		inc esi
  1731 0000130C 8933                <1> 		mov [ebx], esi
  1732 0000130E 81C304000000        <1> 		add ebx, 4
  1733 00001314 66C7030000          <1> 		mov word [ebx], 0
  1734 00001319 81C302000000        <1> 		add ebx, 2
  1735 0000131F 81FB[814F0000]      <1> 		cmp ebx, fileindexend
  1736 00001325 7308                <1> 		jae indexloopdone
  1737 00001327 81C601000000        <1> 		add esi, 1
  1738 0000132D EB88                <1> 		jmp indexloop
  1739 0000132F C3                  <1> indexloopdone: 	ret
  1740                              <1> 
  1741                              <1> 
  1742 00001330 050473686F77696E64- <1> db 5,4,"showindex",0
  1743 00001339 657800              <1>
  1744 0000133C BE[814D0000]        <1> 	mov esi, fileindex
  1745 00001341 BB[814F0000]        <1> 	mov ebx, fileindexend
  1746 00001346 B105                <1> 	mov cl, 5
  1747 00001348 B504                <1> 	mov ch, 4
  1748 0000134A E893FBFFFF          <1> 	call array
  1749 0000134F BE[814D0000]        <1> 	mov esi, fileindex
  1750 00001354 BB[814F0000]        <1> 	mov ebx, fileindexend
  1751 00001359 B106                <1> 	mov cl, 6
  1752 0000135B B504                <1> 	mov ch, 4
  1753 0000135D E880FBFFFF          <1> 	call array
  1754 00001362 BE[814D0000]        <1> 	mov esi, fileindex
  1755 00001367 BB[814F0000]        <1> 	mov ebx, fileindexend
  1756 0000136C B107                <1> 	mov cl, 7
  1757 0000136E B504                <1> 	mov ch, 4
  1758 00001370 E86DFBFFFF          <1> 	call array
  1759 00001375 E9A1F9FFFF          <1> 	jmp nwcmd
  1760                              <1> 
  1761 0000137A 05046C7300          <1> db 5,4,"ls",0
  1762 0000137F BE[90120000]        <1> 	lscmd:	mov esi, progstart
  1763 00001384 BB[D1210000]        <1> 		mov ebx, progend
  1764 00001389 E9B2FAFFFF          <1> 		jmp dir
  1765                              <1> 		
  1766 0000138E 05046469736B00      <1> db 5,4,"disk",0
  1767 00001395 B900000000          <1> 		mov ecx, 0
  1768 0000139A 8A0D[2B000000]      <1> 		mov cl, [DriveNumber]
  1769 000013A0 C605[D4100000]00    <1> 		mov byte [firsthexshown], 0
  1770 000013A7 E829FDFFFF          <1> 		call showhex
  1771 000013AC BE[C9400000]        <1> 		mov esi, line
  1772 000013B1 E8F6F6FFFF          <1> 		call print
  1773 000013B6 BE[21400000]        <1> 		mov esi, diskfileindex
  1774                              <1> 	diskindexdir:
  1775 000013BB E8ECF6FFFF          <1> 		call print
  1776 000013C0 8B4E05              <1> 		mov ecx, [esi + 5]
  1777 000013C3 C605[D4100000]03    <1> 		mov byte [firsthexshown], 3
  1778 000013CA E89CFDFFFF          <1> 		call showdec
  1779 000013CF 56                  <1> 		push esi
  1780 000013D0 BE[C9400000]        <1> 		mov esi, line
  1781 000013D5 E8D2F6FFFF          <1> 		call print
  1782 000013DA 5E                  <1> 		pop esi
  1783 000013DB 81C609000000        <1> 		add esi, 9
  1784 000013E1 81FE[7A400000]      <1> 		cmp esi, enddiskfileindex
  1785 000013E7 72D2                <1> 		jb diskindexdir
  1786 000013E9 E92DF9FFFF          <1> 		jmp nwcmd
  1787                              <1> 
  1788 000013EE 0504636C65617200    <1> db 5,4,"clear",0
  1789 000013F6 E85DF7FFFF          <1> 	cls:	call clear
  1790 000013FB E91BF9FFFF          <1> 		jmp nwcmd
  1791                              <1> 		
  1792 00001400 05047761697400      <1> db 5,4,"wait",0
  1793 00001407 B000                <1> 		mov al, 0
  1794 00001409 E86EF6FFFF          <1> 		call int302
  1795 0000140E E908F9FFFF          <1> 		jmp nwcmd
  1796                              <1> 
  1797 00001413 05046563686F00      <1> db 5,4,"echo",0
  1798 0000141A BE[82540000]        <1> 	echo:	mov esi, buftxt
  1799 0000141F 81C605000000        <1> 		add esi, 5
  1800 00001425 8A06                <1> 		mov al, [esi]
  1801 00001427 3C24                <1> 		cmp al, '$'
  1802 00001429 7414                <1> 		je echovr
  1803 0000142B E87CF6FFFF          <1> 		call print
  1804 00001430 BE[C9400000]        <1> 		mov esi, line
  1805 00001435 E872F6FFFF          <1> 		call print
  1806 0000143A E9DCF8FFFF          <1> 		jmp nwcmd
  1807 0000143F BB[814F0000]        <1> 	echovr:	mov ebx, variables
  1808 00001444 BF06000000          <1> 		mov edi, 6
  1809 00001449 E83A000000          <1> 		call nxtvrech
  1810 0000144E E957000000          <1> 		jmp prntvr2
  1811 00001453 B13D                <1> 	echvar:	mov cl, '='
  1812 00001455 43                  <1> 		inc ebx
  1813 00001456 8A03                <1> 		mov al, [ebx]
  1814 00001458 3C00                <1> 		cmp al, 0
  1815 0000145A 742C                <1> 		je nxtvrech
  1816 0000145C 3C3D                <1> 		cmp al, '='
  1817 0000145E 7420                <1> 		je nxtvrechb1
  1818 00001460 BE[82540000]        <1> 		mov esi, buftxt
  1819 00001465 01FE                <1> 		add esi, edi
  1820 00001467 E8B4F9FFFF          <1> 		call cndtest
  1821 0000146C 3C02                <1> 		cmp al, 2
  1822 0000146E 7436                <1> 		je prntvr
  1823 00001470 3C01                <1> 		cmp al, 1
  1824 00001472 7432                <1> 		je prntvr
  1825 00001474 BE[82540000]        <1> 		mov esi, buftxt
  1826 00001479 01FE                <1> 		add esi, edi
  1827 0000147B E908000000          <1> 		jmp nxtvrech
  1828                              <1> 	nxtvrechb1:
  1829 00001480 81EB02000000        <1> 		sub ebx, 2
  1830 00001486 EBCB                <1> 		jmp echvar
  1831 00001488 8A03                <1> 	nxtvrech: mov al, [ebx]
  1832 0000148A 3C05                <1> 		cmp al, 5
  1833 0000148C 740F                <1> 		je nxtvrec2
  1834 0000148E 43                  <1> 		inc ebx
  1835 0000148F 81FB[81540000]      <1> 		cmp ebx, varend
  1836 00001495 0F8380F8FFFF        <1> 		jae nwcmd
  1837 0000149B EBEB                <1> 		jmp nxtvrech
  1838 0000149D 43                  <1> 	nxtvrec2: inc ebx
  1839 0000149E 8A03                <1> 		mov al, [ebx]
  1840 000014A0 3C04                <1> 		cmp al, 4
  1841 000014A2 74AF                <1> 		je echvar
  1842 000014A4 EBE2                <1> 		jmp nxtvrech
  1843 000014A6 43                  <1> 	prntvr: inc ebx
  1844 000014A7 89DE                <1> 		mov esi, ebx
  1845 000014A9 C3                  <1> 		ret
  1846 000014AA E8FDF5FFFF          <1> 	prntvr2: call print
  1847 000014AF BE[C9400000]        <1> 		mov esi, line
  1848 000014B4 E8F3F5FFFF          <1> 		call print
  1849 000014B9 E95DF8FFFF          <1> 		jmp nwcmd
  1850                              <1> 		
  1851                              <1> 
  1852 000014BE 05042300            <1> db 5,4,"#",0
  1853                              <1> 	num:	
  1854 000014C2 E87CFAFFFF          <1> 		call clearbuffer
  1855 000014C7 C605[7E170000]00    <1> 		mov byte [decimal], 0
  1856 000014CE C605[7F170000]00    <1> 		mov byte [decimal2], 0
  1857 000014D5 BE[82540000]        <1> 		mov esi, buftxt
  1858 000014DA B800000000          <1> 		mov eax, 0
  1859 000014DF B900000000          <1> 		mov ecx, 0
  1860 000014E4 BB00000000          <1> 		mov ebx, 0
  1861 000014E9 8A06                <1> 	num2:	mov al, [esi]
  1862 000014EB 3C2B                <1> 		cmp al, '+'
  1863 000014ED 741B                <1> 		je operatorfound
  1864 000014EF 3C2D                <1> 		cmp al, '-'
  1865 000014F1 7417                <1> 		je operatorfound
  1866 000014F3 3C2A                <1> 		cmp al, '*'
  1867 000014F5 7413                <1> 		je operatorfound
  1868 000014F7 3C2F                <1> 		cmp al, '/'
  1869 000014F9 740F                <1> 		je operatorfound
  1870 000014FB 3C5E                <1> 		cmp al, '^'
  1871 000014FD 740B                <1> 		je operatorfound
  1872 000014FF 46                  <1> 		inc esi
  1873 00001500 3C00                <1> 		cmp al, 0
  1874 00001502 0F8413F8FFFF        <1> 		je near nwcmd
  1875 00001508 EBDF                <1> 		jmp num2
  1876 0000150A 50                  <1> 	operatorfound: push eax
  1877 0000150B B400                <1> 		mov ah, 0
  1878 0000150D 8826                <1> 		mov [esi], ah
  1879 0000150F 89F7                <1> 		mov edi, esi
  1880 00001511 46                  <1> 		inc esi
  1881 00001512 8A06                <1> 		mov al, [esi]
  1882 00001514 3C24                <1> 		cmp al, '$'
  1883 00001516 0F8481000000        <1> 		je near varnum1
  1884 0000151C 3C25                <1> 		cmp al, '%'
  1885 0000151E 0F8469000000        <1> 		je near resultnum1
  1886                              <1> 	varnum2: 
  1887 00001524 57                  <1> 		push edi
  1888 00001525 E8C9000000          <1> 		call checkdecimal
  1889 0000152A 5F                  <1> 		pop edi
  1890 0000152B E8D5FCFFFF          <1> 		call cnvrttxt
  1891                              <1> 	vrnm2:
  1892 00001530 89CB                <1> 		mov ebx, ecx
  1893 00001532 53                  <1> 		push ebx
  1894 00001533 E80BFAFFFF          <1> 		call clearbuffer
  1895 00001538 BE[82540000]        <1> 		mov esi, buftxt
  1896 0000153D 89F7                <1> 		mov edi, esi
  1897 0000153F 46                  <1> 		inc esi
  1898 00001540 8A06                <1> 		mov al, [esi]
  1899 00001542 3C24                <1> 		cmp al, '$'
  1900 00001544 0F8474000000        <1> 		je near varnum3
  1901 0000154A 3C25                <1> 		cmp al, '%'
  1902 0000154C 0F8443000000        <1> 		je near resultnum2
  1903                              <1> 	varnum4: 
  1904 00001552 57                  <1> 		push edi
  1905 00001553 E887000000          <1> 		call checkdecimal2
  1906 00001558 5F                  <1> 		pop edi
  1907 00001559 E8A7FCFFFF          <1> 		call cnvrttxt
  1908                              <1> 	vrnm4:
  1909 0000155E 5B                  <1> 		pop ebx
  1910 0000155F 58                  <1> 		pop eax
  1911 00001560 3C2B                <1> 		cmp al, '+'
  1912 00001562 0F84B9000000        <1> 		je near plusnum
  1913 00001568 3C2D                <1> 		cmp al, '-'
  1914 0000156A 0F84BD000000        <1> 		je near subnum
  1915 00001570 3C2A                <1> 		cmp al, '*'
  1916 00001572 0F84C1000000        <1> 		je near mulnum
  1917 00001578 3C2F                <1> 		cmp al, '/'
  1918 0000157A 0F84CF000000        <1> 		je near divnum
  1919 00001580 3C5E                <1> 		cmp al, '^'
  1920 00001582 0F84ED000000        <1> 		je near expnum
  1921 00001588 E98EF7FFFF          <1> 		jmp nwcmd
  1922                              <1> 	resultnum1:
  1923 0000158D 8B0D[80170000]      <1> 		mov ecx, [result]
  1924 00001593 EB9B                <1> 		jmp vrnm2
  1925                              <1> 	resultnum2:
  1926 00001595 8B0D[80170000]      <1> 		mov ecx, [result]
  1927 0000159B EBC1                <1> 		jmp vrnm4
  1928 0000159D 81EE[82540000]      <1> 	varnum1: sub esi, buftxt
  1929 000015A3 89F7                <1> 		mov edi, esi
  1930 000015A5 81C6[82540000]      <1> 		add esi, buftxt
  1931 000015AB 47                  <1> 		inc edi
  1932 000015AC BB[814F0000]        <1> 		mov ebx, variables
  1933 000015B1 E8D2FEFFFF          <1> 		call nxtvrech
  1934 000015B6 89F7                <1> 		mov edi, esi
  1935 000015B8 4F                  <1> 		dec edi
  1936 000015B9 E966FFFFFF          <1> 		jmp varnum2
  1937 000015BE 81EE[82540000]      <1> 	varnum3: sub esi, buftxt
  1938 000015C4 89F7                <1> 		mov edi, esi
  1939 000015C6 81C6[82540000]      <1> 		add esi, buftxt
  1940 000015CC 47                  <1> 		inc edi
  1941 000015CD BB[814F0000]        <1> 		mov ebx, variables
  1942 000015D2 E8B1FEFFFF          <1> 		call nxtvrech
  1943 000015D7 89F7                <1> 		mov edi, esi
  1944 000015D9 4F                  <1> 		dec edi
  1945 000015DA E973FFFFFF          <1> 		jmp varnum4
  1946                              <1> 	checkdecimal2:
  1947 000015DF 8A25[7E170000]      <1> 		mov ah, [decimal]
  1948 000015E5 8825[7F170000]      <1> 		mov [decimal2], ah
  1949 000015EB B400                <1> 		mov ah, 0
  1950 000015ED 8825[7E170000]      <1> 		mov [decimal], ah
  1951                              <1> 	checkdecimal:
  1952 000015F3 89F7                <1> 		mov edi, esi
  1953                              <1> 	chkdec1:
  1954 000015F5 8A07                <1> 		mov al, [edi]
  1955 000015F7 3C2E                <1> 		cmp al, '.'
  1956 000015F9 0F840B000000        <1> 		je near fnddec
  1957 000015FF 3C00                <1> 		cmp al, 0
  1958 00001601 0F8419000000        <1> 		je near nodecimal
  1959 00001607 47                  <1> 		inc edi
  1960 00001608 EBEB                <1> 		jmp chkdec1
  1961                              <1> 	fnddec:
  1962 0000160A 8A4701              <1> 		mov al, [edi + 1]
  1963 0000160D 8807                <1> 		mov [edi], al
  1964 0000160F 3C00                <1> 		cmp al, 0
  1965 00001611 0F8409000000        <1> 		je near nodecimal
  1966 00001617 FE05[7E170000]      <1> 		inc byte [decimal]
  1967 0000161D 47                  <1> 		inc edi
  1968 0000161E EBEA                <1> 		jmp fnddec
  1969                              <1> 	nodecimal:
  1970 00001620 C3                  <1> 		ret
  1971                              <1> 	plusnum:
  1972 00001621 E816010000          <1> 		call decaddfix
  1973 00001626 01D9                <1> 		add ecx, ebx
  1974 00001628 E991000000          <1> 		jmp retnum
  1975                              <1> 	subnum:
  1976 0000162D E80A010000          <1> 		call decaddfix
  1977 00001632 29D9                <1> 		sub ecx, ebx
  1978 00001634 E985000000          <1> 		jmp retnum
  1979                              <1> 	mulnum:
  1980 00001639 A0[7F170000]        <1> 		mov al, [decimal2]
  1981 0000163E 0005[7E170000]      <1> 		add [decimal], al
  1982 00001644 89C8                <1> 		mov eax, ecx
  1983 00001646 F7E3                <1> 		mul ebx
  1984 00001648 89C1                <1> 		mov ecx, eax
  1985 0000164A E96F000000          <1> 		jmp retnum
  1986                              <1> 	divnum:
  1987 0000164F E8E8000000          <1> 		call decaddfix
  1988 00001654 B000                <1> 		mov al, 0
  1989 00001656 A2[7E170000]        <1> 		mov [decimal], al
  1990 0000165B 6689C8              <1> 		mov ax, cx
  1991 0000165E 80FB00              <1> 		cmp bl, 0
  1992 00001661 0F8457000000        <1> 		je near retnum
  1993 00001667 F6F3                <1> 		div bl
  1994 00001669 B900000000          <1> 		mov ecx, 0
  1995 0000166E 88C1                <1> 		mov cl, al
  1996 00001670 E949000000          <1> 		jmp retnum
  1997                              <1> 	expnum:
  1998 00001675 8A15[7E170000]      <1> 		mov dl, [decimal]
  1999 0000167B 8815[7F170000]      <1> 		mov [decimal2], dl
  2000 00001681 BA00000000          <1> 		mov edx, 0
  2001 00001686 89C8                <1> 		mov eax, ecx
  2002 00001688 89D9                <1> 		mov ecx, ebx
  2003 0000168A 89C3                <1> 		mov ebx, eax
  2004 0000168C 81F900000000        <1> 		cmp ecx, 0
  2005 00001692 7425                <1> 		je noexpnum
  2006 00001694 49                  <1> 		dec ecx
  2007 00001695 81F900000000        <1> 		cmp ecx, 0
  2008 0000169B 7415                <1> 		je noexpnumlp
  2009 0000169D F7E3                <1> 	expnumlp: mul ebx
  2010 0000169F 8A15[7F170000]      <1> 		mov dl, [decimal2]
  2011 000016A5 0015[7E170000]      <1> 		add [decimal], dl
  2012 000016AB BA00000000          <1> 		mov edx, 0
  2013 000016B0 E2EB                <1> 		loop expnumlp
  2014                              <1> 	noexpnumlp:
  2015 000016B2 89C1                <1> 		mov ecx, eax
  2016 000016B4 E905000000          <1> 		jmp retnum
  2017                              <1> 	noexpnum:
  2018 000016B9 B901000000          <1> 		mov ecx, 1
  2019                              <1> 	retnum: 
  2020 000016BE BE[96560000]        <1> 		mov esi, numbuf
  2021 000016C3 890D[80170000]      <1> 		mov [result], ecx
  2022 000016C9 E88AF8FFFF          <1> 		call convert
  2023 000016CE BE[96560000]        <1> 		mov esi, numbuf
  2024 000016D3 8A25[7E170000]      <1> 		mov ah, [decimal]
  2025 000016D9 80FC00              <1> 		cmp ah, 0
  2026 000016DC 0F8425000000        <1> 		je near noputdecimal
  2027                              <1> 	putdecimal:
  2028 000016E2 4E                  <1> 		dec esi
  2029 000016E3 FECC                <1> 		dec ah
  2030 000016E5 80FC00              <1> 		cmp ah, 0
  2031 000016E8 0F87F4FFFFFF        <1> 		ja near putdecimal
  2032 000016EE 4E                  <1> 		dec esi
  2033 000016EF 8A06                <1> 		mov al, [esi]
  2034 000016F1 C6062E              <1> 		mov byte [esi], '.'
  2035                              <1> 	decputloop:
  2036 000016F4 4E                  <1> 		dec esi
  2037 000016F5 8A26                <1> 		mov ah, [esi]
  2038 000016F7 8806                <1> 		mov [esi], al
  2039 000016F9 88E0                <1> 		mov al, ah
  2040 000016FB 81FE[82560000]      <1> 		cmp esi, buf2
  2041 00001701 0F87EDFFFFFF        <1> 		ja near decputloop
  2042                              <1> 	noputdecimal:
  2043 00001707 BE[82560000]        <1> 		mov esi, buf2
  2044 0000170C E809000000          <1> 		call chkadd
  2045 00001711 E905F6FFFF          <1> 		jmp nwcmd
  2046 00001716 00000000            <1> edxnumbuf dw 0,0
  2047 0000171A 8A06                <1> 	chkadd: mov al, [esi]
  2048 0000171C 3C30                <1> 		cmp al, '0'
  2049 0000171E 750C                <1> 		jne dnadd
  2050 00001720 46                  <1> 		inc esi
  2051 00001721 81FE[96560000]      <1> 		cmp esi, numbuf
  2052 00001727 7402                <1> 		je dnaddm1
  2053 00001729 EBEF                <1> 		jmp chkadd
  2054 0000172B 4E                  <1> 	dnaddm1: dec esi
  2055 0000172C E87BF3FFFF          <1> 	dnadd:	call print
  2056 00001731 BE[C9400000]        <1> 		mov esi, line
  2057 00001736 E871F3FFFF          <1> 		call print
  2058 0000173B C3                  <1> 		ret
  2059                              <1> 		
  2060                              <1> 	decaddfix:
  2061 0000173C A0[7F170000]        <1> 		mov al, [decimal2]
  2062 00001741 8A25[7E170000]      <1> 		mov ah, [decimal]
  2063 00001747 38E0                <1> 		cmp al, ah
  2064 00001749 7432                <1> 		je gooddecadd
  2065 0000174B 38E0                <1> 		cmp al, ah
  2066 0000174D 721A                <1> 		jb lowdecadd
  2067                              <1> 	highdecadd:
  2068 0000174F FEC4                <1> 		inc ah
  2069 00001751 89CA                <1> 		mov edx, ecx
  2070 00001753 C1E103              <1> 		shl ecx, 3
  2071 00001756 01D1                <1> 		add ecx, edx
  2072 00001758 01D1                <1> 		add ecx, edx
  2073 0000175A 38E0                <1> 		cmp al, ah
  2074 0000175C 77F1                <1> 		ja highdecadd
  2075 0000175E 8825[7E170000]      <1> 		mov [decimal], ah
  2076 00001764 E914000000          <1> 		jmp gooddecadd
  2077                              <1> 	lowdecadd:
  2078 00001769 FEC0                <1> 		inc al
  2079 0000176B 89DA                <1> 		mov edx, ebx
  2080 0000176D C1E303              <1> 		shl ebx, 3
  2081 00001770 01D3                <1> 		add ebx, edx
  2082 00001772 01D3                <1> 		add ebx, edx
  2083 00001774 38E0                <1> 		cmp al, ah
  2084 00001776 72F1                <1> 		jb lowdecadd
  2085 00001778 A2[7E170000]        <1> 		mov [decimal], al
  2086                              <1> 	gooddecadd:
  2087 0000177D C3                  <1> 		ret
  2088                              <1> 		
  2089 0000177E 00                  <1> decimal db 0
  2090 0000177F 00                  <1> decimal2 db 0
  2091 00001780 00000000            <1> result db 0,0,0,0
  2092                              <1> 	
  2093 00001784 05042500            <1> db 5,4,"%",0
  2094 00001788 E8B6F7FFFF          <1> 	ans:	call clearbuffer
  2095 0000178D 8B0D[80170000]      <1> 		mov ecx, [result]
  2096 00001793 BE[82560000]        <1> 		mov esi, buf2
  2097 00001798 E8BBF7FFFF          <1> 		call convert
  2098 0000179D BE[82560000]        <1> 		mov esi, buf2
  2099 000017A2 E873FFFFFF          <1> 		call chkadd
  2100 000017A7 E96FF5FFFF          <1> 		jmp nwcmd
  2101                              <1> 
  2102 000017AC 05042400            <1> db 5,4,"$",0
  2103 000017B0 BE[82540000]        <1> var:	mov esi, buftxt
  2104 000017B5 BB[814F0000]        <1> 	mov ebx, variables
  2105 000017BA 8A06                <1> lkeq:	mov al, [esi]
  2106 000017BC 3C3D                <1> 	cmp al, '='
  2107 000017BE 741F                <1> 	je eqfnd	;is there an '=' sign?
  2108 000017C0 3C00                <1> 	cmp al, 0
  2109 000017C2 7403                <1> 	je echovars
  2110 000017C4 46                  <1> 	inc esi
  2111 000017C5 EBF3                <1> 	jmp lkeq
  2112 000017C7 BE[814F0000]        <1> echovars: mov esi, variables
  2113 000017CC BB[81540000]        <1> 	mov ebx, varend
  2114 000017D1 B105                <1> 	mov cl, 5
  2115 000017D3 B504                <1> 	mov ch, 4
  2116 000017D5 E808F7FFFF          <1> 	call array
  2117 000017DA E93CF5FFFF          <1> 	jmp nwcmd
  2118 000017DF 46                  <1> eqfnd:	inc esi
  2119 000017E0 8A06                <1> 	mov al, [esi]
  2120 000017E2 3C00                <1> 	cmp al, 0
  2121 000017E4 740F                <1> 	je readvar
  2122 000017E6 BE[82540000]        <1> 	mov esi, buftxt
  2123 000017EB BB[814F0000]        <1> 	mov ebx, variables
  2124 000017F0 E917000000          <1> 	jmp seek
  2125                              <1> readvar: 
  2126 000017F5 B00D                <1> 	mov al, 13
  2127 000017F7 B404                <1> 	mov ah, 4
  2128 000017F9 B307                <1> 	mov bl, 7
  2129 000017FB E8CBF0FFFF          <1> 	call intx4
  2130 00001800 BE[C9400000]        <1> 	mov esi, line
  2131 00001805 E8A2F2FFFF          <1> 	call print
  2132 0000180A EBA4                <1> 	jmp var
  2133 0000180C 668B03              <1> seek:	mov ax, [ebx]
  2134 0000180F B105                <1> 	mov cl, 5
  2135 00001811 B504                <1> 	mov ch, 4
  2136 00001813 663D0000            <1> 	cmp ax, 0
  2137 00001817 0F8459000000        <1> 	je near save
  2138 0000181D 6639C8              <1> 	cmp ax, cx
  2139 00001820 7403                <1> 	je skfnd
  2140 00001822 43                  <1> 	inc ebx
  2141 00001823 EBE7                <1> 	jmp seek
  2142 00001825 BE[82540000]        <1> skfnd:	mov esi, buftxt
  2143 0000182A 46                  <1> 	inc esi
  2144 0000182B 81C302000000        <1> 	add ebx, 2
  2145 00001831 89DF                <1> 	mov edi, ebx
  2146 00001833 B13D                <1> 	mov cl, '='
  2147 00001835 E8E6F5FFFF          <1> 	call cndtest
  2148 0000183A 3C01                <1> 	cmp al, 1	
  2149 0000183C 7417                <1> 	je varfnd
  2150 0000183E 89FB                <1> 	mov ebx, edi
  2151 00001840 BE[82540000]        <1> 	mov esi, buftxt
  2152 00001845 668B03              <1> 	mov ax, [ebx]
  2153 00001848 663D0000            <1> 	cmp ax, 0
  2154 0000184C 0F8424000000        <1> 	je near save
  2155 00001852 43                  <1> 	inc ebx
  2156 00001853 EBB7                <1> 	jmp seek
  2157 00001855 8A03                <1> varfnd:	mov al, [ebx]
  2158 00001857 3C04                <1> 	cmp al, 4
  2159 00001859 7404                <1> 	je save2
  2160 0000185B 4B                  <1> 	dec ebx
  2161 0000185C 4E                  <1> 	dec esi
  2162 0000185D EBF6                <1> 	jmp varfnd
  2163 0000185F 4B                  <1> save2:	dec ebx
  2164 00001860 4E                  <1> 	dec esi
  2165 00001861 8A03                <1> 	mov al, [ebx]
  2166 00001863 3C05                <1> 	cmp al, 5
  2167 00001865 7402                <1> 	je remove
  2168 00001867 EBEC                <1> 	jmp varfnd
  2169 00001869 8A03                <1> remove: mov al, [ebx]
  2170 0000186B 3C00                <1> 	cmp al, 0
  2171 0000186D 749D                <1> 	je seek
  2172 0000186F B000                <1> 	mov al, 0
  2173 00001871 8803                <1> 	mov [ebx], al
  2174 00001873 43                  <1> 	inc ebx
  2175 00001874 EBF3                <1> 	jmp remove	;do not need for now-need defragmentation
  2176 00001876 BE[82540000]        <1> save:	mov esi, buftxt
  2177 0000187B 43                  <1> 	inc ebx
  2178 0000187C B005                <1> 	mov al, 5
  2179 0000187E B404                <1> 	mov ah, 4
  2180 00001880 668903              <1> 	mov [ebx], ax
  2181 00001883 43                  <1> 	inc ebx
  2182 00001884 43                  <1> svhere:	inc ebx
  2183 00001885 46                  <1> 	inc esi
  2184 00001886 8A06                <1> 	mov al, [esi]
  2185 00001888 3C00                <1> 	cmp al, 0
  2186 0000188A 0F8442000000        <1> 	je near svdone
  2187 00001890 3C25                <1> 	cmp al, '%'
  2188 00001892 7404                <1> 	je ans2
  2189 00001894 8803                <1> 	mov [ebx], al	
  2190 00001896 EBEC                <1> 	jmp svhere
  2191 00001898 56                  <1> ans2:	push esi
  2192 00001899 BE[82560000]        <1> 	mov esi, buf2
  2193 0000189E E823000000          <1> 	call ansfnd
  2194 000018A3 E803000000          <1> 	call anscp
  2195 000018A8 5E                  <1> 	pop esi
  2196 000018A9 EBD9                <1> 	jmp svhere
  2197 000018AB 8A06                <1> anscp:	mov al, [esi]
  2198 000018AD 8803                <1> 	mov [ebx], al
  2199 000018AF 81FE[96560000]      <1> 	cmp esi, numbuf
  2200 000018B5 74CD                <1> 	je svhere
  2201 000018B7 3C00                <1> 	cmp al, 0
  2202 000018B9 74C9                <1> 	je svhere
  2203 000018BB 43                  <1> 	inc ebx
  2204 000018BC 46                  <1> 	inc esi
  2205 000018BD EBEC                <1> 	jmp anscp
  2206 000018BF 5E                  <1> ansnf:	pop esi
  2207 000018C0 8A06                <1> 	mov al, [esi]
  2208 000018C2 8803                <1> 	mov [ebx], al
  2209 000018C4 EBBE                <1> 	jmp svhere
  2210 000018C6 46                  <1> ansfnd:	inc esi
  2211 000018C7 8A06                <1> 	mov al, [esi]
  2212 000018C9 3C00                <1> 	cmp al, 0
  2213 000018CB 74F2                <1> 	je ansnf
  2214 000018CD 3C30                <1> 	cmp al, '0'
  2215 000018CF 74F5                <1> 	je ansfnd
  2216 000018D1 C3                  <1> 	ret
  2217 000018D2 B000                <1> svdone:	mov al, 0
  2218 000018D4 8803                <1> 	mov [ebx], al
  2219 000018D6 E940F4FFFF          <1> 	jmp nwcmd
  2220                              <1> 	
  2221                              <1> 	
  2222 000018DB 05042E2F00          <1> 	db 5,4,"./",0
  2223                              <1> rundiskprog:
  2224 000018E0 BF[82540000]        <1> 	mov edi, buftxt
  2225 000018E5 81C702000000        <1> 	add edi, 2
  2226 000018EB BE00001000          <1> 	mov esi, 0x100000
  2227 000018F0 E8C2250000          <1> 	call loadfile
  2228 000018F5 81FA94010000        <1> 	cmp edx, 404
  2229 000018FB 7414                <1> 	je noprogfound
  2230 000018FD BB00001000          <1> 	mov ebx, 0x100000
  2231 00001902 66813B4558          <1> 	cmp word [ebx], "EX"
  2232 00001907 7508                <1> 	jne noprogfound
  2233 00001909 81C302000000        <1> 	add ebx, 2
  2234 0000190F FFE3                <1> 	jmp ebx
  2235                              <1> noprogfound:
  2236 00001911 BE[7F400000]        <1> 	mov esi, notfound1
  2237 00001916 E891F1FFFF          <1> 	call print
  2238 0000191B BE[82540000]        <1> 	mov esi, buftxt
  2239 00001920 81C602000000        <1> 	add esi, 2
  2240 00001926 E881F1FFFF          <1> 	call print
  2241 0000192B BE[89400000]        <1> 	mov esi, notfound2
  2242 00001930 E877F1FFFF          <1> 	call print
  2243 00001935 E9E1F3FFFF          <1> 	jmp nwcmd
  2244                              <1> 
  2245 0000193A E9DCF3FFFF          <1> notbatch: jmp nwcmd
  2246                              <1> 
  2247 0000193F 05047768696C6500    <1> 	db 5,4,"while",0
  2248 00001947 B000                <1> while:  mov al, 0
  2249 00001949 3805[7B4D0000]      <1> 	cmp [BATCHISON], al
  2250 0000194F 0F84E5FFFFFF        <1> 	je near notbatch
  2251 00001955 8B35[774D0000]      <1> 	MOV esi, [BATCHPOS]
  2252 0000195B 4E                  <1> whilefnd: dec esi
  2253 0000195C 8A06                <1> 	mov al, [esi]
  2254 0000195E 3C0A                <1> 	cmp al, 10
  2255 00001960 0F8412000000        <1> 	je near whilefnd2
  2256 00001966 3C0D                <1> 	cmp al, 13
  2257 00001968 0F840A000000        <1> 	je near whilefnd2
  2258 0000196E 3C00                <1> 	cmp al, 0
  2259 00001970 0F8402000000        <1> 	je near whilefnd2
  2260 00001976 EBE3                <1> 	jmp whilefnd
  2261                              <1> whilefnd2:
  2262 00001978 8935[7D4D0000]      <1> 	mov [LOOPPOS], esi
  2263 0000197E C605[7C4D0000]01    <1> 	mov BYTE [LOOPON], 1
  2264 00001985 0005[124D0000]      <1> 	add [IFON], al
  2265 0000198B BE[82540000]        <1> 	mov esi, buftxt
  2266 00001990 BB[82540000]        <1> 	mov ebx, buftxt
  2267 00001995 81C306000000        <1> 	add ebx, 6
  2268 0000199B E923000000          <1> 	jmp chkeqsn
  2269                              <1> 
  2270                              <1> 
  2271 000019A0 0504696600          <1> 	db 5,4,"if",0
  2272 000019A5 B000                <1> if:	mov al, 0
  2273 000019A7 3805[7B4D0000]      <1> 	cmp [BATCHISON], al
  2274 000019AD 0F8487FFFFFF        <1> 	je near notbatch
  2275 000019B3 BE[82540000]        <1> 	mov esi, buftxt
  2276 000019B8 BB[82540000]        <1> 	mov ebx, buftxt
  2277 000019BD 81C303000000        <1> 	add ebx, 3
  2278 000019C3 8A06                <1> chkeqsn: mov al, [esi]
  2279 000019C5 3C00                <1> 	cmp al, 0
  2280 000019C7 0F846DFFFFFF        <1> 	je near notbatch
  2281 000019CD 3C3D                <1> 	cmp al, '='
  2282 000019CF 0F8403000000        <1> 	je near chkeqdn
  2283 000019D5 46                  <1> 	inc esi
  2284 000019D6 EBEB                <1> 	jmp chkeqsn
  2285 000019D8 B000                <1> chkeqdn: mov al, 0 
  2286 000019DA 8806                <1> 	mov [esi], al
  2287 000019DC 46                  <1> 	inc esi
  2288 000019DD 8A06                <1> 	mov al, [esi]
  2289 000019DF 3C24                <1> 	cmp al, '$'
  2290 000019E1 0F8462000000        <1> 	je near ifvar1
  2291 000019E7 8A03                <1> ifvar2: mov al, [ebx]
  2292 000019E9 3C24                <1> 	cmp al, '$'
  2293 000019EB 0F847B000000        <1> 	je near ifvar3
  2294 000019F1 E8F0F3FFFF          <1> ifvar4:	call tester
  2295 000019F6 3C01                <1> 	cmp al, 1
  2296 000019F8 0F8405000000        <1> 	je near trueif
  2297 000019FE E923000000          <1> 	jmp falseif
  2298 00001A03 B800000000          <1> trueif:	mov eax, 0
  2299 00001A08 A0[124D0000]        <1> 	mov al, [IFON]
  2300 00001A0D FEC0                <1> 	inc al
  2301 00001A0F A2[124D0000]        <1> 	mov [IFON], al
  2302 00001A14 B400                <1> 	mov ah, 0
  2303 00001A16 BE[134D0000]        <1> 	mov esi, IFTRUE
  2304 00001A1B 01C6                <1> 	add esi, eax
  2305 00001A1D B401                <1> 	mov ah, 1
  2306 00001A1F 8826                <1> 	mov [esi], ah
  2307 00001A21 E9F5F2FFFF          <1> 	jmp nwcmd
  2308 00001A26 B800000000          <1> falseif: mov eax, 0
  2309 00001A2B A0[124D0000]        <1> 	mov al, [IFON]
  2310 00001A30 FEC0                <1> 	inc al
  2311 00001A32 A2[124D0000]        <1> 	mov [IFON], al
  2312 00001A37 B400                <1> 	mov ah, 0
  2313 00001A39 BE[134D0000]        <1> 	mov esi, IFTRUE
  2314 00001A3E 01C6                <1> 	add esi, eax
  2315 00001A40 B400                <1> 	mov ah, 0
  2316 00001A42 8826                <1> 	mov [esi], ah
  2317 00001A44 E9D2F2FFFF          <1> 	jmp nwcmd
  2318 00001A49 89F7                <1> ifvar1: mov edi, esi
  2319 00001A4B 81EF[82540000]      <1> 	sub edi, buftxt
  2320 00001A51 47                  <1> 	inc edi
  2321 00001A52 BB[814F0000]        <1> 	mov ebx, variables
  2322 00001A57 E82CFAFFFF          <1> 	call nxtvrech
  2323 00001A5C BB[82540000]        <1> 	mov ebx, buftxt
  2324 00001A61 81C303000000        <1> 	add ebx, 3
  2325 00001A67 E97BFFFFFF          <1> 	jmp ifvar2
  2326 00001A6C 8935[8C1A0000]      <1> ifvar3: mov [esiif], esi
  2327 00001A72 BF04000000          <1> 	mov edi, 4
  2328 00001A77 BB[814F0000]        <1> 	mov ebx, variables
  2329 00001A7C E807FAFFFF          <1> 	call nxtvrech
  2330 00001A81 8B35[8C1A0000]      <1> 	mov esi, [esiif]
  2331 00001A87 E965FFFFFF          <1> 	jmp ifvar4
  2332                              <1> 
  2333 00001A8C 00000000            <1> esiif dd 0
  2334                              <1> 	
  2335 00001A90 0504656C736500      <1> 	db 5,4,"else",0
  2336 00001A97 B800000000          <1> else:	mov eax, 0
  2337 00001A9C A0[124D0000]        <1> 	mov al, [IFON]
  2338 00001AA1 BE[134D0000]        <1> 	mov esi, IFTRUE
  2339 00001AA6 01C6                <1> 	add esi, eax
  2340 00001AA8 8A06                <1> 	mov al, [esi]
  2341 00001AAA 3C00                <1> 	cmp al, 0		
  2342 00001AAC 7409                <1> 	je else1
  2343 00001AAE 3C01                <1> 	cmp al, 1
  2344 00001AB0 740E                <1> 	je else2
  2345 00001AB2 E964F2FFFF          <1> 	jmp nwcmd
  2346 00001AB7 B001                <1> else1:  mov al, 1
  2347 00001AB9 8806                <1> 	mov [esi], al
  2348 00001ABB E95BF2FFFF          <1> 	jmp nwcmd
  2349 00001AC0 B000                <1> else2:	mov al, 0
  2350 00001AC2 8806                <1> 	mov [esi], al
  2351 00001AC4 E952F2FFFF          <1> 	jmp nwcmd
  2352                              <1> 
  2353 00001AC9 05046C6F6F7000      <1> 	db 5,4,"loop",0
  2354 00001AD0 3805[7C4D0000]      <1> 	cmp [LOOPON], al
  2355 00001AD6 0F8405000000        <1> 	je near filoop
  2356 00001ADC E93AF2FFFF          <1> 	jmp nwcmd
  2357 00001AE1 8B35[7D4D0000]      <1> filoop: mov esi, [LOOPPOS]
  2358 00001AE7 8935[774D0000]      <1> 	mov [BATCHPOS], esi
  2359 00001AED E929F2FFFF          <1> 	jmp nwcmd
  2360                              <1> 	
  2361                              <1> 
  2362 00001AF2 0504666900          <1> 	db 5,4,"fi",0
  2363 00001AF7 B000                <1> 	mov al, 0
  2364 00001AF9 3805[7B4D0000]      <1> 	cmp [BATCHISON], al
  2365 00001AFF 0F8435FEFFFF        <1> 	je near notbatch
  2366 00001B05 B001                <1> fi:	mov al, 1
  2367 00001B07 2805[124D0000]      <1> 	sub [IFON],al
  2368 00001B0D E909F2FFFF          <1> 	jmp nwcmd
  2369                              <1> 
  2370 00001B12 050473746F7000      <1> 	db 5,4,"stop",0
  2371 00001B19 B000                <1> stop:	mov al, 0
  2372 00001B1B A2[7B4D0000]        <1> 	mov [BATCHISON], al
  2373 00001B20 A2[124D0000]        <1> 	mov [IFON], al
  2374 00001B25 A2[134D0000]        <1> 	mov [IFTRUE], al
  2375 00001B2A A2[7C4D0000]        <1> 	mov [LOOPON], al
  2376 00001B2F E9E7F1FFFF          <1> 	jmp nwcmd
  2377                                      %include 'source/programs.asm'
  2378                              <1> 
  2379 00001B34 0504696E7465726E65- <1> db 5,4,"internet",0
  2380 00001B3D 7400                <1>
  2381                              <1> 	internettest: 			;;initialize network card, lets hope this is right
  2382                              <1> 							;;^^used to^^, now tests int 30h functions		
  2383 00001B3F B403                <1> 		mov ah, 3
  2384 00001B41 CD30                <1> 		int 30h
  2385 00001B43 B401                <1> 		mov ah, 1
  2386 00001B45 BE[571B0000]        <1> 		mov esi, datmsg
  2387 00001B4A 66BB0700            <1> 		mov bx, 7
  2388 00001B4E B000                <1> 		mov al, 0
  2389 00001B50 CD30                <1> 		int 30h
  2390                              <1> 	;jmp packettest
  2391 00001B52 E9C4F1FFFF          <1> 		jmp nwcmd
  2392 00001B57 496E7465726E657420- <1> datmsg: db "Internet has not been implemented yet.",10,13,0
  2393 00001B60 686173206E6F742062- <1>
  2394 00001B69 65656E20696D706C65- <1>
  2395 00001B72 6D656E746564207965- <1>
  2396 00001B7B 742E0A0D00          <1>
  2397                              <1> 		
  2398 00001B80 050470636900        <1> db 5,4,"pci",0
  2399                              <1> 	pcishow:
  2400 00001B86 E872210000          <1> 	call pcidump
  2401 00001B8B E98BF1FFFF          <1> 	jmp nwcmd
  2402 00001B90 050472756E62617400  <1> db 5,4,"runbat",0
  2403                              <1> 	runbatch2:
  2404 00001B99 BE[C9400000]        <1> 		mov esi, line
  2405 00001B9E E809EFFFFF          <1> 		call print
  2406 00001BA3 BF[82540000]        <1> 		mov edi, buftxt
  2407 00001BA8 81C707000000        <1> 		add edi, 7
  2408 00001BAE BE00001000          <1> 		mov esi, 0x100000
  2409 00001BB3 E8FF220000          <1> 		call loadfile
  2410 00001BB8 BF00001000          <1> 		mov edi, 0x100000
  2411 00001BBD C605[7B4D0000]01    <1> 		mov byte [BATCHISON], 1
  2412                              <1> 	batchrunloop:
  2413 00001BC4 E82FF1FFFF          <1> 		call buftxtclear
  2414 00001BC9 BE[82540000]        <1> 		mov esi, buftxt
  2415                              <1> 	batchrunloop2:
  2416 00001BCE B10D                <1> 		mov cl, 13
  2417 00001BD0 B50A                <1> 		mov ch, 10
  2418 00001BD2 66390F              <1> 		cmp [edi], cx
  2419 00001BD5 0F841E000000        <1> 		je near nxtbatchrunline
  2420 00001BDB 66C1C108            <1> 		rol cx, 8
  2421 00001BDF 66390F              <1> 		cmp [edi], cx
  2422 00001BE2 0F8411000000        <1> 		je near nxtbatchrunline
  2423 00001BE8 803F00              <1> 		cmp byte [edi], 0
  2424 00001BEB 0F8408000000        <1> 		je near nxtbatchrunline
  2425 00001BF1 8A07                <1> 		mov al, [edi]
  2426 00001BF3 8806                <1> 		mov [esi], al
  2427 00001BF5 46                  <1> 		inc esi
  2428 00001BF6 47                  <1> 		inc edi
  2429 00001BF7 EBD5                <1> 		jmp batchrunloop2
  2430                              <1> 	nxtbatchrunline:
  2431 00001BF9 81C702000000        <1> 		add edi, 2
  2432 00001BFF 893D[5E1C0000]      <1> 		mov [batchedi], edi
  2433 00001C05 C60600              <1> 		mov byte [esi], 0
  2434 00001C08 BE[82540000]        <1> 		mov esi, buftxt
  2435 00001C0D 803E00              <1> 		cmp byte [esi], 0
  2436 00001C10 0F843C000000        <1> 		je near nobatchfoundrun
  2437 00001C16 BB00000000          <1> 		mov ebx, 0
  2438 00001C1B 8A1D[124D0000]      <1> 		mov bl, [IFON]
  2439 00001C21 80FB01              <1> 		cmp bl, 1
  2440 00001C24 0F8338000000        <1> 		jae near iftestbatch
  2441                              <1> 	doneiftest:
  2442 00001C2A 803D[251D0000]00    <1> 		cmp byte [runnextline], 0
  2443 00001C31 0F8405000000        <1> 		je near noruniftest
  2444 00001C37 E838F1FFFF          <1> 		call progtest
  2445                              <1> 	noruniftest:
  2446 00001C3C C605[251D0000]01    <1> 		mov byte [runnextline], 1
  2447 00001C43 8B3D[5E1C0000]      <1> 		mov edi, [batchedi]
  2448 00001C49 803F00              <1> 		cmp byte [edi], 0
  2449 00001C4C 0F8572FFFFFF        <1> 		jne near batchrunloop
  2450                              <1> 	nobatchfoundrun:
  2451 00001C52 C605[7B4D0000]00    <1> 		mov byte [BATCHISON], 0
  2452 00001C59 E9BDF0FFFF          <1> 		jmp nwcmd
  2453                              <1> 	
  2454 00001C5E 00000000            <1> batchedi dd 0	
  2455                              <1> 	
  2456                              <1> 	iftestbatch:
  2457 00001C62 BE[134D0000]        <1> 		mov esi, IFTRUE
  2458 00001C67 01DE                <1> 		add esi, ebx
  2459 00001C69 803E00              <1> 		cmp byte [esi], 0
  2460 00001C6C 0F85B8FFFFFF        <1> 		jne near doneiftest
  2461 00001C72 881D[261D0000]      <1> 		mov [iffalsebuf], bl
  2462 00001C78 803D[7C4D0000]01    <1> 		cmp byte [LOOPON], 1
  2463 00001C7F 750B                <1> 		jne fifindbatch
  2464 00001C81 8B3D[7D4D0000]      <1> 		mov edi, [LOOPPOS]
  2465 00001C87 E938FFFFFF          <1> 		jmp batchrunloop
  2466                              <1> 	fifindbatch:
  2467 00001C8C 66B96966            <1> 		mov cx, "if"
  2468 00001C90 66B86669            <1> 		mov ax, "fi"
  2469 00001C94 663907              <1> 		cmp [edi], ax
  2470 00001C97 0F841A000000        <1> 		je near fifoundbatch
  2471 00001C9D 66390F              <1> 		cmp [edi], cx
  2472 00001CA0 0F8462000000        <1> 		je near iffoundbatch
  2473 00001CA6 803F00              <1> 		cmp byte [edi], 0
  2474 00001CA9 0F8408000000        <1> 		je near fifoundbatch
  2475 00001CAF 81C702000000        <1> 		add edi, 2
  2476 00001CB5 EBD5                <1> 		jmp fifindbatch
  2477                              <1> 	fifoundbatch:
  2478 00001CB7 81C702000000        <1> 		add edi, 2
  2479 00001CBD B00D                <1> 		mov al, 13
  2480 00001CBF B40A                <1> 		mov ah, 10
  2481 00001CC1 663907              <1> 		cmp [edi], ax
  2482 00001CC4 7414                <1> 		je goodfibatch
  2483 00001CC6 66C1C008            <1> 		rol ax, 8
  2484 00001CCA 663907              <1> 		cmp [edi], ax
  2485 00001CCD 740B                <1> 		je goodfibatch
  2486 00001CCF 803F00              <1> 		cmp byte [edi], 0
  2487 00001CD2 0F847AFFFFFF        <1> 		je near nobatchfoundrun
  2488 00001CD8 EBB2                <1> 		jmp fifindbatch
  2489                              <1> 	goodfibatch:
  2490 00001CDA B001                <1> 		mov al, 1
  2491 00001CDC 2805[124D0000]      <1> 		sub [IFON], al 
  2492 00001CE2 A0[124D0000]        <1> 		mov al, [IFON]
  2493 00001CE7 8A1D[261D0000]      <1> 		mov bl, [iffalsebuf]
  2494 00001CED 38D8                <1> 		cmp al, bl
  2495 00001CEF 779B                <1> 		ja fifindbatch
  2496 00001CF1 BE[82540000]        <1> 		mov esi, buftxt
  2497 00001CF6 81EF02000000        <1> 		sub edi, 2
  2498 00001CFC C605[251D0000]00    <1> 		mov byte [runnextline], 0
  2499 00001D03 E9BCFEFFFF          <1> 		jmp batchrunloop
  2500                              <1> 	iffoundbatch:
  2501 00001D08 B020                <1> 		mov al, ' '
  2502 00001D0A 81C702000000        <1> 		add edi, 2
  2503 00001D10 3807                <1> 		cmp [edi], al
  2504 00001D12 0F8574FFFFFF        <1> 		jne near fifindbatch
  2505 00001D18 B001                <1> 		mov al, 1
  2506 00001D1A 0005[124D0000]      <1> 		add [IFON], al
  2507 00001D20 E967FFFFFF          <1> 		jmp fifindbatch
  2508                              <1> 		
  2509                              <1> 		
  2510 00001D25 01                  <1> runnextline db 1
  2511 00001D26 00                  <1> iffalsebuf db 0
  2512                              <1> 
  2513 00001D27 0504626174636800    <1> db 5,4,"batch",0
  2514                              <1> 	batchst: 
  2515 00001D2F BF[82540000]        <1> 		mov edi, buftxt
  2516 00001D34 81C706000000        <1> 		add edi, 6
  2517 00001D3A 803F00              <1> 		cmp byte [edi], 0
  2518 00001D3D 0F8473000000        <1> 		je near nonamefound
  2519 00001D43 BE00001000          <1> 		mov esi, 0x100000
  2520 00001D48 E86A210000          <1> 		call loadfile
  2521 00001D4D 89D0                <1> 		mov eax, edx
  2522 00001D4F 3D94010000          <1> 		cmp eax, 404
  2523 00001D54 746F                <1> 		je goodbatchname
  2524 00001D56 BE[651D0000]        <1> 		mov esi, badbatchname
  2525 00001D5B E84CEDFFFF          <1> 		call print
  2526 00001D60 E9B6EFFFFF          <1> 		jmp nwcmd
  2527 00001D65 546869732066696C65- <1> 		badbatchname db "This file already exists!",10,13,0
  2528 00001D6E 20616C726561647920- <1>
  2529 00001D77 657869737473210A0D- <1>
  2530 00001D80 00                  <1>
  2531 00001D81 596F75206861766520- <1> 		namenotfoundbatch db "You have to type a name after the command.",10,13,0
  2532 00001D8A 746F20747970652061- <1>
  2533 00001D93 206E616D6520616674- <1>
  2534 00001D9C 65722074686520636F- <1>
  2535 00001DA5 6D6D616E642E0A0D00  <1>
  2536 00001DAE 00000000            <1> 		esicache3 dd 0
  2537 00001DB2 00000000            <1> 		esicache2 dd 0
  2538                              <1> 	nonamefound:
  2539 00001DB6 BE[811D0000]        <1> 		mov esi, namenotfoundbatch
  2540 00001DBB E8ECECFFFF          <1> 		call print
  2541 00001DC0 E956EFFFFF          <1> 		jmp nwcmd
  2542                              <1> 	goodbatchname:
  2543 00001DC5 BE00001000          <1> 		mov esi, 0x100000
  2544                              <1> 	batchcreate:
  2545 00001DCA 8935[AE1D0000]      <1> 		mov [esicache3], esi
  2546 00001DD0 B00D                <1> 		mov al, 13
  2547 00001DD2 B307                <1> 		mov bl, 7
  2548 00001DD4 B404                <1> 		mov ah, 4
  2549 00001DD6 CD30                <1> 		int 30h
  2550 00001DD8 8935[B21D0000]      <1> 		mov [esicache2], esi
  2551 00001DDE 8A0E                <1> 		mov cl, [esi]
  2552 00001DE0 8B35[AE1D0000]      <1> 		mov esi, [esicache3]
  2553 00001DE6 BB[3D1E0000]        <1> 		mov ebx, exitword
  2554 00001DEB E830F0FFFF          <1> 		call cndtest
  2555 00001DF0 3C01                <1> 		cmp al, 1
  2556 00001DF2 7423                <1> 		je endbatchcreate
  2557 00001DF4 3C02                <1> 		cmp al, 2
  2558 00001DF6 741F                <1> 		je endbatchcreate
  2559 00001DF8 BE[C9400000]        <1> 		mov esi, line
  2560 00001DFD E8AAECFFFF          <1> 		call print
  2561 00001E02 8B35[B21D0000]      <1> 		mov esi, [esicache2]
  2562 00001E08 B00D                <1> 		mov al, 13
  2563 00001E0A B40A                <1> 		mov ah, 10
  2564 00001E0C 668906              <1> 		mov [esi], ax
  2565 00001E0F 81C602000000        <1> 		add esi, 2
  2566 00001E15 EBB3                <1> 		jmp batchcreate
  2567                              <1> 	endbatchcreate:
  2568 00001E17 8B35[AE1D0000]      <1> 		mov esi, [esicache3]
  2569 00001E1D B800000000          <1> 		mov eax, 0
  2570 00001E22 8806                <1> 		mov [esi], al
  2571 00001E24 BE[C9400000]        <1> 		mov esi, line
  2572 00001E29 E87EECFFFF          <1> 		call print
  2573 00001E2E BE00001000          <1> 		mov esi, 0x100000
  2574 00001E33 E874ECFFFF          <1> 		call print
  2575 00001E38 E9DEEEFFFF          <1> 		jmp nwcmd
  2576                              <1> 	
  2577 00001E3D 5C7800              <1> 	exitword db "\x",0
  2578 00001E40 54797065205C782074- <1> 	wordmsg db "Type \x to exit.",10,13,0
  2579 00001E49 6F20657869742E0A0D- <1>
  2580 00001E52 00                  <1>
  2581                              <1> 		
  2582 00001E53 050473686F77626D70- <1> db 5,4,"showbmp",0
  2583 00001E5C 00                  <1>
  2584 00001E5D 803D[C4280000]00    <1> 		cmp byte [guion], 0
  2585 00001E64 0F8458000000        <1> 		je near noguibmp
  2586 00001E6A BF[82540000]        <1> 		mov edi, buftxt
  2587 00001E6F 81C708000000        <1> 		add edi, 8
  2588 00001E75 BE00001000          <1> 		mov esi, 0x100000
  2589 00001E7A E838200000          <1> 		call loadfile
  2590 00001E7F BE00001000          <1> 		mov esi, 0x100000
  2591 00001E84 B900000000          <1> 		mov ecx, 0
  2592 00001E89 BA00000000          <1> 		mov edx, 0
  2593 00001E8E B800000000          <1> 		mov eax, 0
  2594 00001E93 BB00000000          <1> 		mov ebx, 0
  2595 00001E98 E8F6190000          <1> 		call showbmp
  2596 00001E9D B000                <1> 		mov al, 0
  2597 00001E9F B405                <1> 		mov ah, 5
  2598 00001EA1 CD30                <1> 		int 30h
  2599 00001EA3 BE[82540000]        <1> 		mov esi, buftxt
  2600 00001EA8 81C608000000        <1> 		add esi, 8
  2601 00001EAE E8F9EBFFFF          <1> 		call print
  2602 00001EB3 BE[891F0000]        <1> 		mov esi, loadedbmpmsg
  2603 00001EB8 E8EFEBFFFF          <1> 		call print
  2604 00001EBD E959EEFFFF          <1> 		jmp nwcmd
  2605                              <1> noguibmp:
  2606 00001EC2 BE[D11E0000]        <1> 		mov esi, warnguibmp
  2607 00001EC7 E8E0EBFFFF          <1> 		call print
  2608 00001ECC E94AEEFFFF          <1> 		jmp nwcmd
  2609 00001ED1 546869732063616E20- <1> warnguibmp db "This can not be done without the gui.",10,13,0
  2610 00001EDA 6E6F7420626520646F- <1>
  2611 00001EE3 6E6520776974686F75- <1>
  2612 00001EEC 742074686520677569- <1>
  2613 00001EF5 2E0A0D00            <1>
  2614                              <1> 
  2615 00001EF9 050473686F77747874- <1> db 5,4,"showtxt",0
  2616 00001F02 00                  <1>
  2617 00001F03 BF[82540000]        <1> 		mov edi, buftxt
  2618 00001F08 81C708000000        <1> 		add edi, 8
  2619 00001F0E BE00001000          <1> 		mov esi, 0x100000
  2620 00001F13 E89F1F0000          <1> 		call loadfile
  2621 00001F18 81FA94010000        <1> 		cmp edx, 404
  2622 00001F1E 0F8419000000        <1> 		je near filenotfound
  2623 00001F24 BE00001000          <1> 		mov esi, 0x100000
  2624 00001F29 E87EEBFFFF          <1> 		call print
  2625 00001F2E BE[C9400000]        <1> 		mov esi, line
  2626 00001F33 E874EBFFFF          <1> 		call print
  2627 00001F38 E9DEEDFFFF          <1> 		jmp nwcmd
  2628                              <1> 		
  2629                              <1> filenotfound:
  2630 00001F3D BE[661F0000]        <1> 		mov esi, filenf
  2631 00001F42 E865EBFFFF          <1> 		call print
  2632 00001F47 BE[82540000]        <1> 		mov esi, buftxt
  2633 00001F4C 81C608000000        <1> 		add esi, 8
  2634 00001F52 E855EBFFFF          <1> 		call print
  2635 00001F57 BE[711F0000]        <1> 		mov esi, filenf2
  2636 00001F5C E84BEBFFFF          <1> 		call print
  2637 00001F61 E9B5EDFFFF          <1> 		jmp nwcmd
  2638 00001F66 5468652066696C6520- <1> filenf db "The file ",34,0
  2639 00001F6F 2200                <1>
  2640 00001F71 2220636F756C64206E- <1> filenf2 db 34," could not be found.",13,10,0
  2641 00001F7A 6F7420626520666F75- <1>
  2642 00001F83 6E642E0D0A00        <1>
  2643                              <1> 		
  2644 00001F89 206C6F616465642E0D- <1> loadedbmpmsg db " loaded.",13,10,0
  2645 00001F92 0A00                <1>
  2646                              <1> 
  2647 00001F94 050464756D7000      <1> 	db 5,4,"dump",0
  2648 00001F9B BE[82540000]        <1> 	mov esi, buftxt
  2649 00001FA0 81C605000000        <1> 	add esi, 5
  2650 00001FA6 B900000000          <1> 	mov ecx, 0
  2651 00001FAB E855F2FFFF          <1> 	call cnvrttxt
  2652 00001FB0 89CF                <1> 	mov edi, ecx
  2653 00001FB2 89FE                <1> 	mov esi, edi
  2654 00001FB4 81C680030000        <1> 	add esi, 896
  2655 00001FBA C605[D4100000]00    <1> 	mov byte [firsthexshown],0
  2656                              <1> dumphexloop:
  2657 00001FC1 8B0F                <1> 	mov ecx, [edi]
  2658 00001FC3 E80DF1FFFF          <1> 	call showhex
  2659 00001FC8 81C704000000        <1> 	add edi, 4
  2660 00001FCE 39F7                <1> 	cmp edi, esi
  2661 00001FD0 72EF                <1> 	jb dumphexloop
  2662 00001FD2 E944EDFFFF          <1> 	jmp nwcmd
  2663                              <1> 	
  2664 00001FD7 050465787000        <1> 	db 5,4,"exp",0
  2665 00001FDD B878563412          <1> 	mov eax, 0x12345678
  2666 00001FE2 BBEFCDAB90          <1> 	mov ebx, 0x90ABCDEF
  2667 00001FE7 B945584345          <1> 	mov ecx, "EXCE"
  2668 00001FEC BA5054494F          <1> 	mov edx, "PTIO"
  2669 00001FF1 BE4E203133          <1> 	mov esi, "N 13"
  2670 00001FF6 BF[1B0D0000]        <1> 	mov edi, nwcmd
  2671 00001FFB CD0D                <1> exception1:	int 13
  2672                              <1> 
  2673 00001FFD 050474696D6500      <1> db 5,4,"time",0
  2674 00002004 E805000000          <1> 	call time
  2675 00002009 E90DEDFFFF          <1> 	jmp nwcmd
  2676                              <1> time:
  2677 0000200E E8C1000000          <1> 	call tstackput1
  2678 00002013 B00A                <1> 	mov al,10			;Get RTC register A
  2679 00002015 E8EB000000          <1> 	call tget1
  2680 0000201A A880                <1> 	test al,0x80			;Is update in progress?
  2681 0000201C 75F0                <1> 	jne time				; yes, wait
  2682                              <1> 
  2683 0000201E B000                <1> 	mov al,0			;Get seconds (00 to 59)
  2684 00002020 E8E0000000          <1> 	call tget1
  2685 00002025 A2[43210000]        <1> 	mov [RTCtimeSecond],al
  2686                              <1> 
  2687 0000202A B002                <1> 	mov al,0x02			;Get minutes (00 to 59)
  2688 0000202C E8D4000000          <1> 	call tget1
  2689 00002031 A2[44210000]        <1> 	mov [RTCtimeMinute],al
  2690                              <1> 
  2691 00002036 B004                <1> 	mov al,0x04			;Get hours (see notes)
  2692 00002038 E8C8000000          <1> 	call tget1
  2693 0000203D A2[45210000]        <1> 	mov [RTCtimeHour],al
  2694                              <1> 
  2695 00002042 B007                <1> 	mov al,0x07			;Get day of month (01 to 31)
  2696 00002044 E8BC000000          <1> 	call tget1
  2697 00002049 A2[46210000]        <1> 	mov [RTCtimeDay],al
  2698                              <1> 
  2699 0000204E B008                <1> 	mov al,0x08			;Get month (01 to 12)
  2700 00002050 E8B0000000          <1> 	call tget1
  2701 00002055 A2[47210000]        <1> 	mov [RTCtimeMonth],al
  2702                              <1> 
  2703 0000205A B009                <1> 	mov al,0x09			;Get year (00 to 99)
  2704 0000205C E8A4000000          <1> 	call tget1
  2705 00002061 A2[48210000]        <1> 	mov [RTCtimeYear],al
  2706                              <1> 	
  2707 00002066 BE[49210000]        <1> 	mov esi, timeshow
  2708 0000206B 8A2D[45210000]      <1> 	mov ch, [RTCtimeHour]
  2709 00002071 E89A000000          <1> 	call tput1
  2710 00002076 8A2D[44210000]      <1> 	mov ch, [RTCtimeMinute]
  2711 0000207C E88F000000          <1> 	call tput1
  2712 00002081 8A2D[43210000]      <1> 	mov ch, [RTCtimeSecond]
  2713 00002087 E884000000          <1> 	call tput1
  2714 0000208C BE[53210000]        <1> 	mov esi, dateshow
  2715 00002091 8A2D[47210000]      <1> 	mov ch, [RTCtimeMonth]
  2716 00002097 E874000000          <1> 	call tput1
  2717 0000209C 8A2D[46210000]      <1> 	mov ch, [RTCtimeDay]
  2718 000020A2 E869000000          <1> 	call tput1
  2719 000020A7 B520                <1> 	mov ch, 0x20
  2720 000020A9 E862000000          <1> 	call tput1
  2721 000020AE 4E                  <1> 	dec esi
  2722 000020AF 8A2D[48210000]      <1> 	mov ch, [RTCtimeYear]
  2723 000020B5 E856000000          <1> 	call tput1
  2724 000020BA E82F000000          <1> 	call tstackget1
  2725 000020BF BE[49210000]        <1> 	mov esi, timeshow
  2726 000020C4 66BB0700            <1> 	mov bx, 7
  2727 000020C8 B401                <1> 	mov ah, 1
  2728 000020CA B000                <1> 	mov al, 0
  2729 000020CC CD30                <1> 	int 30h
  2730 000020CE 66B80000            <1> 	mov ax, 0
  2731 000020D2 CD30                <1> 	int 30h
  2732                              <1> 	
  2733                              <1> tstackput1:
  2734 000020D4 8935[3F210000]      <1> 	mov [tstack + 20], esi
  2735 000020DA BE[2B210000]        <1> 	mov esi, tstack
  2736 000020DF 8906                <1> 	mov [esi], eax
  2737 000020E1 895E04              <1> 	mov [esi + 4], ebx
  2738 000020E4 894E08              <1> 	mov [esi + 8], ecx
  2739 000020E7 89560C              <1> 	mov [esi + 12], edx
  2740 000020EA 897E10              <1> 	mov [esi + 16], edi
  2741 000020ED C3                  <1> 	ret
  2742                              <1> 	
  2743                              <1> tstackget1:
  2744 000020EE BE[2B210000]        <1> 	mov esi, tstack
  2745 000020F3 8B06                <1> 	mov eax, [esi]
  2746 000020F5 8B5E04              <1> 	mov ebx, [esi + 4]
  2747 000020F8 8B4E08              <1> 	mov ecx, [esi + 8]
  2748 000020FB 8B560C              <1> 	mov edx, [esi + 12]
  2749 000020FE 8B7E10              <1> 	mov edi, [esi + 16]
  2750 00002101 8B7614              <1> 	mov esi, [esi + 20]
  2751 00002104 C3                  <1> 	ret
  2752                              <1> 	
  2753                              <1> tget1:
  2754 00002105 66BA7000            <1> 	mov dx, 0x70
  2755 00002109 EE                  <1> 	out dx, al
  2756 0000210A 6642                <1> 	inc dx
  2757 0000210C EC                  <1> 	in al, dx
  2758 0000210D 664A                <1> 	dec dx
  2759 0000210F C3                  <1> 	ret
  2760                              <1> 	
  2761                              <1> tput1:
  2762 00002110 66C1E904            <1> 	shr cx, 4
  2763 00002114 B030                <1> 	mov al, 48
  2764 00002116 00E8                <1> 	add al, ch
  2765 00002118 8806                <1> 	mov [esi], al
  2766 0000211A 46                  <1> 	inc esi
  2767 0000211B B030                <1> 	mov al, 48
  2768 0000211D C0E904              <1> 	shr cl, 4
  2769 00002120 00C8                <1> 	add al, cl
  2770 00002122 8806                <1> 	mov [esi], al
  2771 00002124 81C602000000        <1> 	add esi, 2
  2772 0000212A C3                  <1> 	ret
  2773                              <1> 		
  2774 0000212B 000000000000000000- <1> 	tstack dd 0,0,0,0,0,0
  2775 00002134 000000000000000000- <1>
  2776 0000213D 000000000000        <1>
  2777 00002143 00                  <1> 	RTCtimeSecond db 0
  2778 00002144 00                  <1> 	RTCtimeMinute db 0
  2779 00002145 00                  <1> 	RTCtimeHour db 0
  2780 00002146 00                  <1> 	RTCtimeDay db 0
  2781 00002147 00                  <1> 	RTCtimeMonth db 0
  2782 00002148 00                  <1> 	RTCtimeYear db 0
  2783 00002149 30303A30303A30300D- <1> 	timeshow db "00:00:00",13,10
  2784 00002152 0A                  <1>
  2785 00002153 30302D30302D303030- <1> 	dateshow db "00-00-0000",13,10,0
  2786 0000215C 300D0A00            <1>
  2787                              <1> 
  2788 00002160 0504637075696400    <1> db 5,4,"cpuid",0
  2789 00002168 B800000000          <1> 	mov eax, 0
  2790 0000216D 0FA2                <1> 	cpuid
  2791 0000216F 891D[C4210000]      <1> 	mov [cpuidbuf], ebx
  2792 00002175 8915[C8210000]      <1> 	mov [cpuidbuf + 4], edx
  2793 0000217B 890D[CC210000]      <1> 	mov [cpuidbuf + 8], ecx
  2794 00002181 BE[C4210000]        <1> 	mov esi, cpuidbuf
  2795 00002186 E821E9FFFF          <1> 	call print
  2796 0000218B BE[C9400000]        <1> 	mov esi, line
  2797 00002190 E817E9FFFF          <1> 	call print
  2798 00002195 B801000000          <1> 	mov eax, 1
  2799 0000219A 0FA2                <1> 	cpuid
  2800 0000219C 89C1                <1> 	mov ecx, eax
  2801 0000219E C605[D4100000]02    <1> 	mov byte [firsthexshown], 2
  2802 000021A5 E82BEFFFFF          <1> 	call showhex
  2803 000021AA B808000080          <1> 	mov eax, 0x80000008
  2804 000021AF 0FA2                <1> 	cpuid
  2805 000021B1 89C1                <1> 	mov ecx, eax
  2806 000021B3 C605[D4100000]02    <1> 	mov byte [firsthexshown], 2
  2807 000021BA E816EFFFFF          <1> 	call showhex
  2808 000021BF E957EBFFFF          <1> 	jmp nwcmd
  2809                              <1> 	
  2810 000021C4 00<rept>            <1> cpuidbuf times 13 db 0
  2811                              <1> cpuidvendorend:
  2812                              <1> progend:		;programs end here	
  2813                              <1> batchprogend:
  2814                                      %include 'source/input.asm'
  2815                              <1> PS2SET:
  2816 000021D1 B0A8                <1>   mov  al, 0xa8		; enable mouse port
  2817 000021D3 E664                <1>   out  0x64, al		; write to keyboardcontroller
  2818 000021D5 E801000000          <1>   call CHKPRT		; check if command is progressed (demand!)
  2819 000021DA C3                  <1> ret
  2820                              <1> 
  2821                              <1> ;***********************************************************************
  2822                              <1> ;Check if command is accepted. (not got stuck in inputbuffer)
  2823                              <1> ;***********************************************************************
  2824                              <1> CHKPRT:
  2825 000021DB 66B96400            <1>   mov  cx, 100
  2826                              <1>  .again:
  2827 000021DF E464                <1>   in   al, 0x64		; read from keyboardcontroller
  2828 000021E1 A802                <1>   test al, 2		; Check if input buffer is empty
  2829 000021E3 7402                <1>   je .go
  2830 000021E5 E2F8                <1>   loop .again
  2831                              <1>  .go:
  2832 000021E7 C3                  <1> ret
  2833                              <1> 
  2834                              <1> ;***********************************************************************
  2835                              <1> ;Write to mouse
  2836                              <1> ;***********************************************************************
  2837                              <1> WMOUS:
  2838 000021E8 B0D4                <1>   mov  al, 0xd4		; write to mouse device instead of to keyboard
  2839 000021EA E664                <1>   out  0x64, al		; write to keyboardcontroller
  2840 000021EC E8EAFFFFFF          <1>   call CHKPRT		; check if command is progressed (demand!)
  2841 000021F1 C3                  <1> ret
  2842                              <1> 
  2843                              <1> 
  2844                              <1> 
  2845                              <1> ;***********************************************************************
  2846                              <1> ;mouse output buffer full
  2847                              <1> ;***********************************************************************
  2848                              <1> MBUFFUL:
  2849 000021F2 66B96400            <1>   mov cx, 100
  2850                              <1>  .mn:
  2851 000021F6 E464                <1>   in   al, 0x64		; read from keyboardcontroller
  2852 000021F8 A820                <1>   test al, 0x20		; check if mouse output buffer is full
  2853 000021FA 7402                <1>   jz  .mnn
  2854 000021FC E2F8                <1>   loop .mn
  2855                              <1>  .mnn:
  2856 000021FE C3                  <1> ret
  2857                              <1> 
  2858                              <1> 
  2859                              <1> ;***********************************************************************
  2860                              <1> ;Write activate Mouse HardWare
  2861                              <1> ;***********************************************************************
  2862                              <1> ACTMOUS:
  2863 000021FF E8E4FFFFFF          <1>   call WMOUS
  2864 00002204 B0F4                <1>   mov  al, 0xf4 	; Command to activate mouse itselve (Stream mode)
  2865 00002206 E660                <1>   out  0x60, al		; write ps/2 controller output port (activate mouse)
  2866 00002208 E8CEFFFFFF          <1>   call CHKPRT		; check if command is progressed (demand!)
  2867 0000220D E801000000          <1>   call CHKMOUS		; check if a byte is available
  2868 00002212 C3                  <1> ret
  2869                              <1> 
  2870                              <1> ;***********************************************************************
  2871                              <1> ;Check if mouse has info for us
  2872                              <1> ;***********************************************************************
  2873                              <1> CHKMOUS:
  2874 00002213 B300                <1>   mov  bl, 0
  2875 00002215 66B96400            <1>   mov cx, 100
  2876                              <1>  .vrd:
  2877 00002219 E464                <1>   in   al, 0x64		; read from keyboardcontroller
  2878 0000221B A801                <1>   test al, 1		; check if controller buffer (60h) has data
  2879 0000221D 7504                <1>   jnz .yy
  2880 0000221F E2F8                <1>   loop .vrd
  2881 00002221 B301                <1>   mov  bl, 1
  2882                              <1>  .yy:
  2883 00002223 C3                  <1> ret
  2884                              <1> 
  2885                              <1> ;***********************************************************************
  2886                              <1> ;Get Mouse Byte
  2887                              <1> ;***********************************************************************
  2888                              <1> GETB:
  2889                              <1>  .cagain:
  2890 00002224 E8EAFFFFFF          <1>   call CHKMOUS		; check if a byte is available
  2891 00002229 08DB                <1>   or bl, bl
  2892 0000222B 75F7                <1>   jnz .cagain
  2893 0000222D B0AD                <1>   mov  al, 0xad		; Disable Keyboard
  2894 0000222F E664                <1>   out  0x64, al		; write to keyboardcontroller
  2895 00002231 E8A5FFFFFF          <1>   call CHKPRT		; check if command is progressed (demand!)
  2896 00002236 6631C0              <1>   xor  ax, ax
  2897 00002239 E460                <1>   in   al, 0x60		; read ps/2 controller output port (mousebyte)
  2898 0000223B 88C2                <1>   mov  dl, al
  2899 0000223D B0AE                <1>   mov  al, 0xae		; Enable Keyboard
  2900 0000223F E664                <1>   out  0x64, al		; write to keyboardcontroller
  2901 00002241 E895FFFFFF          <1>   call CHKPRT		; check if command is progressed (demand!)
  2902 00002246 88D0                <1>   mov  al, dl
  2903 00002248 C3                  <1> ret
  2904                              <1> 
  2905 00002249 00                  <1> LBUTTON db 0x00	;	Left   button status 1=PRESSED 0=RELEASED
  2906 0000224A 00                  <1> RBUTTON db 0x00	;	Right  button status 1=PRESSED 0=RELEASED
  2907 0000224B 00                  <1> MBUTTON db 0x00	;	Middle button status 1=PRESSED 0=RELEASED
  2908 0000224C 00                  <1> XCOORD  db 0x00	;	the moved distance  (horizontal)
  2909 0000224D 00                  <1> YCOORD  db 0x00	;	the moved distance  (vertical)
  2910                              <1> 
  2911                              <1> 
  2912                              <1> 	guistartin:
  2913 0000224E B800000000          <1> 		mov eax, 0
  2914 00002253 66A3[790A0000]      <1> 		mov [lastkey], ax
  2915 00002259 E464                <1> 		in al, 64h ; Status
  2916 0000225B A801                <1> 		test al, 1 ; output buffer full?
  2917 0000225D 74EF                <1> 		jz guistartin
  2918 0000225F A820                <1> 		test al, 20h ; PS2-Mouse?
  2919 00002261 0F85E2000000        <1> 		jnz near maincall2
  2920 00002267 E460                <1> 		in al, 60h
  2921 00002269 88C4                <1> 		mov ah, al
  2922 0000226B B000                <1> 		mov al, 0
  2923 0000226D 8825[7A0A0000]      <1> 		mov [lastkey + 1], ah
  2924 00002273 88E0                <1> 		mov al, ah
  2925 00002275 BF[80250000]        <1> 		mov edi, scancode
  2926                              <1> 	guisearchscan: 
  2927 0000227A 3C40                <1> 		cmp al, 40h
  2928 0000227C 7315                <1> 		jae guiscanother
  2929 0000227E B400                <1> 		mov ah, 0
  2930 00002280 D0E0                <1> 		shl al, 1
  2931 00002282 01C7                <1> 		add edi, eax
  2932 00002284 D0E8                <1> 		shr al, 1
  2933 00002286 8A27                <1> 		mov ah, [edi]
  2934 00002288 80FC00              <1> 		cmp ah, 0
  2935 0000228B 7406                <1> 		je guiscanother
  2936 0000228D E964000000          <1> 		jmp guiscanfound
  2937 00002292 00                  <1> guiupper db 0
  2938                              <1> guiscanother:
  2939 00002293 88C4                <1> 		mov ah, al
  2940 00002295 B000                <1> 		mov al, 0
  2941 00002297 66A3[790A0000]      <1> 		mov [lastkey], ax
  2942                              <1> 		;cmp ah, 4Dh
  2943                              <1> 		;je near nextimage
  2944 0000229D 80FC2A              <1> 		cmp ah, 2Ah
  2945 000022A0 0F8437000000        <1> 		je near guishifton
  2946 000022A6 80FC36              <1> 		cmp ah, 36h
  2947 000022A9 0F842E000000        <1> 		je near guishifton
  2948 000022AF 80FC1C              <1> 		cmp ah, 1Ch
  2949 000022B2 0F843D000000        <1> 		je near guientdown
  2950 000022B8 80FCAA              <1> 		cmp ah, 0AAh
  2951 000022BB 0F8428000000        <1> 		je near guishiftoff
  2952 000022C1 80FCB6              <1> 		cmp ah, 0B6h
  2953 000022C4 0F841F000000        <1> 		je near guishiftoff
  2954 000022CA 80FC3A              <1> 		cmp ah, 3Ah
  2955 000022CD 0F8401000000        <1> 		je near guishift
  2956 000022D3 C3                  <1> 		ret
  2957                              <1> 	guishift:
  2958 000022D4 A0[92220000]        <1> 		mov al, [guiupper]
  2959 000022D9 3C01                <1> 		cmp al, 1
  2960 000022DB 730C                <1> 		jae guishiftoff
  2961                              <1> 	guishifton:
  2962 000022DD C605[92220000]01    <1> 		mov byte [guiupper], 1
  2963 000022E4 E965FFFFFF          <1> 		jmp guistartin
  2964                              <1> 	guishiftoff:
  2965 000022E9 C605[92220000]00    <1> 		mov byte [guiupper], 0
  2966 000022F0 E959FFFFFF          <1> 		jmp guistartin
  2967                              <1> 	guientdown:
  2968 000022F5 C3                  <1> 		ret
  2969                              <1> 	guiscanfound:
  2970 000022F6 81C701000000        <1> 		add edi, 1
  2971 000022FC 803D[92220000]01    <1> 		cmp byte [guiupper], 1
  2972 00002303 7306                <1> 		jae uppercasegui
  2973 00002305 81EF01000000        <1> 		sub edi, 1
  2974                              <1> uppercasegui:
  2975 0000230B 8A07                <1> 		mov al,[edi]
  2976 0000230D A2[790A0000]        <1> 		mov [lastkey], al
  2977 00002312 C3                  <1> 		ret
  2978                              <1> 		
  2979                              <1> 		
  2980                              <1> 	cursorgui:
  2981 00002313 803D[37390000]01    <1> 		cmp byte [mouseon], 1
  2982 0000231A 0F8429000000        <1> 		je near maincall2
  2983 00002320 803D[C4280000]00    <1> 		cmp byte [guion], 0
  2984 00002327 0F84C8FFFFFF        <1> 		je near guientdown
  2985                              <1> 	initmouse:
  2986 0000232D E85F060000          <1> 		call switchmousepos2
  2987 00002332 E89AFEFFFF          <1> 	  	call PS2SET
  2988 00002337 E8C3FEFFFF          <1> 		call ACTMOUS
  2989 0000233C C605[37390000]01    <1> 		mov byte [mouseon],1
  2990 00002343 E8DCFEFFFF          <1> 		call GETB 	;;Get the responce byte of the mouse (like: Hey i am active)
  2991                              <1> 				;;If the bytes are mixed up,
  2992                              <1> 				;;remove this line or add another of this line.
  2993                              <1> 		;call GETB
  2994 00002348 C3                  <1> 		ret
  2995                              <1> 	maincall2:
  2996 00002349 803D[37390000]01    <1> 		  cmp byte [mouseon], 1
  2997 00002350 75DB                <1> 		  jne initmouse
  2998 00002352 E8CDFEFFFF          <1> 		  call GETB
  2999 00002357 88C3                <1> 		  mov  bl, al
  3000 00002359 80E301              <1> 		  and  bl, 1
  3001 0000235C 881D[49220000]      <1> 		  mov  BYTE [LBUTTON], bl
  3002 00002362 88C3                <1> 		  mov  bl, al
  3003 00002364 80E302              <1> 		  and  bl, 2
  3004 00002367 D0EB                <1> 		  shr  bl, 1
  3005 00002369 881D[4A220000]      <1> 		  mov  BYTE [RBUTTON], bl
  3006 0000236F 88C3                <1> 		  mov  bl, al
  3007 00002371 80E304              <1> 		  and  bl, 4
  3008 00002374 C0EB02              <1> 		  shr  bl, 2
  3009 00002377 881D[4B220000]      <1> 		  mov  BYTE [MBUTTON], bl
  3010 0000237D E8A2FEFFFF          <1> 		  call GETB
  3011 00002382 A2[4C220000]        <1> 		  mov  BYTE [XCOORD], al
  3012 00002387 E898FEFFFF          <1> 		  call GETB
  3013 0000238C A2[4D220000]        <1> 		  mov  BYTE [YCOORD], al
  3014                              <1> 
  3015                              <1> 	showpixelcursor:
  3016 00002391 668B15[DE240000]    <1> 		mov dx, [mousecursorposition]
  3017 00002398 668B0D[E0240000]    <1> 		mov cx, [mousecursorposition + 2]
  3018 0000239F 668915[DA240000]    <1> 		mov [lastmouseposition], dx
  3019 000023A6 66890D[DC240000]    <1> 		mov [lastmouseposition + 2], cx
  3020 000023AD A0[4C220000]        <1> 		mov al, [XCOORD]
  3021 000023B2 3C80                <1> 		cmp al, 128
  3022 000023B4 730C                <1> 		jae subxcoord
  3023 000023B6 00C0                <1> 		add al, al
  3024 000023B8 B400                <1> 		mov ah, 0
  3025 000023BA 6601C2              <1> 		add dx, ax
  3026 000023BD E90B000000          <1> 		jmp subxcoorddn
  3027                              <1> 	subxcoord:
  3028 000023C2 00C0                <1> 		add al, al
  3029 000023C4 B300                <1> 		mov bl, 0
  3030 000023C6 28C3                <1> 		sub bl, al
  3031 000023C8 B700                <1> 		mov bh, 0
  3032 000023CA 6629DA              <1> 		sub dx, bx
  3033                              <1> 	subxcoorddn:
  3034 000023CD 8A1D[4D220000]      <1> 		mov bl, [YCOORD]
  3035 000023D3 B000                <1> 		mov al, 0
  3036 000023D5 28D8                <1> 		sub al, bl
  3037 000023D7 3C80                <1> 		cmp al, 128
  3038 000023D9 730A                <1> 		jae subycoord
  3039 000023DB B400                <1> 		mov ah, 0
  3040 000023DD 6601C1              <1> 		add cx, ax
  3041 000023E0 E909000000          <1> 		jmp subycoorddn
  3042                              <1> 	subycoord:
  3043 000023E5 B300                <1> 		mov bl, 0
  3044 000023E7 28C3                <1> 		sub bl, al
  3045 000023E9 B700                <1> 		mov bh, 0
  3046 000023EB 6629D9              <1> 		sub cx, bx
  3047                              <1> 	subycoorddn:
  3048 000023EE 6681FA204E          <1> 		cmp dx, 20000
  3049 000023F3 7604                <1> 		jbe nooriginx2
  3050 000023F5 66BA0000            <1> 		mov dx, 0
  3051                              <1> 	nooriginx2:
  3052 000023F9 6681F9204E          <1> 		cmp cx, 20000
  3053 000023FE 7604                <1> 		jbe nooriginy2
  3054 00002400 66B90000            <1> 		mov cx, 0
  3055                              <1> 	nooriginy2:
  3056 00002404 6681FA0000          <1> 		cmp dx, 0
  3057 00002409 7415                <1> 		je nofixxcolumn2
  3058 0000240B 663B15[E4360000]    <1> 		cmp dx, [resolutionx2]
  3059 00002412 720C                <1> 		jb nofixxcolumn2
  3060 00002414 668B15[E4360000]    <1> 		mov dx, [resolutionx2]
  3061 0000241B 6681EA0200          <1> 		sub dx, 2
  3062                              <1> 	nofixxcolumn2:
  3063 00002420 6681F90000          <1> 		cmp cx, 0
  3064 00002425 7415                <1> 		je nofixyrow2
  3065 00002427 663B0D[E0360000]    <1> 		cmp cx, [resolutiony]
  3066 0000242E 720C                <1> 		jb nofixyrow2
  3067 00002430 668B0D[E0360000]    <1> 		mov cx, [resolutiony]
  3068 00002437 6681E90100          <1> 		sub cx, 1
  3069                              <1> 	nofixyrow2:
  3070 0000243C 668915[DE240000]    <1> 		mov [mousecursorposition], dx
  3071 00002443 66890D[E0240000]    <1> 		mov [mousecursorposition + 2], cx
  3072 0000244A E8D9040000          <1> 		call switchmousepos ;;use dragging code to ensure proper icon drag
  3073 0000244F 803D[49220000]01    <1> 		cmp byte [LBUTTON], 1
  3074 00002456 0F84B2050000        <1> 		je near clickicon
  3075 0000245C 803D[4A220000]01    <1> 		cmp byte [RBUTTON], 1
  3076 00002463 0F84A5050000        <1> 		je near clickicon
  3077 00002469 A0[FB290000]        <1> 		mov al, [pbutton]
  3078 0000246E C705[FE290000]0000- <1> 		mov dword [dragging], 0
  3079 00002476 0000                <1>
  3080 00002478 3C00                <1> 		cmp al, 0
  3081 0000247A 740F                <1> 		je nopreviousbutton
  3082 0000247C E844040000          <1> 		call clearmousecursor
  3083 00002481 E8BC0A0000          <1> 		call reloadallgraphics
  3084 00002486 E806050000          <1> 		call switchmousepos2
  3085                              <1> 	nopreviousbutton:
  3086 0000248B B000                <1> 		mov al, 0
  3087 0000248D A2[FB290000]        <1> 		mov [pbutton], al
  3088 00002492 A0[49220000]        <1> 		mov al, [LBUTTON]
  3089 00002497 A2[FC290000]        <1> 		mov [pLBUTTON], al
  3090 0000249C A0[4A220000]        <1> 		mov al, [RBUTTON]
  3091 000024A1 A2[FD290000]        <1> 		mov [pRBUTTON], al
  3092 000024A6 B900000000          <1> 		mov ecx, 0
  3093 000024AB BA00000000          <1> 		mov edx, 0
  3094 000024B0 668B15[DE240000]    <1> 		mov dx, [mousecursorposition]
  3095 000024B7 668B0D[E0240000]    <1> 		mov cx, [mousecursorposition + 2]
  3096 000024BE 66BB9CE7            <1> 		mov bx, 1110011110011100b
  3097 000024C2 B400                <1> 		mov ah, 0
  3098 000024C4 B080                <1> 		mov al, 128
  3099 000024C6 C605[C1280000]01    <1> 		mov byte [showcursorfonton], 1
  3100 000024CD E822120000          <1> 		call showfontvesa
  3101 000024D2 C605[C1280000]00    <1> 		mov byte [showcursorfonton], 0
  3102 000024D9 C3                  <1> 		ret
  3103                              <1> 
  3104 000024DA 84008400            <1> lastmouseposition dw 132,132
  3105 000024DE 84008400            <1> mousecursorposition dw 132,132	
  3106                              <1> 
  3107                              <1> termmouse:
  3108 000024E2 C3                  <1> 	ret	;;lets try this later
  3109 000024E3 BE[97560000]        <1> 		mov esi, videobuf2
  3110 000024E8 BA00000000          <1> 		mov edx, 0
  3111 000024ED 668B15[DA240000]    <1> 		mov dx, [lastmouseposition]
  3112 000024F4 668B0D[DC240000]    <1> 		mov cx, [lastmouseposition + 2]
  3113 000024FB 66A1[7E250000]      <1> 		mov ax, [cursorcache]
  3114 00002501 663D0000            <1> 		cmp ax, 0
  3115 00002505 7426                <1> 		je nocopycursorcache
  3116 00002507 66C1E104            <1> 		shl cx, 4
  3117 0000250B 66C1E203            <1> 		shl dx, 3
  3118 0000250F 01D6                <1> 		add esi, edx
  3119 00002511 66BA0000            <1> 		mov dx, 0
  3120 00002515 8A15[EA080000]      <1> 		mov dl, [charxy]
  3121 0000251B 6641                <1> 		inc cx
  3122                              <1> termmousecplp1:
  3123 0000251D 01D6                <1> 		add esi, edx
  3124 0000251F 6649                <1> 		dec cx
  3125 00002521 6681F90000          <1> 		cmp cx, 0
  3126 00002526 75F5                <1> 		jne termmousecplp1
  3127 00002528 29D6                <1> 		sub esi, edx
  3128 0000252A 668906              <1> 		mov [esi], ax
  3129                              <1> nocopycursorcache:
  3130 0000252D BE[97560000]        <1> 		mov esi, videobuf2
  3131 00002532 BA00000000          <1> 		mov edx, 0
  3132 00002537 668B15[DE240000]    <1> 		mov dx, [mousecursorposition]
  3133 0000253E 668B0D[E0240000]    <1> 		mov cx, [mousecursorposition + 2]
  3134 00002545 66C1E104            <1> 		shl cx, 4
  3135 00002549 66C1E203            <1> 		shl dx, 3
  3136 0000254D 01D6                <1> 		add esi, edx
  3137 0000254F 66BA0000            <1> 		mov dx, 0
  3138 00002553 8A15[EA080000]      <1> 		mov dl, [charxy]
  3139 00002559 6641                <1> 		inc cx
  3140                              <1> termmousecplp2:
  3141 0000255B 01D6                <1> 		add esi, edx
  3142 0000255D 6649                <1> 		dec cx
  3143 0000255F 6681F90000          <1> 		cmp cx, 0
  3144 00002564 75F5                <1> 		jne termmousecplp2
  3145 00002566 29D6                <1> 		sub esi, edx
  3146 00002568 668B06              <1> 		mov ax, [esi]
  3147 0000256B 66A3[7E250000]      <1> 		mov [cursorcache], ax
  3148 00002571 B080                <1> 		mov al, 128
  3149 00002573 B407                <1> 		mov ah, 7
  3150 00002575 668906              <1> 		mov [esi], ax
  3151 00002578 E81FE6FFFF          <1> 		call termcopy
  3152 0000257D C3                  <1> 		ret
  3153 0000257E 0000                <1> cursorcache db 0,0
  3154                              <1> 	
  3155                              <1> scancode:
  3156 00002580 0000                <1> 	db 0,0		;,0h
  3157 00002582 0000                <1> 	db 0,0		;,1h
  3158 00002584 3121                <1> 	db '1','!'	;,2h
  3159 00002586 3240                <1> 	db '2','@'	;,3h
  3160 00002588 3323                <1> 	db '3','#'	;,4h
  3161 0000258A 3424                <1> 	db '4','$'	;,5h
  3162 0000258C 3525                <1> 	db '5','%'	;,6h
  3163 0000258E 365E                <1> 	db '6','^'	;,7h
  3164 00002590 3726                <1> 	db '7','&'	;,8h
  3165 00002592 382A                <1> 	db '8','*'	;,9h
  3166 00002594 3928                <1> 	db '9','('	;,0Ah
  3167 00002596 3029                <1> 	db '0',')'	;,0Bh
  3168 00002598 2D5F                <1> 	db '-','_'	;,0Ch
  3169 0000259A 3D2B                <1> 	db '=','+'	;,0Dh
  3170 0000259C 0808                <1> 	db 8,8		;,0Eh
  3171 0000259E 0000                <1> 	db 0,0		;,0Fh
  3172 000025A0 7151                <1> 	db 'q','Q'	;,10h
  3173 000025A2 7757                <1> 	db 'w','W'	;,11h
  3174 000025A4 6545                <1> 	db 'e','E'	;,12h
  3175 000025A6 7252                <1> 	db 'r','R'	;,13h
  3176 000025A8 7454                <1> 	db 't','T'	;,14h
  3177 000025AA 7959                <1> 	db 'y','Y'	;,15h
  3178 000025AC 7555                <1> 	db 'u','U'	;,16h
  3179 000025AE 6949                <1> 	db 'i','I'	;,17h
  3180 000025B0 6F4F                <1> 	db 'o','O'	;,18h
  3181 000025B2 7050                <1> 	db 'p','P'	;,19h
  3182 000025B4 5B7B                <1> 	db '[','{'	;,1Ah
  3183 000025B6 5D7D                <1> 	db ']','}'	;,1Bh
  3184 000025B8 0000                <1> 	db 0,0		;,1Ch
  3185 000025BA 0000                <1> 	db 0,0		;,1Dh
  3186 000025BC 6141                <1> 	db 'a','A'	;,1Eh
  3187 000025BE 7353                <1> 	db 's','S'	;,1Fh
  3188 000025C0 6444                <1> 	db 'd','D'	;,20h
  3189 000025C2 6646                <1> 	db 'f','F'	;,21h
  3190 000025C4 6747                <1> 	db 'g','G'	;,22h
  3191 000025C6 6848                <1> 	db 'h','H'	;,23h
  3192 000025C8 6A4A                <1> 	db 'j','J'	;,24h
  3193 000025CA 6B4B                <1> 	db 'k','K'	;,25h
  3194 000025CC 6C4C                <1> 	db 'l','L'	;,26h
  3195 000025CE 3B3A                <1> 	db ';',':'	;,27h
  3196 000025D0 2722                <1> 	db 27h,22h	;,28h
  3197 000025D2 607E                <1> 	db '`','~'	;,29h
  3198 000025D4 0000                <1> 	db 0,0		;,2Ah
  3199 000025D6 5C7C                <1> 	db '\','|'	;,2Bh
  3200 000025D8 7A5A                <1> 	db 'z','Z'	;,2Ch
  3201 000025DA 7858                <1> 	db 'x','X'	;,2Dh
  3202 000025DC 6343                <1> 	db 'c','C'	;,2Eh
  3203 000025DE 7656                <1> 	db 'v','V'	;,2Fh
  3204 000025E0 6242                <1> 	db 'b','B'	;,30h
  3205 000025E2 6E4E                <1> 	db 'n','N'	;,31h
  3206 000025E4 6D4D                <1> 	db 'm','M'	;,32h
  3207 000025E6 2C3C                <1> 	db ',','<'	;,33h
  3208 000025E8 2E3E                <1> 	db '.','>'	;,34h
  3209 000025EA 2F3F                <1> 	db '/','?'	;,35h
  3210 000025EC 0000                <1> 	db 0,0		;,36h
  3211 000025EE 0000                <1> 	db 0,0		;,37h
  3212 000025F0 0000                <1> 	db 0,0		;,38h
  3213 000025F2 2020                <1> 	db ' ',' '	;,39h
  3214                              <1> noscan:
  3215                                      %include 'source/gui.asm'
  3216                              <1> guiclear:
  3217 000025F4 8B3D[476C0000]      <1> 	mov edi, [physbaseptr]
  3218 000025FA 668B15[E2360000]    <1> 	mov dx, [resolutionx]
  3219 00002601 668B0D[E0360000]    <1> 	mov cx, [resolutiony]
  3220 00002608 66A1[31260000]      <1> 	mov ax, [background]
  3221                              <1> guiclearloop:
  3222 0000260E 668907              <1> 	mov [edi], ax
  3223 00002611 81C702000000        <1> 	add edi, 2
  3224 00002617 664A                <1> 	dec dx
  3225 00002619 6681FA0000          <1> 	cmp dx, 0
  3226 0000261E 77EE                <1> 	ja guiclearloop
  3227 00002620 6649                <1> 	dec cx
  3228 00002622 668B15[E2360000]    <1> 	mov dx, [resolutionx]
  3229 00002629 6681F90000          <1> 	cmp cx, 0
  3230 0000262E 77DE                <1> 	ja guiclearloop
  3231 00002630 C3                  <1> 	ret
  3232                              <1> 
  3233 00002631 CF7B                <1> background dw 0111101111001111b
  3234                              <1> 
  3235                              <1> gui:	;Let's see what I can do, I am going to try to make this as freestanding as possible
  3236 00002633 E86AECFFFF          <1> 	call indexfiles
  3237 00002638 B800000000          <1> 	mov eax, 0
  3238 0000263D BB00000000          <1> 	mov ebx, 0
  3239 00002642 B900000000          <1> 	mov ecx, 0
  3240 00002647 BA00000000          <1> 	mov edx, 0
  3241 0000264C 8B3D[476C0000]      <1> 	mov edi, [physbaseptr]
  3242 00002652 668B15[E2360000]    <1> 	mov dx, [resolutionx]
  3243 00002659 668B0D[E0360000]    <1> 	mov cx, [resolutiony]
  3244 00002660 668B1D[31260000]    <1> 	mov bx, [background]
  3245                              <1> guiclearloop2:
  3246 00002667 66891F              <1> 	mov [edi], bx
  3247 0000266A 81C702000000        <1> 	add edi, 2
  3248 00002670 664A                <1> 	dec dx
  3249 00002672 6681FA0000          <1> 	cmp dx, 0
  3250 00002677 0F85EAFFFFFF        <1> 	jne near guiclearloop2
  3251 0000267D 6649                <1> 	dec cx
  3252 0000267F 668B15[E2360000]    <1> 	mov dx, [resolutionx]
  3253 00002686 6681F90000          <1> 	cmp cx, 0
  3254 0000268B 0F85D6FFFFFF        <1> 	jne near guiclearloop2
  3255 00002691 C605[C4280000]01    <1> 	mov byte [guion], 1
  3256 00002698 C605[C3280000]00    <1> 	mov byte [mouseselecton], 0
  3257 0000269F B800000000          <1> 	mov eax, 0
  3258 000026A4 BB00000000          <1> 	mov ebx, 0
  3259 000026A9 B900000000          <1> 	mov ecx, 0
  3260 000026AE BA00000000          <1> 	mov edx, 0
  3261                              <1> 	
  3262 000026B3 BE[4C390000]        <1> 	mov esi, pacmsg
  3263 000026B8 66B80000            <1> 	mov ax, 0
  3264 000026BC BB00000000          <1> 	mov ebx, 0
  3265 000026C1 66B90200            <1> 	mov cx, 2
  3266 000026C5 66BA0400            <1> 	mov dx, 4
  3267 000026C9 E8BA0B0000          <1> 	call showstring
  3268                              <1> 	
  3269 000026CE BE[623A0000]        <1> 	mov esi, interneticon
  3270 000026D3 66B80000            <1> 	mov ax, 0
  3271 000026D7 BB[C1390000]        <1> 	mov ebx, noie
  3272 000026DC 66B91800            <1> 	mov cx, 24
  3273 000026E0 66BA0400            <1> 	mov dx, 4
  3274 000026E4 E81E0F0000          <1> 	call showicon
  3275                              <1> 	
  3276 000026E9 BE[E43A0000]        <1> 	mov esi, wordicon
  3277 000026EE 66B80000            <1> 	mov ax, 0
  3278 000026F2 BB00000000          <1> 	mov ebx, 0
  3279 000026F7 66B91800            <1> 	mov cx, 24
  3280 000026FB 66BA3000            <1> 	mov dx, 48
  3281 000026FF E8030F0000          <1> 	call showicon
  3282                              <1> 	
  3283 00002704 BE[663B0000]        <1> 	mov esi, pacmanpellet
  3284 00002709 66B80000            <1> 	mov ax, 0
  3285 0000270D BB00000000          <1> 	mov ebx, 0
  3286 00002712 66B94000            <1> 	mov cx, 64
  3287 00002716 66BA0400            <1> 	mov dx, 4
  3288 0000271A E8E80E0000          <1> 	call showicon
  3289                              <1> 	
  3290 0000271F BE[6A3C0000]        <1> 	mov esi, pacman
  3291 00002724 66B80000            <1> 	mov ax, 0
  3292 00002728 BB[A6390000]        <1> 	mov ebx, pacmannomnom
  3293 0000272D 66B94000            <1> 	mov cx, 64
  3294 00002731 66BA3000            <1> 	mov dx, 48
  3295 00002735 E8CD0E0000          <1> 	call showicon
  3296                              <1> 	
  3297 0000273A BE[E83B0000]        <1> 	mov esi, ghostie
  3298 0000273F 66B80000            <1> 	mov ax, 0
  3299 00002743 BB[8B390000]        <1> 	mov ebx, boo
  3300 00002748 66B96C00            <1> 	mov cx, 108
  3301 0000274C 66BA0400            <1> 	mov dx, 4
  3302 00002750 E8B20E0000          <1> 	call showicon
  3303                              <1> 
  3304 00002755 BE[38390000]        <1> 	mov esi, start
  3305 0000275A 668B0D[E0360000]    <1> 	mov cx, [resolutiony]
  3306 00002761 6681E91000          <1> 	sub cx, 16
  3307 00002766 66BA0200            <1> 	mov dx, 2
  3308 0000276A B400                <1> 	mov ah, 0
  3309 0000276C B010                <1> 	mov al, 00010000b
  3310 0000276E BB[0F3A0000]        <1> 	mov ebx, winblows
  3311 00002773 E8100B0000          <1> 	call showstring
  3312                              <1> 	
  3313 00002778 E896FBFFFF          <1> 	call cursorgui
  3314                              <1> guistart:
  3315 0000277D E8CCFAFFFF          <1> 	call guistartin
  3316 00002782 C605[BD280000]00    <1> 	mov byte [copygui], 0
  3317 00002789 EBF2                <1> 	jmp guistart
  3318                              <1> 	
  3319                              <1> guicopy:	;;for double buffering
  3320 0000278B C605[BD280000]01    <1> 	mov byte [copygui], 1
  3321 00002792 8B3D[4B6C0000]      <1> 	mov edi, [offscreenmemoffset]
  3322 00002798 BA00000000          <1> 	mov edx, 0
  3323 0000279D B900000000          <1> 	mov ecx, 0
  3324 000027A2 668B15[DE240000]    <1> 	mov dx, [mousecursorposition]
  3325 000027A9 668B0D[E0240000]    <1> 	mov cx, [mousecursorposition + 2]
  3326 000027B0 01D7                <1> 	add edi, edx
  3327 000027B2 668B15[E4360000]    <1> 	mov dx, [resolutionx2]
  3328 000027B9 6641                <1> 	inc cx
  3329                              <1> guicp2:
  3330 000027BB 01D7                <1> 	add edi, edx
  3331 000027BD 6649                <1> 	dec cx
  3332 000027BF 6681F90000          <1> 	cmp cx, 0
  3333 000027C4 75F5                <1> 	jne guicp2
  3334 000027C6 29D7                <1> 	sub edi, edx
  3335 000027C8 893D[90280000]      <1> 	mov [cursorloc], edi
  3336 000027CE BB[92490000]        <1> 	mov ebx, cursorbmp
  3337 000027D3 668B0D[E0360000]    <1> 	mov cx, [resolutiony]
  3338 000027DA C1C110              <1> 	rol ecx, 16
  3339 000027DD 668B0D[E2360000]    <1> 	mov cx, [resolutionx]
  3340 000027E4 8B35[476C0000]      <1> 	mov esi, [physbaseptr]
  3341 000027EA 8B3D[4B6C0000]      <1> 	mov edi, [offscreenmemoffset]
  3342                              <1> guicp1:
  3343 000027F0 668B06              <1> 	mov ax, [esi]
  3344 000027F3 668907              <1> 	mov [edi], ax
  3345 000027F6 81C602000000        <1> 	add esi, 2
  3346 000027FC 81C702000000        <1> 	add edi, 2
  3347 00002802 3B3D[90280000]      <1> 	cmp edi, [cursorloc]
  3348 00002808 7427                <1> 	je copycursor
  3349                              <1> dncopycursor:
  3350 0000280A 6649                <1> 	dec cx
  3351 0000280C 6681F90000          <1> 	cmp cx, 0
  3352 00002811 75DD                <1> 	jne guicp1
  3353 00002813 668B0D[E2360000]    <1> 	mov cx, [resolutionx]
  3354 0000281A C1C110              <1> 	rol ecx, 16
  3355 0000281D 6649                <1> 	dec cx
  3356 0000281F 6681F90000          <1> 	cmp cx, 0
  3357 00002824 C1C110              <1> 	rol ecx, 16
  3358 00002827 75C7                <1> 	jne guicp1
  3359 00002829 C605[BD280000]00    <1> 	mov byte [copygui], 0
  3360 00002830 C3                  <1> 	ret
  3361                              <1> copycursor:
  3362 00002831 81FB[124A0000]      <1> 	cmp ebx, cursorbmpend
  3363 00002837 73D1                <1> 	jae dncopycursor
  3364 00002839 668B15[E4360000]    <1> 	mov dx, [resolutionx2]
  3365 00002840 01D7                <1> 	add edi, edx
  3366 00002842 893D[90280000]      <1> 	mov [cursorloc], edi
  3367 00002848 29D7                <1> 	sub edi, edx
  3368 0000284A 4B                  <1> 	dec ebx
  3369 0000284B 81EF02000000        <1> 	sub edi, 2
  3370 00002851 81EE02000000        <1> 	sub esi, 2
  3371 00002857 66BA0900            <1> 	mov dx, 9
  3372                              <1> curscplp:
  3373 0000285B 43                  <1> 	inc ebx
  3374 0000285C 81C602000000        <1> 	add esi, 2
  3375 00002862 81C702000000        <1> 	add edi, 2
  3376 00002868 668B06              <1> 	mov ax, [esi]
  3377 0000286B 668907              <1> 	mov [edi], ax
  3378 0000286E 8A03                <1> 	mov al, [ebx]
  3379 00002870 3C00                <1> 	cmp al, 0
  3380 00002872 7405                <1> 	je curscplp2
  3381 00002874 66C7079CE7          <1> 	mov word [edi], 1110011110011100b
  3382                              <1> curscplp2:
  3383 00002879 6649                <1> 	dec cx
  3384 0000287B 6681F90000          <1> 	cmp cx, 0
  3385 00002880 7488                <1> 	je dncopycursor
  3386 00002882 664A                <1> 	dec dx
  3387 00002884 6681FA0000          <1> 	cmp dx, 0
  3388 00002889 75D0                <1> 	jne curscplp
  3389 0000288B E97AFFFFFF          <1> 	jmp dncopycursor
  3390                              <1> 	
  3391                              <1> 	
  3392 00002890 00000000            <1> cursorloc: dd 0
  3393                              <1> 		
  3394                              <1> nextimage:	
  3395 00002894 E85BFDFFFF          <1> 	call guiclear
  3396 00002899 8B35[2F390000]      <1> 	mov esi, [bmpend]
  3397 0000289F B800000000          <1> 	mov eax, 0
  3398 000028A4 BB00000000          <1> 	mov ebx, 0
  3399 000028A9 B900000000          <1> 	mov ecx, 0
  3400 000028AE BA00000000          <1> 	mov edx, 0
  3401 000028B3 E8DB0F0000          <1> 	call showbmp
  3402 000028B8 E991F9FFFF          <1> 	jmp guistartin
  3403                              <1> 		
  3404 000028BD 00                  <1> copygui db 0
  3405 000028BE 00                  <1> graphicsset db 0
  3406 000028BF 0000                <1> graphicspos db 0,0
  3407 000028C1 00                  <1> showcursorfonton db 0
  3408 000028C2 00                  <1> savefonton db 0
  3409 000028C3 00                  <1> mouseselecton db 0
  3410 000028C4 00                  <1> guion db 0
  3411                              <1> 
  3412                              <1> 		
  3413                              <1> clearmousecursor:
  3414 000028C5 BE[31260000]        <1> 		mov esi, background
  3415 000028CA 8B3D[476C0000]      <1> 		mov edi, [physbaseptr]
  3416 000028D0 BA00000000          <1> 		mov edx, 0
  3417 000028D5 B900000000          <1> 		mov ecx, 0
  3418 000028DA 668B15[DA240000]    <1> 		mov dx, [lastmouseposition]
  3419 000028E1 668B0D[DC240000]    <1> 		mov cx, [lastmouseposition + 2]
  3420 000028E8 01D7                <1> 		add edi, edx
  3421 000028EA BA00000000          <1> 		mov edx, 0
  3422 000028EF 668B15[E4360000]    <1> 		mov dx, [resolutionx2]
  3423 000028F6 6681F90000          <1> 		cmp cx, 0
  3424 000028FB 740B                <1> 		je noyclr
  3425 000028FD 01D7                <1> yclr:	add edi, edx
  3426 000028FF 6649                <1> 		dec cx
  3427 00002901 6681F90000          <1> 		cmp cx, 0
  3428 00002906 75F5                <1> 		jne yclr
  3429 00002908 668B06              <1> noyclr:	mov ax, [esi]
  3430 0000290B C1C010              <1> 		rol eax, 16
  3431 0000290E 668B06              <1> 		mov ax, [esi]
  3432 00002911 8907                <1> 		mov [edi], eax
  3433 00002913 894704              <1> 		mov [edi + 4], eax
  3434 00002916 894708              <1> 		mov [edi + 8], eax
  3435 00002919 89470C              <1> 		mov [edi + 12], eax
  3436 0000291C 01D7                <1> 		add edi, edx
  3437 0000291E 6641                <1> 		inc cx
  3438 00002920 6681F91000          <1> 		cmp cx, 16
  3439 00002925 72E1                <1> 		jb noyclr
  3440 00002927 C3                  <1> 		ret
  3441                              <1> 
  3442                              <1> switchmousepos:		;;switch were the mouse is located
  3443 00002928 BE[124C0000]        <1> 		mov esi, mousecolorbuf
  3444 0000292D 8B3D[476C0000]      <1> 		mov edi, [physbaseptr]
  3445 00002933 BA00000000          <1> 		mov edx, 0
  3446 00002938 B900000000          <1> 		mov ecx, 0
  3447 0000293D 668B15[DA240000]    <1> 		mov dx, [lastmouseposition]
  3448 00002944 668B0D[DC240000]    <1> 		mov cx, [lastmouseposition + 2]
  3449 0000294B 01D7                <1> 		add edi, edx
  3450 0000294D BA00000000          <1> 		mov edx, 0
  3451 00002952 668B15[E4360000]    <1> 		mov dx, [resolutionx2]
  3452 00002959 6681F90000          <1> 		cmp cx, 0
  3453 0000295E 740B                <1> 		je noswmsy
  3454 00002960 01D7                <1> swmsy:		add edi, edx
  3455 00002962 6649                <1> 		dec cx
  3456 00002964 6681F90000          <1> 		cmp cx, 0
  3457 00002969 75F5                <1> 		jne swmsy
  3458 0000296B 8B06                <1> noswmsy:	mov eax, [esi]
  3459 0000296D 8B5E04              <1> 		mov ebx, [esi + 4]
  3460 00002970 8907                <1> 		mov [edi], eax
  3461 00002972 895F04              <1> 		mov [edi + 4], ebx
  3462 00002975 8B4608              <1> 		mov eax, [esi + 8]
  3463 00002978 8B5E0C              <1> 		mov ebx, [esi + 12]
  3464 0000297B 894708              <1> 		mov [edi + 8], eax
  3465 0000297E 895F0C              <1> 		mov [edi + 12], ebx
  3466 00002981 01D7                <1> 		add edi, edx
  3467 00002983 81C610000000        <1> 		add esi, 16
  3468 00002989 81FE[124D0000]      <1> 		cmp esi, mcolorend
  3469 0000298F 72DA                <1> 		jb noswmsy
  3470                              <1> 		
  3471                              <1> switchmousepos2:
  3472 00002991 BE[124C0000]        <1> 		mov esi, mousecolorbuf
  3473 00002996 8B3D[476C0000]      <1> 		mov edi, [physbaseptr]
  3474 0000299C BA00000000          <1> 		mov edx, 0
  3475 000029A1 B900000000          <1> 		mov ecx, 0
  3476 000029A6 668B15[DE240000]    <1> 		mov dx, [mousecursorposition]
  3477 000029AD 668B0D[E0240000]    <1> 		mov cx, [mousecursorposition + 2]
  3478 000029B4 01D7                <1> 		add edi, edx
  3479 000029B6 BA00000000          <1> 		mov edx, 0
  3480 000029BB 668B15[E4360000]    <1> 		mov dx, [resolutionx2]
  3481 000029C2 6681F90000          <1> 		cmp cx, 0
  3482 000029C7 740B                <1> 		je noswmsy2
  3483 000029C9 01D7                <1> swmsy2:		add edi, edx
  3484 000029CB 6649                <1> 		dec cx
  3485 000029CD 6681F90000          <1> 		cmp cx, 0
  3486 000029D2 75F5                <1> 		jne swmsy2
  3487 000029D4 8B07                <1> noswmsy2:	mov eax, [edi]
  3488 000029D6 8B5F04              <1> 		mov ebx, [edi + 4]
  3489 000029D9 8906                <1> 		mov [esi], eax
  3490 000029DB 895E04              <1> 		mov [esi + 4], ebx
  3491 000029DE 8B4708              <1> 		mov eax, [edi + 8]
  3492 000029E1 8B5F0C              <1> 		mov ebx, [edi + 12]
  3493 000029E4 894608              <1> 		mov [esi + 8], eax
  3494 000029E7 895E0C              <1> 		mov [esi + 12], ebx
  3495 000029EA 01D7                <1> 		add edi, edx
  3496 000029EC 81C610000000        <1> 		add esi, 16
  3497 000029F2 81FE[124D0000]      <1> 		cmp esi, mcolorend
  3498 000029F8 72DA                <1> 		jb noswmsy2
  3499 000029FA C3                  <1> 		ret
  3500                              <1> 
  3501 000029FB 00                  <1> pbutton db 0
  3502 000029FC 00                  <1> pLBUTTON db 0
  3503 000029FD 00                  <1> pRBUTTON db 0
  3504 000029FE 00000000            <1> dragging dw 0,0
  3505 00002A02 0000000000000000    <1> lastpos dw 0,0,0,0
  3506 00002A0A 00000000            <1> colorbuf dw 0,0
  3507                              <1> 	
  3508                              <1> 	clickicon:
  3509 00002A0E B001                <1> 		mov al, 1
  3510 00002A10 A2[FB290000]        <1> 		mov [pbutton], al
  3511 00002A15 A0[FC290000]        <1> 		mov al, [pLBUTTON]
  3512 00002A1A 2205[49220000]      <1> 		and al, [LBUTTON]
  3513 00002A20 8A25[FD290000]      <1> 		mov ah, [pRBUTTON]
  3514 00002A26 2225[4A220000]      <1> 		and ah, [RBUTTON]
  3515 00002A2C 08E0                <1> 		or al, ah
  3516 00002A2E 3C00                <1> 		cmp al, 0
  3517 00002A30 741B                <1> 		je nodragclick
  3518 00002A32 813D[FE290000]0100- <1> 		cmp dword [dragging], 1
  3519 00002A3A 0000                <1>
  3520 00002A3C 732D                <1> 		jae dragclick
  3521 00002A3E C705[FE290000]0100- <1> 		mov dword [dragging], 1
  3522 00002A46 0000                <1>
  3523 00002A48 E91E000000          <1> 		jmp dragclick
  3524                              <1> 	nodragclick:
  3525 00002A4D C705[FE290000]0000- <1> 		mov dword [dragging], 0
  3526 00002A55 0000                <1>
  3527 00002A57 A0[49220000]        <1> 		mov al, [LBUTTON]
  3528 00002A5C A2[FC290000]        <1> 		mov [pLBUTTON], al
  3529 00002A61 A0[4A220000]        <1> 		mov al, [RBUTTON]
  3530 00002A66 A2[FD290000]        <1> 		mov [pRBUTTON], al
  3531                              <1> 	dragclick:
  3532 00002A6B 66B80000            <1> 		mov ax, 0
  3533 00002A6F BE[124A0000]        <1> 		mov esi, graphicstable
  3534 00002A74 C705[86390000]0000- <1> 		mov dword [codepointer], 0
  3535 00002A7C 0000                <1>
  3536                              <1> 	clicon2:
  3537 00002A7E BA00000000          <1> 		mov edx, 0
  3538 00002A83 B900000000          <1> 		mov ecx, 0
  3539 00002A88 66813E0100          <1> 		cmp word [esi], 1
  3540 00002A8D 0F841B000000        <1> 		je near iconselect
  3541 00002A93 66813E0200          <1> 		cmp word [esi], 2
  3542 00002A98 0F8472010000        <1> 		je near textselected
  3543 00002A9E 66813E0300          <1> 		cmp word [esi], 3
  3544 00002AA3 0F84C7020000        <1> 		je near windowselect
  3545 00002AA9 E901040000          <1> 		jmp nexticonsel
  3546                              <1> 	iconselect:
  3547 00002AAE 668B5606            <1> 		mov dx, [esi + 6]
  3548 00002AB2 6689D0              <1> 		mov ax, dx
  3549 00002AB5 668B4E08            <1> 		mov cx, [esi + 8]
  3550 00002AB9 6689CB              <1> 		mov bx, cx
  3551 00002ABC 6681C32000          <1> 		add bx, 32
  3552 00002AC1 6601D0              <1> 		add ax, dx
  3553 00002AC4 813D[FE290000]0100- <1> 		cmp dword [dragging], 1
  3554 00002ACC 0000                <1>
  3555 00002ACE 746F                <1> 		je dragicon
  3556 00002AD0 813D[FE290000]0000- <1> 		cmp dword [dragging], 0
  3557 00002AD8 0000                <1>
  3558 00002ADA 7411                <1> 		je nodragiconcheck
  3559 00002ADC 3935[FE290000]      <1> 		cmp dword [dragging], esi
  3560 00002AE2 0F85C7030000        <1> 		jne near nexticonsel
  3561 00002AE8 E952000000          <1> 		jmp dragicon
  3562                              <1> 	nodragiconcheck:
  3563 00002AED 663905[DE240000]    <1> 		cmp [mousecursorposition], ax
  3564 00002AF4 0F82B5030000        <1> 		jb near nexticonsel
  3565 00002AFA 66054000            <1> 		add ax, 64
  3566 00002AFE 663905[DE240000]    <1> 		cmp [mousecursorposition], ax
  3567 00002B05 0F87A4030000        <1> 		ja near nexticonsel
  3568 00002B0B 6629D0              <1> 		sub ax, dx
  3569 00002B0E 66390D[E0240000]    <1> 		cmp [mousecursorposition + 2], cx
  3570 00002B15 0F8294030000        <1> 		jb near nexticonsel
  3571 00002B1B 66391D[E0240000]    <1> 		cmp [mousecursorposition + 2], bx
  3572 00002B22 0F8787030000        <1> 		ja near nexticonsel
  3573 00002B28 668B460A            <1> 		mov ax, [esi + 10]
  3574 00002B2C 66250100            <1> 		and ax, 1
  3575 00002B30 663D0100            <1> 		cmp ax, 1
  3576 00002B34 0F84B6000000        <1> 		je near unselecticon
  3577 00002B3A E98D000000          <1> 		jmp nodragicon
  3578                              <1> 	dragicon:
  3579 00002B3F 663905[DA240000]    <1> 		cmp [lastmouseposition], ax
  3580 00002B46 0F8263030000        <1> 		jb near nexticonsel
  3581 00002B4C 66054000            <1> 		add ax, 64
  3582 00002B50 663905[DA240000]    <1> 		cmp [lastmouseposition], ax
  3583 00002B57 0F8752030000        <1> 		ja near nexticonsel
  3584 00002B5D 6629D0              <1> 		sub ax, dx
  3585 00002B60 66390D[DC240000]    <1> 		cmp [lastmouseposition + 2], cx
  3586 00002B67 0F8242030000        <1> 		jb near nexticonsel
  3587 00002B6D 66391D[DC240000]    <1> 		cmp [lastmouseposition + 2], bx
  3588 00002B74 0F8735030000        <1> 		ja near nexticonsel
  3589 00002B7A 668B460A            <1> 		mov ax, [esi + 10]
  3590 00002B7E 2410                <1> 		and al, 00010000b
  3591 00002B80 3C10                <1> 		cmp al, 00010000b
  3592 00002B82 7448                <1> 		je nodragicon
  3593 00002B84 8935[FE290000]      <1> 		mov [dragging], esi
  3594 00002B8A 66D1E2              <1> 		shl dx, 1
  3595 00002B8D 662B15[DA240000]    <1> 		sub dx, [lastmouseposition]
  3596 00002B94 660315[DE240000]    <1> 		add dx, [mousecursorposition]
  3597 00002B9B 66D1EA              <1> 		shr dx, 1
  3598 00002B9E 66030D[E0240000]    <1> 		add cx, [mousecursorposition + 2]
  3599 00002BA5 662B0D[DC240000]    <1> 		sub cx, [lastmouseposition + 2]
  3600 00002BAC 663B15[E4360000]    <1> 		cmp dx, [resolutionx2]
  3601 00002BB3 7607                <1> 		jbe chkyresdrgicn
  3602 00002BB5 668B15[DE240000]    <1> 		mov dx, [mousecursorposition]
  3603                              <1> 	chkyresdrgicn:
  3604 00002BBC 663B0D[E0360000]    <1> 		cmp cx, [resolutiony]
  3605 00002BC3 7607                <1> 		jbe nodragicon
  3606 00002BC5 668B0D[E0240000]    <1> 		mov cx, [mousecursorposition + 2]
  3607                              <1> 	nodragicon:
  3608 00002BCC 66814E0A0100        <1> 		or word [esi + 10], 1
  3609 00002BD2 8B5E0C              <1> 		mov ebx, [esi + 12]
  3610 00002BD5 668B460A            <1> 		mov ax, [esi + 10]
  3611 00002BD9 8B7602              <1> 		mov esi, [esi + 2]
  3612 00002BDC C705[86390000]0000- <1> 		mov dword [codepointer], 0
  3613 00002BE4 0000                <1>
  3614 00002BE6 E81C0A0000          <1> 		call showicon
  3615 00002BEB E9D8020000          <1> 		jmp doneiconsel
  3616                              <1> 	unselecticon:
  3617 00002BF0 6681660AFEFF        <1> 		and word [esi + 10], 0xFFFE
  3618 00002BF6 8B5E0C              <1> 		mov ebx, [esi + 12]
  3619 00002BF9 668B460A            <1> 		mov ax, [esi + 10]
  3620 00002BFD 8B7602              <1> 		mov esi, [esi + 2]
  3621 00002C00 891D[86390000]      <1> 		mov [codepointer], ebx
  3622 00002C06 E8FC090000          <1> 		call showicon
  3623 00002C0B E9B8020000          <1> 		jmp doneiconsel
  3624                              <1> 	textselected:
  3625 00002C10 8B5E02              <1> 		mov ebx, [esi + 2]
  3626 00002C13 668B5606            <1> 		mov dx, [esi + 6]
  3627 00002C17 6689D0              <1> 		mov ax, dx
  3628 00002C1A 668B4E08            <1> 		mov cx, [esi + 8]
  3629                              <1> 	lengthtesttext:
  3630 00002C1E 803B00              <1> 		cmp byte [ebx], 0
  3631 00002C21 7407                <1> 		je donetesttextlength
  3632 00002C23 43                  <1> 		inc ebx
  3633 00002C24 66051000            <1> 		add ax, 16
  3634 00002C28 EBF4                <1> 		jmp lengthtesttext
  3635                              <1> 	donetesttextlength:
  3636 00002C2A 6689CB              <1> 		mov bx, cx
  3637 00002C2D 6681C30F00          <1> 		add bx, 15
  3638 00002C32 813D[FE290000]0100- <1> 		cmp dword [dragging], 1
  3639 00002C3A 0000                <1>
  3640 00002C3C 7468                <1> 		je dragtext
  3641 00002C3E 813D[FE290000]0000- <1> 		cmp dword [dragging], 0
  3642 00002C46 0000                <1>
  3643 00002C48 7411                <1> 		je nodragtextcheck
  3644 00002C4A 3935[FE290000]      <1> 		cmp dword [dragging], esi
  3645 00002C50 0F8559020000        <1> 		jne near nexticonsel
  3646 00002C56 E94B000000          <1> 		jmp dragtext
  3647                              <1> 	nodragtextcheck:
  3648 00002C5B 663915[DE240000]    <1> 		cmp [mousecursorposition], dx
  3649 00002C62 0F8247020000        <1> 		jb near nexticonsel
  3650 00002C68 663905[DE240000]    <1> 		cmp [mousecursorposition], ax
  3651 00002C6F 0F873A020000        <1> 		ja near nexticonsel
  3652 00002C75 66390D[E0240000]    <1> 		cmp [mousecursorposition + 2], cx
  3653 00002C7C 0F822D020000        <1> 		jb near nexticonsel
  3654 00002C82 66391D[E0240000]    <1> 		cmp [mousecursorposition + 2], bx
  3655 00002C89 0F8720020000        <1> 		ja near nexticonsel
  3656 00002C8F 668B460A            <1> 		mov ax, [esi + 10]
  3657 00002C93 66250100            <1> 		and ax, 1
  3658 00002C97 663D0100            <1> 		cmp ax, 1
  3659 00002C9B 0F84AB000000        <1> 		je near unselecttext
  3660 00002CA1 E986000000          <1> 		jmp nodragtext
  3661                              <1> 	dragtext:
  3662 00002CA6 663915[DA240000]    <1> 		cmp [lastmouseposition], dx
  3663 00002CAD 0F82FC010000        <1> 		jb near nexticonsel
  3664 00002CB3 663905[DA240000]    <1> 		cmp [lastmouseposition], ax
  3665 00002CBA 0F87EF010000        <1> 		ja near nexticonsel
  3666 00002CC0 66390D[DC240000]    <1> 		cmp [lastmouseposition + 2], cx
  3667 00002CC7 0F82E2010000        <1> 		jb near nexticonsel
  3668 00002CCD 66391D[DC240000]    <1> 		cmp [lastmouseposition + 2], bx
  3669 00002CD4 0F87D5010000        <1> 		ja near nexticonsel
  3670 00002CDA 668B460A            <1> 		mov ax, [esi + 10]
  3671 00002CDE 2410                <1> 		and al, 00010000b
  3672 00002CE0 663D1000            <1> 		cmp ax, 00010000b
  3673 00002CE4 0F8442000000        <1> 		je near nodragtext
  3674 00002CEA 8935[FE290000]      <1> 		mov [dragging], esi
  3675 00002CF0 662B15[DA240000]    <1> 		sub dx, [lastmouseposition]
  3676 00002CF7 660315[DE240000]    <1> 		add dx, [mousecursorposition]
  3677 00002CFE 66030D[E0240000]    <1> 		add cx, [mousecursorposition + 2]
  3678 00002D05 662B0D[DC240000]    <1> 		sub cx, [lastmouseposition + 2]
  3679 00002D0C 663B15[E4360000]    <1> 		cmp dx, [resolutionx2]
  3680 00002D13 7607                <1> 		jbe chkyresdrgtxt
  3681 00002D15 668B15[DE240000]    <1> 		mov dx, [mousecursorposition]
  3682                              <1> 	chkyresdrgtxt:
  3683 00002D1C 663B0D[E0360000]    <1> 		cmp cx, [resolutiony]
  3684 00002D23 7607                <1> 		jbe nodragtext
  3685 00002D25 668B0D[E0240000]    <1> 		mov cx, [mousecursorposition + 2]
  3686                              <1> 	nodragtext:
  3687 00002D2C 66814E0A0100        <1> 		or word [esi + 10], 1
  3688 00002D32 8B5E0C              <1> 		mov ebx, [esi + 12]
  3689 00002D35 891D[86390000]      <1> 		mov [codepointer], ebx
  3690 00002D3B 668B460A            <1> 		mov ax, [esi + 10]
  3691 00002D3F 8B7602              <1> 		mov esi, [esi + 2]
  3692 00002D42 E841050000          <1> 		call showstring
  3693 00002D47 E97C010000          <1> 		jmp doneiconsel
  3694                              <1> 	unselecttext:
  3695 00002D4C 6681660AFEFF        <1> 		and word [esi + 10], 0xFFFE
  3696 00002D52 8B5E0C              <1> 		mov ebx, [esi + 12]
  3697 00002D55 668B460A            <1> 		mov ax, [esi + 10]
  3698 00002D59 8B7602              <1> 		mov esi, [esi + 2]
  3699 00002D5C C705[86390000]0000- <1> 		mov dword [codepointer], 0
  3700 00002D64 0000                <1>
  3701 00002D66 E81D050000          <1> 		call showstring
  3702 00002D6B E958010000          <1> 		jmp doneiconsel
  3703                              <1> windowselect:
  3704 00002D70 8B7E02              <1> 		mov edi, [esi + 2]
  3705 00002D73 668B5606            <1> 		mov dx, [esi + 6]
  3706 00002D77 6689D0              <1> 		mov ax, dx
  3707 00002D7A 668B4E08            <1> 		mov cx, [esi + 8]
  3708 00002D7E 6689CB              <1> 		mov bx, cx
  3709 00002D81 6681C31000          <1> 		add bx, 16
  3710 00002D86 813D[FE290000]0100- <1> 		cmp dword [dragging], 1
  3711 00002D8E 0000                <1>
  3712 00002D90 746D                <1> 		je dragwin
  3713 00002D92 813D[FE290000]0000- <1> 		cmp dword [dragging], 0
  3714 00002D9A 0000                <1>
  3715 00002D9C 7411                <1> 		je nodragwincheck
  3716 00002D9E 3935[FE290000]      <1> 		cmp dword [dragging], esi
  3717 00002DA4 0F8505010000        <1> 		jne near nexticonsel
  3718 00002DAA E950000000          <1> 		jmp dragwin
  3719                              <1> 	nodragwincheck:
  3720 00002DAF 663905[DE240000]    <1> 		cmp [mousecursorposition], ax
  3721 00002DB6 0F82F3000000        <1> 		jb near nexticonsel
  3722 00002DBC 660307              <1> 		add ax, [edi]
  3723 00002DBF 660307              <1> 		add ax, [edi]
  3724 00002DC2 663905[DE240000]    <1> 		cmp [mousecursorposition], ax
  3725 00002DC9 0F87E0000000        <1> 		ja near nexticonsel
  3726 00002DCF 66390D[E0240000]    <1> 		cmp [mousecursorposition + 2], cx
  3727 00002DD6 0F82D3000000        <1> 		jb near nexticonsel
  3728 00002DDC 66391D[E0240000]    <1> 		cmp [mousecursorposition + 2], bx
  3729 00002DE3 0F87C6000000        <1> 		ja near nexticonsel
  3730 00002DE9 662D1400            <1> 		sub ax, 20
  3731 00002DED 663905[DE240000]    <1> 		cmp [mousecursorposition], ax
  3732 00002DF4 0F8795000000        <1> 		ja near killwin
  3733 00002DFA E97C000000          <1> 		jmp nodragwin
  3734                              <1> 	dragwin:
  3735 00002DFF 663905[DA240000]    <1> 		cmp [lastmouseposition], ax
  3736 00002E06 0F82A3000000        <1> 		jb near nexticonsel
  3737 00002E0C 660307              <1> 		add ax, [edi]
  3738 00002E0F 660307              <1> 		add ax, [edi]
  3739 00002E12 663905[DA240000]    <1> 		cmp [lastmouseposition], ax
  3740 00002E19 0F8790000000        <1> 		ja near nexticonsel
  3741 00002E1F 66390D[DC240000]    <1> 		cmp [lastmouseposition + 2], cx
  3742 00002E26 0F8283000000        <1> 		jb near nexticonsel
  3743 00002E2C 66391D[DC240000]    <1> 		cmp [lastmouseposition + 2], bx
  3744 00002E33 0F8776000000        <1> 		ja near nexticonsel
  3745 00002E39 8935[FE290000]      <1> 		mov [dragging], esi
  3746 00002E3F 662B15[DA240000]    <1> 		sub dx, [lastmouseposition]
  3747 00002E46 660315[DE240000]    <1> 		add dx, [mousecursorposition]
  3748 00002E4D 66030D[E0240000]    <1> 		add cx, [mousecursorposition + 2]
  3749 00002E54 662B0D[DC240000]    <1> 		sub cx, [lastmouseposition + 2]
  3750 00002E5B 663B15[E4360000]    <1> 		cmp dx, [resolutionx2]
  3751 00002E62 7607                <1> 		jbe chkyresdrgwin
  3752 00002E64 668B15[DE240000]    <1> 		mov dx, [mousecursorposition]
  3753                              <1> 	chkyresdrgwin:
  3754 00002E6B 663B0D[E0360000]    <1> 		cmp cx, [resolutiony]
  3755 00002E72 7607                <1> 		jbe nodragwin
  3756 00002E74 668B0D[E0240000]    <1> 		mov cx, [mousecursorposition + 2]
  3757                              <1> 	nodragwin:
  3758 00002E7B 8B5E0C              <1> 		mov ebx, [esi + 12]
  3759 00002E7E 668B460A            <1> 		mov ax, [esi + 10]
  3760 00002E82 8B7602              <1> 		mov esi, [esi + 2]
  3761 00002E85 E853040000          <1> 		call showwindow
  3762 00002E8A E939000000          <1> 		jmp doneiconsel
  3763                              <1> 	killwin:
  3764 00002E8F 66C7060000          <1> 		mov word [esi], 0
  3765 00002E94 C705[EA020000]0000- <1> 		mov dword [user2codepoint], 0
  3766 00002E9C 0000                <1>
  3767 00002E9E C605[F8080000]00    <1> 		mov byte [termguion], 0
  3768 00002EA5 E84AF7FFFF          <1> 		call guiclear
  3769 00002EAA E939000000          <1> 		jmp doneiconsel2
  3770                              <1> 	nexticonsel:
  3771 00002EAF 6681660AFEFF        <1> 		and word [esi + 10], 0xFFFE
  3772 00002EB5 81C610000000        <1> 		add esi, 16
  3773 00002EBB 81FE[124C0000]      <1> 		cmp esi, graphicstableend
  3774 00002EC1 7305                <1> 		jae doneiconsel
  3775 00002EC3 E9B6FBFFFF          <1> 		jmp clicon2
  3776                              <1> 	doneiconsel:
  3777 00002EC8 813D[FE290000]0100- <1> 		cmp dword [dragging], 1
  3778 00002ED0 0000                <1>
  3779 00002ED2 7314                <1> 		jae doneiconsel2
  3780 00002ED4 813D[86390000]0000- <1> 		cmp dword [codepointer], 0
  3781 00002EDC 0000                <1>
  3782 00002EDE 7408                <1> 		je doneiconsel2
  3783 00002EE0 8B1D[86390000]      <1> 		mov ebx, [codepointer]
  3784 00002EE6 FFE3                <1> 		jmp ebx 
  3785                              <1> 	doneiconsel2:
  3786 00002EE8 A0[49220000]        <1> 		mov al, [LBUTTON]
  3787 00002EED A2[FC290000]        <1> 		mov [pLBUTTON], al
  3788 00002EF2 A0[4A220000]        <1> 		mov al, [RBUTTON]
  3789 00002EF7 A2[FD290000]        <1> 		mov [pRBUTTON], al
  3790 00002EFC E8C4F9FFFF          <1> call clearmousecursor
  3791 00002F01 E83C000000          <1> call reloadallgraphics
  3792 00002F06 B900000000          <1> 		mov ecx, 0
  3793 00002F0B BA00000000          <1> 		mov edx, 0
  3794 00002F10 B400                <1> 		mov ah, 0
  3795 00002F12 B080                <1> 		mov al, 128
  3796 00002F14 668B15[DE240000]    <1> 		mov dx, [mousecursorposition]
  3797 00002F1B 668B0D[E0240000]    <1> 		mov cx, [mousecursorposition + 2]
  3798 00002F22 66BBE738            <1> 		mov bx, 0011100011100111b
  3799 00002F26 C605[C1280000]01    <1> 		mov byte [showcursorfonton], 1
  3800 00002F2D E8C2070000          <1> 		call showfontvesa
  3801 00002F32 C605[C1280000]00    <1> 		mov byte [showcursorfonton], 0
  3802 00002F39 C3                  <1> 		ret
  3803 00002F3A 00000000            <1> lastdrag dw 0,0
  3804 00002F3E 00000000            <1> grpctblpos dw 0,0
  3805                              <1> 
  3806                              <1> reloadallgraphics:
  3807 00002F42 BF[124A0000]        <1> 		mov edi, graphicstable
  3808                              <1> reloadgraphicsloop:
  3809 00002F47 8B7702              <1> 		mov esi, [edi + 2]
  3810 00002F4A 668B5706            <1> 		mov dx, [edi + 6]
  3811 00002F4E 668B4F08            <1> 		mov cx, [edi + 8]
  3812 00002F52 668B07              <1> 		mov ax, [edi]
  3813 00002F55 668B5F0A            <1> 		mov bx, [edi + 10]
  3814 00002F59 893D[3E2F0000]      <1> 		mov [grpctblpos], edi
  3815 00002F5F 3B3D[FE290000]      <1> 		cmp edi, [dragging]
  3816 00002F65 741E                <1> 		je loadedgraphic
  3817 00002F67 663D0100            <1> 		cmp ax, 1
  3818 00002F6B 0F8431000000        <1> 		je near icongraphic
  3819 00002F71 663D0200            <1> 		cmp ax, 2
  3820 00002F75 0F8437000000        <1> 		je near stringgraphic
  3821 00002F7B 663D0300            <1> 		cmp ax, 3
  3822 00002F7F 0F8416000000        <1> 		je near windowgraphic
  3823 00002F85 8B3D[3E2F0000]      <1> loadedgraphic:  mov edi, [grpctblpos]
  3824 00002F8B 81C710000000        <1> 		add edi, 16
  3825 00002F91 81FF[124C0000]      <1> 		cmp edi, graphicstableend
  3826 00002F97 7329                <1> 		jae donereloadgraphics
  3827 00002F99 EBAC                <1> 		jmp reloadgraphicsloop
  3828 00002F9B E890030000          <1> windowgraphic:	call showwindow2
  3829 00002FA0 EBE3                <1> 		jmp loadedgraphic
  3830 00002FA2 80E301              <1> icongraphic:	and bl, 1
  3831 00002FA5 881D[8A390000]      <1> 		mov [iconselected], bl
  3832 00002FAB E86A060000          <1> 		call showicon2
  3833 00002FB0 EBD3                <1> 		jmp loadedgraphic
  3834 00002FB2 80E301              <1> stringgraphic:  and bl, 1
  3835 00002FB5 881D[C3280000]      <1> 		mov [mouseselecton], bl
  3836 00002FBB E8DB020000          <1> 		call showstring2
  3837 00002FC0 EBC3                <1> 		jmp loadedgraphic
  3838                              <1> donereloadgraphics:
  3839 00002FC2 8B3D[FE290000]      <1> 		mov edi, [dragging]
  3840 00002FC8 81FF[124A0000]      <1> 		cmp edi, graphicstable
  3841 00002FCE 723B                <1> 		jb notcorrectdrag
  3842 00002FD0 668B07              <1> 		mov ax, [edi]
  3843 00002FD3 8B7702              <1> 		mov esi, [edi + 2]
  3844 00002FD6 668B5706            <1> 		mov dx, [edi + 6]
  3845 00002FDA 668B4F08            <1> 		mov cx, [edi + 8]
  3846 00002FDE 668B5F0A            <1> 		mov bx, [edi + 10]
  3847 00002FE2 663D0100            <1> 		cmp ax, 1
  3848 00002FE6 750F                <1> 		jne noticondragging
  3849 00002FE8 80E301              <1> 		and bl, 1
  3850 00002FEB 881D[8A390000]      <1> 		mov [iconselected], bl
  3851 00002FF1 E824060000          <1> 		call showicon2
  3852 00002FF6 C3                  <1> 		ret
  3853                              <1> 
  3854                              <1> 	noticondragging:
  3855 00002FF7 663D0200            <1> 		cmp ax, 2
  3856 00002FFB 750E                <1> 		jne notcorrectdrag
  3857 00002FFD 80E301              <1> 		and bl, 1
  3858 00003000 881D[C3280000]      <1> 		mov [mouseselecton], bl
  3859 00003006 E890020000          <1> 		call showstring2
  3860                              <1> 	notcorrectdrag:
  3861 0000300B C3                  <1> 		ret
  3862                              <1> 
  3863 0000300C 00<rept>            <1> grphbuf times 16 db 0
  3864                              <1> 	graphicsadd:
  3865 0000301C BF[124A0000]        <1> 		mov edi, graphicstable
  3866                              <1> 	shwgrph1:
  3867 00003021 397702              <1> 		cmp dword [edi + 2], esi
  3868 00003024 7414                <1> 		je showgraphicsreplace2
  3869 00003026 81C710000000        <1> 		add edi, 16
  3870 0000302C 81FF[124C0000]      <1> 		cmp edi, graphicstableend
  3871 00003032 0F8335020000        <1> 		jae near showgraphicsnew
  3872 00003038 EBE7                <1> 		jmp shwgrph1
  3873                              <1> 	showgraphicsreplace2:
  3874 0000303A 8935[0E300000]      <1> 		mov [grphbuf + 2], esi
  3875 00003040 668915[12300000]    <1> 		mov [grphbuf + 6], dx
  3876 00003047 66890D[14300000]    <1> 		mov [grphbuf + 8], cx
  3877 0000304E 891D[18300000]      <1> 		mov [grphbuf + 12], ebx
  3878 00003054 B700                <1> 		mov bh, 0
  3879 00003056 88E3                <1> 		mov bl, ah
  3880 00003058 B400                <1> 		mov ah, 0
  3881 0000305A 66A3[16300000]      <1> 		mov [grphbuf + 10], ax	
  3882 00003060 66891D[0C300000]    <1> 		mov [grphbuf], bx
  3883 00003067 66A1[0C300000]      <1> 		mov ax, [grphbuf]
  3884 0000306D 663D0100            <1> 		cmp ax, 1
  3885 00003071 0F8419000000        <1> 		je near replaceicon
  3886 00003077 663D0200            <1> 		cmp ax, 2
  3887 0000307B 0F8493000000        <1> 		je near replacestring
  3888 00003081 663D0300            <1> 		cmp ax, 3
  3889 00003085 0F840F010000        <1> 		je near replacewindow
  3890 0000308B E9BA010000          <1> 		jmp showgraphicsreplace
  3891                              <1> 	replaceicon:
  3892 00003090 893D[022A0000]      <1> 		mov [lastpos], edi
  3893 00003096 8935[062A0000]      <1> 		mov [lastpos + 4], esi
  3894 0000309C 8B7702              <1> 		mov esi, [edi + 2]
  3895 0000309F 668B5F0C            <1> 		mov bx, [edi + 12]
  3896 000030A3 668B5706            <1> 		mov dx, [edi + 6]
  3897 000030A7 668B4F08            <1> 		mov cx, [edi + 8]
  3898 000030AB 668B06              <1> 		mov ax, [esi]
  3899 000030AE 66A3[0A2A0000]      <1> 		mov [colorbuf], ax
  3900 000030B4 66A1[31260000]      <1> 		mov ax, [background]
  3901 000030BA 668906              <1> 		mov [esi], ax
  3902 000030BD 8B5F0C              <1> 		mov ebx, [edi + 12]
  3903 000030C0 668B470A            <1> 		mov ax, [edi + 10]
  3904 000030C4 2401                <1> 		and al, 1
  3905 000030C6 A2[8A390000]        <1> 		mov [iconselected], al
  3906 000030CB 668B470A            <1> 		mov ax, [edi + 10]
  3907 000030CF E846050000          <1> 		call showicon2
  3908 000030D4 8B3D[022A0000]      <1> 		mov edi, [lastpos]
  3909 000030DA 8B7702              <1> 		mov esi, [edi + 2]
  3910 000030DD 66A1[0A2A0000]      <1> 		mov ax, [colorbuf]
  3911 000030E3 668906              <1> 		mov [esi], ax
  3912 000030E6 8B35[062A0000]      <1> 		mov esi, [lastpos + 4]
  3913 000030EC 668B15[12300000]    <1> 		mov dx, [grphbuf + 6]
  3914 000030F3 668B0D[14300000]    <1> 		mov cx, [grphbuf + 8]
  3915 000030FA 668B1D[0C300000]    <1> 		mov bx, [grphbuf]
  3916 00003101 66A1[16300000]      <1> 		mov ax, [grphbuf + 10]
  3917 00003107 88DC                <1> 		mov ah, bl
  3918 00003109 8B1D[18300000]      <1> 		mov ebx, [grphbuf + 12]
  3919 0000310F E936010000          <1> 		jmp showgraphicsreplace
  3920                              <1> 	replacestring:
  3921 00003114 893D[022A0000]      <1> 		mov [lastpos], edi
  3922 0000311A 8935[062A0000]      <1> 		mov [lastpos + 4], esi
  3923 00003120 8B5F0C              <1> 		mov ebx, [edi + 12]
  3924 00003123 8B7702              <1> 		mov esi, [edi + 2]
  3925 00003126 668B5706            <1> 		mov dx, [edi + 6]
  3926 0000312A 668B4F08            <1> 		mov cx, [edi + 8]
  3927 0000312E 66A1[CB320000]      <1> 		mov ax, [colorfont2]
  3928 00003134 66A3[0A2A0000]      <1> 		mov [colorbuf], ax
  3929 0000313A 66A1[31260000]      <1> 		mov ax, [background]
  3930 00003140 66A3[CB320000]      <1> 		mov [colorfont2], ax		
  3931 00003146 8B5F0C              <1> 		mov ebx, [edi + 12]
  3932 00003149 668B470A            <1> 		mov ax, [edi + 10]
  3933 0000314D 2401                <1> 		and al, 1
  3934 0000314F A2[C3280000]        <1> 		mov [mouseselecton], al
  3935 00003154 668B470A            <1> 		mov ax, [edi + 10]
  3936 00003158 E83E010000          <1> 		call showstring2
  3937 0000315D 66A1[0A2A0000]      <1> 		mov ax, [colorbuf]
  3938 00003163 66A3[CB320000]      <1> 		mov [colorfont2], ax
  3939 00003169 8B3D[022A0000]      <1> 		mov edi, [lastpos]
  3940 0000316F 8B7702              <1> 		mov esi, [edi + 2]
  3941 00003172 668B15[12300000]    <1> 		mov dx, [grphbuf + 6]
  3942 00003179 668B0D[14300000]    <1> 		mov cx, [grphbuf + 8]
  3943 00003180 668B1D[0C300000]    <1> 		mov bx, [grphbuf]
  3944 00003187 66A1[16300000]      <1> 		mov ax, [grphbuf + 10]
  3945 0000318D 88DC                <1> 		mov ah, bl
  3946 0000318F 8B1D[18300000]      <1> 		mov ebx, [grphbuf + 12]
  3947 00003195 E9B0000000          <1> 		jmp showgraphicsreplace
  3948                              <1> 	replacewindow:
  3949 0000319A 893D[022A0000]      <1> 		mov [lastpos], edi
  3950 000031A0 8935[062A0000]      <1> 		mov [lastpos + 4], esi
  3951 000031A6 8B7702              <1> 		mov esi, [edi + 2]
  3952 000031A9 8B3D[D9320000]      <1> 		mov edi, [windowbufloc]
  3953 000031AF BA00000000          <1> 		mov edx, 0
  3954 000031B4 668B15[E4360000]    <1> 		mov dx, [resolutionx2]
  3955 000031BB C1E204              <1> 		shl edx, 4
  3956 000031BE 29D7                <1> 		sub edi, edx
  3957 000031C0 BA00000000          <1> 		mov edx, 0
  3958 000031C5 668B16              <1> 		mov dx, [esi]
  3959 000031C8 660316              <1> 		add dx, [esi]
  3960 000031CB 668B4E02            <1> 		mov cx, [esi + 2]
  3961 000031CF 6681C11000          <1> 		add cx, 16
  3962 000031D4 66A1[31260000]      <1> 		mov ax, [background]
  3963                              <1> 	clearwindow:
  3964 000031DA 668907              <1> 		mov [edi], ax
  3965 000031DD 81C702000000        <1> 		add edi, 2
  3966 000031E3 81EA02000000        <1> 		sub edx, 2
  3967 000031E9 81FA00000000        <1> 		cmp edx, 0
  3968 000031EF 75E9                <1> 		jne clearwindow
  3969 000031F1 6649                <1> 		dec cx
  3970 000031F3 668B15[E4360000]    <1> 		mov dx, [resolutionx2]
  3971 000031FA 662B16              <1> 		sub dx, [esi]
  3972 000031FD 662B16              <1> 		sub dx, [esi]
  3973 00003200 01D7                <1> 		add edi, edx
  3974 00003202 668B16              <1> 		mov dx, [esi]
  3975 00003205 660316              <1> 		add dx, [esi]
  3976 00003208 6681F90000          <1> 		cmp cx, 0
  3977 0000320D 75CB                <1> 		jne clearwindow
  3978 0000320F C605[F9080000]00    <1> 		mov byte [termcopyon], 0
  3979 00003216 8B3D[022A0000]      <1> 		mov edi, [lastpos]
  3980 0000321C 8B35[0E300000]      <1> 		mov esi, [grphbuf + 2]
  3981 00003222 668B15[12300000]    <1> 		mov dx, [grphbuf + 6]
  3982 00003229 668B0D[14300000]    <1> 		mov cx, [grphbuf + 8]
  3983 00003230 668B1D[0C300000]    <1> 		mov bx, [grphbuf]
  3984 00003237 66A1[16300000]      <1> 		mov ax, [grphbuf + 10]
  3985 0000323D 88DC                <1> 		mov ah, bl
  3986 0000323F 8B1D[18300000]      <1> 		mov ebx, [grphbuf + 12]
  3987 00003245 E900000000          <1> 		jmp showgraphicsreplace
  3988                              <1> 	showgraphicsreplace:
  3989 0000324A 897702              <1> 		mov [edi + 2], esi
  3990 0000324D 66895706            <1> 		mov [edi + 6], dx
  3991 00003251 66894F08            <1> 		mov [edi + 8], cx
  3992 00003255 895F0C              <1> 		mov [edi + 12], ebx
  3993 00003258 B700                <1> 		mov bh, 0
  3994 0000325A 88E3                <1> 		mov bl, ah
  3995 0000325C B400                <1> 		mov ah, 0
  3996 0000325E 6689470A            <1> 		mov [edi + 10], ax
  3997 00003262 66891F              <1> 		mov [edi], bx
  3998 00003265 8B5F0C              <1> 		mov ebx, [edi + 12]
  3999 00003268 668B470A            <1> 		mov ax, [edi + 10]
  4000 0000326C C3                  <1> 		ret
  4001                              <1> 	showgraphicsnew:
  4002 0000326D BF[124A0000]        <1> 		mov edi, graphicstable
  4003                              <1> 	shwgrph2:
  4004 00003272 66813F0000          <1> 		cmp word [edi], 0
  4005 00003277 74D1                <1> 		je showgraphicsreplace
  4006 00003279 81C710000000        <1> 		add edi, 16
  4007 0000327F 81FF[124C0000]      <1> 		cmp edi, graphicstableend
  4008 00003285 72EB                <1> 		jb shwgrph2
  4009                              <1> 	showgraphicsdone:
  4010 00003287 C3                  <1> 		ret
  4011                              <1> 
  4012                              <1> 	showstring:
  4013 00003288 A2[C3280000]        <1> 		mov [mouseselecton], al
  4014 0000328D 8025[C3280000]01    <1> 		and byte [mouseselecton], 1
  4015 00003294 B402                <1> 		mov ah, 2
  4016 00003296 E881FDFFFF          <1> 		call graphicsadd
  4017                              <1> 	showstring2:
  4018 0000329B B400                <1> 		mov ah, 0
  4019 0000329D 8A06                <1> 		mov al, [esi]
  4020 0000329F 3C00                <1> 		cmp al, 0
  4021 000032A1 7420                <1> 		je doneshowstring
  4022 000032A3 46                  <1> 		inc esi
  4023 000032A4 8935[33390000]      <1> 		mov [showstringesi], esi
  4024 000032AA 668B1D[CB320000]    <1> 		mov bx, [colorfont2]
  4025 000032B1 E83E040000          <1> 		call showfontvesa
  4026 000032B6 6681C20800          <1> 		add dx, 8
  4027 000032BB 8B35[33390000]      <1> 		mov esi, [showstringesi]
  4028 000032C1 EBD8                <1> 		jmp showstring2
  4029                              <1> 	doneshowstring:
  4030 000032C3 C605[C3280000]00    <1> 		mov byte [mouseselecton], 0
  4031 000032CA C3                  <1> 		ret
  4032                              <1> 
  4033 000032CB FFFF                <1> colorfont2 dw 0xFFFF
  4034 000032CD 0000                <1> winvcopystx dw 0
  4035 000032CF 0000                <1> winvcopysty dw 0
  4036 000032D1 0000                <1> winvcopydx dw 0
  4037 000032D3 0000                <1> winvcopycx dw 0
  4038 000032D5 FFFF0000            <1> windowcolor dw 0xFFFF,0x0
  4039 000032D9 00000000            <1> windowbufloc: dw 0,0
  4040                              <1> 
  4041                              <1> 	showwindow:	;;windowstuff in si, position in (dx, cx), nothing in ax, code in bx
  4042 000032DD C605[F8080000]01    <1> 		mov byte [termguion], 1
  4043 000032E4 6681C11000          <1> 		add cx, 16
  4044 000032E9 668915[CD320000]    <1> 		mov [winvcopystx], dx
  4045 000032F0 66890D[CF320000]    <1> 		mov [winvcopysty], cx
  4046 000032F7 668B16              <1> 		mov dx, [esi]
  4047 000032FA 668B4E02            <1> 		mov cx, [esi + 2]
  4048 000032FE 6601D2              <1> 		add dx, dx
  4049 00003301 668915[D1320000]    <1> 		mov [winvcopydx], dx
  4050 00003308 66890D[D3320000]    <1> 		mov [winvcopycx], cx
  4051 0000330F 668B0D[CF320000]    <1> 		mov cx, [winvcopysty]
  4052 00003316 6681E91000          <1> 		sub cx, 16
  4053 0000331B 668B15[CD320000]    <1> 		mov dx, [winvcopystx]
  4054 00003322 C605[F9080000]00    <1> 		mov byte [termcopyon], 0
  4055 00003329 B403                <1> 		mov ah, 3
  4056 0000332B E8ECFCFFFF          <1> 		call graphicsadd
  4057                              <1> 	showwindow2:
  4058 00003330 6681C11000          <1> 		add cx, 16
  4059 00003335 668915[CD320000]    <1> 		mov [winvcopystx], dx
  4060 0000333C 66890D[CF320000]    <1> 		mov [winvcopysty], cx
  4061 00003343 668B16              <1> 		mov dx, [esi]
  4062 00003346 668B4E02            <1> 		mov cx, [esi + 2]
  4063 0000334A 6601D2              <1> 		add dx, dx
  4064 0000334D 668915[D1320000]    <1> 		mov [winvcopydx], dx
  4065 00003354 66890D[D3320000]    <1> 		mov [winvcopycx], cx
  4066 0000335B 8B3D[D9320000]      <1> 		mov edi, [windowbufloc]
  4067 00003361 BA00000000          <1> 		mov edx, 0
  4068 00003366 668B15[E4360000]    <1> 		mov dx, [resolutionx2]
  4069 0000336D C1E204              <1> 		shl edx, 4
  4070 00003370 29D7                <1> 		sub edi, edx
  4071 00003372 803D[F9080000]00    <1> 		cmp byte [termcopyon], 0
  4072 00003379 753E                <1> 		jne nocleartitlebarpos
  4073 0000337B 8B3D[476C0000]      <1> 		mov edi, [physbaseptr]
  4074 00003381 BA00000000          <1> 		mov edx, 0
  4075 00003386 668B15[CD320000]    <1> 		mov dx, [winvcopystx]
  4076 0000338D 01D7                <1> 		add edi, edx
  4077 0000338F 668B0D[CF320000]    <1> 		mov cx, [winvcopysty]
  4078 00003396 6681E91000          <1> 		sub cx, 16
  4079 0000339B 6681F90000          <1> 		cmp cx, 0
  4080 000033A0 7417                <1> 		je nocleartitlebarpos
  4081                              <1> 	cleartitlebarpos:
  4082 000033A2 BA00000000          <1> 		mov edx, 0
  4083 000033A7 668B15[E4360000]    <1> 		mov dx, [resolutionx2]
  4084 000033AE 01D7                <1> 		add edi, edx
  4085 000033B0 6649                <1> 		dec cx
  4086 000033B2 6681F90000          <1> 		cmp cx, 0
  4087 000033B7 75E9                <1> 		jne cleartitlebarpos
  4088                              <1> 	nocleartitlebarpos:
  4089 000033B9 66B91000            <1> 		mov cx, 16
  4090 000033BD 668B15[D1320000]    <1> 		mov dx, [winvcopydx]
  4091 000033C4 6681F90000          <1> 		cmp cx, 0
  4092 000033C9 0F844B000000        <1> 		je near canceltitlebarput
  4093 000033CF 6681FA0000          <1> 		cmp dx, 0
  4094 000033D4 0F8440000000        <1> 		je near canceltitlebarput
  4095                              <1> 	titlebarput:
  4096 000033DA 66A1[D5320000]      <1> 		mov ax, [windowcolor]
  4097 000033E0 668907              <1> 		mov [edi], ax
  4098 000033E3 6681EA0200          <1> 		sub dx, 2
  4099 000033E8 81C702000000        <1> 		add edi, 2
  4100 000033EE 6681FA0000          <1> 		cmp dx, 0
  4101 000033F3 75E5                <1> 		jne titlebarput
  4102 000033F5 BA00000000          <1> 		mov edx, 0
  4103 000033FA 668B15[E4360000]    <1> 		mov dx, [resolutionx2]
  4104 00003401 6649                <1> 		dec cx
  4105 00003403 662B15[D1320000]    <1> 		sub dx, [winvcopydx]
  4106 0000340A 01D7                <1> 		add edi, edx
  4107 0000340C 668B15[D1320000]    <1> 		mov dx, [winvcopydx]
  4108 00003413 6681F90000          <1> 		cmp cx, 0
  4109 00003418 75C0                <1> 		jne titlebarput
  4110                              <1> 	canceltitlebarput:
  4111 0000341A 893D[D9320000]      <1> 		mov [windowbufloc], edi
  4112 00003420 803D[F9080000]02    <1> 		cmp byte [termcopyon], 2
  4113 00003427 0F8463000000        <1> 		je near winvcpst
  4114 0000342D 66B80000            <1> 		mov ax, 0
  4115 00003431 81C604000000        <1> 		add esi, 4
  4116 00003437 668B15[CD320000]    <1> 		mov dx, [winvcopystx]
  4117 0000343E 668B0D[CF320000]    <1> 		mov cx, [winvcopysty]
  4118 00003445 6681E91000          <1> 		sub cx, 16
  4119 0000344A 66BB0000            <1> 		mov bx, 0
  4120 0000344E C605[C3280000]01    <1> 		mov byte [mouseselecton], 1
  4121 00003455 E841FEFFFF          <1> 		call showstring2
  4122 0000345A B058                <1> 		mov al, "X"
  4123 0000345C B400                <1> 		mov ah, 0
  4124 0000345E 668B1D[CB320000]    <1> 		mov bx, [colorfont2]
  4125 00003465 668B15[CD320000]    <1> 		mov dx, [winvcopystx]
  4126 0000346C 668B0D[CF320000]    <1> 		mov cx, [winvcopysty]
  4127 00003473 6681E91000          <1> 		sub cx, 16
  4128 00003478 6681EA1400          <1> 		sub dx, 20
  4129 0000347D 660315[D1320000]    <1> 		add dx, [winvcopydx]
  4130 00003484 C605[C3280000]01    <1> 		mov byte [mouseselecton], 1
  4131 0000348B E864020000          <1> 		call showfontvesa
  4132                              <1> 	winvcpst:
  4133 00003490 8B3D[D9320000]      <1> 		mov edi, [windowbufloc]
  4134 00003496 E957000000          <1> 		jmp windowvideocopyset
  4135                              <1> 
  4136                              <1> 	windowvideocopy:
  4137 0000349B 8B3D[D9320000]      <1> 		mov edi, [windowbufloc]
  4138 000034A1 3B3D[476C0000]      <1> 		cmp edi, [physbaseptr]
  4139 000034A7 0F8345000000        <1> 		jae near windowvideocopyset
  4140 000034AD B900000000          <1> 		mov ecx, 0
  4141 000034B2 BA00000000          <1> 		mov edx, 0
  4142 000034B7 668B15[CD320000]    <1> 		mov dx, [winvcopystx]
  4143 000034BE 668B0D[CF320000]    <1> 		mov cx, [winvcopysty]
  4144 000034C5 8B3D[476C0000]      <1> 		mov edi, [physbaseptr]
  4145 000034CB 01D7                <1> 		add edi, edx
  4146 000034CD 81F900000000        <1> 		cmp ecx, 0
  4147 000034D3 741D                <1> 		je windowvideocopyset
  4148                              <1> 	yrescopylp:
  4149 000034D5 BA00000000          <1> 		mov edx, 0
  4150 000034DA 668B15[E4360000]    <1> 		mov dx, [resolutionx2]
  4151 000034E1 01D7                <1> 		add edi, edx
  4152 000034E3 6649                <1> 		dec cx
  4153 000034E5 6681F90000          <1> 		cmp cx, 0
  4154 000034EA 75E9                <1> 		jne yrescopylp
  4155 000034EC 893D[D9320000]      <1> 		mov [windowbufloc], edi
  4156                              <1> 	windowvideocopyset:
  4157 000034F2 66B90000            <1> 		mov cx, 0
  4158 000034F6 66890D[FF350000]    <1> 		mov [charposline], cx
  4159 000034FD BE[97560000]        <1> 		mov esi, videobuf2
  4160 00003502 8935[01360000]      <1> 		mov [charposvbuf], esi
  4161 00003508 8A1E                <1> 		mov bl, [esi]
  4162 0000350A B700                <1> 		mov bh, 0
  4163 0000350C 66C1E304            <1> 		shl bx, 4
  4164 00003510 678AB7[7241]        <1> 		mov dh, [fonts + bx]
  4165 00003515 D0CE                <1> 		ror dh, 1
  4166 00003517 89FE                <1> 		mov esi, edi
  4167                              <1> 	copywindow:
  4168 00003519 B201                <1> 		mov dl, 1
  4169 0000351B D0C6                <1> 		rol dh, 1
  4170 0000351D 20F2                <1> 		and dl, dh
  4171 0000351F 66A1[D7320000]      <1> 		mov ax, [windowcolor + 2]
  4172 00003525 668907              <1> 		mov [edi], ax
  4173 00003528 80FA00              <1> 		cmp dl, 0
  4174 0000352B 7409                <1> 		je nowritewin
  4175 0000352D 66A1[D5320000]      <1> 		mov ax, [windowcolor]
  4176 00003533 668907              <1> 		mov [edi], ax
  4177                              <1> 	nowritewin:
  4178 00003536 81C702000000        <1> 		add edi, 2
  4179 0000353C FEC1                <1> 		inc cl
  4180 0000353E 80F908              <1> 		cmp cl, 8
  4181 00003541 75D6                <1> 		jne copywindow
  4182 00003543 6643                <1> 		inc bx
  4183 00003545 B100                <1> 		mov cl, 0
  4184 00003547 BA00000000          <1> 		mov edx, 0
  4185 0000354C 668B15[E4360000]    <1> 		mov dx, [resolutionx2]
  4186 00003553 01D6                <1> 		add esi, edx
  4187 00003555 89F7                <1> 		mov edi, esi
  4188 00003557 678AB7[7241]        <1> 		mov dh, [fonts + bx]
  4189 0000355C D0CE                <1> 		ror dh, 1
  4190 0000355E FEC5                <1> 		inc ch
  4191 00003560 80FD10              <1> 		cmp ch, 16
  4192 00003563 75B4                <1> 		jne copywindow
  4193 00003565 66B90000            <1> 		mov cx, 0
  4194 00003569 8B3D[01360000]      <1> 		mov edi, [charposvbuf]
  4195 0000356F 81C702000000        <1> 		add edi, 2
  4196 00003575 81FF[57690000]      <1> 		cmp edi, videobufend
  4197 0000357B 7370                <1> 		jae donewincopynow
  4198 0000357D 8A1F                <1> 		mov bl, [edi]
  4199 0000357F B700                <1> 		mov bh, 0
  4200 00003581 66C1E304            <1> 		shl bx, 4
  4201 00003585 893D[01360000]      <1> 		mov [charposvbuf], edi
  4202 0000358B BA00000000          <1> 		mov edx, 0
  4203 00003590 668B15[E4360000]    <1> 		mov dx, [resolutionx2]
  4204 00003597 C1E204              <1> 		shl edx, 4
  4205 0000359A 29D6                <1> 		sub esi, edx
  4206 0000359C 81C610000000        <1> 		add esi, 16
  4207 000035A2 89F7                <1> 		mov edi, esi
  4208 000035A4 668B0D[FF350000]    <1> 		mov cx, [charposline]
  4209 000035AB 6641                <1> 		inc cx
  4210 000035AD 6681F95000          <1> 		cmp cx, 80
  4211 000035B2 7317                <1> 		jae fixwindowcopy
  4212 000035B4 66890D[FF350000]    <1> 		mov [charposline], cx
  4213 000035BB 66B90000            <1> 		mov cx, 0
  4214 000035BF 678AB7[7241]        <1> 		mov dh, [fonts + bx]
  4215 000035C4 D0CE                <1> 		ror dh, 1
  4216 000035C6 E94EFFFFFF          <1> 		jmp copywindow
  4217                              <1> fixwindowcopy:
  4218 000035CB 66B90000            <1> 		mov cx, 0
  4219 000035CF 66890D[FF350000]    <1> 		mov [charposline], cx
  4220 000035D6 662B15[D1320000]    <1> 		sub dx, [winvcopydx]
  4221 000035DD 01D6                <1> 		add esi, edx
  4222 000035DF 89F7                <1> 		mov edi, esi
  4223 000035E1 678AB7[7241]        <1> 		mov dh, [fonts + bx]
  4224 000035E6 D0CE                <1> 		ror dh, 1
  4225 000035E8 E92CFFFFFF          <1> 		jmp copywindow
  4226                              <1> donewincopynow:
  4227 000035ED 803D[F9080000]01    <1> 		cmp byte [termcopyon], 1
  4228 000035F4 7501                <1> 		jne forgetresetstuff
  4229 000035F6 61                  <1> 		popa
  4230                              <1> forgetresetstuff:
  4231 000035F7 C605[F9080000]00    <1> 		mov byte [termcopyon], 0
  4232 000035FE C3                  <1> 		ret
  4233                              <1> 
  4234 000035FF 0000                <1> charposline dw 0
  4235 00003601 00000000            <1> charposvbuf dw 0,0
  4236 00003605 0000                <1> iconcolor dw 0
  4237                              <1> 	showicon:	;;icon in si, position in (dx,cx), selected in ax, code in bx
  4238 00003607 A2[8A390000]        <1> 		mov [iconselected], al
  4239 0000360C 8025[8A390000]01    <1> 		and byte [iconselected], 1
  4240 00003613 B401                <1> 		mov ah, 1
  4241 00003615 E802FAFFFF          <1> 		call graphicsadd
  4242                              <1> 	showicon2:
  4243 0000361A 8B3D[476C0000]      <1> 		mov edi, [physbaseptr]
  4244 00003620 6601D2              <1> 		add dx, dx
  4245 00003623 663B15[E4360000]    <1> 		cmp dx, [resolutionx2]
  4246 0000362A 720C                <1> 		jb screenxgood
  4247 0000362C 668B15[E4360000]    <1> 		mov dx, [resolutionx2]
  4248 00003633 6681EA4000          <1> 		sub dx, 64
  4249                              <1> 	screenxgood:
  4250 00003638 6681F90000          <1> 		cmp cx, 0
  4251 0000363D 7425                <1> 		je noscreenygoodchk
  4252 0000363F 663B0D[E0360000]    <1> 		cmp cx, [resolutiony]
  4253 00003646 720C                <1> 		jb screenygood
  4254 00003648 668B0D[E0360000]    <1> 		mov cx, [resolutiony]
  4255 0000364F 6681E92000          <1> 		sub cx, 32
  4256                              <1> 	screenygood:
  4257 00003654 BB00000000          <1> 		mov ebx, 0
  4258 00003659 668B1D[E4360000]    <1> 		mov bx, [resolutionx2]
  4259 00003660 01DF                <1> 		add edi, ebx
  4260 00003662 E2F0                <1> 		loop screenygood
  4261                              <1> 	noscreenygoodchk:
  4262 00003664 BB00000000          <1> 		mov ebx, 0
  4263 00003669 6689D3              <1> 		mov bx, dx
  4264 0000366C 01DF                <1> 		add edi, ebx
  4265 0000366E 66B90000            <1> 		mov cx, 0
  4266 00003672 668B06              <1> 		mov ax, [esi]
  4267 00003675 81C602000000        <1> 		add esi, 2
  4268 0000367B 66A3[05360000]      <1> 		mov [iconcolor], ax
  4269                              <1> 	writeicon:
  4270 00003681 8B06                <1> 		mov eax, [esi]
  4271 00003683 D1C0                <1> 		rol eax, 1
  4272 00003685 B100                <1> 		mov cl, 0
  4273                              <1> 	writeiconline:
  4274 00003687 B201                <1> 		mov dl, 1
  4275 00003689 20C2                <1> 		and dl, al
  4276 0000368B 3215[8A390000]      <1> 		xor dl, [iconselected]
  4277 00003691 668B1D[31260000]    <1> 		mov bx, [background]
  4278 00003698 66891F              <1> 		mov [edi], bx
  4279 0000369B 80FA00              <1> 		cmp dl, 0
  4280 0000369E 740A                <1> 		je noiconline
  4281 000036A0 668B15[05360000]    <1> 		mov dx, [iconcolor]
  4282 000036A7 668917              <1> 		mov [edi], dx
  4283                              <1> 	noiconline:
  4284 000036AA 81C702000000        <1> 		add edi, 2
  4285 000036B0 D1C0                <1> 		rol eax, 1
  4286 000036B2 FEC1                <1> 		inc cl
  4287 000036B4 80F920              <1> 		cmp cl, 32
  4288 000036B7 72CE                <1> 		jb writeiconline
  4289 000036B9 81C604000000        <1> 		add esi, 4
  4290 000036BF FEC5                <1> 		inc ch
  4291 000036C1 BA00000000          <1> 		mov edx, 0
  4292 000036C6 668B15[E4360000]    <1> 		mov dx, [resolutionx2]
  4293 000036CD 01D7                <1> 		add edi, edx
  4294 000036CF 81EF40000000        <1> 		sub edi, 64
  4295 000036D5 80FD20              <1> 		cmp ch, 32
  4296 000036D8 72A7                <1> 		jb writeicon
  4297 000036DA B800000000          <1> 		mov eax, 0
  4298 000036DF C3                  <1> 		ret
  4299                              <1> 
  4300 000036E0 0000                <1> resolutiony dw 0
  4301 000036E2 0000                <1> resolutionx dw 0
  4302 000036E4 0000                <1> resolutionx2 dw 0
  4303 000036E6 02                  <1> resolutionbytes db 2
  4304 000036E7 0000                <1> posxvesa dw 0
  4305 000036E9 0000                <1> posyvesa dw 0
  4306 000036EB FFFF                <1> colorfont dw 0xFFFF
  4307                              <1> savefontvesa:		;;same rules as showfontvesa
  4308 000036ED C605[C2280000]01    <1> 	mov byte [savefonton], 1
  4309                              <1> showfontvesa:		;;position in (dx,cx), color in bx, char in al
  4310 000036F4 66890D[E9360000]    <1> 	mov [posyvesa], cx
  4311 000036FB 668915[E7360000]    <1> 	mov [posxvesa], dx
  4312 00003702 8B3D[476C0000]      <1> 	mov edi, [physbaseptr]
  4313 00003708 66891D[EB360000]    <1> 	mov [colorfont], bx
  4314 0000370F BB00000000          <1> 	mov ebx, 0
  4315 00003714 88C3                <1> 	mov bl, al
  4316 00003716 B800000000          <1> 	mov eax, 0
  4317 0000371B 88D8                <1> 	mov al, bl
  4318 0000371D 6689D3              <1> 	mov bx, dx
  4319 00003720 89DA                <1> 	mov edx, ebx
  4320 00003722 BB00000000          <1> 	mov ebx, 0
  4321 00003727 6681F90000          <1> 	cmp cx, 0
  4322 0000372C 7415                <1> 	je vesaposloopdn
  4323 0000372E 668B1D[E4360000]    <1> 	mov bx, [resolutionx2]
  4324                              <1> vesaposloop:
  4325 00003735 01DA                <1> 	add edx, ebx
  4326 00003737 6681E90100          <1> 	sub cx, 1
  4327 0000373C 6681F90000          <1> 	cmp cx, 0
  4328 00003741 75F2                <1> 	jne vesaposloop
  4329                              <1> vesaposloopdn:
  4330 00003743 01D7                <1> 	add edi, edx
  4331 00003745 BE[72410000]        <1> 	mov esi, fonts
  4332                              <1> findfontvesa:
  4333 0000374A B400                <1> 	mov ah, 0
  4334 0000374C C1E004              <1> 	shl eax, 4
  4335 0000374F 01C6                <1> 	add esi, eax
  4336 00003751 C1E804              <1> 	shr eax, 4
  4337 00003754 81FE[92490000]      <1> 	cmp esi, fontend
  4338 0000375A 0F83BF000000        <1> 	jae near donefontvesa
  4339 00003760 4E                  <1> 	dec esi
  4340                              <1> foundfontvesa:
  4341 00003761 46                  <1> 	inc esi
  4342 00003762 803D[C2280000]01    <1> 	cmp byte [savefonton], 1
  4343 00003769 0F84E1000000        <1> 	je near vesafontsaver
  4344 0000376F B100                <1> 	mov cl, 0
  4345 00003771 8A06                <1> 	mov al, [esi]
  4346 00003773 668B15[E4360000]    <1> 	mov dx, [resolutionx2]
  4347 0000377A 662B15[E7360000]    <1> 	sub dx, [posxvesa]
  4348 00003781 6681FA1000          <1> 	cmp dx, 16
  4349 00003786 7708                <1> 	ja paintfontvesa
  4350 00003788 D0EA                <1> 	shr dl, 1
  4351 0000378A 8815[4F380000]      <1> 	mov [charwidth], dl
  4352                              <1> paintfontvesa:
  4353 00003790 B201                <1> 	mov dl, 1
  4354 00003792 20C2                <1> 	and dl, al
  4355 00003794 803D[C1280000]01    <1> 	cmp byte [showcursorfonton], 1
  4356 0000379B 0F8435000000        <1> 	je near nodelpaintedfont
  4357 000037A1 803D[C1280000]02    <1> 	cmp byte [showcursorfonton], 2
  4358 000037A8 0F8518000000        <1> 	jne near noswitchcursorfonton
  4359 000037AE 80FA00              <1> 	cmp dl, 0
  4360 000037B1 0F842E000000        <1> 	je near nopixelset
  4361 000037B7 668B1D[EB360000]    <1> 	mov bx, [colorfont]
  4362 000037BE 66891F              <1> 	mov [edi], bx
  4363 000037C1 E91F000000          <1> 	jmp nopixelset
  4364                              <1> noswitchcursorfonton:
  4365 000037C6 3215[C3280000]      <1> 	xor dl, [mouseselecton]
  4366 000037CC 668B1D[31260000]    <1> 	mov bx, [background]
  4367 000037D3 66891F              <1> 	mov [edi], bx
  4368                              <1> nodelpaintedfont:
  4369 000037D6 80FA00              <1> 	cmp dl, 0
  4370 000037D9 740A                <1> 	je nopixelset
  4371 000037DB 668B15[EB360000]    <1> 	mov dx, [colorfont]
  4372 000037E2 668917              <1> 	mov [edi], dx
  4373                              <1> nopixelset:
  4374 000037E5 81C702000000        <1> 	add edi, 2
  4375 000037EB D0C0                <1> 	rol al, 1
  4376 000037ED FEC1                <1> 	inc cl
  4377 000037EF 3A0D[4F380000]      <1> 	cmp cl, [charwidth]
  4378 000037F5 7299                <1> 	jb paintfontvesa
  4379 000037F7 FEC5                <1> 	inc ch
  4380 000037F9 BA00000000          <1> 	mov edx, 0
  4381 000037FE 668B15[E4360000]    <1> 	mov dx, [resolutionx2]
  4382 00003805 01D7                <1> 	add edi, edx
  4383 00003807 BA00000000          <1> 	mov edx, 0
  4384 0000380C 8A15[4F380000]      <1> 	mov dl, [charwidth]
  4385 00003812 00D2                <1> 	add dl, dl
  4386 00003814 29D7                <1> 	sub edi, edx
  4387 00003816 80FD10              <1> 	cmp ch, 16
  4388 00003819 0F8242FFFFFF        <1> 	jb foundfontvesa
  4389                              <1> donefontvesa:
  4390 0000381F B208                <1> 	mov dl, 8
  4391 00003821 8815[4F380000]      <1> 	mov [charwidth], dl
  4392 00003827 668B15[E7360000]    <1> 	mov dx, [posxvesa]
  4393 0000382E 8A1D[4F380000]      <1> 	mov bl, [charwidth]
  4394 00003834 B700                <1> 	mov bh, 0
  4395 00003836 6601DA              <1> 	add dx, bx
  4396 00003839 668B1D[EB360000]    <1> 	mov bx, [colorfont]
  4397 00003840 668B0D[E9360000]    <1> 	mov cx, [posyvesa]
  4398 00003847 C605[C2280000]00    <1> 	mov byte [savefonton], 0
  4399 0000384E C3                  <1> 	ret
  4400 0000384F 08                  <1> charwidth db 8
  4401                              <1> vesafontsaver:
  4402 00003850 B000                <1> 	mov al, 0
  4403 00003852 B100                <1> 	mov cl, 0
  4404                              <1> vesafontsaver2:
  4405 00003854 668B17              <1> 	mov dx, [edi]
  4406 00003857 663B15[EB360000]    <1> 	cmp dx, [colorfont]
  4407 0000385E 742F                <1> 	je colorfontmatch
  4408                              <1> donecolormatch:
  4409 00003860 81C702000000        <1> 	add edi, 2
  4410 00003866 D0C0                <1> 	rol al, 1
  4411 00003868 FEC1                <1> 	inc cl
  4412 0000386A 80F908              <1> 	cmp cl, 8
  4413 0000386D 72E5                <1> 	jb vesafontsaver2
  4414 0000386F 8806                <1> 	mov [esi], al
  4415 00003871 46                  <1> 	inc esi
  4416 00003872 FEC5                <1> 	inc ch
  4417 00003874 BA00000000          <1> 	mov edx, 0
  4418 00003879 668B15[E4360000]    <1> 	mov dx, [resolutionx2]
  4419 00003880 01D7                <1> 	add edi, edx
  4420 00003882 81EF10000000        <1> 	sub edi, 16
  4421 00003888 80FD10              <1> 	cmp ch, 16
  4422 0000388B 72C3                <1> 	jb vesafontsaver
  4423 0000388D EB90                <1> 	jmp donefontvesa
  4424                              <1> colorfontmatch:
  4425 0000388F 0401                <1> 	add al, 1
  4426 00003891 EBCD                <1> 	jmp donecolormatch
  4427                              <1> 	
  4428                              <1> showbmp:
  4429 00003893 668B06              <1> 	mov ax, [esi]
  4430 00003896 663D424D            <1> 	cmp ax, "BM"
  4431 0000389A 0F858E000000        <1> 	jne near endedbmp
  4432 000038A0 8B3D[476C0000]      <1> 	mov edi, [physbaseptr]
  4433 000038A6 6689D0              <1> 	mov ax, dx
  4434 000038A9 6689CB              <1> 	mov bx, cx
  4435 000038AC B900000000          <1> 	mov ecx, 0
  4436 000038B1 BA00000000          <1> 	mov edx, 0
  4437 000038B6 6689D9              <1> 	mov cx, bx
  4438 000038B9 6689C2              <1> 	mov dx, ax
  4439 000038BC 01D7                <1> 	add edi, edx
  4440 000038BE 01D7                <1> 	add edi, edx
  4441 000038C0 BA00000000          <1> 	mov edx, 0
  4442 000038C5 668B15[E4360000]    <1> 	mov dx, [resolutionx2]
  4443 000038CC 41                  <1> 	inc ecx
  4444 000038CD 034E16              <1> 	add ecx, [esi + 22]
  4445                              <1> bmplocloop:
  4446 000038D0 01D7                <1> 	add edi, edx
  4447 000038D2 E2FC                <1> 	loop bmplocloop
  4448 000038D4 29D7                <1> 	sub edi, edx
  4449 000038D6 8B5612              <1> 	mov edx, [esi + 18]
  4450 000038D9 8B4E16              <1> 	mov ecx, [esi + 22]
  4451 000038DC 8B460A              <1> 	mov eax, [esi + 10]
  4452 000038DF 8B5E02              <1> 	mov ebx, [esi + 2]
  4453 000038E2 01F3                <1> 	add ebx, esi
  4454 000038E4 891D[2F390000]      <1> 	mov [bmpend], ebx
  4455 000038EA 89D3                <1> 	mov ebx, edx
  4456 000038EC 01C6                <1> 	add esi, eax
  4457                              <1> ldxbmp:
  4458 000038EE 668B06              <1> 	mov ax, [esi]
  4459 000038F1 668907              <1> 	mov [edi], ax
  4460 000038F4 81C702000000        <1> 	add edi, 2
  4461 000038FA 81C602000000        <1> 	add esi, 2
  4462 00003900 3B35[2F390000]      <1> 	cmp esi, [bmpend]
  4463 00003906 7726                <1> 	ja endedbmp
  4464 00003908 4A                  <1> 	dec edx
  4465 00003909 81FA00000000        <1> 	cmp edx, 0
  4466 0000390F 77DD                <1> 	ja ldxbmp
  4467 00003911 BA00000000          <1> 	mov edx, 0
  4468 00003916 668B15[E4360000]    <1> 	mov dx, [resolutionx2]
  4469 0000391D 29DF                <1> 	sub edi, ebx
  4470 0000391F 29DF                <1> 	sub edi, ebx
  4471 00003921 29D7                <1> 	sub edi, edx
  4472 00003923 49                  <1> 	dec ecx
  4473 00003924 89DA                <1> 	mov edx, ebx
  4474 00003926 81F900000000        <1> 	cmp ecx, 0
  4475 0000392C 77C0                <1> 	ja ldxbmp
  4476                              <1> endedbmp:
  4477 0000392E C3                  <1> 	ret
  4478                              <1> 	
  4479 0000392F 00000000            <1> 	bmpend dd 0
  4480                              <1> 
  4481                              <1> ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;Here are some vars;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
  4482 00003933 00000000            <1> 	showstringesi dw 0,0
  4483 00003937 00                  <1> 	mouseon db 0
  4484 00003938 737461727400        <1> 	start	db "start",0
  4485 0000393E 536F6C6C65724F5300  <1> 	gotomenu db "SollerOS",0
  4486 00003947 426F6F2100          <1> 	boomsg db "Boo!",0
  4487 0000394C 5061636D616E207761- <1> 	pacmsg	db "Pacman was easy to draw.",0
  4488 00003955 73206561737920746F- <1>
  4489 0000395E 20647261772E00      <1>
  4490 00003965 4F6D206E6F6D206E6F- <1> 	pacnom  db "Om nom nom nom",0
  4491 0000396E 6D206E6F6D00        <1>
  4492 00003974 77696E646F77732073- <1> 	winmsg	db "windows sucks",0
  4493 0000397D 75636B7300          <1>
  4494 00003982 5800                <1> 	xmsg db "X",0
  4495 00003984 0000                <1> 	icon dw 0	;pointer to icon
  4496 00003986 00000000            <1> 	codepointer dw 0,0 ;pointer to code
  4497 0000398A 00                  <1> 	iconselected db 0
  4498                              <1> 	
  4499                              <1> 	boo:
  4500 0000398B BE[47390000]        <1> 		mov esi, boomsg
  4501 00003990 66BA6400            <1> 		mov dx, 100
  4502 00003994 66B94001            <1> 		mov cx, 320
  4503 00003998 BB00000000          <1> 		mov ebx, 0
  4504 0000399D 66B80000            <1> 		mov ax, 0
  4505 000039A1 E9E2F8FFFF          <1> 		jmp showstring
  4506                              <1> 
  4507                              <1> 	pacmannomnom:
  4508 000039A6 BE[65390000]        <1> 		mov esi, pacnom
  4509 000039AB 66BA8200            <1> 		mov dx, 130
  4510 000039AF 66B93C00            <1> 		mov cx, 60
  4511 000039B3 BB00000000          <1> 		mov ebx, 0
  4512 000039B8 66B80000            <1> 		mov ax, 0
  4513 000039BC E9C7F8FFFF          <1> 		jmp showstring	
  4514                              <1> 	
  4515                              <1> 	noie:
  4516 000039C1 BE[553A0000]        <1> 		mov esi, termwindow
  4517 000039C6 66BA0000            <1> 		mov dx, 0
  4518 000039CA 66B90000            <1> 		mov cx, 0
  4519 000039CE BB[1B0D0000]        <1> 		mov ebx, nwcmd
  4520                              <1> ;;		mov ebx, internettest
  4521 000039D3 891D[EA020000]      <1> 		mov [user2codepoint], ebx
  4522 000039D9 66B80000            <1> 		mov ax, 0
  4523 000039DD E8FBF8FFFF          <1> 		call showwindow
  4524                              <1> ;;		jmp internettest
  4525 000039E2 E934D3FFFF          <1> 		jmp nwcmd
  4526 000039E7 C3                  <1> 		ret
  4527                              <1> 
  4528                              <1> 	gotomenuboot:
  4529 000039E8 BE[553A0000]        <1> 		mov esi, termwindow
  4530 000039ED 66BA0000            <1> 		mov dx, 0
  4531 000039F1 66B90000            <1> 		mov cx, 0
  4532 000039F5 BB[590C0000]        <1> 		mov ebx, os
  4533 000039FA 891D[EA020000]      <1> 		mov [user2codepoint], ebx
  4534 00003A00 66B80000            <1> 		mov ax, 0
  4535 00003A04 E8D4F8FFFF          <1> 		call showwindow
  4536 00003A09 E94BD2FFFF          <1> jmp os
  4537 00003A0E C3                  <1> 		ret
  4538                              <1> 
  4539                              <1> 	winblows:
  4540 00003A0F BE[74390000]        <1> 		mov esi, winmsg
  4541 00003A14 66BA0000            <1> 		mov dx, 0
  4542 00003A18 668B0D[E0360000]    <1> 		mov cx, [resolutiony]
  4543 00003A1F 6681E92000          <1> 		sub cx, 32
  4544 00003A24 BB00000000          <1> 		mov ebx, 0
  4545 00003A29 B400                <1> 		mov ah, 0
  4546 00003A2B B011                <1> 		mov al, 00010001b
  4547 00003A2D E856F8FFFF          <1> 		call showstring
  4548 00003A32 BE[3E390000]        <1> 		mov esi, gotomenu
  4549 00003A37 668B0D[E0360000]    <1> 		mov cx, [resolutiony]
  4550 00003A3E 6681E93000          <1> 		sub cx, 48
  4551 00003A43 66BA0000            <1> 		mov dx, 0
  4552 00003A47 B400                <1> 		mov ah, 0
  4553 00003A49 B010                <1> 		mov al, 00010000b
  4554 00003A4B BB[E8390000]        <1> 		mov ebx, gotomenuboot
  4555 00003A50 E933F8FFFF          <1> 		jmp showstring
  4556                              <1> 
  4557 00003A55 8002E001            <1> 	termwindow:	dw 640,480	;;window size
  4558 00003A59 5445524D494E414C00  <1> 	termmsg:	db "TERMINAL",0	;;window title
  4559 00003A59 <incbin>            <1> interneticon: 	incbin 'source/precompiled/interneticon.pak'
  4560 00003A59 <incbin>            <1> wordicon: 	incbin 'source/precompiled/wordicon.pak'
  4561 00003A59 <incbin>            <1> pacmanpellet: incbin 'source/precompiled/pacmanpellet.pak'
  4562 00003A59 <incbin>            <1> ghostie	incbin 'source/precompiled/ghostie.pak'
  4563 00003A59 <incbin>            <1> pacman	incbin 'source/precompiled/pacman.pak'
  4564                                      ;%include 'source/network.asm'
  4565                                  	%include 'source/pci.asm'
  4566 00003CEC 00                  <1> pcibus		db 0
  4567 00003CED 00                  <1> pcidevice	db 0
  4568 00003CEE 00                  <1> pcifunction	db 0
  4569 00003CEF 00                  <1> pciregister	db 0
  4570 00003CF0 00                  <1> pcireqtype db 0
  4571                              <1> 
  4572                              <1> getpciport:
  4573 00003CF1 B001                <1> 	mov al, 1
  4574 00003CF3 A2[F03C0000]        <1> 	mov [pcireqtype], al
  4575 00003CF8 E91E000000          <1> 	jmp searchpci
  4576                              <1> pcidump:
  4577 00003CFD B800000000          <1> 	mov eax, 0
  4578 00003D02 A2[EE3C0000]        <1> 	mov [pcifunction], al
  4579 00003D07 A2[EC3C0000]        <1> 	mov [pcibus], al
  4580 00003D0C A2[ED3C0000]        <1> 	mov [pcidevice], al
  4581 00003D11 A2[F03C0000]        <1> 	mov [pcireqtype], al
  4582 00003D16 E900000000          <1> 	jmp searchpci
  4583                              <1> searchpci:		;;return in ebx, start X in pciX
  4584 00003D1B B000                <1> 	mov al, 0
  4585 00003D1D A2[EF3C0000]        <1> 	mov [pciregister], al
  4586 00003D22 E84F010000          <1> 	call getpciaddr
  4587 00003D27 BAF80C0000          <1> 	mov edx, 0xCF8
  4588 00003D2C EF                  <1> 	out dx, eax	;;request pci config
  4589 00003D2D BAFC0C0000          <1> 	mov edx, 0xCFC
  4590 00003D32 ED                  <1> 	in eax, dx 	;;read in pci config
  4591 00003D33 3D0000FFFF          <1> 	cmp eax, 0xFFFF0000
  4592 00003D38 0F8237000000        <1> 	jb near checkpcidevice
  4593                              <1> searchpciret:
  4594                              <1> nextpcidevice:
  4595 00003D3E B000                <1> 	mov al, 0
  4596 00003D40 A2[EE3C0000]        <1> 	mov [pcifunction], al
  4597 00003D45 A0[ED3C0000]        <1> 	mov al, [pcidevice]
  4598 00003D4A 3C1F                <1> 	cmp al, 11111b
  4599 00003D4C 0F83B8000000        <1> 	jae near nextpcibus
  4600 00003D52 FEC0                <1> 	inc al
  4601 00003D54 A2[ED3C0000]        <1> 	mov [pcidevice], al
  4602 00003D59 EBC0                <1> 	jmp searchpci
  4603 00003D5B A0[EE3C0000]        <1> 	mov al, [pcifunction]
  4604 00003D60 3C07                <1> 	cmp al, 111b
  4605 00003D62 0F83D6FFFFFF        <1> 	jae near nextpcidevice
  4606 00003D68 FEC0                <1> 	inc al
  4607 00003D6A A2[EE3C0000]        <1> 	mov [pcifunction], al
  4608 00003D6F EBAA                <1> 	jmp searchpci
  4609 00003D71 00000000            <1> pcitype: db 0,0,0,0
  4610                              <1> checkpcidevice:
  4611 00003D75 B000                <1> 	mov al, 0
  4612 00003D77 3805[F03C0000]      <1> 	cmp [pcireqtype], al
  4613 00003D7D 0F842B000000        <1> 	je near dumppcidevice
  4614 00003D83 B008                <1> 	mov al, 0x08
  4615 00003D85 A2[EF3C0000]        <1> 	mov [pciregister], al	;;class code, subclass, revision id
  4616 00003D8A E8E7000000          <1> 	call getpciaddr
  4617 00003D8F BAF80C0000          <1> 	mov edx, 0xCF8
  4618 00003D94 EF                  <1> 	out dx, eax
  4619 00003D95 BAFC0C0000          <1> 	mov edx, 0xCFC
  4620 00003D9A ED                  <1> 	in eax, dx
  4621 00003D9B C1C008              <1> 	rol eax, 8
  4622 00003D9E 8A1D[713D0000]      <1> 	mov bl, [pcitype]
  4623 00003DA4 38D8                <1> 	cmp al, bl
  4624 00003DA6 0F8480000000        <1> 	je near foundpciaddr
  4625 00003DAC EB90                <1> 	jmp searchpciret
  4626                              <1> dumppcidevice:
  4627 00003DAE B000                <1> 	mov al, 0
  4628 00003DB0 A2[EF3C0000]        <1> 	mov [pciregister], al
  4629 00003DB5 E8BC000000          <1> 	call getpciaddr
  4630 00003DBA 89C1                <1> 	mov ecx, eax
  4631 00003DBC C605[D4100000]03    <1> 	mov byte [firsthexshown],3
  4632 00003DC3 E80DD3FFFF          <1> 	call showhex
  4633                              <1> dumppcidevicelp:
  4634 00003DC8 A2[EF3C0000]        <1> 	mov [pciregister], al
  4635 00003DCD E8A4000000          <1> 	call getpciaddr
  4636 00003DD2 BAF80C0000          <1> 	mov edx, 0xCF8
  4637 00003DD7 EF                  <1> 	out dx, eax
  4638 00003DD8 BAFC0C0000          <1> 	mov edx, 0xCFC
  4639 00003DDD ED                  <1> 	in eax, dx
  4640 00003DDE 89C1                <1> 	mov ecx, eax
  4641 00003DE0 A0[EF3C0000]        <1> 	mov al, [pciregister]
  4642 00003DE5 0404                <1> 	add al, 4
  4643 00003DE7 3C3C                <1> 	cmp al, 0x3C
  4644 00003DE9 730E                <1> 	jae dumppcidn
  4645 00003DEB C605[D4100000]00    <1> 	mov byte [firsthexshown],0
  4646 00003DF2 E8DED2FFFF          <1> 	call showhex
  4647 00003DF7 EBCF                <1> 	jmp dumppcidevicelp
  4648                              <1> dumppcidn:
  4649 00003DF9 C605[D4100000]02    <1> 	mov byte [firsthexshown],2
  4650 00003E00 E8D0D2FFFF          <1> 	call showhex
  4651 00003E05 E934FFFFFF          <1> 	jmp searchpciret
  4652                              <1> nextpcibus:
  4653 00003E0A B000                <1> 	mov al, 0
  4654 00003E0C A2[ED3C0000]        <1> 	mov [pcidevice], al
  4655 00003E11 A0[EC3C0000]        <1> 	mov al, [pcibus]
  4656 00003E16 3C7F                <1> 	cmp al, 1111111b
  4657 00003E18 730C                <1> 	jae donesearchpci
  4658 00003E1A FEC0                <1> 	inc al
  4659 00003E1C A2[EC3C0000]        <1> 	mov [pcibus], al
  4660 00003E21 E9F5FEFFFF          <1> 	jmp searchpci
  4661                              <1> donesearchpci:
  4662 00003E26 BA00000000          <1> 	mov edx, 0
  4663 00003E2B C3                  <1> 	ret
  4664                              <1> foundpciaddr:
  4665 00003E2C B010                <1> 	mov al, 0x10
  4666 00003E2E A2[EF3C0000]        <1> 	mov [pciregister], al
  4667                              <1> findpciioaddr:
  4668 00003E33 E83E000000          <1> 	call getpciaddr
  4669 00003E38 BAF80C0000          <1> 	mov edx, 0xCF8
  4670 00003E3D EF                  <1> 	out dx, eax
  4671 00003E3E BAFC0C0000          <1> 	mov edx, 0xCFC
  4672 00003E43 ED                  <1> 	in eax, dx
  4673 00003E44 89C3                <1> 	mov ebx, eax
  4674 00003E46 81E301000000        <1> 	and ebx, 1
  4675 00003E4C 81FB00000000        <1> 	cmp ebx, 0
  4676 00003E52 0F8408000000        <1> 	je near notpciioaddr
  4677 00003E58 2D01000000          <1> 	sub eax, 1
  4678 00003E5D 89C2                <1> 	mov edx, eax
  4679 00003E5F C3                  <1> 	ret
  4680                              <1> notpciioaddr:
  4681 00003E60 A0[EF3C0000]        <1> 	mov al, [pciregister]
  4682 00003E65 0404                <1> 	add al, 4
  4683 00003E67 3C28                <1> 	cmp al, 0x28
  4684 00003E69 0F87CFFEFFFF        <1> 	ja near searchpciret
  4685 00003E6F A2[EF3C0000]        <1> 	mov [pciregister], al
  4686 00003E74 EBBD                <1> 	jmp findpciioaddr
  4687                              <1> getpciaddr:		;;puts it in eax and ebx
  4688 00003E76 B800000000          <1> 			mov eax, 0
  4689 00003E7B BB00000080          <1> 			mov ebx, 0x80000000
  4690 00003E80 A0[EC3C0000]        <1> 			mov al, [pcibus]
  4691 00003E85 C1E010              <1> 			shl eax, 16
  4692 00003E88 01C3                <1> 			add ebx, eax
  4693 00003E8A B800000000          <1> 			mov eax, 0
  4694 00003E8F A0[ED3C0000]        <1> 			mov al, [pcidevice]
  4695 00003E94 C1E00B              <1> 			shl eax, 11
  4696 00003E97 01C3                <1> 			add ebx, eax
  4697 00003E99 B800000000          <1> 			mov eax, 0
  4698 00003E9E A0[EE3C0000]        <1> 			mov al, [pcifunction]
  4699 00003EA3 C1E008              <1> 			shl eax, 8
  4700 00003EA6 01C3                <1> 			add ebx, eax
  4701 00003EA8 B800000000          <1> 			mov eax, 0
  4702 00003EAD A0[EF3C0000]        <1> 			mov al, [pciregister]
  4703 00003EB2 01C3                <1> 			add ebx, eax
  4704 00003EB4 89D8                <1> 			mov eax, ebx
  4705 00003EB6 C3                  <1> 			ret
  4706                                  	;%include 'source/process.asm'
  4707                                      %include 'source/disk.asm'
  4708                              <1> ;;disk.asm - new - using lba
  4709                              <1> loadfile:	;;loads a file with the name buffer's location in edi into location in esi
  4710 00003EB7 803F00              <1> 	cmp byte [edi], 0
  4711 00003EBA 0F8444000000        <1> 	je near nofileload
  4712 00003EC0 89FA                <1> 	mov edx, edi
  4713 00003EC2 BB[21400000]        <1> 	mov ebx, diskfileindex
  4714                              <1> nextnamechar:
  4715 00003EC7 8A07                <1> 	mov al, [edi]
  4716 00003EC9 8A23                <1> 	mov ah, [ebx]
  4717 00003ECB 47                  <1> 	inc edi
  4718 00003ECC 43                  <1> 	inc ebx
  4719 00003ECD 88C1                <1> 	mov cl, al
  4720 00003ECF 08E1                <1> 	or cl, ah
  4721 00003ED1 80F900              <1> 	cmp cl, 0
  4722 00003ED4 744E                <1> 	je equalfilenames
  4723 00003ED6 80F920              <1> 	cmp cl, ' '
  4724 00003ED9 7449                <1> 	je equalfilenames
  4725 00003EDB 3C2A                <1> 	cmp al, '*'
  4726 00003EDD 742B                <1> 	je equalfilenames2
  4727 00003EDF 80FC00              <1> 	cmp ah, 0
  4728 00003EE2 7410                <1> 	je nextfilename
  4729 00003EE4 3C00                <1> 	cmp al, 0
  4730 00003EE6 740C                <1> 	je nextfilename
  4731 00003EE8 38E0                <1> 	cmp al, ah
  4732 00003EEA 74DB                <1> 	je nextnamechar
  4733                              <1> getebxzero:
  4734 00003EEC 8A23                <1> 	mov ah, [ebx]
  4735 00003EEE 43                  <1> 	inc ebx
  4736 00003EEF 80FC00              <1> 	cmp ah, 0
  4737 00003EF2 75F8                <1> 	jne getebxzero
  4738                              <1> nextfilename:
  4739 00003EF4 81C308000000        <1> 	add ebx, 8		;;next descriptor
  4740 00003EFA 89D7                <1> 	mov edi, edx
  4741 00003EFC 81FB[7A400000]      <1> 	cmp ebx, enddiskfileindex
  4742 00003F02 72C3                <1> 	jb nextnamechar
  4743                              <1> nofileload:
  4744 00003F04 BA94010000          <1> 	mov edx, 404	;;indicate not found error
  4745 00003F09 C3                  <1> 	ret
  4746                              <1> equalfilenames2:
  4747 00003F0A 81EB02000000        <1> 	sub ebx, 2
  4748                              <1> eqfilefind:
  4749 00003F10 43                  <1> 	inc ebx
  4750 00003F11 81FB[7A400000]      <1> 	cmp ebx, enddiskfileindex
  4751 00003F17 0F83E7FFFFFF        <1> 	jae near nofileload
  4752 00003F1D 8A03                <1> 	mov al, [ebx]
  4753 00003F1F 3C00                <1> 	cmp al, 0
  4754 00003F21 75ED                <1> 	jne eqfilefind
  4755 00003F23 43                  <1> 	inc ebx
  4756                              <1> equalfilenames:
  4757 00003F24 8B4304              <1> 	mov eax, [ebx + 4] 	;;put file size in eax
  4758 00003F27 8B1B                <1> 	mov ebx, [ebx]		;;put file beginning in ebx
  4759 00003F29 031D[2C000000]      <1> 	add ebx, [lbaad]	;;add offset to solleros
  4760 00003F2F B900000000          <1> 	mov ecx, 0
  4761 00003F34 88C1                <1> 	mov cl, al			;;get excess number of sectors
  4762 00003F36 D0E1                <1> 	shl cl, 1
  4763 00003F38 D0E9                <1> 	shr cl, 1			;;cut off at 128
  4764 00003F3A 29C8                <1> 	sub eax, ecx		;;get rid of excess sectors
  4765 00003F3C B500                <1> 	mov ch, 0			;;drive 0
  4766 00003F3E C1E807              <1> 	shr eax, 7			;;get number of 128 sector tracks
  4767                              <1> loaddiskfile:		;;tracks in eax, excess sectors in cl, drive in ch, buffer in esi, address in ebx
  4768 00003F41 A3[7F3F0000]        <1> 	mov [filetracks], eax
  4769 00003F46 89F7                <1> 	mov edi, esi		;;just in case cl is 0
  4770 00003F48 89DA                <1> 	mov edx, ebx
  4771 00003F4A 80F900              <1> 	cmp cl, 0
  4772 00003F4D 7405                <1> 	je copytracksforfile
  4773 00003F4F E831000000          <1> 	call diskr		;;take care of excess sectors
  4774                              <1> copytracksforfile:
  4775 00003F54 A1[7F3F0000]        <1> 	mov eax, [filetracks]
  4776 00003F59 3D00000000          <1> 	cmp eax, 0
  4777 00003F5E 7419                <1> 	je donecopyfile
  4778 00003F60 48                  <1> 	dec eax
  4779 00003F61 A3[7F3F0000]        <1> 	mov [filetracks], eax
  4780 00003F66 89D3                <1> 	mov ebx, edx	;;get end lba
  4781 00003F68 B180                <1> 	mov cl, 0x80
  4782 00003F6A 8A2D[2B000000]      <1> 	mov ch, [DriveNumber]
  4783 00003F70 89FE                <1> 	mov esi, edi	;;reset buffer
  4784 00003F72 E80E000000          <1> 	call diskr
  4785 00003F77 EBDB                <1> 	jmp copytracksforfile
  4786                              <1> donecopyfile:
  4787 00003F79 BA00000000          <1> 	mov edx, 0	;;no error
  4788 00003F7E C3                  <1> 	ret
  4789                              <1> 	
  4790 00003F7F 00000000            <1> filetracks dd 0
  4791                              <1> 	
  4792 00003F83 6400                <1> segments dw 100
  4793                              <1> 
  4794                              <1> diskr:		;;sector count in cl, disk number in ch, 28 bit address in first 28 bits of ebx, buffer in esi, puts end buffer in edi and end lba in edx
  4795 00003F85 8935[1D400000]      <1> 	mov [bufferstartesi], esi
  4796 00003F8B 891D[19400000]      <1> 	mov [lbaadstartebx], ebx
  4797 00003F91 BA00000000          <1> 	mov edx, 0
  4798 00003F96 88CA                <1> 	mov dl, cl
  4799 00003F98 01DA                <1> 	add edx, ebx
  4800 00003F9A 8915[15400000]      <1> 	mov [lbaadend], edx
  4801 00003FA0 66B80000            <1> 	mov ax, 0
  4802 00003FA4 66BAF101            <1> 	mov dx, 0x1F1
  4803 00003FA8 EE                  <1> 	out dx, al	;;send null byte to port
  4804 00003FA9 6642                <1> 	inc dx	;;0x1F2
  4805 00003FAB 88C8                <1> 	mov al, cl	;;get sector count
  4806 00003FAD EE                  <1> 	out dx, al	;;send sector count
  4807 00003FAE 6642                <1> 	inc dx	;;0x1F3
  4808 00003FB0 88D8                <1> 	mov al, bl	;;get first 8 bits of address
  4809 00003FB2 EE                  <1> 	out dx, al	;;send them
  4810 00003FB3 6642                <1> 	inc dx	;;0x1F4
  4811 00003FB5 C1CB08              <1> 	ror ebx, 8	;;get next 8 bits
  4812 00003FB8 88D8                <1> 	mov al, bl
  4813 00003FBA EE                  <1> 	out dx, al
  4814 00003FBB 6642                <1> 	inc dx	;;0x1F5
  4815 00003FBD C1CB08              <1> 	ror ebx, 8	;;again
  4816 00003FC0 88D8                <1> 	mov al, bl
  4817 00003FC2 EE                  <1> 	out dx, al
  4818 00003FC3 6642                <1> 	inc dx	;;0x1F6
  4819 00003FC5 C1CB08              <1> 	ror ebx, 8
  4820 00003FC8 88D8                <1> 	mov al, bl
  4821 00003FCA 240F                <1> 	and al, 00001111b	;;last 4 bits of address
  4822 00003FCC 0CE0                <1> 	or al, 0xE0			;;majic number
  4823 00003FCE C0E504              <1> 	shl ch, 4
  4824 00003FD1 08E8                <1> 	or al, ch
  4825 00003FD3 EE                  <1> 	out dx, al			;;send drive indicator, magic bits, and highest 4 bits of address
  4826 00003FD4 6642                <1> 	inc dx	;;0x1F7
  4827 00003FD6 B020                <1> 	mov al, 0x20
  4828 00003FD8 EE                  <1> 	out dx, al			;;execute read command
  4829                              <1> diskrwait:
  4830 00003FD9 66BAF701            <1> 	mov dx, 0x1F7
  4831 00003FDD EC                  <1> 	in al, dx
  4832 00003FDE 2408                <1> 	and al, 0x08
  4833 00003FE0 3C08                <1> 	cmp al, 0x08
  4834 00003FE2 75F5                <1> 	jne diskrwait
  4835 00003FE4 88CD                <1> 	mov ch, cl	;;move sector data into ch, multiplying it by 256
  4836 00003FE6 B100                <1> 	mov cl, 0
  4837                              <1> diskdataread:
  4838 00003FE8 66BAF001            <1> 	mov dx, 0x1F0
  4839 00003FEC 66ED                <1> 	in ax, dx
  4840 00003FEE 668906              <1> 	mov [esi], ax
  4841 00003FF1 81C602000000        <1> 	add esi, 2
  4842 00003FF7 6649                <1> 	dec cx
  4843 00003FF9 6681F90000          <1> 	cmp cx, 0
  4844 00003FFE 75E8                <1> 	jne diskdataread		;;read all sectors
  4845 00004000 89F7                <1> 	mov edi, esi
  4846 00004002 8B15[15400000]      <1> 	mov edx, [lbaadend]
  4847 00004008 8B35[1D400000]      <1> 	mov esi, [bufferstartesi]
  4848 0000400E 8B1D[19400000]      <1> 	mov ebx, [lbaadstartebx]
  4849 00004014 C3                  <1> 	ret
  4850                              <1> 	
  4851 00004015 00000000            <1> lbaadend dd 0
  4852 00004019 00000000            <1> lbaadstartebx dd 0
  4853 0000401D 00000000            <1> bufferstartesi dd 0
  4854                                      %include 'fileindex.asm'
  4855                              <1> diskfileindex:
  4856 00004021 736F6C6C65726F732E- <1> db "solleros.bmp",0
  4857 0000402A 626D7000            <1>
  4858 0000402E 37000000            <1> dd (f0-$$)/512
  4859 00004032 B0020000            <1> dd (f1-f0)/512
  4860 00004036 736F6C6C65726F732E- <1> db "solleros.txt",0
  4861 0000403F 74787400            <1>
  4862 00004043 E7020000            <1> dd (f1-$$)/512
  4863 00004047 01000000            <1> dd (f2-f1)/512
  4864 0000404B 74656C7900          <1> db "tely",0
  4865 00004050 E8020000            <1> dd (f2-$$)/512
  4866 00004054 01000000            <1> dd (f3-f2)/512
  4867 00004058 74696D6500          <1> db "time",0
  4868 0000405D E9020000            <1> dd (f3-$$)/512
  4869 00004061 01000000            <1> dd (f4-f3)/512
  4870 00004065 7475746F7269616C2E- <1> db "tutorial.bat",0
  4871 0000406E 62617400            <1>
  4872 00004072 EA020000            <1> dd (f4-$$)/512
  4873 00004076 02000000            <1> dd (f5-f4)/512
  4874                              <1> enddiskfileindex:
  4875                              <1> 
  4876                                      %include 'source/msg.asm'
  4877 0000407A 6578697400          <1> 	exitmsg db	"exit",0
  4878 0000407F 50726F6772616D2022- <1> 	notfound1 db "Program ",34,0
  4879 00004088 00                  <1>
  4880 00004089 22206E6F7420666F75- <1> 	notfound2 db  34," not found.",13,10,0
  4881 00004092 6E642E0D0A00        <1>
  4882 00004098 456E74657220506173- <1> 	pwdask	db	"Enter Password:",0
  4883 000040A1 73776F72643A00      <1>
  4884 000040A8 70617373776F726400  <1> 	pwd	db	"password",0
  4885 000040B1 5B7573657240536F6C- <1> 	cmd	db	"[user@SollerOS-v0.9.0$]",0
  4886 000040BA 6C65724F532D76302E- <1>
  4887 000040C3 392E30245D00        <1>
  4888 000040C9 0D0A00              <1> 	line	db	13,10,0
  4889 000040CC 536F6C6C65724F5320- <1>     msg:       db "SollerOS Beta version 0.9.0 - compiled by Jeremy Soller.",13,10,0
  4890 000040D5 426574612076657273- <1>
  4891 000040DE 696F6E20302E392E30- <1>
  4892 000040E7 202D20636F6D70696C- <1>
  4893 000040F0 6564206279204A6572- <1>
  4894 000040F9 656D7920536F6C6C65- <1>
  4895 00004102 722E0D0A00          <1>
  4896 00004107 506C65617365207365- <1>     wrongmsg:  db "Please select one of the options above.",13,10,"You selected: ",0
  4897 00004110 6C656374206F6E6520- <1>
  4898 00004119 6F6620746865206F70- <1>
  4899 00004122 74696F6E732061626F- <1>
  4900 0000412B 76652E0D0A596F7520- <1>
  4901 00004134 73656C65637465643A- <1>
  4902 0000413D 2000                <1>
  4903 0000413F 546F2072756E207468- <1> 	batchmsg db "To run this batch type runbatch and press enter.",10,13,0
  4904 00004148 697320626174636820- <1>
  4905 00004151 747970652072756E62- <1>
  4906 0000415A 6174636820616E6420- <1>
  4907 00004163 707265737320656E74- <1>
  4908 0000416C 65722E0A0D00        <1>
  4909                              <1> 	
  4910 0000416C <incbin>            <1> fonts:	incbin 'source/precompiled/fonts.pak'
  4911                              <1> fontend2:
  4912                              <1> mcursor:
  4913 00004982 01                  <1> 	db	00000001b
  4914 00004983 81                  <1> 	db	10000001b
  4915 00004984 C1                  <1> 	db	11000001b
  4916 00004985 E1                  <1> 	db	11100001b
  4917 00004986 F1                  <1> 	db	11110001b
  4918 00004987 F9                  <1> 	db	11111001b
  4919 00004988 FD                  <1> 	db	11111101b
  4920 00004989 FF                  <1> 	db	11111111b
  4921 0000498A F9                  <1> 	db	11111001b
  4922 0000498B B9                  <1> 	db	10111001b
  4923 0000498C 39                  <1> 	db	00111001b
  4924 0000498D 1C                  <1> 	db	00011100b
  4925 0000498E 1C                  <1> 	db	00011100b
  4926 0000498F 0E                  <1> 	db	00001110b
  4927 00004990 0E                  <1> 	db	00001110b
  4928 00004991 0C                  <1> 	db	00001100b
  4929                              <1> fontend:
  4930                              <1> 
  4931                              <1> cursorbmp:
  4932 00004992 0100000000000000    <1> 	db	1,0,0,0,0,0,0,0
  4933 0000499A 0101000000000000    <1> 	db	1,1,0,0,0,0,0,0
  4934 000049A2 0101010000000000    <1> 	db	1,1,1,0,0,0,0,0
  4935 000049AA 0101010100000000    <1> 	db	1,1,1,1,0,0,0,0
  4936 000049B2 0101010101000000    <1> 	db	1,1,1,1,1,0,0,0
  4937 000049BA 0101010101010000    <1> 	db	1,1,1,1,1,1,0,0
  4938 000049C2 0101010101010100    <1> 	db	1,1,1,1,1,1,1,0
  4939 000049CA 0101010101010101    <1> 	db	1,1,1,1,1,1,1,1
  4940 000049D2 0101010101010000    <1> 	db	1,1,1,1,1,1,0,0
  4941 000049DA 0101000101010000    <1> 	db	1,1,0,1,1,1,0,0
  4942 000049E2 0100000101010000    <1> 	db	1,0,0,1,1,1,0,0
  4943 000049EA 0000000001010100    <1> 	db	0,0,0,0,1,1,1,0
  4944 000049F2 0000000001010100    <1> 	db	0,0,0,0,1,1,1,0
  4945 000049FA 0000000000010101    <1> 	db	0,0,0,0,0,1,1,1
  4946 00004A02 0000000000010101    <1> 	db	0,0,0,0,0,1,1,1
  4947 00004A0A 0000000000010100    <1> 	db	0,0,0,0,0,1,1,0
  4948                              <1> cursorbmpend:
  4949                              <1> ;;; ZEROS-THESE DO NOT NEED TO BE COMPILED BUT ADDRESSES SHOULD BE USED
  4950                              <1> ;;[section .bss] ;nevermind
  4951                              <1> 
  4952                              <1> graphicstable: ;w type, dw datalocation, w locationx, w locationy, w selected, dw code
  4953 00004A12 00<rept>            <1> 	times 200h db 0
  4954                              <1> 	graphicstableend:
  4955                              <1> mousecolorbuf: ;where the gui under the mouse is stored
  4956 00004C12 00<rept>            <1> 	times 256 db 0
  4957                              <1> mcolorend:
  4958 00004D12 00                  <1> IFON times 1 db 0
  4959 00004D13 00<rept>            <1> IFTRUE times 100 db 0
  4960 00004D77 00<rept>            <1> BATCHPOS times 4 db 0
  4961 00004D7B 00                  <1> BATCHISON times 1 db 0
  4962 00004D7C 00                  <1> LOOPON times 1 db 0
  4963 00004D7D 00<rept>            <1> LOOPPOS	times 4 db 0
  4964 00004D81 00<rept>            <1> fileindex: times 200h db 0
  4965                              <1> fileindexend:
  4966 00004F81 00<rept>            <1> variables: 	times 500h db 0
  4967 00005481 00                  <1> varend: times 1 db 0
  4968 00005482 00<rept>            <1> buftxt: times 200h db 0
  4969 00005682 00<rept>            <1> buf2:	times 20 db 0
  4970 00005696 00                  <1> numbuf: times 1 db 0
  4971 00005697 00<rept>            <1> videobuf2 		times 0x12C0 db 0
  4972 00006957 00<rept>            <1> videobufend		times 200 db 0
  4973                              <1> 
  4974                              <1> VBEMODEBLOCK:
  4975 00006A1F 00<rept>            <1> vbesignature 		times 4 db 0	;VBE Signature
  4976 00006A23 00<rept>            <1> vbeversion  		times 2 db 0	;VBE Version
  4977 00006A25 00<rept>            <1> oemstringptr  		times 4 db 0	;Pointer to OEM String
  4978 00006A29 00<rept>            <1> capabilities 		times 4 db 0	;Capabilities of graphics cont.
  4979 00006A2D 00<rept>            <1> videomodeptr 		times 4 db 0	;Pointer to Video Mode List
  4980 00006A31 00<rept>            <1> totalmemory   		times 2 db 0	;number of 64Kb memory blocks
  4981 00006A33 00<rept>            <1> oemsoftwarerev  	times 2 db 0	;VBE implementation Software revision
  4982 00006A35 00<rept>            <1> oemvendornameptr 	times 4 db 0	;Pointer to Vendor Name String
  4983 00006A39 00<rept>            <1> oemproductnameptr 	times 4 db 0	;Pointer to Product Name String
  4984 00006A3D 00<rept>            <1> oemproductrevptr 	times 4 db 0	;Pointer to Product Revision String
  4985 00006A41 00<rept>            <1> reserved			times 222 db 0	;Reserved for VBE implementation scratch area
  4986 00006B1F 00<rept>            <1> oemdata 			times 256 db 0	;Data Area for OEM Strings
  4987                              <1> 
  4988                              <1> 
  4989                              <1> VBEMODEINFOBLOCK:
  4990                              <1> ;Mandatory information for all VBE revision
  4991 00006C1F 00<rept>            <1> modeattributes   	times 2 db 0	;Mode attributes
  4992 00006C21 00                  <1> winaattributes   	times 1 db 0	;Window A attributes
  4993 00006C22 00                  <1> winbattributes   	times 1 db 0	;Window B attributes
  4994 00006C23 00<rept>            <1> wingranularity   	times 2 db 0	;Window granularity
  4995 00006C25 00<rept>            <1> winsize          	times 2 db 0	;Window size
  4996 00006C27 00<rept>            <1> winasegment      	times 2 db 0	;Window A start segment
  4997 00006C29 00<rept>            <1> winbsegment      	times 2 db 0	;Window B start segment
  4998 00006C2B 00<rept>            <1> winfuncptr       	times 4 db 0	;pointer to window function
  4999 00006C2F 00<rept>            <1> bytesperscanline 	times 2 db 0	;Bytes per scan line
  5000                              <1> 
  5001                              <1> ;Mandatory information for VBE 1.2 and above
  5002 00006C31 00<rept>            <1> xresolution     	times 2 db 0	;Horizontal resolution in pixel or chars
  5003 00006C33 00<rept>            <1> yresolution	    	times 2 db 0	;Vertical resolution in pixel or chars
  5004 00006C35 00                  <1> xcharsize       	times 1 db 0	;Character cell width in pixel
  5005 00006C36 00                  <1> ycharsize       	times 1 db 0	;Character cell height in pixel
  5006 00006C37 00                  <1> numberofplanes  	times 1 db 0	;Number of memory planes
  5007 00006C38 00                  <1> bitsperpixel    	times 1 db 0	;Bits per pixel
  5008 00006C39 00                  <1> numberofbanks   	times 1 db 0	;Number of banks
  5009 00006C3A 00                  <1> memorymodel     	times 1 db 0	;Memory model type
  5010 00006C3B 00                  <1> banksize        	times 1 db 0	;Bank size in KB
  5011 00006C3C 00                  <1> numberofimagepages	times 1 db 0	;Number of images
  5012 00006C3D 00                  <1> reserved1       	times 1 db 0	;Reserved for page function
  5013                              <1> 
  5014                              <1> ;Direct Color fields (required for direct/6 and YUV/7 memory models)
  5015 00006C3E 00                  <1> redmasksize			times 1 db 0	;Size of direct color red mask in bits
  5016 00006C3F 00                  <1> redfieldposition	times 1 db 0	;Bit position of lsb of red bask
  5017 00006C40 00                  <1> greenmasksize   	times 1 db 0	;Size of direct color green mask in bits
  5018 00006C41 00                  <1> greenfieldposition	times 1 db 0	;Bit position of lsb of green bask
  5019 00006C42 00                  <1> bluemasksize		times 1 db 0	;Size of direct color blue mask in bits
  5020 00006C43 00                  <1> bluefieldposition	times 1 db 0	;Bit position of lsb of blue bask
  5021 00006C44 00                  <1> rsvdmasksize        times 1	db 0	;Size of direct color reserved mask in bits
  5022 00006C45 00                  <1> rsvdfieldposition	times 1	db 0	;Bit position of lsb of reserved bask
  5023 00006C46 00                  <1> directcolormodeinfo	times 1 db 0	;Direct color mode attributes
  5024                              <1> 
  5025                              <1> ;Mandatory information for VBE 2.0 and above
  5026 00006C47 00<rept>            <1> physbaseptr 		times 4 db 0	;Physical address for flat frame buffer
  5027 00006C4B 00<rept>            <1> offscreenmemoffset 	times 4 db 0	;Pointer to start of off screen memory
  5028 00006C4F 00<rept>            <1> offscreenmemsize 	times 2 db 0    ;Amount of off screen memory in 1Kb units
  5029 00006C51 00<rept>            <1> reserved2 			times 206 db 0  ;Remainder of ModeInfoBlock
  5030                              <1> endbss:
  5031                              <1> ;;[section .text]
  5032                                      %include 'files.asm'
  5033 00006D1F 00<rept>            <1> align 512,db 0
  5034                              <1> f0:
  5035 00006D1F <incbin>            <1> incbin "included/solleros.bmp"
  5036 0005CDE6 00<rept>            <1> align 512,db 0
  5037                              <1> f1:
  5038 0005CDE6 <incbin>            <1> incbin "included/solleros.txt"
  5039 0005CF97 00<rept>            <1> align 512,db 0
  5040                              <1> f2:
  5041 0005CF97 <incbin>            <1> incbin "included/tely"
  5042 0005D1BD 00<rept>            <1> align 512,db 0
  5043                              <1> f3:
  5044 0005D1BD <incbin>            <1> incbin "included/time"
  5045 0005D354 00<rept>            <1> align 512,db 0
  5046                              <1> f4:
  5047 0005D354 <incbin>            <1> incbin "included/tutorial.bat"
  5048 0005D778 00<rept>            <1> align 512,db 0
  5049                              <1> f5:
