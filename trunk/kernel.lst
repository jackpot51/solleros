     1                                  [BITS 16]
     2                                      %include 'source/menu.asm'
     3                              <1>     ; MENU.ASM
     4                              <1> menustart:	
     5 00000000 8CC8                <1> 	    mov ax, cs
     6 00000002 E90400              <1> 	    jmp mainindex	;;this command gives the solleros user the location of mainindex
     7 00000005 4A525300            <1> 	    db "JRS",0	;;this gives the bootloader a key to look for
     8                              <1> mainindex:
     9 00000009 E90000              <1> 	    jmp mainindexdn	;;this gives the size of the index
    10                              <1> 	    ;not needed;dw 0405h,progstart,batchprogend,fileindex,fileindexend,variables,varend,nwcmd,int30h,physbaseptr,0
    11                              <1> mainindexdn:
    12 0000000C 8ED8                <1> 	mov ds, ax
    13 0000000E 8EC0                <1> 	mov es, ax
    14 00000010 8ED0                <1> 	mov ss, ax
    15 00000012 880E[2B00]          <1> 	mov [DriveNumber], cl
    16 00000016 668916[2C00]        <1> 	mov [lbaad], edx
    17 0000001B B800A0              <1> 	mov ax, 0xA000
    18 0000001E 8EE8                <1> 	mov gs, ax
    19 00000020 B81200              <1> 	mov ax, 12h
    20 00000023 BB0000              <1> 	mov bx, 0
    21 00000026 CD10                <1> 	int 10h
    22 00000028 E90900              <1> 	jmp guiload
    23                              <1> 
    24 0000002B 00                  <1> DriveNumber db 0
    25 0000002C 00000000            <1> lbaad dd 0
    26                              <1> 	
    27 00000030 0000                <1> vesamode dw 0
    28 00000032 0000                <1> videomodecache dw 0
    29                              <1> 
    30                              <1> guiload:
    31 00000034 B8004F              <1> 	mov ax, 04F00h
    32 00000037 BF[E047]            <1> 	mov di, VBEMODEBLOCK
    33 0000003A CD10                <1> 	int 10h
    34 0000003C BE[0248]            <1> 	mov si, reserved
    35 0000003F 81EE0200            <1> 	sub si, 2
    36                              <1> findvideomodes:
    37 00000043 81C60200            <1> 	add si, 2
    38 00000047 8B0C                <1> 	mov cx, [si]
    39 00000049 81F9FFFF            <1> 	cmp cx, 0xFFFF
    40 0000004D 0F840A00            <1> 	je near nextvmode
    41 00000051 81FE[E048]          <1> 	cmp si, oemdata
    42 00000055 0F83CF00            <1> 	jae near guiload2	;;kill if no valid list is found
    43 00000059 EBE8                <1> 	jmp findvideomodes 	
    44                              <1> ;;debug,shows vmodes available
    45                              <1> nextvmode:
    46 0000005B 81EE0200            <1> 	sub si, 2
    47 0000005F 81FE[0248]          <1> 	cmp si, reserved
    48 00000063 0F82C100            <1> 	jb near guiload2
    49 00000067 8B0C                <1> 	mov cx, [si]
    50 00000069 81F9FFFF            <1> 	cmp cx, 0xFFFF
    51 0000006D 0F84EAFF            <1> 	je near nextvmode
    52 00000071 81C10040            <1> 	add cx, 0x4000 		;;Linear Frame Buffer
    53 00000075 B8014F              <1> 	mov ax, 04F01h
    54 00000078 BF[E049]            <1> 	mov di, VBEMODEINFOBLOCK
    55 0000007B 890E[3000]          <1> 	mov [vesamode], cx
    56 0000007F CD10                <1> 	int 10h
    57 00000081 A0[F949]            <1> 	mov al, [bitsperpixel]
    58 00000084 3C10                <1> 	cmp al, 16
    59 00000086 75D3                <1> 	jne nextvmode
    60 00000088 8936[3200]          <1> 	mov [videomodecache], si
    61 0000008C 80FC00              <1> 	cmp ah, 0
    62 0000008F 0F842200            <1> 	je near setvesamode
    63 00000093 EBC6                <1> 	jmp nextvmode
    64 00000095 0A0D49732074686973- <1> isthisvideook db 10,13,"Is this video mode OK?(y/n)",13,10,0
    65 0000009E 20766964656F206D6F- <1>
    66 000000A7 6465204F4B3F28792F- <1>
    67 000000B0 6E290D0A00          <1>
    68                              <1> setvesamode:
    69 000000B5 8B0E[F249]          <1> 	mov cx, [xresolution]
    70 000000B9 E8B800              <1> 	call decshow
    71 000000BC B078                <1> 	mov al, "x"
    72 000000BE E82001              <1> 	call char
    73 000000C1 8B0E[F449]          <1> 	mov cx, [yresolution]
    74 000000C5 E8AC00              <1> 	call decshow
    75 000000C8 B040                <1> 	mov al, "@"
    76 000000CA E81401              <1> 	call char
    77 000000CD 8A0E[F949]          <1> 	mov cl, [bitsperpixel]
    78 000000D1 E8A000              <1> 	call decshow
    79 000000D4 BE[9500]            <1> 	mov si, isthisvideook
    80 000000D7 E88200              <1> 	call printrm
    81 000000DA B80000              <1> 	mov ax, 0
    82 000000DD CD16                <1> 	int 16h
    83 000000DF 8B36[3200]          <1> 	mov si, [videomodecache]
    84 000000E3 3C79                <1> 	cmp al, "y"
    85 000000E5 0F8572FF            <1> 	jne near nextvmode
    86 000000E9 8B16[F249]          <1> 	mov dx, [xresolution]
    87 000000ED 8B0E[F449]          <1> 	mov cx, [yresolution]
    88 000000F1 8916[B935]          <1> 	mov [resolutionx], dx
    89 000000F5 890E[B735]          <1> 	mov [resolutiony], cx
    90 000000F9 01D2                <1> 	add dx, dx
    91 000000FB 8916[BB35]          <1> 	mov [resolutionx2], dx
    92 000000FF BA0000              <1> 	mov dx, 0
    93 00000102 B90000              <1> 	mov cx, 0
    94 00000105 B8024F              <1> 	mov ax, 04F02h
    95 00000108 8B1E[3000]          <1> 	mov bx, [vesamode]
    96 0000010C CD10                <1> 	int 10h		;;enter VESA mode
    97 0000010E C606[5B01]00        <1> 	mov byte [guinodo], 0
    98 00000113 6631C0              <1> 	xor eax, eax
    99 00000116 6631DB              <1> 	xor ebx, ebx
   100 00000119 6631C9              <1> 	xor ecx, ecx
   101 0000011C 6631D2              <1> 	xor edx, edx
   102 0000011F 6631F6              <1> 	xor esi, esi
   103 00000122 6631FF              <1> 	xor edi, edi	;;reset registers
   104 00000125 E91F01              <1> 	jmp pmode
   105                              <1> guiload2:
   106 00000128 B9E001              <1> 	mov cx, 480
   107 0000012B BA8002              <1> 	mov dx, 640
   108 0000012E 8916[B935]          <1> 	mov [resolutionx], dx
   109 00000132 01D2                <1> 	add dx, dx
   110 00000134 8916[BB35]          <1> 	mov [resolutionx2], dx
   111 00000138 890E[B735]          <1> 	mov [resolutiony], cx
   112 0000013C B81200              <1> 	mov ax, 12h
   113 0000013F BB0000              <1> 	mov bx, 0
   114 00000142 CD10                <1> 	int 10h
   115 00000144 C606[5B01]01        <1> 	mov byte [guinodo], 1
   116 00000149 6631DB              <1> 	xor ebx, ebx
   117 0000014C 6631C9              <1> 	xor ecx, ecx
   118 0000014F 6631D2              <1> 	xor edx, edx
   119 00000152 6631F6              <1> 	xor esi, esi
   120 00000155 6631FF              <1> 	xor edi, edi
   121 00000158 E9EC00              <1> 	jmp pmode
   122                              <1> ;;	jmp gui ;;test vesa
   123                              <1> 
   124 0000015B 00                  <1> guinodo db 0
   125                              <1> 
   126                              <1>     printrm:			; 'si' comes in with string address
   127 0000015C BB0700              <1> 	    mov bx,07		; write to display
   128 0000015F B40E                <1> 	    mov ah,0Eh		; screen function
   129 00000161 8A04                <1>     prs2:    mov al,[si]         ; get next character
   130 00000163 3C00                <1> 	    cmp al,0		; look for terminator 
   131 00000165 7405                <1>             je finpr2		; zero byte at end of string
   132 00000167 CD10                <1> 	    int 10h		; write character to screen.    
   133 00000169 46                  <1>      	    inc si	     	; move to next character
   134 0000016A EBF5                <1> 	    jmp prs2		; loop
   135 0000016C C3                  <1>     finpr2: ret
   136                              <1> 
   137 0000016D 0000000000          <1> dcnm db 0,0,0,0,0
   138 00000172 0000                <1> dcnmend db 0,0
   139                              <1> 
   140                              <1> 
   141                              <1> decshow:
   142 00000174 BE[6D01]            <1> 	mov si, dcnm
   143                              <1> decclear:
   144 00000177 B030                <1> 	mov al, "0"
   145 00000179 8804                <1> 	mov [si], al
   146 0000017B 46                  <1> 	inc si
   147 0000017C 81FE[7201]          <1> 	cmp si, dcnmend
   148 00000180 76F5                <1> 	jbe decclear
   149 00000182 4E                  <1> 	dec si
   150 00000183 E81500              <1> 	call convertrm
   151 00000186 BE[6D01]            <1> 	mov si, dcnm
   152                              <1> dectst:
   153 00000189 8A04                <1> 	mov al, [si]
   154 0000018B 46                  <1> 	inc si
   155 0000018C 81FE[7201]          <1> 	cmp si, dcnmend
   156 00000190 7704                <1> 	ja dectstend
   157 00000192 3C30                <1> 	cmp al, "0"
   158 00000194 76F3                <1> 	jbe dectst
   159                              <1> dectstend:
   160 00000196 4E                  <1> 	dec si
   161 00000197 E8C2FF              <1> 	call printrm
   162 0000019A C3                  <1> 	ret
   163                              <1> 	
   164                              <1> 	
   165                              <1> convertrm:
   166 0000019B 4E                  <1> 	dec si
   167 0000019C 89F3                <1> 	mov bx, si		;place to convert into must be in si, number to convert must be in cx
   168                              <1> cnvrtrm:
   169 0000019E 89DE                <1> 	mov si, bx
   170 000001A0 81EE0300            <1> 	sub si, 3
   171 000001A4 46                  <1> ten3rm:	inc si
   172 000001A5 81F9E803            <1> 	cmp cx, 1000
   173 000001A9 7208                <1> 	jb ten2rm
   174 000001AB 81E9E803            <1> 	sub cx, 1000
   175 000001AF FE04                <1> 	inc byte [si]
   176 000001B1 EBEB                <1> 	jmp cnvrtrm
   177 000001B3 46                  <1> ten2rm:	inc si
   178 000001B4 81F96400            <1> 	cmp cx, 100
   179 000001B8 7208                <1> 	jb ten1rm
   180 000001BA 81E96400            <1> 	sub cx, 100
   181 000001BE FE04                <1> 	inc byte [si]
   182 000001C0 EBDC                <1> 	jmp cnvrtrm
   183 000001C2 46                  <1> ten1rm:	inc si
   184 000001C3 81F90A00            <1> 	cmp cx, 10
   185 000001C7 7208                <1> 	jb ten0rm
   186 000001C9 81E90A00            <1> 	sub cx, 10
   187 000001CD FE04                <1> 	inc byte [si]
   188 000001CF EBCD                <1> 	jmp cnvrtrm
   189 000001D1 46                  <1> ten0rm:	inc si
   190 000001D2 81F90100            <1> 	cmp cx, 1
   191 000001D6 7208                <1> 	jb tendnrm
   192 000001D8 81E90100            <1> 	sub cx, 1
   193 000001DC FE04                <1> 	inc byte [si]
   194 000001DE EBBE                <1> 	jmp cnvrtrm
   195                              <1> tendnrm:
   196 000001E0 C3                  <1> 	ret
   197                              <1> 
   198                              <1> 
   199                              <1> 
   200                              <1> 
   201                              <1>     char: 		    ;char must be in al
   202 000001E1 BB0700              <1>            mov bx, 07
   203 000001E4 B40E                <1> 	   mov ah, 0Eh
   204 000001E6 CD10                <1> 	   int 10h
   205 000001E8 C3                  <1> 	    ret
   206                              <1> 
   207                              <1> 		shutdown:
   208 000001E9 E84B00              <1> 			call realmode	
   209 000001EC B80053              <1> 			MOV AX, 5300h	; Shuts down APM-Machines.
   210 000001EF 31DB                <1> 			XOR BX, BX	; Newer machines automatically
   211 000001F1 CD15                <1> 			INT 15h		; shut down
   212 000001F3 B80453              <1> 			MOV AX, 5304h
   213 000001F6 31DB                <1> 			XOR BX, BX
   214 000001F8 CD15                <1> 			INT 15h		; Interrupt 15h originally was
   215 000001FA B80153              <1> 			MOV AX, 5301h	; used for Cartridges (cassettes)
   216 000001FD 31DB                <1> 			XOR BX, BX	; but is still in use for
   217 000001FF CD15                <1> 			INT 15h		; diverse things
   218 00000201 B80753              <1> 			MOV AX, 5307h
   219 00000204 BB0100              <1> 			MOV BX, 1
   220 00000207 B90300              <1> 			MOV CX, 3
   221 0000020A CD15                <1> 			INT 15h
   222 0000020C CF                  <1> 			IRET
   223                              <1> 
   224                              <1> 	coldboot:
   225 0000020D E82700              <1> 			call realmode
   226 00000210 B84000              <1> 			MOV AX, 0040h
   227 00000213 8EC0                <1> 			MOV ES, AX
   228 00000215 26C70672000000      <1> 			MOV WORD [ES:00072h], 0h
   229 0000021C EA0000FFFF          <1> 			JMP 0FFFFh:0000h
   230 00000221 CF                  <1> 			IRET
   231                              <1> 
   232                              <1> 		warmboot:
   233 00000222 E81200              <1> 			call realmode
   234 00000225 B84000              <1> 			MOV AX, 0040h
   235 00000228 8EC0                <1> 			MOV ES, AX
   236 0000022A 26C70672003412      <1> 			MOV WORD [ES:00072h], 01234h
   237 00000231 EA0000FFFF          <1> 			JMP 0FFFFh:0000h
   238 00000236 CF                  <1> 			IRET
   239                              <1> 
   240                              <1> 
   241                              <1> realmode:
   242 00000237 0F20C0              <1>    mov eax, cr0
   243 0000023A 24FE                <1>    and al,0xFE     ; back to realmode
   244 0000023C 0F22C0              <1>    mov  cr0, eax   ; by toggling bit again
   245 0000023F FB                  <1>    sti
   246                              <1> 
   247 00000240 66B800000000        <1>    mov eax, 0
   248 00000246 C3                  <1>    ret
   249                                      %include 'source/pmode.asm'
   250                              <1> [BITS 16]
   251                              <1> ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
   252                              <1> ;	16-bit real mode
   253                              <1> ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
   254                              <1> 
   255                              <1> pmode:
   256 00000247 BA9200              <1> 	mov dx, 0x92
   257 0000024A EC                  <1> 	in al, dx	;;A20
   258 0000024B 0C02                <1> 	or al, 2
   259 0000024D EE                  <1> 	out dx, al
   260 0000024E 6631DB              <1> 	xor ebx,ebx
   261 00000251 8CCB                <1> 	mov bx,cs		; EBX=segment
   262 00000253 66C1E304            <1> 	shl ebx,4		;	<< 4
   263 00000257 67668D03            <1> 	lea eax,[ebx]		; EAX=linear address of segment base
   264 0000025B A3[1C07]            <1> 	mov [gdt2 + 2],ax
   265 0000025E A3[2407]            <1> 	mov [gdt3 + 2],ax
   266 00000261 66C1E810            <1> 	shr eax,16
   267 00000265 A2[1E07]            <1> 	mov [gdt2 + 4],al
   268 00000268 A2[2607]            <1> 	mov [gdt3 + 4],al
   269 0000026B 8826[2107]          <1> 	mov [gdt2 + 7],ah
   270 0000026F 8826[2907]          <1> 	mov [gdt3 + 7],ah
   271 00000273 66B8[00000000]      <1> 	mov eax, stack
   272 00000279 A3[2C07]            <1> 	mov [gdts + 2],ax
   273 0000027C 66C1E810            <1> 	shr eax,16
   274 00000280 A2[2E07]            <1> 	mov [gdts + 4],al
   275 00000283 8826[3107]          <1> 	mov [gdts + 7],ah
   276                              <1> ; fix up gdt and idt
   277 00000287 67668D83[0A070000]  <1> 	lea eax,[ebx + gdt]	; EAX=linear address of gdt
   278 0000028F 66A3[0007]          <1> 	mov [gdtr + 2],eax
   279 00000293 67668D83[37070000]  <1> 	lea eax,[ebx + idt]	; EAX=linear address of idt
   280 0000029B 66A3[0607]          <1> 	mov [idtr + 2],eax
   281 0000029F FA                  <1> 	cli
   282 000002A0 0F0116[FE06]        <1> 	lgdt [gdtr]
   283 000002A5 0F011E[0407]        <1> 	lidt [idtr]
   284 000002AA 66BB00000000        <1> 	mov ebx, 0
   285 000002B0 8CDB                <1> 	mov bx, ds
   286 000002B2 66891E[3103]        <1> 	mov [basecache], ebx
   287 000002B7 0F20C0              <1> 	mov eax,cr0
   288 000002BA 0C01                <1> 	or al,1
   289 000002BC 0F22C0              <1> 	mov cr0,eax
   290 000002BF EA[C402]1000        <1> 	jmp SYS_CODE_SEL:do_pm
   291                              <1> [BITS 32]
   292                              <1> do_pm:
   293 000002C4 66B81800            <1> 	mov ax, SYS_DATA_SEL
   294 000002C8 8ED8                <1> 	mov ds,ax
   295 000002CA 66B82000            <1> 	mov ax, STACK_SEL
   296 000002CE 8ED0                <1> 	mov ss, ax
   297 000002D0 BC00100000          <1> 	mov esp, 4096
   298 000002D5 90                  <1> 	nop
   299 000002D6 90                  <1> 	nop
   300 000002D7 66B81800            <1> 	mov ax, SYS_DATA_SEL
   301 000002DB 8EC0                <1> 	mov es,ax
   302 000002DD 8EE0                <1> 	mov fs,ax
   303 000002DF 8EE8                <1> 	mov gs,ax
   304 000002E1 B800000000          <1> 	mov eax, 0
   305 000002E6 BE[00000000]        <1> 	mov esi, bssstart
   306                              <1> clearkernelbuffers:
   307 000002EB 8906                <1> 	mov [esi], eax
   308 000002ED 81C604000000        <1> 	add esi, 4
   309 000002F3 81FE[0D300000]      <1> 	cmp esi, bssend
   310 000002F9 72F0                <1> 	jb clearkernelbuffers
   311                              <1> user1:
   312 000002FB 8B3D[084A0000]      <1> 	mov edi, [physbaseptr]
   313 00000301 A1[31030000]        <1> 	mov eax, [basecache]
   314 00000306 C1E004              <1> 	shl eax, 4
   315 00000309 29C7                <1> 	sub edi, eax
   316 0000030B 893D[084A0000]      <1> 	mov [physbaseptr], edi
   317 00000311 E85A100000          <1> 	call indexfiles
   318 00000316 803D[5B010000]00    <1> 	cmp byte [guinodo], 0
   319 0000031D 0F8405000000        <1> 	je near guido
   320 00000323 E988090000          <1> 	jmp os
   321                              <1> 	
   322                              <1> guido:
   323 00000328 E914230000          <1> 	jmp gui
   324                              <1> 	
   325 0000032D 00000000            <1> user2codepoint dw 0,0
   326 00000331 00000000            <1> basecache dd 0
   327                              <1> 
   328                              <1> unhand:	
   329                              <1> 	%assign i 0
   330                              <1> 	%rep 40
   331                              <1> 	cli
   332                              <1> 	mov byte [intprob], i
   333                              <1> 	jmp unhand2
   334                              <1> 	%assign i i+1
   335                              <1> 	%endrep
   336 00000335 FA                  <2>  cli
   337 00000336 C605[3A060000]00    <2>  mov byte [intprob], i
   338 0000033D E9FB010000          <2>  jmp unhand2
   339                              <2>  %assign i i+1
   340 00000342 FA                  <2>  cli
   341 00000343 C605[3A060000]01    <2>  mov byte [intprob], i
   342 0000034A E9EE010000          <2>  jmp unhand2
   343                              <2>  %assign i i+1
   344 0000034F FA                  <2>  cli
   345 00000350 C605[3A060000]02    <2>  mov byte [intprob], i
   346 00000357 E9E1010000          <2>  jmp unhand2
   347                              <2>  %assign i i+1
   348 0000035C FA                  <2>  cli
   349 0000035D C605[3A060000]03    <2>  mov byte [intprob], i
   350 00000364 E9D4010000          <2>  jmp unhand2
   351                              <2>  %assign i i+1
   352 00000369 FA                  <2>  cli
   353 0000036A C605[3A060000]04    <2>  mov byte [intprob], i
   354 00000371 E9C7010000          <2>  jmp unhand2
   355                              <2>  %assign i i+1
   356 00000376 FA                  <2>  cli
   357 00000377 C605[3A060000]05    <2>  mov byte [intprob], i
   358 0000037E E9BA010000          <2>  jmp unhand2
   359                              <2>  %assign i i+1
   360 00000383 FA                  <2>  cli
   361 00000384 C605[3A060000]06    <2>  mov byte [intprob], i
   362 0000038B E9AD010000          <2>  jmp unhand2
   363                              <2>  %assign i i+1
   364 00000390 FA                  <2>  cli
   365 00000391 C605[3A060000]07    <2>  mov byte [intprob], i
   366 00000398 E9A0010000          <2>  jmp unhand2
   367                              <2>  %assign i i+1
   368 0000039D FA                  <2>  cli
   369 0000039E C605[3A060000]08    <2>  mov byte [intprob], i
   370 000003A5 E993010000          <2>  jmp unhand2
   371                              <2>  %assign i i+1
   372 000003AA FA                  <2>  cli
   373 000003AB C605[3A060000]09    <2>  mov byte [intprob], i
   374 000003B2 E986010000          <2>  jmp unhand2
   375                              <2>  %assign i i+1
   376 000003B7 FA                  <2>  cli
   377 000003B8 C605[3A060000]0A    <2>  mov byte [intprob], i
   378 000003BF E979010000          <2>  jmp unhand2
   379                              <2>  %assign i i+1
   380 000003C4 FA                  <2>  cli
   381 000003C5 C605[3A060000]0B    <2>  mov byte [intprob], i
   382 000003CC E96C010000          <2>  jmp unhand2
   383                              <2>  %assign i i+1
   384 000003D1 FA                  <2>  cli
   385 000003D2 C605[3A060000]0C    <2>  mov byte [intprob], i
   386 000003D9 E95F010000          <2>  jmp unhand2
   387                              <2>  %assign i i+1
   388 000003DE FA                  <2>  cli
   389 000003DF C605[3A060000]0D    <2>  mov byte [intprob], i
   390 000003E6 E952010000          <2>  jmp unhand2
   391                              <2>  %assign i i+1
   392 000003EB FA                  <2>  cli
   393 000003EC C605[3A060000]0E    <2>  mov byte [intprob], i
   394 000003F3 E945010000          <2>  jmp unhand2
   395                              <2>  %assign i i+1
   396 000003F8 FA                  <2>  cli
   397 000003F9 C605[3A060000]0F    <2>  mov byte [intprob], i
   398 00000400 E938010000          <2>  jmp unhand2
   399                              <2>  %assign i i+1
   400 00000405 FA                  <2>  cli
   401 00000406 C605[3A060000]10    <2>  mov byte [intprob], i
   402 0000040D E92B010000          <2>  jmp unhand2
   403                              <2>  %assign i i+1
   404 00000412 FA                  <2>  cli
   405 00000413 C605[3A060000]11    <2>  mov byte [intprob], i
   406 0000041A E91E010000          <2>  jmp unhand2
   407                              <2>  %assign i i+1
   408 0000041F FA                  <2>  cli
   409 00000420 C605[3A060000]12    <2>  mov byte [intprob], i
   410 00000427 E911010000          <2>  jmp unhand2
   411                              <2>  %assign i i+1
   412 0000042C FA                  <2>  cli
   413 0000042D C605[3A060000]13    <2>  mov byte [intprob], i
   414 00000434 E904010000          <2>  jmp unhand2
   415                              <2>  %assign i i+1
   416 00000439 FA                  <2>  cli
   417 0000043A C605[3A060000]14    <2>  mov byte [intprob], i
   418 00000441 E9F7000000          <2>  jmp unhand2
   419                              <2>  %assign i i+1
   420 00000446 FA                  <2>  cli
   421 00000447 C605[3A060000]15    <2>  mov byte [intprob], i
   422 0000044E E9EA000000          <2>  jmp unhand2
   423                              <2>  %assign i i+1
   424 00000453 FA                  <2>  cli
   425 00000454 C605[3A060000]16    <2>  mov byte [intprob], i
   426 0000045B E9DD000000          <2>  jmp unhand2
   427                              <2>  %assign i i+1
   428 00000460 FA                  <2>  cli
   429 00000461 C605[3A060000]17    <2>  mov byte [intprob], i
   430 00000468 E9D0000000          <2>  jmp unhand2
   431                              <2>  %assign i i+1
   432 0000046D FA                  <2>  cli
   433 0000046E C605[3A060000]18    <2>  mov byte [intprob], i
   434 00000475 E9C3000000          <2>  jmp unhand2
   435                              <2>  %assign i i+1
   436 0000047A FA                  <2>  cli
   437 0000047B C605[3A060000]19    <2>  mov byte [intprob], i
   438 00000482 E9B6000000          <2>  jmp unhand2
   439                              <2>  %assign i i+1
   440 00000487 FA                  <2>  cli
   441 00000488 C605[3A060000]1A    <2>  mov byte [intprob], i
   442 0000048F E9A9000000          <2>  jmp unhand2
   443                              <2>  %assign i i+1
   444 00000494 FA                  <2>  cli
   445 00000495 C605[3A060000]1B    <2>  mov byte [intprob], i
   446 0000049C E99C000000          <2>  jmp unhand2
   447                              <2>  %assign i i+1
   448 000004A1 FA                  <2>  cli
   449 000004A2 C605[3A060000]1C    <2>  mov byte [intprob], i
   450 000004A9 E98F000000          <2>  jmp unhand2
   451                              <2>  %assign i i+1
   452 000004AE FA                  <2>  cli
   453 000004AF C605[3A060000]1D    <2>  mov byte [intprob], i
   454 000004B6 E982000000          <2>  jmp unhand2
   455                              <2>  %assign i i+1
   456 000004BB FA                  <2>  cli
   457 000004BC C605[3A060000]1E    <2>  mov byte [intprob], i
   458 000004C3 E975000000          <2>  jmp unhand2
   459                              <2>  %assign i i+1
   460 000004C8 FA                  <2>  cli
   461 000004C9 C605[3A060000]1F    <2>  mov byte [intprob], i
   462 000004D0 E968000000          <2>  jmp unhand2
   463                              <2>  %assign i i+1
   464 000004D5 FA                  <2>  cli
   465 000004D6 C605[3A060000]20    <2>  mov byte [intprob], i
   466 000004DD E95B000000          <2>  jmp unhand2
   467                              <2>  %assign i i+1
   468 000004E2 FA                  <2>  cli
   469 000004E3 C605[3A060000]21    <2>  mov byte [intprob], i
   470 000004EA E94E000000          <2>  jmp unhand2
   471                              <2>  %assign i i+1
   472 000004EF FA                  <2>  cli
   473 000004F0 C605[3A060000]22    <2>  mov byte [intprob], i
   474 000004F7 E941000000          <2>  jmp unhand2
   475                              <2>  %assign i i+1
   476 000004FC FA                  <2>  cli
   477 000004FD C605[3A060000]23    <2>  mov byte [intprob], i
   478 00000504 E934000000          <2>  jmp unhand2
   479                              <2>  %assign i i+1
   480 00000509 FA                  <2>  cli
   481 0000050A C605[3A060000]24    <2>  mov byte [intprob], i
   482 00000511 E927000000          <2>  jmp unhand2
   483                              <2>  %assign i i+1
   484 00000516 FA                  <2>  cli
   485 00000517 C605[3A060000]25    <2>  mov byte [intprob], i
   486 0000051E E91A000000          <2>  jmp unhand2
   487                              <2>  %assign i i+1
   488 00000523 FA                  <2>  cli
   489 00000524 C605[3A060000]26    <2>  mov byte [intprob], i
   490 0000052B E90D000000          <2>  jmp unhand2
   491                              <2>  %assign i i+1
   492 00000530 FA                  <2>  cli
   493 00000531 C605[3A060000]27    <2>  mov byte [intprob], i
   494 00000538 E900000000          <2>  jmp unhand2
   495                              <2>  %assign i i+1
   496                              <1> unhand2:
   497 0000053D 60                  <1> 	pushad
   498 0000053E C705[2D030000]0000- <1> 	mov dword [user2codepoint], 0
   499 00000546 0000                <1>
   500 00000548 89E6                <1> 	mov esi, esp
   501 0000054A 81C628000000        <1> 	add esi, ((unhndrgend - unhndrg)/13)*4
   502 00000550 8935[30060000]      <1> 	mov [esploc], esi
   503 00000556 BE[3B060000]        <1> 	mov esi, unhandmsg
   504 0000055B 8935[34060000]      <1> 	mov [esiloc], esi
   505 00000561 B900000000          <1> 	mov ecx, 0
   506 00000566 8A0D[3A060000]      <1> 	mov cl, [intprob]
   507 0000056C E85A000000          <1> 	call expdump
   508                              <1> dumpstack:
   509 00000571 8B35[30060000]      <1> 	mov esi, [esploc]
   510 00000577 39E6                <1> 	cmp esi, esp
   511 00000579 7216                <1> 	jb donedump
   512 0000057B 368B0E              <1> 	mov ecx, [ss:esi]
   513 0000057E 81EE04000000        <1> 	sub esi, 4
   514 00000584 8935[30060000]      <1> 	mov [esploc], esi
   515 0000058A E83C000000          <1> 	call expdump
   516 0000058F EBE0                <1> 	jmp dumpstack
   517                              <1> donedump:
   518 00000591 8B35[30060000]      <1> 	mov esi, [esploc]
   519 00000597 368B7C2420          <1> 	mov edi, [ss:esp + 32]
   520 0000059C 8B4FFC              <1> 	mov ecx, [edi - 4]
   521 0000059F E827000000          <1> 	call expdump
   522 000005A4 8B35[30060000]      <1> 	mov esi, [esploc]
   523 000005AA 368B7C2420          <1> 	mov edi, [ss:esp + 32]
   524 000005AF 8B0F                <1> 	mov ecx, [edi]
   525 000005B1 E815000000          <1> 	call expdump
   526 000005B6 8B35[30060000]      <1> 	mov esi, [esploc]
   527 000005BC 368B7C2420          <1> 	mov edi, [ss:esp + 32]
   528 000005C1 8B4F04              <1> 	mov ecx, [edi + 4]
   529 000005C4 E802000000          <1> 	call expdump
   530 000005C9 EBFE                <1> 	jmp $
   531                              <1> expdump:
   532 000005CB 8B35[34060000]      <1> 	mov esi, [esiloc]
   533 000005D1 89F7                <1> 	mov edi, esi
   534 000005D3 81C70D000000        <1> 	add edi, 13
   535 000005D9 81C604000000        <1> 	add esi, 4
   536 000005DF 893D[34060000]      <1> 	mov [esiloc], edi
   537 000005E5 4F                  <1> 	dec edi
   538 000005E6 E8350B0000          <1> 	call converthex
   539 000005EB 81EE04000000        <1> 	sub esi, 4
   540 000005F1 803D[9B270000]00    <1> 	cmp byte [guion], 0
   541 000005F8 0F8422000000        <1> 	je near expdumptext
   542 000005FE 668B0D[38060000]    <1> 	mov cx, [locunhand]
   543 00000605 668105[38060000]10- <1> 	add word [locunhand], 16
   544 0000060D 00                  <1>
   545 0000060E 66BA0200            <1> 	mov dx, 2
   546 00000612 66B80100            <1> 	mov ax, 1
   547 00000616 66BB0000            <1> 	mov bx, 0
   548 0000061A E8402B0000          <1> 	call showstring
   549 0000061F C3                  <1> 	ret
   550                              <1> expdumptext:
   551 00000620 E8E4040000          <1> 	call print
   552 00000625 BE[9D3F0000]        <1> 	mov esi, line
   553 0000062A E8DA040000          <1> 	call print
   554 0000062F C3                  <1> 	ret
   555 00000630 00000000            <1> esploc dd 0
   556 00000634 00000000            <1> esiloc dd 0
   557 00000638 0100                <1> locunhand dw 1
   558 0000063A 00                  <1> intprob db 0
   559                              <1> 	unhandmsg	
   560 0000063B 494E54203030303030- <1> 			db "INT 00000000",0
   561 00000644 30303000            <1>
   562                              <1> unhndrg:
   563 00000648 45464C3D3030303030- <1> 			db "EFL=00000000",0
   564 00000651 30303000            <1>
   565 00000655 43533A3D3030303030- <1> 			db "CS:=00000000",0
   566 0000065E 30303000            <1>
   567 00000662 4549503D3030303030- <1> 			db "EIP=00000000",0
   568 0000066B 30303000            <1>
   569 0000066F 4541583D3030303030- <1> 			db "EAX=00000000",0
   570 00000678 30303000            <1>
   571 0000067C 4543583D3030303030- <1> 			db "ECX=00000000",0
   572 00000685 30303000            <1>
   573 00000689 4544583D3030303030- <1> 			db "EDX=00000000",0
   574 00000692 30303000            <1>
   575 00000696 4542583D3030303030- <1> 			db "EBX=00000000",0
   576 0000069F 30303000            <1>
   577 000006A3 4553503D3030303030- <1> 			db "ESP=00000000",0
   578 000006AC 30303000            <1>
   579 000006B0 4542503D3030303030- <1> 			db "EBP=00000000",0
   580 000006B9 30303000            <1>
   581 000006BD 4553493D3030303030- <1> 			db "ESI=00000000",0
   582 000006C6 30303000            <1>
   583 000006CA 4544493D3030303030- <1> unhndrgend:	db "EDI=00000000",0
   584 000006D3 30303000            <1>
   585 000006D7 434D443D3030303030- <1> 			db "CMD=00000000",0
   586 000006E0 30303000            <1>
   587 000006E4 434D443D3030303030- <1> 			db "CMD=00000000",0
   588 000006ED 30303000            <1>
   589 000006F1 434D443D3030303030- <1> 			db "CMD=00000000",0
   590 000006FA 30303000            <1>
   591                              <1> unhandmsgend:
   592                              <1> 
   593                              <1> [BITS 16]
   594                              <1> 
   595                              <1> ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
   596                              <1> ;	16-bit limit/32-bit linear base address of GDT and IDT
   597                              <1> ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
   598 000006FE 2700                <1> gdtr:	dw gdt_end - gdt - 1	; GDT limit
   599 00000700 [0A070000]          <1> 	dd gdt			; linear, physical address of GDT
   600                              <1> 
   601 00000704 8701                <1> idtr:	dw idt_end - idt - 1	; IDT limit
   602 00000706 [37070000]          <1> 	dd idt			; linear, physical address of IDT
   603                              <1> 
   604                              <1> 
   605 0000070A 0000                <1> gdt:	dw 0			; limit 15:0
   606 0000070C 0000                <1> 	dw 0			; base 15:0
   607 0000070E 00                  <1> 	db 0			; base 23:16
   608 0000070F 00                  <1> 	db 0			; type
   609 00000710 00                  <1> 	db 0			; limit 19:16, flags
   610 00000711 00                  <1> 	db 0			; base 31:24
   611                              <1> ; linear data segment descriptor
   612                              <1> LINEAR_SEL	equ	$-gdt
   613 00000712 FFFF                <1> 	dw 0xFFFF		; limit 0xFFFFF
   614 00000714 0000                <1> 	dw 0			; base for this one is always 0
   615 00000716 00                  <1> 	db 0
   616 00000717 92                  <1> 	db 0x92			; present, ring 0, data, expand-up, writable
   617 00000718 CF                  <1> 	db 0xCF			; page-granular, 32-bit
   618 00000719 00                  <1> 	db 0
   619                              <1> ; code segment descriptor
   620                              <1> SYS_CODE_SEL	equ	$-gdt
   621 0000071A FFFF                <1> gdt2:	dw 0xFFFF
   622 0000071C 0000                <1> 	dw 0			; (base gets set above)
   623 0000071E 00                  <1> 	db 0
   624 0000071F 9A                  <1> 	db 0x9A			; present, ring 0, code, non-conforming, readable
   625 00000720 CF                  <1> 	db 0xCF
   626 00000721 00                  <1> 	db 0
   627                              <1> ; data segment descriptor
   628                              <1> SYS_DATA_SEL	equ	$-gdt
   629 00000722 FFFF                <1> gdt3:	dw 0xFFFF
   630 00000724 0000                <1> 	dw 0			; (base gets set above)
   631 00000726 00                  <1> 	db 0
   632 00000727 92                  <1> 	db 0x92			; present, ring 0, data, expand-up, writable
   633 00000728 CF                  <1> 	db 0xCF
   634 00000729 00                  <1> 	db 0
   635                              <1> STACK_SEL	equ	$-gdt
   636 0000072A 0100                <1> gdts:	dw 1
   637 0000072C 0000                <1> 	dw 0			; (base gets set above)
   638 0000072E 00                  <1> 	db 0
   639 0000072F 92                  <1> 	db 0x92			; present, ring 0, data, expand-up, writable
   640 00000730 C0                  <1> 	db 0xC0
   641 00000731 00                  <1> 	db 0
   642                              <1> gdt_end:
   643                              <1> ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
   644                              <1> ;	interrupt descriptor table (IDT)
   645                              <1> ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
   646                              <1> ; 32 reserved interrupts:
   647 00000732 494454              <1> db "IDT"
   648 00000735 [3503]              <1> dw unhand
   649                              <1> idt:	
   650                              <1> %assign i 0
   651                              <1> %rep    48
   652                              <1>         dw unhand + i*13,SYS_CODE_SEL,0x8E00,0
   653                              <1> %assign i i+1 
   654                              <1> %endrep
   655 00000737 [3503]1000008E0000  <2>  dw unhand + i*13,SYS_CODE_SEL,0x8E00,0
   656                              <2> %assign i i+1
   657 0000073F [4203]1000008E0000  <2>  dw unhand + i*13,SYS_CODE_SEL,0x8E00,0
   658                              <2> %assign i i+1
   659 00000747 [4F03]1000008E0000  <2>  dw unhand + i*13,SYS_CODE_SEL,0x8E00,0
   660                              <2> %assign i i+1
   661 0000074F [5C03]1000008E0000  <2>  dw unhand + i*13,SYS_CODE_SEL,0x8E00,0
   662                              <2> %assign i i+1
   663 00000757 [6903]1000008E0000  <2>  dw unhand + i*13,SYS_CODE_SEL,0x8E00,0
   664                              <2> %assign i i+1
   665 0000075F [7603]1000008E0000  <2>  dw unhand + i*13,SYS_CODE_SEL,0x8E00,0
   666                              <2> %assign i i+1
   667 00000767 [8303]1000008E0000  <2>  dw unhand + i*13,SYS_CODE_SEL,0x8E00,0
   668                              <2> %assign i i+1
   669 0000076F [9003]1000008E0000  <2>  dw unhand + i*13,SYS_CODE_SEL,0x8E00,0
   670                              <2> %assign i i+1
   671 00000777 [9D03]1000008E0000  <2>  dw unhand + i*13,SYS_CODE_SEL,0x8E00,0
   672                              <2> %assign i i+1
   673 0000077F [AA03]1000008E0000  <2>  dw unhand + i*13,SYS_CODE_SEL,0x8E00,0
   674                              <2> %assign i i+1
   675 00000787 [B703]1000008E0000  <2>  dw unhand + i*13,SYS_CODE_SEL,0x8E00,0
   676                              <2> %assign i i+1
   677 0000078F [C403]1000008E0000  <2>  dw unhand + i*13,SYS_CODE_SEL,0x8E00,0
   678                              <2> %assign i i+1
   679 00000797 [D103]1000008E0000  <2>  dw unhand + i*13,SYS_CODE_SEL,0x8E00,0
   680                              <2> %assign i i+1
   681 0000079F [DE03]1000008E0000  <2>  dw unhand + i*13,SYS_CODE_SEL,0x8E00,0
   682                              <2> %assign i i+1
   683 000007A7 [EB03]1000008E0000  <2>  dw unhand + i*13,SYS_CODE_SEL,0x8E00,0
   684                              <2> %assign i i+1
   685 000007AF [F803]1000008E0000  <2>  dw unhand + i*13,SYS_CODE_SEL,0x8E00,0
   686                              <2> %assign i i+1
   687 000007B7 [0504]1000008E0000  <2>  dw unhand + i*13,SYS_CODE_SEL,0x8E00,0
   688                              <2> %assign i i+1
   689 000007BF [1204]1000008E0000  <2>  dw unhand + i*13,SYS_CODE_SEL,0x8E00,0
   690                              <2> %assign i i+1
   691 000007C7 [1F04]1000008E0000  <2>  dw unhand + i*13,SYS_CODE_SEL,0x8E00,0
   692                              <2> %assign i i+1
   693 000007CF [2C04]1000008E0000  <2>  dw unhand + i*13,SYS_CODE_SEL,0x8E00,0
   694                              <2> %assign i i+1
   695 000007D7 [3904]1000008E0000  <2>  dw unhand + i*13,SYS_CODE_SEL,0x8E00,0
   696                              <2> %assign i i+1
   697 000007DF [4604]1000008E0000  <2>  dw unhand + i*13,SYS_CODE_SEL,0x8E00,0
   698                              <2> %assign i i+1
   699 000007E7 [5304]1000008E0000  <2>  dw unhand + i*13,SYS_CODE_SEL,0x8E00,0
   700                              <2> %assign i i+1
   701 000007EF [6004]1000008E0000  <2>  dw unhand + i*13,SYS_CODE_SEL,0x8E00,0
   702                              <2> %assign i i+1
   703 000007F7 [6D04]1000008E0000  <2>  dw unhand + i*13,SYS_CODE_SEL,0x8E00,0
   704                              <2> %assign i i+1
   705 000007FF [7A04]1000008E0000  <2>  dw unhand + i*13,SYS_CODE_SEL,0x8E00,0
   706                              <2> %assign i i+1
   707 00000807 [8704]1000008E0000  <2>  dw unhand + i*13,SYS_CODE_SEL,0x8E00,0
   708                              <2> %assign i i+1
   709 0000080F [9404]1000008E0000  <2>  dw unhand + i*13,SYS_CODE_SEL,0x8E00,0
   710                              <2> %assign i i+1
   711 00000817 [A104]1000008E0000  <2>  dw unhand + i*13,SYS_CODE_SEL,0x8E00,0
   712                              <2> %assign i i+1
   713 0000081F [AE04]1000008E0000  <2>  dw unhand + i*13,SYS_CODE_SEL,0x8E00,0
   714                              <2> %assign i i+1
   715 00000827 [BB04]1000008E0000  <2>  dw unhand + i*13,SYS_CODE_SEL,0x8E00,0
   716                              <2> %assign i i+1
   717 0000082F [C804]1000008E0000  <2>  dw unhand + i*13,SYS_CODE_SEL,0x8E00,0
   718                              <2> %assign i i+1
   719 00000837 [D504]1000008E0000  <2>  dw unhand + i*13,SYS_CODE_SEL,0x8E00,0
   720                              <2> %assign i i+1
   721 0000083F [E204]1000008E0000  <2>  dw unhand + i*13,SYS_CODE_SEL,0x8E00,0
   722                              <2> %assign i i+1
   723 00000847 [EF04]1000008E0000  <2>  dw unhand + i*13,SYS_CODE_SEL,0x8E00,0
   724                              <2> %assign i i+1
   725 0000084F [FC04]1000008E0000  <2>  dw unhand + i*13,SYS_CODE_SEL,0x8E00,0
   726                              <2> %assign i i+1
   727 00000857 [0905]1000008E0000  <2>  dw unhand + i*13,SYS_CODE_SEL,0x8E00,0
   728                              <2> %assign i i+1
   729 0000085F [1605]1000008E0000  <2>  dw unhand + i*13,SYS_CODE_SEL,0x8E00,0
   730                              <2> %assign i i+1
   731 00000867 [2305]1000008E0000  <2>  dw unhand + i*13,SYS_CODE_SEL,0x8E00,0
   732                              <2> %assign i i+1
   733 0000086F [3005]1000008E0000  <2>  dw unhand + i*13,SYS_CODE_SEL,0x8E00,0
   734                              <2> %assign i i+1
   735 00000877 [3D05]1000008E0000  <2>  dw unhand + i*13,SYS_CODE_SEL,0x8E00,0
   736                              <2> %assign i i+1
   737 0000087F [4A05]1000008E0000  <2>  dw unhand + i*13,SYS_CODE_SEL,0x8E00,0
   738                              <2> %assign i i+1
   739 00000887 [5705]1000008E0000  <2>  dw unhand + i*13,SYS_CODE_SEL,0x8E00,0
   740                              <2> %assign i i+1
   741 0000088F [6405]1000008E0000  <2>  dw unhand + i*13,SYS_CODE_SEL,0x8E00,0
   742                              <2> %assign i i+1
   743 00000897 [7105]1000008E0000  <2>  dw unhand + i*13,SYS_CODE_SEL,0x8E00,0
   744                              <2> %assign i i+1
   745 0000089F [7E05]1000008E0000  <2>  dw unhand + i*13,SYS_CODE_SEL,0x8E00,0
   746                              <2> %assign i i+1
   747 000008A7 [8B05]1000008E0000  <2>  dw unhand + i*13,SYS_CODE_SEL,0x8E00,0
   748                              <2> %assign i i+1
   749 000008AF [9805]1000008E0000  <2>  dw unhand + i*13,SYS_CODE_SEL,0x8E00,0
   750                              <2> %assign i i+1
   751                              <1> ;;INT 30h for os use and 3rd party use:
   752 000008B7 [BF08]1000008E0000  <1> 	dw newints,SYS_CODE_SEL,0x8E00,0
   753                              <1> idt_end:
   754                              <1> [BITS 32]
   755                                  [BITS 32]
   756                                      %include 'source/ints.asm'
   757                              <1> newints:	;;for great justice
   758 000008BF 80FC00              <1> 	cmp ah, 0		;;originally 0
   759 000008C2 0F8449000000        <1> 	je near intx0   ;;0=kills app
   760 000008C8 80FC01              <1> 	cmp ah, 1		;;originally 1
   761 000008CB 0F8445000000        <1> 	je near intx1   ;;3=print string
   762 000008D1 80FC02              <1> 	cmp ah, 2		;;originally 2
   763 000008D4 0F8442000000        <1> 	je near intx2	;;4=read string
   764 000008DA 80FC03              <1> 	cmp ah, 3		;;originally 3
   765 000008DD 0F843F000000        <1> 	je near intx3	;;6=clear screen
   766 000008E3 80FC04              <1> 	cmp ah, 4		;;originally 4
   767 000008E6 0F843C000000        <1> 	je near intx4	;;5=read and print string
   768 000008EC 80FC05              <1> 	cmp ah, 5		;;originally 5		
   769 000008EF 0F8439000000        <1> 	je near intx5	;;2=get char
   770 000008F5 80FC06              <1> 	cmp ah, 6		;;originally 6
   771 000008F8 0F8436000000        <1> 	je near intx6	;;1=print char
   772 000008FE 80FC07              <1> 	cmp ah, 7
   773 00000901 0F8433000000        <1> 	je near intx7	;;read file
   774 00000907 80FC0A              <1> 	cmp ah, 10
   775 0000090A 0F8430000000        <1> 	je near intx10	;;create thread
   776 00000910 C3                  <1> 	ret
   777                              <1> 	
   778                              <1> intx0:
   779 00000911 E9AB040000          <1> 	jmp nwcmd
   780                              <1> intx1:
   781 00000916 E8F6010000          <1> 	call int303
   782 0000091B C3                  <1> 	ret
   783                              <1> intx2:
   784 0000091C E80D020000          <1> 	call int304
   785 00000921 C3                  <1> 	ret
   786                              <1> intx3:
   787 00000922 E88E020000          <1> 	call int306
   788 00000927 C3                  <1> 	ret
   789                              <1> intx4:
   790 00000928 E825020000          <1> 	call int305
   791 0000092D C3                  <1> 	ret
   792                              <1> intx5:
   793 0000092E E8A6010000          <1> 	call int302
   794 00000933 C3                  <1> 	ret
   795                              <1> intx6:
   796 00000934 E812000000          <1> 	call int301
   797 00000939 C3                  <1> 	ret
   798                              <1> intx7:
   799 0000093A E84F340000          <1> 	call loadfile
   800 0000093F C3                  <1> 	ret
   801                              <1> intx10:
   802                              <1> ;	call thread
   803 00000940 C3                  <1> 	ret
   804                              <1> 	
   805 00000941 0000                <1> linebeginpos dw 0
   806 00000943 0000                <1> videobufpos: dw 0
   807 00000945 0000                <1> charpos db 0,0
   808 00000947 A01E                <1> charxy db 160,30
   809 00000949 0000                <1> charbuf dw 0
   810                              <1> 
   811                              <1> int301:	;;print char, char in al, modifier in bl, will run videobuf2copy if called as is
   812 0000094B E807000000          <1> 	call int301prnt
   813 00000950 E9A4020000          <1> 	jmp termcopy
   814 00000955 00                  <1> termguion db 0
   815 00000956 00                  <1> termcopyon db 0
   816                              <1> int301prnt:
   817 00000957 88DC                <1> 	mov ah, bl
   818 00000959 66A3[49090000]      <1> 	mov [charbuf], ax
   819 0000095F BB00000000          <1> 	mov ebx, 0
   820 00000964 668B1D[43090000]    <1> 	mov bx, [videobufpos]
   821 0000096B BF[851C0000]        <1> 	mov edi, videobuf2
   822 00000970 01DF                <1> 	add edi, ebx
   823 00000972 BA00000000          <1> 	mov edx, 0
   824 00000977 668B15[45090000]    <1> 	mov dx, [charpos]
   825 0000097E B900000000          <1> 	mov ecx, 0
   826 00000983 668B0D[47090000]    <1> 	mov cx, [charxy]
   827 0000098A 3C0D                <1> 	cmp al, 13
   828 0000098C 0F844B000000        <1> 	je near int301cr
   829 00000992 3C0A                <1> 	cmp al, 10
   830 00000994 0F8479000000        <1> 	je near int301nl
   831 0000099A 3C08                <1> 	cmp al, 8
   832 0000099C 0F8452000000        <1> 	je near int301bs
   833 000009A2 668907              <1> 	mov [edi], ax
   834 000009A5 81C702000000        <1> 	add edi, 2
   835 000009AB 80C202              <1> 	add dl, 2
   836                              <1> donecrnl:
   837 000009AE 38CA                <1> 	cmp dl, cl
   838 000009B0 0F838E000000        <1> 	jae near int301eol
   839                              <1> doneeol:
   840 000009B6 38EE                <1> 	cmp dh, ch
   841 000009B8 0F83A4000000        <1> 	jae near int301scr	
   842                              <1> donescr:
   843 000009BE 89FB                <1> 	mov ebx, edi
   844 000009C0 81EB[851C0000]      <1> 	sub ebx, videobuf2
   845 000009C6 66891D[43090000]    <1> 	mov [videobufpos], bx
   846 000009CD 668915[45090000]    <1> 	mov [charpos], dx
   847 000009D4 66A1[49090000]      <1> 	mov ax, [charbuf]
   848 000009DA 88E3                <1> 	mov bl, ah
   849 000009DC C3                  <1> 	ret
   850                              <1> 	
   851                              <1> 	int301cr:
   852 000009DD B200                <1> 		mov dl, 0
   853 000009DF BB00000000          <1> 		mov ebx, 0
   854 000009E4 BF[851C0000]        <1> 		mov edi, videobuf2
   855 000009E9 668B1D[41090000]    <1> 		mov bx, [linebeginpos]
   856 000009F0 01DF                <1> 		add edi, ebx
   857 000009F2 EBBA                <1> 		jmp donecrnl
   858                              <1> 			
   859                              <1> 	int301bs:
   860 000009F4 80FA00              <1> 		cmp dl, 0
   861 000009F7 740F                <1> 		je int301backline
   862                              <1> 	int301nobmr:
   863 000009F9 80EA02              <1> 		sub dl, 2
   864 000009FC 66B80000            <1> 		mov ax, 0
   865 00000A00 81EF02000000        <1> 		sub edi, 2
   866 00000A06 EBA6                <1> 		jmp donecrnl
   867                              <1> 	int301backline:
   868 00000A08 88CA                <1> 		mov dl, cl
   869 00000A0A 80FE00              <1> 		cmp dh, 0
   870 00000A0D 74EA                <1> 		je int301nobmr
   871 00000A0F FECE                <1> 		dec dh
   872 00000A11 EBE6                <1> 		jmp int301nobmr
   873                              <1> 		
   874                              <1> 	int301nl:
   875 00000A13 FEC6                <1> 		inc dh
   876 00000A15 BB00000000          <1> 		mov ebx, 0
   877 00000A1A 88CB                <1> 		mov bl, cl
   878 00000A1C BF[851C0000]        <1> 		mov edi, videobuf2
   879 00000A21 66031D[43090000]    <1> 		add bx, [videobufpos]
   880 00000A28 01DF                <1> 		add edi, ebx
   881 00000A2A BB00000000          <1> 		mov ebx, 0
   882 00000A2F 88CB                <1> 		mov bl, cl
   883 00000A31 66031D[41090000]    <1> 		add bx, [linebeginpos]
   884 00000A38 66891D[41090000]    <1> 		mov [linebeginpos], bx
   885 00000A3F E96AFFFFFF          <1> 		jmp donecrnl
   886                              <1> 		
   887                              <1> 	int301eol:
   888 00000A44 B200                <1> 		mov dl, 0
   889 00000A46 FEC6                <1> 		inc dh
   890 00000A48 BB00000000          <1> 		mov ebx, 0
   891 00000A4D 88CB                <1> 		mov bl, cl
   892 00000A4F 66031D[41090000]    <1> 		add bx, [linebeginpos]
   893 00000A56 66891D[41090000]    <1> 		mov [linebeginpos], bx
   894 00000A5D E954FFFFFF          <1> 		jmp doneeol
   895                              <1> 		
   896                              <1> 	int301scr:
   897 00000A62 FECE                <1> 		dec dh
   898 00000A64 BF[851C0000]        <1> 		mov edi, videobuf2
   899 00000A69 BB00000000          <1> 		mov ebx, 0
   900 00000A6E 88CB                <1> 		mov bl, cl
   901 00000A70 01FB                <1> 		add ebx, edi
   902                              <1> 	intscrollloop:
   903 00000A72 668B03              <1> 		mov ax, [ebx]
   904 00000A75 668907              <1> 		mov [edi], ax
   905 00000A78 81C702000000        <1> 		add edi, 2
   906 00000A7E 81C302000000        <1> 		add ebx, 2
   907 00000A84 80E902              <1> 		sub cl, 2
   908 00000A87 80F900              <1> 		cmp cl, 0
   909 00000A8A 75E6                <1> 		jne intscrollloop
   910 00000A8C 8A0D[47090000]      <1> 		mov cl, [charxy]
   911 00000A92 FECD                <1> 		dec ch
   912 00000A94 80FD01              <1> 		cmp ch, 1
   913 00000A97 77D9                <1> 		ja intscrollloop
   914 00000A99 66B80000            <1> 		mov ax, 0
   915 00000A9D 81EF[851C0000]      <1> 		sub edi, videobuf2
   916 00000AA3 66893D[41090000]    <1> 		mov [linebeginpos], di
   917 00000AAA 81C7[851C0000]      <1> 		add edi, videobuf2
   918 00000AB0 89FB                <1> 		mov ebx, edi
   919                              <1> 	intloopclear:
   920 00000AB2 668903              <1> 		mov [ebx], ax
   921 00000AB5 81C302000000        <1> 		add ebx, 2
   922 00000ABB 80E902              <1> 		sub cl, 2
   923 00000ABE 80F900              <1> 		cmp cl, 0
   924 00000AC1 75EF                <1> 		jne intloopclear
   925 00000AC3 FECD                <1> 		dec ch
   926 00000AC5 80FD00              <1> 		cmp ch, 0
   927 00000AC8 75E8                <1> 		jne intloopclear
   928 00000ACA 668B0D[47090000]    <1> 		mov cx, [charxy]
   929 00000AD1 E9E8FEFFFF          <1> 		jmp donescr
   930                              <1> 		
   931                              <1> 		
   932 00000AD6 0000                <1> lastkey db 0,0
   933 00000AD8 00                  <1> trans db 0
   934                              <1> 
   935                              <1> 	int302:		;;get char, if al is 0, wait for key
   936 00000AD9 A2[D80A0000]        <1> 		mov [trans], al
   937                              <1> 	transcheck:
   938 00000ADE E879170000          <1> 		call guistartin
   939 00000AE3 8A3D[D80A0000]      <1> 		mov bh, [trans]
   940 00000AE9 66A1[D60A0000]      <1> 		mov ax, [lastkey]
   941 00000AEF 80FC1C              <1> 		cmp ah, 1Ch
   942 00000AF2 740C                <1> 		je int302enter
   943 00000AF4 08C7                <1> 		or bh, al
   944 00000AF6 80FF00              <1> 		cmp bh, 0
   945 00000AF9 74E3                <1> 		je transcheck
   946 00000AFB E907000000          <1> 		jmp int302end
   947                              <1> 	int302enter:
   948 00000B00 B00D                <1> 		mov al, 13
   949 00000B02 E900000000          <1> 		jmp int302end
   950                              <1> 	int302end:
   951 00000B07 C3                  <1> 		ret
   952                              <1> 	
   953 00000B08 00                  <1> endkey303 db 0
   954                              <1>     print:
   955 00000B09 66B80000            <1> 		mov ax, 0
   956 00000B0D 66BB0700            <1> 		mov bx, 7
   957                              <1> 	int303:	;;print line, al=last key,bl=modifier, esi=buffer
   958 00000B11 A2[080B0000]        <1> 		mov [endkey303], al
   959                              <1> 	int303b:
   960 00000B16 8A06                <1> 		mov al, [esi]
   961 00000B18 3A05[080B0000]      <1> 		cmp al, [endkey303]
   962 00000B1E 7408                <1> 		je doneint303
   963 00000B20 E832FEFFFF          <1> 		call int301prnt
   964 00000B25 46                  <1> 		inc esi
   965 00000B26 EBEE                <1> 		jmp int303b
   966                              <1> 	doneint303:
   967 00000B28 E9CC000000          <1> 		jmp termcopy
   968                              <1> 	
   969 00000B2D 00                  <1> endkey304 db 0
   970                              <1> 	int304:	;;get line, al=last key, esi = buffer
   971 00000B2E A2[2D0B0000]        <1> 		mov [endkey304], al
   972                              <1> 	int304b:
   973 00000B33 56                  <1> 		push esi
   974 00000B34 B000                <1> 		mov al, 0
   975 00000B36 E89EFFFFFF          <1> 		call int302
   976 00000B3B 5E                  <1> 		pop esi
   977 00000B3C 8806                <1> 		mov [esi], al
   978 00000B3E 46                  <1> 		inc esi
   979 00000B3F 3A05[2D0B0000]      <1> 		cmp al, [endkey304]
   980 00000B45 75EC                <1> 		jne int304b
   981 00000B47 4E                  <1> 		dec esi
   982 00000B48 C60600              <1> 		mov byte [esi], 0
   983 00000B4B C3                  <1> 	ret
   984                              <1> 	
   985 00000B4C 00                  <1> endkey305 db 0
   986 00000B4D 00                  <1> modkey305 db 0
   987 00000B4E 00000000            <1> firstesi305 dd 0
   988                              <1> 	int305:	;;print and get line, al=last key, bl=modifier, esi=buffer
   989 00000B52 A2[4C0B0000]        <1> 		mov [endkey305], al
   990 00000B57 881D[4D0B0000]      <1> 		mov [modkey305], bl
   991 00000B5D 8935[4E0B0000]      <1> 		mov [firstesi305], esi
   992                              <1> 	int305b:
   993 00000B63 56                  <1> 		push esi
   994 00000B64 B000                <1> 		mov al, 0
   995 00000B66 E86EFFFFFF          <1> 		call int302
   996 00000B6B 5E                  <1> 		pop esi
   997 00000B6C 3C08                <1> 		cmp al, 8
   998 00000B6E 0F841D000000        <1> 		je near int305bscheck
   999 00000B74 8806                <1> 		mov [esi], al
  1000 00000B76 46                  <1> 		inc esi
  1001                              <1> 	bscheckequal:
  1002 00000B77 8A1D[4D0B0000]      <1> 		mov bl, [modkey305]
  1003 00000B7D E8C9FDFFFF          <1> 		call int301
  1004 00000B82 8A25[4C0B0000]      <1> 		mov ah, [endkey305]
  1005 00000B88 38E0                <1> 		cmp al, ah
  1006 00000B8A 75D7                <1> 		jne int305b
  1007 00000B8C 4E                  <1> 		dec esi
  1008 00000B8D C60600              <1> 		mov byte [esi], 0
  1009 00000B90 C3                  <1> 		ret
  1010                              <1> 	
  1011                              <1> 	int305bscheck:
  1012 00000B91 3B35[4E0B0000]      <1> 		cmp esi, [firstesi305]
  1013 00000B97 7702                <1> 		ja goodbscheck
  1014 00000B99 EBC8                <1> 		jmp int305b
  1015                              <1> 	goodbscheck:
  1016 00000B9B 4E                  <1> 		dec esi
  1017 00000B9C C60600              <1> 		mov byte [esi], 0
  1018 00000B9F 8A1D[4D0B0000]      <1> 		mov bl, [modkey305]
  1019 00000BA5 E8A1FDFFFF          <1> 		call int301
  1020 00000BAA B020                <1> 		mov al, " "
  1021 00000BAC E89AFDFFFF          <1> 		call int301
  1022 00000BB1 B008                <1> 		mov al, 8
  1023 00000BB3 EBC2                <1> 		jmp bscheckequal
  1024                              <1> 		
  1025                              <1> 	clear:		
  1026                              <1> 	
  1027                              <1> 	int306:	;;clear screen
  1028 00000BB5 668B0D[47090000]    <1> 		mov cx, [charxy]
  1029 00000BBC BF[851C0000]        <1> 		mov edi, videobuf2
  1030 00000BC1 66B80000            <1> 		mov ax, 0
  1031 00000BC5 66A3[41090000]      <1> 		mov [linebeginpos], ax
  1032 00000BCB 66A3[43090000]      <1> 		mov [videobufpos], ax
  1033 00000BD1 66BA0000            <1> 		mov dx, 0
  1034 00000BD5 66A3[45090000]      <1> 		mov [charpos], ax
  1035                              <1> 	int306b:
  1036 00000BDB 668907              <1> 		mov [edi], ax
  1037 00000BDE 81C702000000        <1> 		add edi, 2
  1038 00000BE4 80E902              <1> 		sub cl, 2
  1039 00000BE7 80F900              <1> 		cmp cl, 0
  1040 00000BEA 75EF                <1> 		jne int306b
  1041 00000BEC 8A0D[47090000]      <1> 		mov cl, [charxy]
  1042 00000BF2 FECD                <1> 		dec ch
  1043 00000BF4 80FD00              <1> 		cmp ch, 0
  1044 00000BF7 75E2                <1> 		jne int306b
  1045                              <1> 	
  1046                              <1> termcopy:	
  1047 00000BF9 60                  <1> 	pusha
  1048 00000BFA C605[9A270000]00    <1> 	mov byte [mouseselecton], 0
  1049 00000C01 C605[56090000]01    <1> 	mov byte [termcopyon], 1
  1050 00000C08 803D[9B270000]00    <1> 	cmp byte [guion], 0
  1051 00000C0F 0F840D000000        <1> 	je near nowincopy
  1052 00000C15 803D[55090000]01    <1> 	cmp byte [termguion], 1
  1053 00000C1C 0F8450270000        <1> 	je near windowvideocopy
  1054                              <1> nowincopy:
  1055 00000C22 BE00000A00          <1> 	mov esi, 0xA0000
  1056 00000C27 A1[31030000]        <1> 	mov eax, [basecache]
  1057 00000C2C C1E004              <1> 	shl eax, 4
  1058 00000C2F 29C6                <1> 	sub esi, eax
  1059 00000C31 BF[851C0000]        <1> 	mov edi, videobuf2
  1060 00000C36 B900000000          <1> 	mov ecx, 0
  1061 00000C3B 668B0D[47090000]    <1> 	mov cx, [charxy]
  1062                              <1> nowincopy2:
  1063 00000C42 BB[C03F0000]        <1> 	mov ebx, fonts
  1064 00000C47 B800000000          <1> 	mov eax, 0
  1065 00000C4C 8A07                <1> 	mov al, [edi]
  1066 00000C4E C1E004              <1> 	shl eax, 4
  1067 00000C51 01C3                <1> 	add ebx, eax
  1068 00000C53 47                  <1> 	inc edi
  1069 00000C54 8A27                <1> 	mov ah, [edi]
  1070 00000C56 BA00000000          <1> 	mov edx, 0
  1071 00000C5B 8A15[47090000]      <1> 	mov dl, [charxy]
  1072 00000C61 D1EA                <1> 	shr edx, 1
  1073 00000C63 C1C110              <1> 	rol ecx, 16
  1074 00000C66 B110                <1> 	mov cl, 16
  1075                              <1> nowinfont
  1076 00000C68 8A03                <1> 	mov al, [ebx]
  1077 00000C6A D0C8                <1> 	ror al, 1
  1078 00000C6C 80FC07              <1> 	cmp ah, 7
  1079 00000C6F 7602                <1> 	jbe notnotfont
  1080 00000C71 F6D0                <1> 	not al
  1081                              <1> notnotfont:
  1082 00000C73 8806                <1> 	mov [esi], al
  1083 00000C75 01D6                <1> 	add esi, edx
  1084 00000C77 43                  <1> 	inc ebx
  1085 00000C78 FEC9                <1> 	dec cl
  1086 00000C7A 80F900              <1> 	cmp cl, 0
  1087 00000C7D 75E9                <1> 	jne nowinfont
  1088 00000C7F C1E204              <1> 	shl edx, 4
  1089 00000C82 29D6                <1> 	sub esi, edx
  1090 00000C84 C1C110              <1> 	rol ecx, 16
  1091                              <1> nopresentwinfont:
  1092 00000C87 47                  <1> 	inc edi
  1093 00000C88 46                  <1> 	inc esi
  1094 00000C89 80E902              <1> 	sub cl, 2
  1095 00000C8C 80F900              <1> 	cmp cl, 0
  1096 00000C8F 75B1                <1> 	jne nowincopy2
  1097 00000C91 8A0D[47090000]      <1> 	mov cl, [charxy]
  1098 00000C97 BA00000000          <1> 	mov edx, 0
  1099 00000C9C 88CA                <1> 	mov dl, cl
  1100 00000C9E D1EA                <1> 	shr edx, 1
  1101 00000CA0 29D6                <1> 	sub esi, edx
  1102 00000CA2 C1E204              <1> 	shl edx, 4
  1103 00000CA5 01D6                <1> 	add esi, edx
  1104 00000CA7 FECD                <1> 	dec ch
  1105 00000CA9 80FD00              <1> 	cmp ch, 0
  1106 00000CAC 7594                <1> 	jne nowincopy2
  1107 00000CAE 61                  <1> 	popa
  1108 00000CAF C3                  <1> 	ret
  1109                                      %include 'source/solleros.asm'
  1110                              <1> 	;SOLLEROS.ASM
  1111                              <1> os:
  1112 00000CB0 E800FFFFFF          <1> 	call clear
  1113 00000CB5 BE[7B3F0000]        <1> 	mov esi, userask
  1114 00000CBA E84AFEFFFF          <1> 	call print
  1115                              <1> usercheck:
  1116 00000CBF BE[701A0000]        <1> 	mov esi, buftxt
  1117 00000CC4 B00D                <1> 	mov al, 13
  1118 00000CC6 B404                <1> 	mov ah, 4
  1119 00000CC8 CD30                <1> 	int 30h
  1120 00000CCA 56                  <1> 	push esi
  1121 00000CCB BE[9D3F0000]        <1> 	mov esi, line
  1122 00000CD0 E834FEFFFF          <1> 	call print
  1123 00000CD5 BE[853F0000]        <1> 	mov esi, pwdask
  1124 00000CDA E82AFEFFFF          <1> 	call print
  1125 00000CDF 5E                  <1> 	pop esi
  1126 00000CE0 46                  <1> 	inc esi
  1127 00000CE1 8935[960D0000]      <1> 	mov [esipass], esi
  1128                              <1> passcheck:
  1129 00000CE7 B000                <1> 	mov al, 0
  1130 00000CE9 B405                <1> 	mov ah, 5
  1131 00000CEB CD30                <1> 	int 30h
  1132 00000CED 3C0D                <1> 	cmp al, 13
  1133 00000CEF 0F8434000000        <1> 	je near gotpass
  1134 00000CF5 3C08                <1> 	cmp al, 8
  1135 00000CF7 0F840B000000        <1> 	je near backpass
  1136 00000CFD 8806                <1> 	mov [esi], al
  1137 00000CFF 46                  <1> 	inc esi
  1138 00000D00 B02A                <1> 	mov al, '*'
  1139 00000D02 B406                <1> 	mov ah, 6
  1140 00000D04 CD30                <1> 	int 30h
  1141 00000D06 EBDF                <1> 	jmp passcheck
  1142                              <1> backpass:
  1143 00000D08 3B35[960D0000]      <1> 	cmp esi, [esipass]
  1144 00000D0E 0F84D3FFFFFF        <1> 	je near passcheck
  1145 00000D14 4E                  <1> 	dec esi
  1146 00000D15 B008                <1> 	mov al, 8
  1147 00000D17 B406                <1> 	mov ah, 6
  1148 00000D19 CD30                <1> 	int 30h
  1149 00000D1B B020                <1> 	mov al, " "
  1150 00000D1D B406                <1> 	mov ah, 6
  1151 00000D1F CD30                <1> 	int 30h
  1152 00000D21 B008                <1> 	mov al, 8
  1153 00000D23 B406                <1> 	mov ah, 6
  1154 00000D25 CD30                <1> 	int 30h
  1155 00000D27 EBBE                <1> 	jmp passcheck
  1156                              <1> gotpass:
  1157 00000D29 B000                <1> 	mov al,0
  1158 00000D2B 8806                <1> 	mov [esi], al
  1159 00000D2D BE[9D3F0000]        <1> 	mov esi, line
  1160 00000D32 E8D2FDFFFF          <1> 	call print
  1161 00000D37 BB[A03F0000]        <1> 	mov ebx, userlst
  1162                              <1> userfind:
  1163 00000D3C BE[701A0000]        <1> 	mov esi, buftxt
  1164 00000D41 8A06                <1> 	mov al, [esi]
  1165 00000D43 3C00                <1> 	cmp al, 0
  1166 00000D45 0F8465FFFFFF        <1> 	je near os
  1167 00000D4B 891D[9A0D0000]      <1> 	mov [usercache], ebx
  1168 00000D51 E870010000          <1> 	call tester
  1169 00000D56 3C01                <1> 	cmp al, 1
  1170 00000D58 7415                <1> 	je pwdtest
  1171                              <1> nxtuser:
  1172 00000D5A 43                  <1> 	inc ebx
  1173 00000D5B 8A03                <1> 	mov al, [ebx]
  1174 00000D5D 3C00                <1> 	cmp al, 0
  1175 00000D5F 74DB                <1> 	je userfind
  1176 00000D61 81FB[C03F0000]      <1> 	cmp ebx, userlstend
  1177 00000D67 0F8343FFFFFF        <1> 	jae near os
  1178 00000D6D EBCD                <1> 	jmp userfind
  1179                              <1> pwdtest:
  1180 00000D6F 46                  <1> 	inc esi
  1181 00000D70 43                  <1> 	inc ebx
  1182 00000D71 E850010000          <1> 	call tester
  1183 00000D76 3C01                <1> 	cmp al, 1
  1184 00000D78 7402                <1> 	je pwdrgt
  1185 00000D7A EBDE                <1> 	jmp nxtuser
  1186 00000D7C E834FEFFFF          <1> pwdrgt:	call clear
  1187 00000D81 66B90002            <1> 	mov cx, 200h
  1188 00000D85 BE[701A0000]        <1> 	mov esi, buftxt
  1189 00000D8A B000                <1> 	mov al, 0
  1190 00000D8C 8806                <1> bufclr:	mov [esi], al
  1191 00000D8E 46                  <1> 	inc esi
  1192 00000D8F E2FB                <1> 	loop bufclr
  1193                              <1> ;;;;;;;;;;;;;;;;
  1194 00000D91 E92B000000          <1> 	jmp nwcmd
  1195                              <1> 
  1196 00000D96 00000000            <1> esipass dd 0
  1197 00000D9A [A03F0000]          <1> usercache dd userlst
  1198                              <1> 	
  1199                              <1> buftxtclear:
  1200 00000D9E B000                <1> 	mov al, 0
  1201 00000DA0 BE[701A0000]        <1> 	mov esi, buftxt
  1202 00000DA5 81FE[701C0000]      <1> clearbuftxt: cmp esi, buf2
  1203 00000DAB 730E                <1> 	jae retbufclr
  1204 00000DAD 8806                <1> 	mov [esi], al
  1205 00000DAF 46                  <1> 	inc esi
  1206 00000DB0 EBF3                <1> 	jmp clearbuftxt
  1207                              <1> 
  1208 00000DB2 39DE                <1> clearitbuf: cmp esi, ebx
  1209 00000DB4 7305                <1> 	jae retbufclr
  1210 00000DB6 8806                <1> 	mov [esi], al
  1211 00000DB8 46                  <1> 	inc esi
  1212 00000DB9 EBF7                <1> 	jmp clearitbuf
  1213 00000DBB C3                  <1> retbufclr: ret
  1214                              <1> 
  1215 00000DBC E900000000          <1> full:	jmp nwcmd
  1216                              <1> 
  1217                              <1> 
  1218 00000DC1 B001                <1> nwcmd:	mov al, 1
  1219 00000DC3 3805[69130000]      <1> 	cmp [BATCHISON], al
  1220 00000DC9 0F835E000000        <1> 	jae near batchran
  1221 00000DCF B000                <1> cancel:	mov al, 0
  1222 00000DD1 A2[00130000]        <1> 	mov [IFON], al
  1223 00000DD6 A2[69130000]        <1> 	mov [BATCHISON], al
  1224 00000DDB B05B                <1> 	mov al, '['
  1225 00000DDD B406                <1> 	mov ah, 6
  1226 00000DDF 66BB0700            <1> 	mov bx, 7
  1227 00000DE3 E86FFBFFFF          <1> 	call int301prnt
  1228 00000DE8 8B35[9A0D0000]      <1> 	mov esi, [usercache]
  1229 00000DEE E816FDFFFF          <1> 	call print
  1230 00000DF3 BE[8F3F0000]        <1> 	mov esi, location
  1231 00000DF8 E80CFDFFFF          <1> 	call print
  1232 00000DFD E82E120000          <1> 	call time
  1233 00000E02 BE[57210000]        <1> 	mov esi, timeshow
  1234 00000E07 E8FDFCFFFF          <1> 	call print
  1235 00000E0C BE[9A3F0000]        <1> 	mov esi, cmd
  1236 00000E11 E8F3FCFFFF          <1> 	call print
  1237 00000E16 E883FFFFFF          <1> 	call buftxtclear
  1238 00000E1B BE[701A0000]        <1> 	mov esi, buftxt
  1239 00000E20 B00D                <1> 	mov al, 13
  1240 00000E22 B307                <1> 	mov bl, 7
  1241 00000E24 B404                <1> 	mov ah, 4
  1242 00000E26 CD30                <1> 	int 30h
  1243                              <1> gotcmd:	
  1244 00000E28 E914000000          <1> 	jmp run
  1245                              <1> 	
  1246                              <1> batchran:
  1247 00000E2D C3                  <1> 	ret
  1248                              <1> 
  1249 00000E2E E86BFFFFFF          <1> input:	call buftxtclear
  1250 00000E33 BE[701A0000]        <1> 	mov esi, buftxt		;puts input into buftxt AND onto screen
  1251 00000E38 B00D                <1> stdin:	mov al, 13
  1252 00000E3A B307                <1> 	mov bl, 7
  1253 00000E3C B404                <1> 	mov ah, 4
  1254 00000E3E CD30                <1> 	int 30h
  1255 00000E40 C3                  <1> 	ret
  1256                              <1> 
  1257 00000E41 BE[9D3F0000]        <1> run:	mov esi, line
  1258 00000E46 E8BEFCFFFF          <1> 		call print
  1259                              <1> progtest:
  1260 00000E4B BE[701A0000]        <1> 	mov esi, buftxt
  1261 00000E50 BB[6F130000]        <1> 	mov ebx, fileindex
  1262 00000E55 668B03              <1> prgnxt:	mov ax, [ebx]
  1263 00000E58 B105                <1> 	mov cl, 5
  1264 00000E5A B504                <1> 	mov ch, 4
  1265 00000E5C 6639C8              <1> 	cmp ax, cx
  1266 00000E5F 740B                <1> 	je fndprg
  1267 00000E61 43                  <1> 	inc ebx
  1268 00000E62 81FB[6F150000]      <1> 	cmp ebx, fileindexend
  1269 00000E68 7330                <1> 	jae prgnf
  1270 00000E6A EBE9                <1> 	jmp prgnxt
  1271 00000E6C 81C302000000        <1> fndprg: add ebx, 2
  1272 00000E72 BE[701A0000]        <1> 	mov esi, buftxt
  1273 00000E77 66B90000            <1> 	mov cx, 0
  1274 00000E7B E880000000          <1> 	call cndtest
  1275 00000E80 3C01                <1> 	cmp al, 1
  1276 00000E82 7302                <1> 	jae prggood
  1277 00000E84 EBCF                <1> 	jmp prgnxt
  1278 00000E86 81FB[6F150000]      <1> prggood: cmp ebx, fileindexend
  1279 00000E8C 7333                <1> 	jae prgdn
  1280 00000E8E 81C303000000        <1> 	add ebx, 3
  1281 00000E94 8B3B                <1> 	mov edi, [ebx]
  1282 00000E96 90                  <1> 	nop
  1283 00000E97 90                  <1> 	nop
  1284 00000E98 FFE7                <1> 	jmp edi
  1285                              <1> prgnf:	
  1286 00000E9A A0[701A0000]        <1> 	mov al, [buftxt]
  1287 00000E9F 3C00                <1> 	cmp al, 0
  1288 00000EA1 741E                <1> 	je prgdn
  1289 00000EA3 BE[623F0000]        <1> 	mov esi, notfound1
  1290 00000EA8 E85CFCFFFF          <1> 	call print
  1291 00000EAD BE[701A0000]        <1> 	mov esi, buftxt
  1292 00000EB2 E852FCFFFF          <1> 	call print
  1293 00000EB7 BE[6C3F0000]        <1> 	mov esi, notfound2
  1294 00000EBC E848FCFFFF          <1> 	call print
  1295 00000EC1 E9FBFEFFFF          <1> prgdn:	jmp nwcmd
  1296                              <1> 
  1297                              <1> 
  1298                              <1> tester:			;si=user bx=prog returns 1 in al if true
  1299 00000EC6 B000                <1> 	mov al, 0
  1300 00000EC8 8A06                <1> retest:	mov al, [esi]
  1301 00000ECA 8A23                <1> 	mov ah, [ebx]
  1302 00000ECC 3C00                <1> 	cmp al, 0
  1303 00000ECE 7408                <1> 	je testtrue
  1304 00000ED0 38E0                <1> 	cmp al, ah
  1305 00000ED2 750C                <1> 	jne testfalse
  1306 00000ED4 43                  <1> 	inc ebx
  1307 00000ED5 46                  <1> 	inc esi
  1308 00000ED6 EBF0                <1> 	jmp retest
  1309                              <1> testtrue:
  1310 00000ED8 80FC00              <1> 	cmp ah, 0
  1311 00000EDB 7503                <1> 	jne testfalse
  1312 00000EDD B001                <1> 	mov al, 1
  1313 00000EDF C3                  <1> 	ret
  1314                              <1> testfalse:
  1315 00000EE0 B000                <1> 	mov al, 0
  1316 00000EE2 C3                  <1> 	ret
  1317                              <1> 
  1318                              <1> optest:			;si=user bx=prog returns 1 in al if true
  1319 00000EE3 B000                <1> 	mov al, 0
  1320                              <1> opretest:
  1321 00000EE5 8A06                <1> 	mov al, [esi]
  1322 00000EE7 8A23                <1> 	mov ah, [ebx]
  1323 00000EE9 38E0                <1> 	cmp al, ah
  1324 00000EEB 7510                <1> 	jne optestfalse
  1325 00000EED 80FC00              <1> 	cmp ah, 0
  1326 00000EF0 7404                <1> 	je optesttrue
  1327 00000EF2 43                  <1> 	inc ebx
  1328 00000EF3 46                  <1> 	inc esi
  1329 00000EF4 EBEF                <1> 	jmp opretest
  1330                              <1> optesttrue:
  1331 00000EF6 3C00                <1> 	cmp al, 0
  1332 00000EF8 7503                <1> 	jne optestfalse
  1333 00000EFA B001                <1> 	mov al, 1
  1334 00000EFC C3                  <1> 	ret
  1335                              <1> optestfalse:
  1336 00000EFD B000                <1> 	mov al, 0
  1337 00000EFF C3                  <1> 	ret
  1338                              <1> 
  1339                              <1> cndtest:			;si=user bx=prog cl=endchar returns 1 in al if true
  1340 00000F00 B000                <1> 	mov al, 0
  1341 00000F02 8A06                <1> cndretest:	mov al, [esi]
  1342 00000F04 8A23                <1> 	mov ah, [ebx]
  1343 00000F06 38CC                <1> 	cmp ah, cl
  1344 00000F08 7408                <1> 	je cndtesttrue
  1345 00000F0A 38E0                <1> 	cmp al, ah
  1346 00000F0C 750B                <1> 	jne cndtestfalse
  1347 00000F0E 43                  <1> 	inc ebx
  1348 00000F0F 46                  <1> 	inc esi
  1349 00000F10 EBF0                <1> 	jmp cndretest
  1350                              <1> cndtesttrue:
  1351 00000F12 38C8                <1> 	cmp al, cl
  1352 00000F14 7506                <1> 	jne cndtestalmost
  1353 00000F16 B001                <1> 	mov al, 1
  1354 00000F18 C3                  <1> 	ret
  1355                              <1> cndtestfalse:
  1356 00000F19 B000                <1> 	mov al, 0
  1357 00000F1B C3                  <1> 	ret
  1358                              <1> cndtestalmost:
  1359 00000F1C B002                <1> 	mov al, 2
  1360 00000F1E C3                  <1> 	ret
  1361 00000F1F 00                  <1> currentdir db 0
  1362 00000F20 BE[6F130000]        <1> dir:	mov esi, fileindex
  1363 00000F25 8A06                <1> 	dirnxt:	mov al, [esi]
  1364 00000F27 B400                <1> 		mov ah, 0
  1365 00000F29 3C05                <1> 		cmp al, 5
  1366 00000F2B 744A                <1> 		je dirfnd
  1367 00000F2D 3C07                <1> 		cmp al, 7
  1368 00000F2F 743C                <1> 		je dirfnd3
  1369 00000F31 3C06                <1> 		cmp al, 6
  1370 00000F33 7438                <1> 		je dirfnd3
  1371 00000F35 46                  <1> 		inc esi
  1372 00000F36 81FE[6F150000]      <1> 		cmp esi,  fileindexend
  1373 00000F3C 737B                <1> 		jae dirdn
  1374 00000F3E EBE5                <1> 		jmp dirnxt
  1375 00000F40 060400626174636800- <1> 	typetable db 6,4,0,"batch",0,7,4,0,"document",0,10,4,0,"folder",0,5,4,0,"executable",0
  1376 00000F49 070400646F63756D65- <1>
  1377 00000F52 6E74000A0400666F6C- <1>
  1378 00000F5B 646572000504006578- <1>
  1379 00000F64 6563757461626C6500  <1>
  1380                              <1> 	dirfnd3:
  1381 00000F6D 46                  <1> 		inc esi
  1382 00000F6E 81FE[6F150000]      <1> 		cmp esi, fileindexend
  1383 00000F74 76AF                <1> 		jbe dirnxt
  1384 00000F76 4E                  <1> 		dec esi
  1385 00000F77 46                  <1> 	dirfnd:	inc esi
  1386 00000F78 8A06                <1> 		mov al, [esi]
  1387 00000F7A B400                <1> 		mov ah, 0
  1388 00000F7C 3C04                <1> 		cmp al, 4
  1389 00000F7E 740B                <1> 		je dirfnd2
  1390 00000F80 46                  <1> 		inc esi
  1391 00000F81 81FE[6F150000]      <1> 		cmp esi,  fileindexend
  1392 00000F87 7330                <1> 		jae dirdn
  1393 00000F89 EB9A                <1> 		jmp dirnxt
  1394 00000F8B 81C601000000        <1> 	dirfnd2: add esi, 1
  1395 00000F91 E873FBFFFF          <1> 		call print
  1396 00000F96 8935[BE0F0000]      <1> 		mov [esidir], esi
  1397 00000F9C BE[9D3F0000]        <1> 		mov esi, line
  1398 00000FA1 E863FBFFFF          <1> 		call print
  1399 00000FA6 8B35[BE0F0000]      <1> 		mov esi, [esidir]
  1400 00000FAC 81FE[6F150000]      <1> 		cmp esi,  fileindexend
  1401 00000FB2 7305                <1> 		jae dirdn
  1402 00000FB4 E96CFFFFFF          <1> 		jmp dirnxt
  1403 00000FB9 E903FEFFFF          <1> 	dirdn:	jmp nwcmd
  1404 00000FBE 00000000            <1> esidir dd 0
  1405                              <1> 
  1406                              <1> array:				;arraystart in si, arrayend in bx, arrayseperator in cx
  1407                              <1> 		                ;ends if array seperator is found backwards after 0
  1408                              <1> 	arnxt:	      
  1409 00000FC2 88E8                <1> 		mov al, ch
  1410 00000FC4 88CC                <1> 		mov ah, cl        
  1411 00000FC6 663906              <1> 		cmp [esi], ax
  1412 00000FC9 744D                <1> 		je ardn
  1413 00000FCB 66390E              <1> 		cmp [esi], cx
  1414 00000FCE 7407                <1> 		je arfnd
  1415 00000FD0 46                  <1> 		inc esi
  1416 00000FD1 39DE                <1> 		cmp esi, ebx
  1417 00000FD3 7343                <1> 		jae ardn
  1418 00000FD5 EBEB                <1> 		jmp arnxt
  1419 00000FD7 81C602000000        <1> 	arfnd: add esi, 2
  1420 00000FDD 891D[19100000]      <1> 		mov [arbx], ebx
  1421 00000FE3 890D[1D100000]      <1> 		mov [arcx], ecx
  1422 00000FE9 E81BFBFFFF          <1> 		call print
  1423 00000FEE 8935[1F100000]      <1> 		mov [arsi], esi
  1424 00000FF4 BE[9D3F0000]        <1> 		mov esi, line
  1425 00000FF9 E80BFBFFFF          <1> 		call print
  1426 00000FFE 8B1D[19100000]      <1> 		mov ebx, [arbx]
  1427 00001004 668B0D[1D100000]    <1> 		mov cx, [arcx]
  1428 0000100B 8B35[1F100000]      <1> 		mov esi, [arsi]
  1429 00001011 46                  <1> 		inc esi
  1430 00001012 39DE                <1> 		cmp esi, ebx
  1431 00001014 7302                <1> 		jae ardn
  1432 00001016 EBAA                <1> 		jmp arnxt
  1433 00001018 C3                  <1> 	ardn:	ret
  1434 00001019 00000000            <1> arbx:	dw 0,0
  1435 0000101D 0000                <1> arcx:	db 0,0
  1436 0000101F 00000000            <1> arsi:	dw 0,0
  1437                              <1> 
  1438                              <1> clearbuffer:
  1439 00001023 BE[701C0000]        <1> 	mov esi, buf2
  1440 00001028 B030                <1> 	mov al, '0'
  1441 0000102A 81FE[841C0000]      <1> clearbuf: cmp esi, numbuf
  1442 00001030 7305                <1> 	jae doneclearbuff
  1443 00001032 8806                <1> 	mov [esi], al
  1444 00001034 46                  <1> 	inc esi
  1445 00001035 EBF3                <1> 	jmp clearbuf
  1446                              <1> doneclearbuff: 
  1447 00001037 C3                  <1> 		ret
  1448                              <1> 
  1449                              <1> convert:
  1450 00001038 4E                  <1> 	dec esi
  1451 00001039 89F3                <1> 	mov ebx, esi		;place to convert into must be in si, number to convert must be in cx
  1452                              <1> cnvrt:
  1453 0000103B 89DE                <1> 	mov esi, ebx
  1454 0000103D 81EE09000000        <1> 	sub esi, 9
  1455 00001043 81F900CA9A3B        <1> 	cmp ecx, 1000000000
  1456 00001049 720A                <1> 	jb ten8
  1457 0000104B 81E900CA9A3B        <1> 	sub ecx, 1000000000
  1458 00001051 FE06                <1> 	inc byte [esi]
  1459 00001053 EBE6                <1> 	jmp cnvrt
  1460 00001055 46                  <1> ten8:	inc esi
  1461 00001056 81F900E1F505        <1> 	cmp ecx, 100000000
  1462 0000105C 720A                <1> 	jb ten7
  1463 0000105E 81E900E1F505        <1> 	sub ecx, 100000000
  1464 00001064 FE06                <1> 	inc byte [esi]
  1465 00001066 EBD3                <1> 	jmp cnvrt
  1466 00001068 46                  <1> ten7:	inc esi
  1467 00001069 81F980969800        <1> 	cmp ecx, 10000000
  1468 0000106F 720A                <1> 	jb ten6
  1469 00001071 81E980969800        <1> 	sub ecx, 10000000
  1470 00001077 FE06                <1> 	inc byte [esi]
  1471 00001079 EBC0                <1> 	jmp cnvrt
  1472 0000107B 46                  <1> ten6:	inc esi
  1473 0000107C 81F940420F00        <1> 	cmp ecx, 1000000
  1474 00001082 720A                <1> 	jb ten5
  1475 00001084 81E940420F00        <1> 	sub ecx, 1000000
  1476 0000108A FE06                <1> 	inc byte [esi]
  1477 0000108C EBAD                <1> 	jmp cnvrt
  1478 0000108E 46                  <1> ten5:	inc esi
  1479 0000108F 81F9A0860100        <1> 	cmp ecx, 100000
  1480 00001095 720A                <1> 	jb ten4
  1481 00001097 81E9A0860100        <1> 	sub ecx, 100000
  1482 0000109D FE06                <1> 	inc byte [esi]
  1483 0000109F EB9A                <1> 	jmp cnvrt
  1484 000010A1 46                  <1> ten4:	inc esi
  1485 000010A2 81F910270000        <1> 	cmp ecx, 10000
  1486 000010A8 720A                <1> 	jb ten3
  1487 000010AA 81E910270000        <1> 	sub ecx, 10000
  1488 000010B0 FE06                <1> 	inc byte [esi]
  1489 000010B2 EB87                <1> 	jmp cnvrt
  1490 000010B4 46                  <1> ten3:	inc esi
  1491 000010B5 81F9E8030000        <1> 	cmp ecx, 1000
  1492 000010BB 720D                <1> 	jb ten2
  1493 000010BD 81E9E8030000        <1> 	sub ecx, 1000
  1494 000010C3 FE06                <1> 	inc byte [esi]
  1495 000010C5 E971FFFFFF          <1> 	jmp cnvrt
  1496 000010CA 46                  <1> ten2:	inc esi
  1497 000010CB 81F964000000        <1> 	cmp ecx, 100
  1498 000010D1 720D                <1> 	jb ten1
  1499 000010D3 81E964000000        <1> 	sub ecx, 100
  1500 000010D9 FE06                <1> 	inc byte [esi]
  1501 000010DB E95BFFFFFF          <1> 	jmp cnvrt
  1502 000010E0 46                  <1> ten1:	inc esi
  1503 000010E1 81F90A000000        <1> 	cmp ecx, 10
  1504 000010E7 720D                <1> 	jb ten0
  1505 000010E9 81E90A000000        <1> 	sub ecx, 10
  1506 000010EF FE06                <1> 	inc byte [esi]
  1507 000010F1 E945FFFFFF          <1> 	jmp cnvrt
  1508 000010F6 46                  <1> ten0:	inc esi
  1509 000010F7 81F901000000        <1> 	cmp ecx, 1
  1510 000010FD 720D                <1> 	jb tendn
  1511 000010FF 81E901000000        <1> 	sub ecx, 1
  1512 00001105 FE06                <1> 	inc byte [esi]
  1513 00001107 E92FFFFFFF          <1> 	jmp cnvrt
  1514                              <1> tendn:
  1515 0000110C C3                  <1> 	ret
  1516                              <1> 
  1517                              <1> 	
  1518                              <1> 
  1519 0000110D 00<rept>            <1> hexnumber times 8 db 0
  1520 00001115 202000              <1> hexnumberend db "  ",0
  1521                              <1> 
  1522                              <1> 
  1523 00001118 00000000            <1> sibuf dw 0,0
  1524 0000111C 00000000            <1> dibuf dw 0,0
  1525                              <1> 
  1526                              <1> converthex:
  1527                              <1> clearbufferhex:
  1528 00001120 B030                <1> 	mov al, '0'
  1529 00001122 8935[18110000]      <1> 	mov [sibuf], esi
  1530 00001128 893D[1C110000]      <1> 	mov [dibuf], edi
  1531 0000112E 39FE                <1> clearbufhex: cmp esi, edi
  1532 00001130 7305                <1> 	jae doneclearbuffhex
  1533 00001132 8806                <1> 	mov [esi], al
  1534 00001134 46                  <1> 	inc esi
  1535 00001135 EBF7                <1> 	jmp clearbufhex
  1536                              <1> doneclearbuffhex:
  1537 00001137 8B35[1C110000]      <1> 	mov esi, [dibuf]
  1538 0000113D 89CA                <1> 	mov edx, ecx
  1539 0000113F 81FA00000000        <1> 	cmp edx, 0
  1540 00001145 741F                <1> 	je donenxtephx
  1541                              <1> nxtexphx:	;0x10^x
  1542 00001147 4E                  <1> 	dec esi
  1543 00001148 89F7                <1> 	mov edi, esi		;;location of 0x10^x
  1544 0000114A 89D1                <1> 	mov ecx, edx
  1545 0000114C 81E10F000000        <1> 	and ecx, 0xF		;;just this digit
  1546 00001152 E81C000000          <1> 	call cnvrtexphx		;;get this digit
  1547 00001157 89FE                <1> 	mov esi, edi
  1548 00001159 C1EA04              <1> 	shr edx, 4		;;next digit
  1549 0000115C 81FA00000000        <1> 	cmp edx, 0
  1550 00001162 7402                <1> 	je donenxtephx
  1551 00001164 EBE1                <1> 	jmp nxtexphx
  1552                              <1> donenxtephx:
  1553 00001166 8B35[18110000]      <1> 	mov esi, [sibuf]
  1554 0000116C 8B3D[1C110000]      <1> 	mov edi, [dibuf]
  1555 00001172 C3                  <1> 	ret
  1556                              <1> cnvrtexphx:			;;convert this number
  1557 00001173 89F3                <1> 	mov ebx, esi		;place to convert to must be in si, number to convert must be in cx
  1558 00001175 81F900000000        <1> 	cmp ecx, 0
  1559 0000117B 7429                <1> 	je zerohx
  1560 0000117D 8A06                <1> cnvrthx:  mov al, [esi]
  1561 0000117F 3C39                <1> 	cmp al, '9'
  1562 00001181 741B                <1> 	je lettershx
  1563 00001183 3C46                <1> lttrhxdn: cmp al, 'F'
  1564 00001185 741F                <1> 	je zerohx
  1565 00001187 8A06                <1> 	mov al, [esi]
  1566 00001189 FEC0                <1> 	inc al
  1567 0000118B 8806                <1> 	mov [esi], al
  1568 0000118D 89DE                <1> 	mov esi, ebx
  1569 0000118F 81E901000000        <1> cnvrtlphx: sub ecx, 1
  1570 00001195 81F900000000        <1> 	cmp ecx, 0
  1571 0000119B 75E0                <1> 	jne cnvrthx
  1572 0000119D C3                  <1> 	ret
  1573                              <1> lettershx:
  1574 0000119E B041                <1> 	mov al, 'A'
  1575 000011A0 2C01                <1> 	sub al, 1
  1576 000011A2 8806                <1> 	mov [esi], al
  1577 000011A4 EBDD                <1> 	jmp lttrhxdn
  1578 000011A6 B030                <1> zerohx:	mov al, '0'
  1579 000011A8 8806                <1> 	mov [esi], al
  1580 000011AA 4E                  <1> 	dec esi
  1581 000011AB 8A06                <1> 	mov al, [esi]
  1582 000011AD 3C46                <1> 	cmp al, 'F'
  1583 000011AF 74F5                <1> 	je zerohx
  1584 000011B1 41                  <1> 	inc ecx
  1585 000011B2 EBDB                <1> 	jmp cnvrtlphx
  1586                              <1> 
  1587 000011B4 01                  <1> firsthexshown db 1
  1588                              <1> showhex:
  1589 000011B5 60                  <1> 	pusha
  1590 000011B6 BE[0D110000]        <1> 	mov esi, hexnumber
  1591 000011BB BF[15110000]        <1> 	mov edi, hexnumberend
  1592 000011C0 E85BFFFFFF          <1> 	call converthex
  1593 000011C5 803D[B4110000]01    <1> 	cmp byte [firsthexshown], 1
  1594 000011CC 7504                <1> 	jne showthathex
  1595 000011CE 66BA0000            <1> 	mov dx, 0
  1596                              <1> showthathex:
  1597 000011D2 803D[B4110000]03    <1> 	cmp byte [firsthexshown], 3
  1598 000011D9 750A                <1> 	jne nonewhexline
  1599 000011DB BE[9D3F0000]        <1> 	mov esi, line
  1600 000011E0 E824F9FFFF          <1> 	call print
  1601                              <1> nonewhexline:
  1602 000011E5 803D[B4110000]04    <1> 	cmp byte [firsthexshown], 4
  1603 000011EC 7527                <1> 	jne notabfixhex
  1604 000011EE B1A0                <1> 	mov cl, 160
  1605 000011F0 28D1                <1> 	sub cl, dl
  1606 000011F2 C0E905              <1> 	shr cl, 5
  1607 000011F5 C0E105              <1> 	shl cl, 5
  1608 000011F8 80F900              <1> 	cmp cl, 0
  1609 000011FB 750F                <1> 	jne nonewlinetabfixhex
  1610 000011FD BE[9D3F0000]        <1> 	mov esi, line
  1611 00001202 E802F9FFFF          <1> 	call print
  1612 00001207 E909000000          <1> 	jmp notabfixhex
  1613                              <1> nonewlinetabfixhex:
  1614 0000120C 80C20F              <1> 	add dl, 15
  1615 0000120F C0EA04              <1> 	shr dl, 4
  1616 00001212 C0E204              <1> 	shl dl, 4
  1617                              <1> notabfixhex:
  1618 00001215 BE[0D110000]        <1> 	mov esi, hexnumber
  1619 0000121A E8EAF8FFFF          <1> 	call print
  1620 0000121F 803D[B4110000]02    <1> 	cmp byte [firsthexshown], 2
  1621 00001226 750A                <1> 	jne hexshown
  1622 00001228 BE[9D3F0000]        <1> 	mov esi, line
  1623 0000122D E8D7F8FFFF          <1> 	call print
  1624                              <1> hexshown:
  1625 00001232 C605[B4110000]00    <1> 	mov byte [firsthexshown], 0
  1626 00001239 61                  <1> 	popa
  1627 0000123A C3                  <1> 	ret
  1628                              <1> 
  1629                              <1> 
  1630 0000123B 303030303030303030- <1> decnumber db "00000000000000"
  1631 00001244 3030303030          <1>
  1632 00001249 2000                <1> decnumberend: db " ",0
  1633                              <1> 
  1634                              <1> showdec: ;;same as showhex, just uses decimal conversion
  1635 0000124B 60                  <1> 	pusha
  1636 0000124C BF[3B120000]        <1> 	mov edi, decnumber
  1637 00001251 BE[49120000]        <1> 	mov esi, decnumberend
  1638                              <1> cleardecbuf:
  1639 00001256 C60730              <1> 	mov byte [edi], '0'
  1640 00001259 47                  <1> 	inc edi
  1641 0000125A 39F7                <1> 	cmp edi, esi
  1642 0000125C 72F8                <1> 	jb cleardecbuf
  1643 0000125E BF[3B120000]        <1> 	mov edi, decnumber
  1644 00001263 E8D0FDFFFF          <1> 	call convert
  1645 00001268 803D[B4110000]01    <1> 	cmp byte [firsthexshown], 1
  1646 0000126F 7504                <1> 	jne showthatdec
  1647 00001271 66BA0000            <1> 	mov dx, 0
  1648                              <1> showthatdec:
  1649 00001275 803D[B4110000]03    <1> 	cmp byte [firsthexshown], 3
  1650 0000127C 750A                <1> 	jne nonewdecline
  1651 0000127E BE[9D3F0000]        <1> 	mov esi, line
  1652 00001283 E881F8FFFF          <1> 	call print
  1653                              <1> nonewdecline:
  1654 00001288 803D[B4110000]04    <1> 	cmp byte [firsthexshown], 4
  1655 0000128F 7527                <1> 	jne notabfixdec
  1656 00001291 B1A0                <1> 	mov cl, 160
  1657 00001293 28D1                <1> 	sub cl, dl
  1658 00001295 C0E905              <1> 	shr cl, 5
  1659 00001298 C0E105              <1> 	shl cl, 5
  1660 0000129B 80F900              <1> 	cmp cl, 0
  1661 0000129E 750F                <1> 	jne nonewlinetabfixdec
  1662 000012A0 BE[9D3F0000]        <1> 	mov esi, line
  1663 000012A5 E85FF8FFFF          <1> 	call print
  1664 000012AA E909000000          <1> 	jmp notabfixdec
  1665                              <1> nonewlinetabfixdec:
  1666 000012AF 80C20F              <1> 	add dl, 15
  1667 000012B2 C0EA04              <1> 	shr dl, 4
  1668 000012B5 C0E204              <1> 	shl dl, 4
  1669                              <1> notabfixdec:
  1670 000012B8 BE[3B120000]        <1> 	mov esi, decnumber
  1671 000012BD 4E                  <1> 	dec esi
  1672                              <1> sifind:
  1673 000012BE 46                  <1> 	inc esi
  1674 000012BF 803E30              <1> 	cmp byte [esi], '0'
  1675 000012C2 74FA                <1> 	je sifind
  1676 000012C4 E840F8FFFF          <1> 	call print
  1677 000012C9 803D[B4110000]02    <1> 	cmp byte [firsthexshown], 2
  1678 000012D0 750A                <1> 	jne decshown
  1679 000012D2 BE[9D3F0000]        <1> 	mov esi, line
  1680 000012D7 E82DF8FFFF          <1> 	call print
  1681                              <1> decshown:
  1682 000012DC C605[B4110000]00    <1> 	mov byte [firsthexshown], 0
  1683 000012E3 61                  <1> 	popa
  1684 000012E4 C3                  <1> 	ret
  1685                              <1> 	
  1686                              <1> cnvrttxt: 
  1687 000012E5 B900000000          <1> 	mov ecx, 0
  1688 000012EA B800000000          <1> 	mov eax, 0
  1689 000012EF BA00000000          <1> 	mov edx, 0
  1690 000012F4 BB00000000          <1> 	mov ebx, 0
  1691 000012F9 4E                  <1> 	dec esi
  1692                              <1> cnvrtlptxt:
  1693 000012FA 46                  <1> 	inc esi
  1694 000012FB 8A06                <1> 	mov al, [esi]
  1695 000012FD 3C00                <1> 	cmp al, 0
  1696 000012FF 75F9                <1> 	jne cnvrtlptxt
  1697 00001301 4E                  <1> 	dec esi
  1698 00001302 8A06                <1> 	mov al, [esi]
  1699 00001304 3C30                <1> 	cmp al, '0'
  1700 00001306 7504                <1> 	jne txtlp
  1701 00001308 39FE                <1> zerotest: cmp esi, edi
  1702 0000130A 745B                <1> 	je donecnvrt
  1703                              <1> txtlp:	
  1704 0000130C B800000000          <1> 	mov eax, 0
  1705 00001311 8A06                <1> 	mov al, [esi]
  1706 00001313 3C3D                <1> 	cmp al, '='
  1707 00001315 7450                <1> 	je donecnvrt
  1708 00001317 3C30                <1> 	cmp al, 48
  1709 00001319 724C                <1> 	jb donecnvrt
  1710 0000131B 3C23                <1> 	cmp al, '#'
  1711 0000131D 7448                <1> 	je donecnvrt
  1712 0000131F 39FE                <1> 	cmp esi, edi
  1713 00001321 7244                <1> 	jb donecnvrt
  1714 00001323 81F900000000        <1> 	cmp ecx, 0
  1715 00001329 7708                <1> 	ja exp
  1716 0000132B 2C30                <1> noexp:	sub al, 48
  1717 0000132D 01C2                <1> 	add edx, eax
  1718 0000132F 4E                  <1> 	dec esi
  1719 00001330 41                  <1> 	inc ecx
  1720 00001331 EBD9                <1> 	jmp txtlp
  1721 00001333 81F900000000        <1> exp:	cmp ecx, 0
  1722 00001339 74F0                <1> 	je noexp
  1723 0000133B 2C30                <1> 	sub al, 48
  1724 0000133D 51                  <1> 	push ecx
  1725 0000133E 89C3                <1> expmul:	mov ebx, eax
  1726 00001340 01D8                <1> 	add eax, ebx
  1727 00001342 01D8                <1> 	add eax, ebx
  1728 00001344 01D8                <1> 	add eax, ebx
  1729 00001346 01D8                <1> 	add eax, ebx
  1730 00001348 01D8                <1> 	add eax, ebx
  1731 0000134A 01D8                <1> 	add eax, ebx
  1732 0000134C 01D8                <1> 	add eax, ebx
  1733 0000134E 01D8                <1> 	add eax, ebx
  1734 00001350 01D8                <1> 	add eax, ebx
  1735 00001352 81E901000000        <1> 	sub ecx, 1
  1736 00001358 81F900000000        <1> 	cmp ecx, 0
  1737 0000135E 77DE                <1> 	ja expmul
  1738 00001360 01C2                <1> 	add edx, eax
  1739 00001362 59                  <1> 	pop ecx
  1740 00001363 4E                  <1> 	dec esi
  1741 00001364 41                  <1> 	inc ecx
  1742 00001365 EBA5                <1> 	jmp txtlp
  1743 00001367 89D1                <1> donecnvrt: mov ecx, edx
  1744 00001369 C3                  <1> 	ret
  1745                                      %include 'source/builtinprogs.asm'
  1746 0000136A 050406040704        <1> filetypes db 5,4,6,4,7,4
  1747                              <1> progstart:		;programs start here
  1748                              <1> ;db 5,4,"index",0
  1749                              <1> ;	call indexfiles
  1750                              <1> ;	jmp nwcmd
  1751                              <1> indexfiles:
  1752 00001370 BE[70130000]        <1> 	mov esi, progstart
  1753 00001375 BB[6F130000]        <1> 	mov ebx, fileindex
  1754 0000137A BF[70130000]        <1> 	mov edi, progstart
  1755 0000137F 81EF02000000        <1> 	sub edi, 2
  1756                              <1> indexloop:
  1757 00001385 668B0E              <1> 	mov cx, [esi]
  1758                              <1> 	indexloop2:
  1759 00001388 663B0F              <1> 		cmp cx, [edi]
  1760 0000138B 7424                <1> 		je indexloop2done
  1761 0000138D 81EF02000000        <1> 		sub edi, 2
  1762 00001393 81FF[6A130000]      <1> 		cmp edi, filetypes
  1763 00001399 73ED                <1> 		jae indexloop2
  1764 0000139B BF[70130000]        <1> 	mov edi, progstart
  1765 000013A0 81EF02000000        <1> 	sub edi, 2
  1766 000013A6 46                  <1> 	inc esi
  1767 000013A7 81FE[DF210000]      <1> 	cmp esi, batchprogend
  1768 000013AD 734E                <1> 	jae indexloopdone
  1769 000013AF EBD4                <1> 	jmp indexloop
  1770                              <1> indexloop2done:
  1771 000013B1 66890B              <1> 	mov [ebx], cx
  1772 000013B4 81C302000000        <1> 	add ebx, 2
  1773 000013BA 81C602000000        <1> 	add esi, 2
  1774                              <1> 	nameindex:
  1775 000013C0 8A0E                <1> 		mov cl, [esi]
  1776 000013C2 80F900              <1> 		cmp cl, 0
  1777 000013C5 7406                <1> 		je nameindexdone
  1778 000013C7 880B                <1> 		mov [ebx], cl
  1779 000013C9 46                  <1> 		inc esi
  1780 000013CA 43                  <1> 		inc ebx
  1781 000013CB EBF3                <1> 		jmp nameindex
  1782                              <1> 	nameindexdone:
  1783 000013CD 43                  <1> 		inc ebx
  1784 000013CE 66C7030000          <1> 		mov word [ebx], 0
  1785 000013D3 81C302000000        <1> 		add ebx, 2
  1786 000013D9 46                  <1> 		inc esi
  1787 000013DA 8933                <1> 		mov [ebx], esi
  1788 000013DC 81C304000000        <1> 		add ebx, 4
  1789 000013E2 66C7030000          <1> 		mov word [ebx], 0
  1790 000013E7 81C302000000        <1> 		add ebx, 2
  1791 000013ED 81FB[6F150000]      <1> 		cmp ebx, fileindexend
  1792 000013F3 7308                <1> 		jae indexloopdone
  1793 000013F5 81C601000000        <1> 		add esi, 1
  1794 000013FB EB88                <1> 		jmp indexloop
  1795 000013FD C3                  <1> indexloopdone: 	ret
  1796                              <1> 
  1797                              <1> 
  1798                              <1> ;db 5,4,"showindex",0
  1799                              <1> ;	mov esi, fileindex
  1800                              <1> ;	mov ebx, fileindexend
  1801                              <1> ;	mov cl, 5
  1802                              <1> ;	mov ch, 4
  1803                              <1> ;	call array
  1804                              <1> ;	mov esi, fileindex
  1805                              <1> ;	mov ebx, fileindexend
  1806                              <1> ;	mov cl, 6
  1807                              <1> ;	mov ch, 4
  1808                              <1> ;	call array
  1809                              <1> ;	mov esi, fileindex
  1810                              <1> ;	mov ebx, fileindexend
  1811                              <1> ;	mov cl, 7
  1812                              <1> ;	mov ch, 4
  1813                              <1> ;	call array
  1814                              <1> ;	jmp nwcmd
  1815                              <1> 
  1816 000013FE 05046C7300          <1> db 5,4,"ls",0
  1817 00001403 BE[70130000]        <1> 	lscmd:	mov esi, progstart
  1818 00001408 BB[DF210000]        <1> 		mov ebx, progend
  1819 0000140D E90EFBFFFF          <1> 		jmp dir
  1820                              <1> 		
  1821 00001412 05046469736B00      <1> db 5,4,"disk",0
  1822 00001419 B900000000          <1> 		mov ecx, 0
  1823 0000141E 8A0D[2B000000]      <1> 		mov cl, [DriveNumber]
  1824 00001424 C605[B4110000]00    <1> 		mov byte [firsthexshown], 0
  1825 0000142B E885FDFFFF          <1> 		call showhex
  1826 00001430 BE[9D3F0000]        <1> 		mov esi, line
  1827 00001435 E8CFF6FFFF          <1> 		call print
  1828 0000143A BE[F83E0000]        <1> 		mov esi, diskfileindex
  1829                              <1> 	diskindexdir:
  1830 0000143F E8C5F6FFFF          <1> 		call print
  1831 00001444 8B4E05              <1> 		mov ecx, [esi + 5]
  1832 00001447 C605[B4110000]03    <1> 		mov byte [firsthexshown], 3
  1833 0000144E E8F8FDFFFF          <1> 		call showdec
  1834 00001453 56                  <1> 		push esi
  1835 00001454 BE[9D3F0000]        <1> 		mov esi, line
  1836 00001459 E8ABF6FFFF          <1> 		call print
  1837 0000145E 5E                  <1> 		pop esi
  1838 0000145F 81C609000000        <1> 		add esi, 9
  1839 00001465 81FE[5D3F0000]      <1> 		cmp esi, enddiskfileindex
  1840 0000146B 72D2                <1> 		jb diskindexdir
  1841 0000146D E94FF9FFFF          <1> 		jmp nwcmd
  1842                              <1> 
  1843 00001472 0504636C65617200    <1> db 5,4,"clear",0
  1844 0000147A E836F7FFFF          <1> 	cls:	call clear
  1845 0000147F E93DF9FFFF          <1> 		jmp nwcmd
  1846                              <1> 		
  1847 00001484 05047761697400      <1> db 5,4,"wait",0
  1848 0000148B B000                <1> 		mov al, 0
  1849 0000148D E847F6FFFF          <1> 		call int302
  1850 00001492 E92AF9FFFF          <1> 		jmp nwcmd
  1851                              <1> 
  1852 00001497 05046563686F00      <1> db 5,4,"echo",0
  1853 0000149E BE[701A0000]        <1> 	echo:	mov esi, buftxt
  1854 000014A3 81C605000000        <1> 		add esi, 5
  1855 000014A9 8A06                <1> 		mov al, [esi]
  1856 000014AB 3C24                <1> 		cmp al, '$'
  1857 000014AD 7414                <1> 		je echovr
  1858 000014AF E855F6FFFF          <1> 		call print
  1859 000014B4 BE[9D3F0000]        <1> 		mov esi, line
  1860 000014B9 E84BF6FFFF          <1> 		call print
  1861 000014BE E9FEF8FFFF          <1> 		jmp nwcmd
  1862 000014C3 BB[6F150000]        <1> 	echovr:	mov ebx, variables
  1863 000014C8 BF06000000          <1> 		mov edi, 6
  1864 000014CD E83A000000          <1> 		call nxtvrech
  1865 000014D2 E957000000          <1> 		jmp prntvr2
  1866 000014D7 B13D                <1> 	echvar:	mov cl, '='
  1867 000014D9 43                  <1> 		inc ebx
  1868 000014DA 8A03                <1> 		mov al, [ebx]
  1869 000014DC 3C00                <1> 		cmp al, 0
  1870 000014DE 742C                <1> 		je nxtvrech
  1871 000014E0 3C3D                <1> 		cmp al, '='
  1872 000014E2 7420                <1> 		je nxtvrechb1
  1873 000014E4 BE[701A0000]        <1> 		mov esi, buftxt
  1874 000014E9 01FE                <1> 		add esi, edi
  1875 000014EB E810FAFFFF          <1> 		call cndtest
  1876 000014F0 3C02                <1> 		cmp al, 2
  1877 000014F2 7436                <1> 		je prntvr
  1878 000014F4 3C01                <1> 		cmp al, 1
  1879 000014F6 7432                <1> 		je prntvr
  1880 000014F8 BE[701A0000]        <1> 		mov esi, buftxt
  1881 000014FD 01FE                <1> 		add esi, edi
  1882 000014FF E908000000          <1> 		jmp nxtvrech
  1883                              <1> 	nxtvrechb1:
  1884 00001504 81EB02000000        <1> 		sub ebx, 2
  1885 0000150A EBCB                <1> 		jmp echvar
  1886 0000150C 8A03                <1> 	nxtvrech: mov al, [ebx]
  1887 0000150E 3C05                <1> 		cmp al, 5
  1888 00001510 740F                <1> 		je nxtvrec2
  1889 00001512 43                  <1> 		inc ebx
  1890 00001513 81FB[6F1A0000]      <1> 		cmp ebx, varend
  1891 00001519 0F83A2F8FFFF        <1> 		jae nwcmd
  1892 0000151F EBEB                <1> 		jmp nxtvrech
  1893 00001521 43                  <1> 	nxtvrec2: inc ebx
  1894 00001522 8A03                <1> 		mov al, [ebx]
  1895 00001524 3C04                <1> 		cmp al, 4
  1896 00001526 74AF                <1> 		je echvar
  1897 00001528 EBE2                <1> 		jmp nxtvrech
  1898 0000152A 43                  <1> 	prntvr: inc ebx
  1899 0000152B 89DE                <1> 		mov esi, ebx
  1900 0000152D C3                  <1> 		ret
  1901 0000152E E8D6F5FFFF          <1> 	prntvr2: call print
  1902 00001533 BE[9D3F0000]        <1> 		mov esi, line
  1903 00001538 E8CCF5FFFF          <1> 		call print
  1904 0000153D E97FF8FFFF          <1> 		jmp nwcmd
  1905                              <1> 		
  1906                              <1> 
  1907 00001542 05042300            <1> db 5,4,"#",0
  1908                              <1> 	num:	
  1909 00001546 E8D8FAFFFF          <1> 		call clearbuffer
  1910 0000154B C605[02180000]00    <1> 		mov byte [decimal], 0
  1911 00001552 C605[03180000]00    <1> 		mov byte [decimal2], 0
  1912 00001559 BE[701A0000]        <1> 		mov esi, buftxt
  1913 0000155E B800000000          <1> 		mov eax, 0
  1914 00001563 B900000000          <1> 		mov ecx, 0
  1915 00001568 BB00000000          <1> 		mov ebx, 0
  1916 0000156D 8A06                <1> 	num2:	mov al, [esi]
  1917 0000156F 3C2B                <1> 		cmp al, '+'
  1918 00001571 741B                <1> 		je operatorfound
  1919 00001573 3C2D                <1> 		cmp al, '-'
  1920 00001575 7417                <1> 		je operatorfound
  1921 00001577 3C2A                <1> 		cmp al, '*'
  1922 00001579 7413                <1> 		je operatorfound
  1923 0000157B 3C2F                <1> 		cmp al, '/'
  1924 0000157D 740F                <1> 		je operatorfound
  1925 0000157F 3C5E                <1> 		cmp al, '^'
  1926 00001581 740B                <1> 		je operatorfound
  1927 00001583 46                  <1> 		inc esi
  1928 00001584 3C00                <1> 		cmp al, 0
  1929 00001586 0F8435F8FFFF        <1> 		je near nwcmd
  1930 0000158C EBDF                <1> 		jmp num2
  1931 0000158E 50                  <1> 	operatorfound: push eax
  1932 0000158F B400                <1> 		mov ah, 0
  1933 00001591 8826                <1> 		mov [esi], ah
  1934 00001593 89F7                <1> 		mov edi, esi
  1935 00001595 46                  <1> 		inc esi
  1936 00001596 8A06                <1> 		mov al, [esi]
  1937 00001598 3C24                <1> 		cmp al, '$'
  1938 0000159A 0F8481000000        <1> 		je near varnum1
  1939 000015A0 3C25                <1> 		cmp al, '%'
  1940 000015A2 0F8469000000        <1> 		je near resultnum1
  1941                              <1> 	varnum2: 
  1942 000015A8 57                  <1> 		push edi
  1943 000015A9 E8C9000000          <1> 		call checkdecimal
  1944 000015AE 5F                  <1> 		pop edi
  1945 000015AF E831FDFFFF          <1> 		call cnvrttxt
  1946                              <1> 	vrnm2:
  1947 000015B4 89CB                <1> 		mov ebx, ecx
  1948 000015B6 53                  <1> 		push ebx
  1949 000015B7 E867FAFFFF          <1> 		call clearbuffer
  1950 000015BC BE[701A0000]        <1> 		mov esi, buftxt
  1951 000015C1 89F7                <1> 		mov edi, esi
  1952 000015C3 46                  <1> 		inc esi
  1953 000015C4 8A06                <1> 		mov al, [esi]
  1954 000015C6 3C24                <1> 		cmp al, '$'
  1955 000015C8 0F8474000000        <1> 		je near varnum3
  1956 000015CE 3C25                <1> 		cmp al, '%'
  1957 000015D0 0F8443000000        <1> 		je near resultnum2
  1958                              <1> 	varnum4: 
  1959 000015D6 57                  <1> 		push edi
  1960 000015D7 E887000000          <1> 		call checkdecimal2
  1961 000015DC 5F                  <1> 		pop edi
  1962 000015DD E803FDFFFF          <1> 		call cnvrttxt
  1963                              <1> 	vrnm4:
  1964 000015E2 5B                  <1> 		pop ebx
  1965 000015E3 58                  <1> 		pop eax
  1966 000015E4 3C2B                <1> 		cmp al, '+'
  1967 000015E6 0F84B9000000        <1> 		je near plusnum
  1968 000015EC 3C2D                <1> 		cmp al, '-'
  1969 000015EE 0F84BD000000        <1> 		je near subnum
  1970 000015F4 3C2A                <1> 		cmp al, '*'
  1971 000015F6 0F84C1000000        <1> 		je near mulnum
  1972 000015FC 3C2F                <1> 		cmp al, '/'
  1973 000015FE 0F84CF000000        <1> 		je near divnum
  1974 00001604 3C5E                <1> 		cmp al, '^'
  1975 00001606 0F84ED000000        <1> 		je near expnum
  1976 0000160C E9B0F7FFFF          <1> 		jmp nwcmd
  1977                              <1> 	resultnum1:
  1978 00001611 8B0D[04180000]      <1> 		mov ecx, [result]
  1979 00001617 EB9B                <1> 		jmp vrnm2
  1980                              <1> 	resultnum2:
  1981 00001619 8B0D[04180000]      <1> 		mov ecx, [result]
  1982 0000161F EBC1                <1> 		jmp vrnm4
  1983 00001621 81EE[701A0000]      <1> 	varnum1: sub esi, buftxt
  1984 00001627 89F7                <1> 		mov edi, esi
  1985 00001629 81C6[701A0000]      <1> 		add esi, buftxt
  1986 0000162F 47                  <1> 		inc edi
  1987 00001630 BB[6F150000]        <1> 		mov ebx, variables
  1988 00001635 E8D2FEFFFF          <1> 		call nxtvrech
  1989 0000163A 89F7                <1> 		mov edi, esi
  1990 0000163C 4F                  <1> 		dec edi
  1991 0000163D E966FFFFFF          <1> 		jmp varnum2
  1992 00001642 81EE[701A0000]      <1> 	varnum3: sub esi, buftxt
  1993 00001648 89F7                <1> 		mov edi, esi
  1994 0000164A 81C6[701A0000]      <1> 		add esi, buftxt
  1995 00001650 47                  <1> 		inc edi
  1996 00001651 BB[6F150000]        <1> 		mov ebx, variables
  1997 00001656 E8B1FEFFFF          <1> 		call nxtvrech
  1998 0000165B 89F7                <1> 		mov edi, esi
  1999 0000165D 4F                  <1> 		dec edi
  2000 0000165E E973FFFFFF          <1> 		jmp varnum4
  2001                              <1> 	checkdecimal2:
  2002 00001663 8A25[02180000]      <1> 		mov ah, [decimal]
  2003 00001669 8825[03180000]      <1> 		mov [decimal2], ah
  2004 0000166F B400                <1> 		mov ah, 0
  2005 00001671 8825[02180000]      <1> 		mov [decimal], ah
  2006                              <1> 	checkdecimal:
  2007 00001677 89F7                <1> 		mov edi, esi
  2008                              <1> 	chkdec1:
  2009 00001679 8A07                <1> 		mov al, [edi]
  2010 0000167B 3C2E                <1> 		cmp al, '.'
  2011 0000167D 0F840B000000        <1> 		je near fnddec
  2012 00001683 3C00                <1> 		cmp al, 0
  2013 00001685 0F8419000000        <1> 		je near nodecimal
  2014 0000168B 47                  <1> 		inc edi
  2015 0000168C EBEB                <1> 		jmp chkdec1
  2016                              <1> 	fnddec:
  2017 0000168E 8A4701              <1> 		mov al, [edi + 1]
  2018 00001691 8807                <1> 		mov [edi], al
  2019 00001693 3C00                <1> 		cmp al, 0
  2020 00001695 0F8409000000        <1> 		je near nodecimal
  2021 0000169B FE05[02180000]      <1> 		inc byte [decimal]
  2022 000016A1 47                  <1> 		inc edi
  2023 000016A2 EBEA                <1> 		jmp fnddec
  2024                              <1> 	nodecimal:
  2025 000016A4 C3                  <1> 		ret
  2026                              <1> 	plusnum:
  2027 000016A5 E816010000          <1> 		call decaddfix
  2028 000016AA 01D9                <1> 		add ecx, ebx
  2029 000016AC E991000000          <1> 		jmp retnum
  2030                              <1> 	subnum:
  2031 000016B1 E80A010000          <1> 		call decaddfix
  2032 000016B6 29D9                <1> 		sub ecx, ebx
  2033 000016B8 E985000000          <1> 		jmp retnum
  2034                              <1> 	mulnum:
  2035 000016BD A0[03180000]        <1> 		mov al, [decimal2]
  2036 000016C2 0005[02180000]      <1> 		add [decimal], al
  2037 000016C8 89C8                <1> 		mov eax, ecx
  2038 000016CA F7E3                <1> 		mul ebx
  2039 000016CC 89C1                <1> 		mov ecx, eax
  2040 000016CE E96F000000          <1> 		jmp retnum
  2041                              <1> 	divnum:
  2042 000016D3 E8E8000000          <1> 		call decaddfix
  2043 000016D8 B000                <1> 		mov al, 0
  2044 000016DA A2[02180000]        <1> 		mov [decimal], al
  2045 000016DF 6689C8              <1> 		mov ax, cx
  2046 000016E2 80FB00              <1> 		cmp bl, 0
  2047 000016E5 0F8457000000        <1> 		je near retnum
  2048 000016EB F6F3                <1> 		div bl
  2049 000016ED B900000000          <1> 		mov ecx, 0
  2050 000016F2 88C1                <1> 		mov cl, al
  2051 000016F4 E949000000          <1> 		jmp retnum
  2052                              <1> 	expnum:
  2053 000016F9 8A15[02180000]      <1> 		mov dl, [decimal]
  2054 000016FF 8815[03180000]      <1> 		mov [decimal2], dl
  2055 00001705 BA00000000          <1> 		mov edx, 0
  2056 0000170A 89C8                <1> 		mov eax, ecx
  2057 0000170C 89D9                <1> 		mov ecx, ebx
  2058 0000170E 89C3                <1> 		mov ebx, eax
  2059 00001710 81F900000000        <1> 		cmp ecx, 0
  2060 00001716 7425                <1> 		je noexpnum
  2061 00001718 49                  <1> 		dec ecx
  2062 00001719 81F900000000        <1> 		cmp ecx, 0
  2063 0000171F 7415                <1> 		je noexpnumlp
  2064 00001721 F7E3                <1> 	expnumlp: mul ebx
  2065 00001723 8A15[03180000]      <1> 		mov dl, [decimal2]
  2066 00001729 0015[02180000]      <1> 		add [decimal], dl
  2067 0000172F BA00000000          <1> 		mov edx, 0
  2068 00001734 E2EB                <1> 		loop expnumlp
  2069                              <1> 	noexpnumlp:
  2070 00001736 89C1                <1> 		mov ecx, eax
  2071 00001738 E905000000          <1> 		jmp retnum
  2072                              <1> 	noexpnum:
  2073 0000173D B901000000          <1> 		mov ecx, 1
  2074                              <1> 	retnum: 
  2075 00001742 BE[841C0000]        <1> 		mov esi, numbuf
  2076 00001747 890D[04180000]      <1> 		mov [result], ecx
  2077 0000174D E8E6F8FFFF          <1> 		call convert
  2078 00001752 BE[841C0000]        <1> 		mov esi, numbuf
  2079 00001757 8A25[02180000]      <1> 		mov ah, [decimal]
  2080 0000175D 80FC00              <1> 		cmp ah, 0
  2081 00001760 0F8425000000        <1> 		je near noputdecimal
  2082                              <1> 	putdecimal:
  2083 00001766 4E                  <1> 		dec esi
  2084 00001767 FECC                <1> 		dec ah
  2085 00001769 80FC00              <1> 		cmp ah, 0
  2086 0000176C 0F87F4FFFFFF        <1> 		ja near putdecimal
  2087 00001772 4E                  <1> 		dec esi
  2088 00001773 8A06                <1> 		mov al, [esi]
  2089 00001775 C6062E              <1> 		mov byte [esi], '.'
  2090                              <1> 	decputloop:
  2091 00001778 4E                  <1> 		dec esi
  2092 00001779 8A26                <1> 		mov ah, [esi]
  2093 0000177B 8806                <1> 		mov [esi], al
  2094 0000177D 88E0                <1> 		mov al, ah
  2095 0000177F 81FE[701C0000]      <1> 		cmp esi, buf2
  2096 00001785 0F87EDFFFFFF        <1> 		ja near decputloop
  2097                              <1> 	noputdecimal:
  2098 0000178B BE[701C0000]        <1> 		mov esi, buf2
  2099 00001790 E809000000          <1> 		call chkadd
  2100 00001795 E927F6FFFF          <1> 		jmp nwcmd
  2101 0000179A 00000000            <1> edxnumbuf dw 0,0
  2102 0000179E 8A06                <1> 	chkadd: mov al, [esi]
  2103 000017A0 3C30                <1> 		cmp al, '0'
  2104 000017A2 750C                <1> 		jne dnadd
  2105 000017A4 46                  <1> 		inc esi
  2106 000017A5 81FE[841C0000]      <1> 		cmp esi, numbuf
  2107 000017AB 7402                <1> 		je dnaddm1
  2108 000017AD EBEF                <1> 		jmp chkadd
  2109 000017AF 4E                  <1> 	dnaddm1: dec esi
  2110 000017B0 E854F3FFFF          <1> 	dnadd:	call print
  2111 000017B5 BE[9D3F0000]        <1> 		mov esi, line
  2112 000017BA E84AF3FFFF          <1> 		call print
  2113 000017BF C3                  <1> 		ret
  2114                              <1> 		
  2115                              <1> 	decaddfix:
  2116 000017C0 A0[03180000]        <1> 		mov al, [decimal2]
  2117 000017C5 8A25[02180000]      <1> 		mov ah, [decimal]
  2118 000017CB 38E0                <1> 		cmp al, ah
  2119 000017CD 7432                <1> 		je gooddecadd
  2120 000017CF 38E0                <1> 		cmp al, ah
  2121 000017D1 721A                <1> 		jb lowdecadd
  2122                              <1> 	highdecadd:
  2123 000017D3 FEC4                <1> 		inc ah
  2124 000017D5 89CA                <1> 		mov edx, ecx
  2125 000017D7 C1E103              <1> 		shl ecx, 3
  2126 000017DA 01D1                <1> 		add ecx, edx
  2127 000017DC 01D1                <1> 		add ecx, edx
  2128 000017DE 38E0                <1> 		cmp al, ah
  2129 000017E0 77F1                <1> 		ja highdecadd
  2130 000017E2 8825[02180000]      <1> 		mov [decimal], ah
  2131 000017E8 E914000000          <1> 		jmp gooddecadd
  2132                              <1> 	lowdecadd:
  2133 000017ED FEC0                <1> 		inc al
  2134 000017EF 89DA                <1> 		mov edx, ebx
  2135 000017F1 C1E303              <1> 		shl ebx, 3
  2136 000017F4 01D3                <1> 		add ebx, edx
  2137 000017F6 01D3                <1> 		add ebx, edx
  2138 000017F8 38E0                <1> 		cmp al, ah
  2139 000017FA 72F1                <1> 		jb lowdecadd
  2140 000017FC A2[02180000]        <1> 		mov [decimal], al
  2141                              <1> 	gooddecadd:
  2142 00001801 C3                  <1> 		ret
  2143                              <1> 		
  2144 00001802 00                  <1> decimal db 0
  2145 00001803 00                  <1> decimal2 db 0
  2146 00001804 00000000            <1> result db 0,0,0,0
  2147                              <1> 	
  2148 00001808 05042500            <1> db 5,4,"%",0
  2149 0000180C E812F8FFFF          <1> 	ans:	call clearbuffer
  2150 00001811 8B0D[04180000]      <1> 		mov ecx, [result]
  2151 00001817 BE[701C0000]        <1> 		mov esi, buf2
  2152 0000181C E817F8FFFF          <1> 		call convert
  2153 00001821 BE[701C0000]        <1> 		mov esi, buf2
  2154 00001826 E873FFFFFF          <1> 		call chkadd
  2155 0000182B E991F5FFFF          <1> 		jmp nwcmd
  2156                              <1> 
  2157 00001830 05042400            <1> db 5,4,"$",0
  2158 00001834 BE[701A0000]        <1> var:	mov esi, buftxt
  2159 00001839 BB[6F150000]        <1> 	mov ebx, variables
  2160 0000183E 8A06                <1> lkeq:	mov al, [esi]
  2161 00001840 3C3D                <1> 	cmp al, '='
  2162 00001842 741F                <1> 	je eqfnd	;is there an '=' sign?
  2163 00001844 3C00                <1> 	cmp al, 0
  2164 00001846 7403                <1> 	je echovars
  2165 00001848 46                  <1> 	inc esi
  2166 00001849 EBF3                <1> 	jmp lkeq
  2167 0000184B BE[6F150000]        <1> echovars: mov esi, variables
  2168 00001850 BB[6F1A0000]        <1> 	mov ebx, varend
  2169 00001855 B105                <1> 	mov cl, 5
  2170 00001857 B504                <1> 	mov ch, 4
  2171 00001859 E864F7FFFF          <1> 	call array
  2172 0000185E E95EF5FFFF          <1> 	jmp nwcmd
  2173 00001863 46                  <1> eqfnd:	inc esi
  2174 00001864 8A06                <1> 	mov al, [esi]
  2175 00001866 3C00                <1> 	cmp al, 0
  2176 00001868 740F                <1> 	je readvar
  2177 0000186A BE[701A0000]        <1> 	mov esi, buftxt
  2178 0000186F BB[6F150000]        <1> 	mov ebx, variables
  2179 00001874 E917000000          <1> 	jmp seek
  2180                              <1> readvar: 
  2181 00001879 B00D                <1> 	mov al, 13
  2182 0000187B B404                <1> 	mov ah, 4
  2183 0000187D B307                <1> 	mov bl, 7
  2184 0000187F E8A4F0FFFF          <1> 	call intx4
  2185 00001884 BE[9D3F0000]        <1> 	mov esi, line
  2186 00001889 E87BF2FFFF          <1> 	call print
  2187 0000188E EBA4                <1> 	jmp var
  2188 00001890 668B03              <1> seek:	mov ax, [ebx]
  2189 00001893 B105                <1> 	mov cl, 5
  2190 00001895 B504                <1> 	mov ch, 4
  2191 00001897 663D0000            <1> 	cmp ax, 0
  2192 0000189B 0F8459000000        <1> 	je near save
  2193 000018A1 6639C8              <1> 	cmp ax, cx
  2194 000018A4 7403                <1> 	je skfnd
  2195 000018A6 43                  <1> 	inc ebx
  2196 000018A7 EBE7                <1> 	jmp seek
  2197 000018A9 BE[701A0000]        <1> skfnd:	mov esi, buftxt
  2198 000018AE 46                  <1> 	inc esi
  2199 000018AF 81C302000000        <1> 	add ebx, 2
  2200 000018B5 89DF                <1> 	mov edi, ebx
  2201 000018B7 B13D                <1> 	mov cl, '='
  2202 000018B9 E842F6FFFF          <1> 	call cndtest
  2203 000018BE 3C01                <1> 	cmp al, 1	
  2204 000018C0 7417                <1> 	je varfnd
  2205 000018C2 89FB                <1> 	mov ebx, edi
  2206 000018C4 BE[701A0000]        <1> 	mov esi, buftxt
  2207 000018C9 668B03              <1> 	mov ax, [ebx]
  2208 000018CC 663D0000            <1> 	cmp ax, 0
  2209 000018D0 0F8424000000        <1> 	je near save
  2210 000018D6 43                  <1> 	inc ebx
  2211 000018D7 EBB7                <1> 	jmp seek
  2212 000018D9 8A03                <1> varfnd:	mov al, [ebx]
  2213 000018DB 3C04                <1> 	cmp al, 4
  2214 000018DD 7404                <1> 	je save2
  2215 000018DF 4B                  <1> 	dec ebx
  2216 000018E0 4E                  <1> 	dec esi
  2217 000018E1 EBF6                <1> 	jmp varfnd
  2218 000018E3 4B                  <1> save2:	dec ebx
  2219 000018E4 4E                  <1> 	dec esi
  2220 000018E5 8A03                <1> 	mov al, [ebx]
  2221 000018E7 3C05                <1> 	cmp al, 5
  2222 000018E9 7402                <1> 	je remove
  2223 000018EB EBEC                <1> 	jmp varfnd
  2224 000018ED 8A03                <1> remove: mov al, [ebx]
  2225 000018EF 3C00                <1> 	cmp al, 0
  2226 000018F1 749D                <1> 	je seek
  2227 000018F3 B000                <1> 	mov al, 0
  2228 000018F5 8803                <1> 	mov [ebx], al
  2229 000018F7 43                  <1> 	inc ebx
  2230 000018F8 EBF3                <1> 	jmp remove	;do not need for now-need defragmentation
  2231 000018FA BE[701A0000]        <1> save:	mov esi, buftxt
  2232 000018FF 43                  <1> 	inc ebx
  2233 00001900 B005                <1> 	mov al, 5
  2234 00001902 B404                <1> 	mov ah, 4
  2235 00001904 668903              <1> 	mov [ebx], ax
  2236 00001907 43                  <1> 	inc ebx
  2237 00001908 43                  <1> svhere:	inc ebx
  2238 00001909 46                  <1> 	inc esi
  2239 0000190A 8A06                <1> 	mov al, [esi]
  2240 0000190C 3C00                <1> 	cmp al, 0
  2241 0000190E 0F8442000000        <1> 	je near svdone
  2242 00001914 3C25                <1> 	cmp al, '%'
  2243 00001916 7404                <1> 	je ans2
  2244 00001918 8803                <1> 	mov [ebx], al	
  2245 0000191A EBEC                <1> 	jmp svhere
  2246 0000191C 56                  <1> ans2:	push esi
  2247 0000191D BE[701C0000]        <1> 	mov esi, buf2
  2248 00001922 E823000000          <1> 	call ansfnd
  2249 00001927 E803000000          <1> 	call anscp
  2250 0000192C 5E                  <1> 	pop esi
  2251 0000192D EBD9                <1> 	jmp svhere
  2252 0000192F 8A06                <1> anscp:	mov al, [esi]
  2253 00001931 8803                <1> 	mov [ebx], al
  2254 00001933 81FE[841C0000]      <1> 	cmp esi, numbuf
  2255 00001939 74CD                <1> 	je svhere
  2256 0000193B 3C00                <1> 	cmp al, 0
  2257 0000193D 74C9                <1> 	je svhere
  2258 0000193F 43                  <1> 	inc ebx
  2259 00001940 46                  <1> 	inc esi
  2260 00001941 EBEC                <1> 	jmp anscp
  2261 00001943 5E                  <1> ansnf:	pop esi
  2262 00001944 8A06                <1> 	mov al, [esi]
  2263 00001946 8803                <1> 	mov [ebx], al
  2264 00001948 EBBE                <1> 	jmp svhere
  2265 0000194A 46                  <1> ansfnd:	inc esi
  2266 0000194B 8A06                <1> 	mov al, [esi]
  2267 0000194D 3C00                <1> 	cmp al, 0
  2268 0000194F 74F2                <1> 	je ansnf
  2269 00001951 3C30                <1> 	cmp al, '0'
  2270 00001953 74F5                <1> 	je ansfnd
  2271 00001955 C3                  <1> 	ret
  2272 00001956 B000                <1> svdone:	mov al, 0
  2273 00001958 8803                <1> 	mov [ebx], al
  2274 0000195A E962F4FFFF          <1> 	jmp nwcmd
  2275                              <1> 	
  2276                              <1> 	
  2277 0000195F 05042E2F00          <1> 	db 5,4,"./",0
  2278                              <1> rundiskprog:
  2279 00001964 BF[701A0000]        <1> 	mov edi, buftxt
  2280 00001969 81C702000000        <1> 	add edi, 2
  2281 0000196F BE00001000          <1> 	mov esi, 0x100000
  2282 00001974 E815240000          <1> 	call loadfile
  2283 00001979 81FA94010000        <1> 	cmp edx, 404
  2284 0000197F 7414                <1> 	je noprogfound
  2285 00001981 BB00001000          <1> 	mov ebx, 0x100000
  2286 00001986 66813B4558          <1> 	cmp word [ebx], "EX"
  2287 0000198B 7531                <1> 	jne progbatchfound
  2288 0000198D 81C302000000        <1> 	add ebx, 2
  2289 00001993 FFE3                <1> 	jmp ebx
  2290                              <1> noprogfound:
  2291 00001995 BE[623F0000]        <1> 	mov esi, notfound1
  2292 0000199A E86AF1FFFF          <1> 	call print
  2293 0000199F BE[701A0000]        <1> 	mov esi, buftxt
  2294 000019A4 81C602000000        <1> 	add esi, 2
  2295 000019AA E85AF1FFFF          <1> 	call print
  2296 000019AF BE[6C3F0000]        <1> 	mov esi, notfound2
  2297 000019B4 E850F1FFFF          <1> 	call print
  2298 000019B9 E903F4FFFF          <1> 	jmp nwcmd
  2299                              <1> progbatchfound:
  2300 000019BE BF00001000          <1> 		mov edi, 0x100000
  2301 000019C3 C605[69130000]01    <1> 		mov byte [BATCHISON], 1
  2302                              <1> 	batchrunloop:
  2303 000019CA E8CFF3FFFF          <1> 		call buftxtclear
  2304 000019CF BE[701A0000]        <1> 		mov esi, buftxt
  2305                              <1> 	batchrunloop2:
  2306 000019D4 B10D                <1> 		mov cl, 13
  2307 000019D6 B50A                <1> 		mov ch, 10
  2308 000019D8 66390F              <1> 		cmp [edi], cx
  2309 000019DB 0F841E000000        <1> 		je near nxtbatchrunline
  2310 000019E1 66C1C108            <1> 		rol cx, 8
  2311 000019E5 66390F              <1> 		cmp [edi], cx
  2312 000019E8 0F8411000000        <1> 		je near nxtbatchrunline
  2313 000019EE 803F00              <1> 		cmp byte [edi], 0
  2314 000019F1 0F8408000000        <1> 		je near nxtbatchrunline
  2315 000019F7 8A07                <1> 		mov al, [edi]
  2316 000019F9 8806                <1> 		mov [esi], al
  2317 000019FB 46                  <1> 		inc esi
  2318 000019FC 47                  <1> 		inc edi
  2319 000019FD EBD5                <1> 		jmp batchrunloop2
  2320                              <1> 	nxtbatchrunline:
  2321 000019FF 81C702000000        <1> 		add edi, 2
  2322 00001A05 893D[641A0000]      <1> 		mov [batchedi], edi
  2323 00001A0B C60600              <1> 		mov byte [esi], 0
  2324 00001A0E BE[701A0000]        <1> 		mov esi, buftxt
  2325 00001A13 803E00              <1> 		cmp byte [esi], 0
  2326 00001A16 0F843C000000        <1> 		je near nobatchfoundrun
  2327 00001A1C BB00000000          <1> 		mov ebx, 0
  2328 00001A21 8A1D[00130000]      <1> 		mov bl, [IFON]
  2329 00001A27 80FB01              <1> 		cmp bl, 1
  2330 00001A2A 0F8338000000        <1> 		jae near iftestbatch
  2331                              <1> 	doneiftest:
  2332 00001A30 803D[2B1B0000]00    <1> 		cmp byte [runnextline], 0
  2333 00001A37 0F8405000000        <1> 		je near noruniftest
  2334 00001A3D E809F4FFFF          <1> 		call progtest
  2335                              <1> 	noruniftest:
  2336 00001A42 C605[2B1B0000]01    <1> 		mov byte [runnextline], 1
  2337 00001A49 8B3D[641A0000]      <1> 		mov edi, [batchedi]
  2338 00001A4F 803F00              <1> 		cmp byte [edi], 0
  2339 00001A52 0F8572FFFFFF        <1> 		jne near batchrunloop
  2340                              <1> 	nobatchfoundrun:
  2341 00001A58 C605[69130000]00    <1> 		mov byte [BATCHISON], 0
  2342 00001A5F E95DF3FFFF          <1> 		jmp nwcmd
  2343                              <1> 	
  2344 00001A64 00000000            <1> batchedi dd 0	
  2345                              <1> 	
  2346                              <1> 	iftestbatch:
  2347 00001A68 BE[01130000]        <1> 		mov esi, IFTRUE
  2348 00001A6D 01DE                <1> 		add esi, ebx
  2349 00001A6F 803E00              <1> 		cmp byte [esi], 0
  2350 00001A72 0F85B8FFFFFF        <1> 		jne near doneiftest
  2351 00001A78 881D[2C1B0000]      <1> 		mov [iffalsebuf], bl
  2352 00001A7E 803D[6A130000]01    <1> 		cmp byte [LOOPON], 1
  2353 00001A85 750B                <1> 		jne fifindbatch
  2354 00001A87 8B3D[6B130000]      <1> 		mov edi, [LOOPPOS]
  2355 00001A8D E938FFFFFF          <1> 		jmp batchrunloop
  2356                              <1> 	fifindbatch:
  2357 00001A92 66B96966            <1> 		mov cx, "if"
  2358 00001A96 66B86669            <1> 		mov ax, "fi"
  2359 00001A9A 663907              <1> 		cmp [edi], ax
  2360 00001A9D 0F841A000000        <1> 		je near fifoundbatch
  2361 00001AA3 66390F              <1> 		cmp [edi], cx
  2362 00001AA6 0F8462000000        <1> 		je near iffoundbatch
  2363 00001AAC 803F00              <1> 		cmp byte [edi], 0
  2364 00001AAF 0F8408000000        <1> 		je near fifoundbatch
  2365 00001AB5 81C702000000        <1> 		add edi, 2
  2366 00001ABB EBD5                <1> 		jmp fifindbatch
  2367                              <1> 	fifoundbatch:
  2368 00001ABD 81C702000000        <1> 		add edi, 2
  2369 00001AC3 B00D                <1> 		mov al, 13
  2370 00001AC5 B40A                <1> 		mov ah, 10
  2371 00001AC7 663907              <1> 		cmp [edi], ax
  2372 00001ACA 7414                <1> 		je goodfibatch
  2373 00001ACC 66C1C008            <1> 		rol ax, 8
  2374 00001AD0 663907              <1> 		cmp [edi], ax
  2375 00001AD3 740B                <1> 		je goodfibatch
  2376 00001AD5 803F00              <1> 		cmp byte [edi], 0
  2377 00001AD8 0F847AFFFFFF        <1> 		je near nobatchfoundrun
  2378 00001ADE EBB2                <1> 		jmp fifindbatch
  2379                              <1> 	goodfibatch:
  2380 00001AE0 B001                <1> 		mov al, 1
  2381 00001AE2 2805[00130000]      <1> 		sub [IFON], al 
  2382 00001AE8 A0[00130000]        <1> 		mov al, [IFON]
  2383 00001AED 8A1D[2C1B0000]      <1> 		mov bl, [iffalsebuf]
  2384 00001AF3 38D8                <1> 		cmp al, bl
  2385 00001AF5 779B                <1> 		ja fifindbatch
  2386 00001AF7 BE[701A0000]        <1> 		mov esi, buftxt
  2387 00001AFC 81EF02000000        <1> 		sub edi, 2
  2388 00001B02 C605[2B1B0000]00    <1> 		mov byte [runnextline], 0
  2389 00001B09 E9BCFEFFFF          <1> 		jmp batchrunloop
  2390                              <1> 	iffoundbatch:
  2391 00001B0E B020                <1> 		mov al, ' '
  2392 00001B10 81C702000000        <1> 		add edi, 2
  2393 00001B16 3807                <1> 		cmp [edi], al
  2394 00001B18 0F8574FFFFFF        <1> 		jne near fifindbatch
  2395 00001B1E B001                <1> 		mov al, 1
  2396 00001B20 0005[00130000]      <1> 		add [IFON], al
  2397 00001B26 E967FFFFFF          <1> 		jmp fifindbatch
  2398                              <1> 		
  2399                              <1> 		
  2400 00001B2B 01                  <1> runnextline db 1
  2401 00001B2C 00                  <1> iffalsebuf db 0
  2402                              <1> 
  2403 00001B2D E98FF2FFFF          <1> notbatch: jmp nwcmd
  2404                              <1> 
  2405 00001B32 05047768696C6500    <1> 	db 5,4,"while",0
  2406 00001B3A B000                <1> while:  mov al, 0
  2407 00001B3C 3805[69130000]      <1> 	cmp [BATCHISON], al
  2408 00001B42 0F84E5FFFFFF        <1> 	je near notbatch
  2409 00001B48 8B35[65130000]      <1> 	MOV esi, [BATCHPOS]
  2410 00001B4E 4E                  <1> whilefnd: dec esi
  2411 00001B4F 8A06                <1> 	mov al, [esi]
  2412 00001B51 3C0A                <1> 	cmp al, 10
  2413 00001B53 0F8412000000        <1> 	je near whilefnd2
  2414 00001B59 3C0D                <1> 	cmp al, 13
  2415 00001B5B 0F840A000000        <1> 	je near whilefnd2
  2416 00001B61 3C00                <1> 	cmp al, 0
  2417 00001B63 0F8402000000        <1> 	je near whilefnd2
  2418 00001B69 EBE3                <1> 	jmp whilefnd
  2419                              <1> whilefnd2:
  2420 00001B6B 8935[6B130000]      <1> 	mov [LOOPPOS], esi
  2421 00001B71 C605[6A130000]01    <1> 	mov BYTE [LOOPON], 1
  2422 00001B78 0005[00130000]      <1> 	add [IFON], al
  2423 00001B7E BE[701A0000]        <1> 	mov esi, buftxt
  2424 00001B83 BB[701A0000]        <1> 	mov ebx, buftxt
  2425 00001B88 81C306000000        <1> 	add ebx, 6
  2426 00001B8E E923000000          <1> 	jmp chkeqsn
  2427                              <1> 
  2428                              <1> 
  2429 00001B93 0504696600          <1> 	db 5,4,"if",0
  2430 00001B98 B000                <1> if:	mov al, 0
  2431 00001B9A 3805[69130000]      <1> 	cmp [BATCHISON], al
  2432 00001BA0 0F8487FFFFFF        <1> 	je near notbatch
  2433 00001BA6 BE[701A0000]        <1> 	mov esi, buftxt
  2434 00001BAB BB[701A0000]        <1> 	mov ebx, buftxt
  2435 00001BB0 81C303000000        <1> 	add ebx, 3
  2436 00001BB6 8A06                <1> chkeqsn: mov al, [esi]
  2437 00001BB8 3C00                <1> 	cmp al, 0
  2438 00001BBA 0F846DFFFFFF        <1> 	je near notbatch
  2439 00001BC0 3C3D                <1> 	cmp al, '='
  2440 00001BC2 0F8403000000        <1> 	je near chkeqdn
  2441 00001BC8 46                  <1> 	inc esi
  2442 00001BC9 EBEB                <1> 	jmp chkeqsn
  2443 00001BCB B000                <1> chkeqdn: mov al, 0 
  2444 00001BCD 8806                <1> 	mov [esi], al
  2445 00001BCF 46                  <1> 	inc esi
  2446 00001BD0 8A06                <1> 	mov al, [esi]
  2447 00001BD2 3C24                <1> 	cmp al, '$'
  2448 00001BD4 0F8462000000        <1> 	je near ifvar1
  2449 00001BDA 8A03                <1> ifvar2: mov al, [ebx]
  2450 00001BDC 3C24                <1> 	cmp al, '$'
  2451 00001BDE 0F847B000000        <1> 	je near ifvar3
  2452 00001BE4 E8DDF2FFFF          <1> ifvar4:	call tester
  2453 00001BE9 3C01                <1> 	cmp al, 1
  2454 00001BEB 0F8405000000        <1> 	je near trueif
  2455 00001BF1 E923000000          <1> 	jmp falseif
  2456 00001BF6 B800000000          <1> trueif:	mov eax, 0
  2457 00001BFB A0[00130000]        <1> 	mov al, [IFON]
  2458 00001C00 FEC0                <1> 	inc al
  2459 00001C02 A2[00130000]        <1> 	mov [IFON], al
  2460 00001C07 B400                <1> 	mov ah, 0
  2461 00001C09 BE[01130000]        <1> 	mov esi, IFTRUE
  2462 00001C0E 01C6                <1> 	add esi, eax
  2463 00001C10 B401                <1> 	mov ah, 1
  2464 00001C12 8826                <1> 	mov [esi], ah
  2465 00001C14 E9A8F1FFFF          <1> 	jmp nwcmd
  2466 00001C19 B800000000          <1> falseif: mov eax, 0
  2467 00001C1E A0[00130000]        <1> 	mov al, [IFON]
  2468 00001C23 FEC0                <1> 	inc al
  2469 00001C25 A2[00130000]        <1> 	mov [IFON], al
  2470 00001C2A B400                <1> 	mov ah, 0
  2471 00001C2C BE[01130000]        <1> 	mov esi, IFTRUE
  2472 00001C31 01C6                <1> 	add esi, eax
  2473 00001C33 B400                <1> 	mov ah, 0
  2474 00001C35 8826                <1> 	mov [esi], ah
  2475 00001C37 E985F1FFFF          <1> 	jmp nwcmd
  2476 00001C3C 89F7                <1> ifvar1: mov edi, esi
  2477 00001C3E 81EF[701A0000]      <1> 	sub edi, buftxt
  2478 00001C44 47                  <1> 	inc edi
  2479 00001C45 BB[6F150000]        <1> 	mov ebx, variables
  2480 00001C4A E8BDF8FFFF          <1> 	call nxtvrech
  2481 00001C4F BB[701A0000]        <1> 	mov ebx, buftxt
  2482 00001C54 81C303000000        <1> 	add ebx, 3
  2483 00001C5A E97BFFFFFF          <1> 	jmp ifvar2
  2484 00001C5F 8935[7F1C0000]      <1> ifvar3: mov [esiif], esi
  2485 00001C65 BF04000000          <1> 	mov edi, 4
  2486 00001C6A BB[6F150000]        <1> 	mov ebx, variables
  2487 00001C6F E898F8FFFF          <1> 	call nxtvrech
  2488 00001C74 8B35[7F1C0000]      <1> 	mov esi, [esiif]
  2489 00001C7A E965FFFFFF          <1> 	jmp ifvar4
  2490                              <1> 
  2491 00001C7F 00000000            <1> esiif dd 0
  2492                              <1> 	
  2493 00001C83 0504656C736500      <1> 	db 5,4,"else",0
  2494 00001C8A B800000000          <1> else:	mov eax, 0
  2495 00001C8F A0[00130000]        <1> 	mov al, [IFON]
  2496 00001C94 BE[01130000]        <1> 	mov esi, IFTRUE
  2497 00001C99 01C6                <1> 	add esi, eax
  2498 00001C9B 8A06                <1> 	mov al, [esi]
  2499 00001C9D 3C00                <1> 	cmp al, 0		
  2500 00001C9F 7409                <1> 	je else1
  2501 00001CA1 3C01                <1> 	cmp al, 1
  2502 00001CA3 740E                <1> 	je else2
  2503 00001CA5 E917F1FFFF          <1> 	jmp nwcmd
  2504 00001CAA B001                <1> else1:  mov al, 1
  2505 00001CAC 8806                <1> 	mov [esi], al
  2506 00001CAE E90EF1FFFF          <1> 	jmp nwcmd
  2507 00001CB3 B000                <1> else2:	mov al, 0
  2508 00001CB5 8806                <1> 	mov [esi], al
  2509 00001CB7 E905F1FFFF          <1> 	jmp nwcmd
  2510                              <1> 
  2511 00001CBC 05046C6F6F7000      <1> 	db 5,4,"loop",0
  2512 00001CC3 3805[6A130000]      <1> 	cmp [LOOPON], al
  2513 00001CC9 0F8405000000        <1> 	je near filoop
  2514 00001CCF E9EDF0FFFF          <1> 	jmp nwcmd
  2515 00001CD4 8B35[6B130000]      <1> filoop: mov esi, [LOOPPOS]
  2516 00001CDA 8935[65130000]      <1> 	mov [BATCHPOS], esi
  2517 00001CE0 E9DCF0FFFF          <1> 	jmp nwcmd
  2518                              <1> 	
  2519                              <1> 
  2520 00001CE5 0504666900          <1> 	db 5,4,"fi",0
  2521 00001CEA B000                <1> 	mov al, 0
  2522 00001CEC 3805[69130000]      <1> 	cmp [BATCHISON], al
  2523 00001CF2 0F8435FEFFFF        <1> 	je near notbatch
  2524 00001CF8 B001                <1> fi:	mov al, 1
  2525 00001CFA 2805[00130000]      <1> 	sub [IFON],al
  2526 00001D00 E9BCF0FFFF          <1> 	jmp nwcmd
  2527                              <1> 
  2528 00001D05 050473746F7000      <1> 	db 5,4,"stop",0
  2529 00001D0C B000                <1> stop:	mov al, 0
  2530 00001D0E A2[69130000]        <1> 	mov [BATCHISON], al
  2531 00001D13 A2[00130000]        <1> 	mov [IFON], al
  2532 00001D18 A2[01130000]        <1> 	mov [IFTRUE], al
  2533 00001D1D A2[6A130000]        <1> 	mov [LOOPON], al
  2534 00001D22 E99AF0FFFF          <1> 	jmp nwcmd
  2535                                      %include 'source/programs.asm'
  2536                              <1> 
  2537                              <1> ;db 5,4,"internet",0
  2538                              <1> 	internettest: 			;;initialize network card, lets hope this is right
  2539                              <1> 							;;^^used to^^, now tests int 30h functions		
  2540 00001D27 B403                <1> 		mov ah, 3
  2541 00001D29 CD30                <1> 		int 30h
  2542 00001D2B B401                <1> 		mov ah, 1
  2543 00001D2D BE[3F1D0000]        <1> 		mov esi, datmsg
  2544 00001D32 66BB0700            <1> 		mov bx, 7
  2545 00001D36 B000                <1> 		mov al, 0
  2546 00001D38 CD30                <1> 		int 30h
  2547                              <1> 	;jmp packettest
  2548 00001D3A E982F0FFFF          <1> 		jmp nwcmd
  2549 00001D3F 496E7465726E657420- <1> datmsg: db "Internet has not been implemented yet.",10,13,0
  2550 00001D48 686173206E6F742062- <1>
  2551 00001D51 65656E20696D706C65- <1>
  2552 00001D5A 6D656E746564207965- <1>
  2553 00001D63 742E0A0D00          <1>
  2554                              <1> 		
  2555 00001D68 050470636900        <1> db 5,4,"pci",0
  2556                              <1> 	pcishow:
  2557 00001D6E E8611E0000          <1> 	call pcidump
  2558 00001D73 E949F0FFFF          <1> 	jmp nwcmd
  2559                              <1> ;db 5,4,"runbat",0
  2560                              <1> ;	runbatch2:
  2561                              <1> ;		mov esi, line
  2562                              <1> ;		call print
  2563                              <1> ;		mov edi, buftxt
  2564                              <1> ;		add edi, 7
  2565                              <1> ;		mov esi, 0x100000
  2566                              <1> ;		call loadfile
  2567                              <1> 
  2568                              <1> 
  2569 00001D78 0504626174636800    <1> db 5,4,"batch",0
  2570                              <1> 	batchst: 
  2571 00001D80 BF[701A0000]        <1> 		mov edi, buftxt
  2572 00001D85 81C706000000        <1> 		add edi, 6
  2573 00001D8B 803F00              <1> 		cmp byte [edi], 0
  2574 00001D8E 0F8473000000        <1> 		je near nonamefound
  2575 00001D94 BE00001000          <1> 		mov esi, 0x100000
  2576 00001D99 E8F01F0000          <1> 		call loadfile
  2577 00001D9E 89D0                <1> 		mov eax, edx
  2578 00001DA0 3D94010000          <1> 		cmp eax, 404
  2579 00001DA5 746F                <1> 		je goodbatchname
  2580 00001DA7 BE[B61D0000]        <1> 		mov esi, badbatchname
  2581 00001DAC E858EDFFFF          <1> 		call print
  2582 00001DB1 E90BF0FFFF          <1> 		jmp nwcmd
  2583 00001DB6 546869732066696C65- <1> 		badbatchname db "This file already exists!",10,13,0
  2584 00001DBF 20616C726561647920- <1>
  2585 00001DC8 657869737473210A0D- <1>
  2586 00001DD1 00                  <1>
  2587 00001DD2 596F75206861766520- <1> 		namenotfoundbatch db "You have to type a name after the command.",10,13,0
  2588 00001DDB 746F20747970652061- <1>
  2589 00001DE4 206E616D6520616674- <1>
  2590 00001DED 65722074686520636F- <1>
  2591 00001DF6 6D6D616E642E0A0D00  <1>
  2592 00001DFF 00000000            <1> 		esicache3 dd 0
  2593 00001E03 00000000            <1> 		esicache2 dd 0
  2594                              <1> 	nonamefound:
  2595 00001E07 BE[D21D0000]        <1> 		mov esi, namenotfoundbatch
  2596 00001E0C E8F8ECFFFF          <1> 		call print
  2597 00001E11 E9ABEFFFFF          <1> 		jmp nwcmd
  2598                              <1> 	goodbatchname:
  2599 00001E16 BE00001000          <1> 		mov esi, 0x100000
  2600                              <1> 	batchcreate:
  2601 00001E1B 8935[FF1D0000]      <1> 		mov [esicache3], esi
  2602 00001E21 B00D                <1> 		mov al, 13
  2603 00001E23 B307                <1> 		mov bl, 7
  2604 00001E25 B404                <1> 		mov ah, 4
  2605 00001E27 CD30                <1> 		int 30h
  2606 00001E29 8935[031E0000]      <1> 		mov [esicache2], esi
  2607 00001E2F 8A0E                <1> 		mov cl, [esi]
  2608 00001E31 8B35[FF1D0000]      <1> 		mov esi, [esicache3]
  2609 00001E37 BB[8E1E0000]        <1> 		mov ebx, exitword
  2610 00001E3C E8BFF0FFFF          <1> 		call cndtest
  2611 00001E41 3C01                <1> 		cmp al, 1
  2612 00001E43 7423                <1> 		je endbatchcreate
  2613 00001E45 3C02                <1> 		cmp al, 2
  2614 00001E47 741F                <1> 		je endbatchcreate
  2615 00001E49 BE[9D3F0000]        <1> 		mov esi, line
  2616 00001E4E E8B6ECFFFF          <1> 		call print
  2617 00001E53 8B35[031E0000]      <1> 		mov esi, [esicache2]
  2618 00001E59 B00D                <1> 		mov al, 13
  2619 00001E5B B40A                <1> 		mov ah, 10
  2620 00001E5D 668906              <1> 		mov [esi], ax
  2621 00001E60 81C602000000        <1> 		add esi, 2
  2622 00001E66 EBB3                <1> 		jmp batchcreate
  2623                              <1> 	endbatchcreate:
  2624 00001E68 8B35[FF1D0000]      <1> 		mov esi, [esicache3]
  2625 00001E6E B800000000          <1> 		mov eax, 0
  2626 00001E73 8806                <1> 		mov [esi], al
  2627 00001E75 BE[9D3F0000]        <1> 		mov esi, line
  2628 00001E7A E88AECFFFF          <1> 		call print
  2629 00001E7F BE00001000          <1> 		mov esi, 0x100000
  2630 00001E84 E880ECFFFF          <1> 		call print
  2631 00001E89 E933EFFFFF          <1> 		jmp nwcmd
  2632                              <1> 	
  2633 00001E8E 5C7800              <1> 	exitword db "\x",0
  2634 00001E91 54797065205C782074- <1> 	wordmsg db "Type \x to exit.",10,13,0
  2635 00001E9A 6F20657869742E0A0D- <1>
  2636 00001EA3 00                  <1>
  2637                              <1> 		
  2638 00001EA4 050473686F7700      <1> db 5,4,"show",0
  2639 00001EAB BF[701A0000]        <1> 		mov edi, buftxt
  2640 00001EB0 81C705000000        <1> 		add edi, 5
  2641 00001EB6 BE00001000          <1> 		mov esi, 0x100000
  2642 00001EBB E8CE1E0000          <1> 		call loadfile
  2643 00001EC0 BE00001000          <1> 		mov esi, 0x100000
  2644 00001EC5 66813E424D          <1> 		cmp word [esi], "BM"
  2645 00001ECA 7414                <1> 		je bmpfound
  2646 00001ECC E838ECFFFF          <1> 		call print
  2647 00001ED1 BE[9D3F0000]        <1> 		mov esi, line
  2648 00001ED6 E82EECFFFF          <1> 		call print
  2649 00001EDB E9E1EEFFFF          <1> 		jmp nwcmd
  2650                              <1> bmpfound:
  2651 00001EE0 803D[9B270000]00    <1> 		cmp byte [guion], 0
  2652 00001EE7 0F8443000000        <1> 		je near noguibmp
  2653 00001EED BE00001000          <1> 		mov esi, 0x100000
  2654 00001EF2 B900000000          <1> 		mov ecx, 0
  2655 00001EF7 BA00000000          <1> 		mov edx, 0
  2656 00001EFC B800000000          <1> 		mov eax, 0
  2657 00001F01 BB00000000          <1> 		mov ebx, 0
  2658 00001F06 E85F180000          <1> 		call showbmp
  2659 00001F0B B000                <1> 		mov al, 0
  2660 00001F0D B405                <1> 		mov ah, 5
  2661 00001F0F CD30                <1> 		int 30h
  2662 00001F11 BE[701A0000]        <1> 		mov esi, buftxt
  2663 00001F16 81C608000000        <1> 		add esi, 8
  2664 00001F1C E8E8EBFFFF          <1> 		call print
  2665 00001F21 BE[B31F0000]        <1> 		mov esi, loadedbmpmsg
  2666 00001F26 E8DEEBFFFF          <1> 		call print
  2667 00001F2B E991EEFFFF          <1> 		jmp nwcmd
  2668                              <1> noguibmp:
  2669 00001F30 BE[3F1F0000]        <1> 		mov esi, warnguibmp
  2670 00001F35 E8CFEBFFFF          <1> 		call print
  2671 00001F3A E982EEFFFF          <1> 		jmp nwcmd
  2672 00001F3F 546869732063616E20- <1> warnguibmp db "This can not be done without the gui.",10,13,0
  2673 00001F48 6E6F7420626520646F- <1>
  2674 00001F51 6E6520776974686F75- <1>
  2675 00001F5A 742074686520677569- <1>
  2676 00001F63 2E0A0D00            <1>
  2677                              <1> 
  2678                              <1> 		
  2679                              <1> filenotfound:
  2680 00001F67 BE[901F0000]        <1> 		mov esi, filenf
  2681 00001F6C E898EBFFFF          <1> 		call print
  2682 00001F71 BE[701A0000]        <1> 		mov esi, buftxt
  2683 00001F76 81C608000000        <1> 		add esi, 8
  2684 00001F7C E888EBFFFF          <1> 		call print
  2685 00001F81 BE[9B1F0000]        <1> 		mov esi, filenf2
  2686 00001F86 E87EEBFFFF          <1> 		call print
  2687 00001F8B E931EEFFFF          <1> 		jmp nwcmd
  2688 00001F90 5468652066696C6520- <1> filenf db "The file ",34,0
  2689 00001F99 2200                <1>
  2690 00001F9B 2220636F756C64206E- <1> filenf2 db 34," could not be found.",13,10,0
  2691 00001FA4 6F7420626520666F75- <1>
  2692 00001FAD 6E642E0D0A00        <1>
  2693                              <1> 		
  2694 00001FB3 206C6F616465642E0D- <1> loadedbmpmsg db " loaded.",13,10,0
  2695 00001FBC 0A00                <1>
  2696                              <1> 
  2697 00001FBE 050464756D7000      <1> 	db 5,4,"dump",0
  2698 00001FC5 BE[701A0000]        <1> 	mov esi, buftxt
  2699 00001FCA 81C605000000        <1> 	add esi, 5
  2700 00001FD0 B900000000          <1> 	mov ecx, 0
  2701 00001FD5 E80BF3FFFF          <1> 	call cnvrttxt
  2702 00001FDA 89CF                <1> 	mov edi, ecx
  2703 00001FDC 89FE                <1> 	mov esi, edi
  2704 00001FDE 81C680030000        <1> 	add esi, 896
  2705 00001FE4 C605[B4110000]00    <1> 	mov byte [firsthexshown],0
  2706                              <1> dumphexloop:
  2707 00001FEB 8B0F                <1> 	mov ecx, [edi]
  2708 00001FED E8C3F1FFFF          <1> 	call showhex
  2709 00001FF2 81C704000000        <1> 	add edi, 4
  2710 00001FF8 39F7                <1> 	cmp edi, esi
  2711 00001FFA 72EF                <1> 	jb dumphexloop
  2712 00001FFC E9C0EDFFFF          <1> 	jmp nwcmd
  2713                              <1> 
  2714 00002001 050474696D6500      <1> db 5,4,"time",0
  2715 00002008 E823000000          <1> 	call time
  2716 0000200D BE[57210000]        <1> 	mov esi, timeshow
  2717 00002012 E8F2EAFFFF          <1> 	call print
  2718 00002017 BE[9D3F0000]        <1> 	mov esi, line
  2719 0000201C E8E8EAFFFF          <1> 	call print
  2720 00002021 BE[61210000]        <1> 	mov esi, dateshow
  2721 00002026 E8DEEAFFFF          <1> 	call print
  2722 0000202B E991EDFFFF          <1> 	jmp nwcmd
  2723                              <1> time:
  2724 00002030 E8AD000000          <1> 	call tstackput1
  2725 00002035 B00A                <1> 	mov al,10			;Get RTC register A
  2726 00002037 E8D7000000          <1> 	call tget1
  2727 0000203C A880                <1> 	test al,0x80			;Is update in progress?
  2728 0000203E 75F0                <1> 	jne time				; yes, wait
  2729                              <1> 
  2730 00002040 B000                <1> 	mov al,0			;Get seconds (00 to 59)
  2731 00002042 E8CC000000          <1> 	call tget1
  2732 00002047 A2[51210000]        <1> 	mov [RTCtimeSecond],al
  2733                              <1> 
  2734 0000204C B002                <1> 	mov al,0x02			;Get minutes (00 to 59)
  2735 0000204E E8C0000000          <1> 	call tget1
  2736 00002053 A2[52210000]        <1> 	mov [RTCtimeMinute],al
  2737                              <1> 
  2738 00002058 B004                <1> 	mov al,0x04			;Get hours (see notes)
  2739 0000205A E8B4000000          <1> 	call tget1
  2740 0000205F A2[53210000]        <1> 	mov [RTCtimeHour],al
  2741                              <1> 
  2742 00002064 B007                <1> 	mov al,0x07			;Get day of month (01 to 31)
  2743 00002066 E8A8000000          <1> 	call tget1
  2744 0000206B A2[54210000]        <1> 	mov [RTCtimeDay],al
  2745                              <1> 
  2746 00002070 B008                <1> 	mov al,0x08			;Get month (01 to 12)
  2747 00002072 E89C000000          <1> 	call tget1
  2748 00002077 A2[55210000]        <1> 	mov [RTCtimeMonth],al
  2749                              <1> 
  2750 0000207C B009                <1> 	mov al,0x09			;Get year (00 to 99)
  2751 0000207E E890000000          <1> 	call tget1
  2752 00002083 A2[56210000]        <1> 	mov [RTCtimeYear],al
  2753                              <1> 	
  2754 00002088 BE[57210000]        <1> 	mov esi, timeshow
  2755 0000208D 8A2D[53210000]      <1> 	mov ch, [RTCtimeHour]
  2756 00002093 E886000000          <1> 	call tput1
  2757 00002098 8A2D[52210000]      <1> 	mov ch, [RTCtimeMinute]
  2758 0000209E E87B000000          <1> 	call tput1
  2759 000020A3 8A2D[51210000]      <1> 	mov ch, [RTCtimeSecond]
  2760 000020A9 E870000000          <1> 	call tput1
  2761 000020AE BE[61210000]        <1> 	mov esi, dateshow
  2762 000020B3 8A2D[55210000]      <1> 	mov ch, [RTCtimeMonth]
  2763 000020B9 E860000000          <1> 	call tput1
  2764 000020BE 8A2D[54210000]      <1> 	mov ch, [RTCtimeDay]
  2765 000020C4 E855000000          <1> 	call tput1
  2766 000020C9 B520                <1> 	mov ch, 0x20
  2767 000020CB E84E000000          <1> 	call tput1
  2768 000020D0 4E                  <1> 	dec esi
  2769 000020D1 8A2D[56210000]      <1> 	mov ch, [RTCtimeYear]
  2770 000020D7 E842000000          <1> 	call tput1
  2771 000020DC E81B000000          <1> 	call tstackget1
  2772 000020E1 C3                  <1> 	ret
  2773                              <1> 	
  2774                              <1> tstackput1:
  2775 000020E2 8935[4D210000]      <1> 	mov [tstack + 20], esi
  2776 000020E8 BE[39210000]        <1> 	mov esi, tstack
  2777 000020ED 8906                <1> 	mov [esi], eax
  2778 000020EF 895E04              <1> 	mov [esi + 4], ebx
  2779 000020F2 894E08              <1> 	mov [esi + 8], ecx
  2780 000020F5 89560C              <1> 	mov [esi + 12], edx
  2781 000020F8 897E10              <1> 	mov [esi + 16], edi
  2782 000020FB C3                  <1> 	ret
  2783                              <1> 	
  2784                              <1> tstackget1:
  2785 000020FC BE[39210000]        <1> 	mov esi, tstack
  2786 00002101 8B06                <1> 	mov eax, [esi]
  2787 00002103 8B5E04              <1> 	mov ebx, [esi + 4]
  2788 00002106 8B4E08              <1> 	mov ecx, [esi + 8]
  2789 00002109 8B560C              <1> 	mov edx, [esi + 12]
  2790 0000210C 8B7E10              <1> 	mov edi, [esi + 16]
  2791 0000210F 8B7614              <1> 	mov esi, [esi + 20]
  2792 00002112 C3                  <1> 	ret
  2793                              <1> 	
  2794                              <1> tget1:
  2795 00002113 66BA7000            <1> 	mov dx, 0x70
  2796 00002117 EE                  <1> 	out dx, al
  2797 00002118 6642                <1> 	inc dx
  2798 0000211A EC                  <1> 	in al, dx
  2799 0000211B 664A                <1> 	dec dx
  2800 0000211D C3                  <1> 	ret
  2801                              <1> 	
  2802                              <1> tput1:
  2803 0000211E 66C1E904            <1> 	shr cx, 4
  2804 00002122 B030                <1> 	mov al, 48
  2805 00002124 00E8                <1> 	add al, ch
  2806 00002126 8806                <1> 	mov [esi], al
  2807 00002128 46                  <1> 	inc esi
  2808 00002129 B030                <1> 	mov al, 48
  2809 0000212B C0E904              <1> 	shr cl, 4
  2810 0000212E 00C8                <1> 	add al, cl
  2811 00002130 8806                <1> 	mov [esi], al
  2812 00002132 81C602000000        <1> 	add esi, 2
  2813 00002138 C3                  <1> 	ret
  2814                              <1> 		
  2815 00002139 000000000000000000- <1> 	tstack dd 0,0,0,0,0,0
  2816 00002142 000000000000000000- <1>
  2817 0000214B 000000000000        <1>
  2818 00002151 00                  <1> 	RTCtimeSecond db 0
  2819 00002152 00                  <1> 	RTCtimeMinute db 0
  2820 00002153 00                  <1> 	RTCtimeHour db 0
  2821 00002154 00                  <1> 	RTCtimeDay db 0
  2822 00002155 00                  <1> 	RTCtimeMonth db 0
  2823 00002156 00                  <1> 	RTCtimeYear db 0
  2824 00002157 30303A30303A303000- <1> 	timeshow db "00:00:00",0,0
  2825 00002160 00                  <1>
  2826 00002161 30302D30302D303030- <1> 	dateshow db "00-00-0000",13,10,0
  2827 0000216A 300D0A00            <1>
  2828                              <1> 
  2829 0000216E 0504637075696400    <1> db 5,4,"cpuid",0
  2830 00002176 B800000000          <1> 	mov eax, 0
  2831 0000217B 0FA2                <1> 	cpuid
  2832 0000217D 891D[D2210000]      <1> 	mov [cpuidbuf], ebx
  2833 00002183 8915[D6210000]      <1> 	mov [cpuidbuf + 4], edx
  2834 00002189 890D[DA210000]      <1> 	mov [cpuidbuf + 8], ecx
  2835 0000218F BE[D2210000]        <1> 	mov esi, cpuidbuf
  2836 00002194 E870E9FFFF          <1> 	call print
  2837 00002199 BE[9D3F0000]        <1> 	mov esi, line
  2838 0000219E E866E9FFFF          <1> 	call print
  2839 000021A3 B801000000          <1> 	mov eax, 1
  2840 000021A8 0FA2                <1> 	cpuid
  2841 000021AA 89C1                <1> 	mov ecx, eax
  2842 000021AC C605[B4110000]02    <1> 	mov byte [firsthexshown], 2
  2843 000021B3 E8FDEFFFFF          <1> 	call showhex
  2844 000021B8 B808000080          <1> 	mov eax, 0x80000008
  2845 000021BD 0FA2                <1> 	cpuid
  2846 000021BF 89C1                <1> 	mov ecx, eax
  2847 000021C1 C605[B4110000]02    <1> 	mov byte [firsthexshown], 2
  2848 000021C8 E8E8EFFFFF          <1> 	call showhex
  2849 000021CD E9EFEBFFFF          <1> 	jmp nwcmd
  2850                              <1> 	
  2851 000021D2 00<rept>            <1> cpuidbuf times 13 db 0
  2852                              <1> cpuidvendorend:
  2853                              <1> progend:		;programs end here	
  2854                              <1> batchprogend:
  2855                                      %include 'source/input.asm'
  2856                              <1> PS2SET:
  2857 000021DF B0A8                <1>   mov  al, 0xa8		; enable mouse port
  2858 000021E1 E664                <1>   out  0x64, al		; write to keyboardcontroller
  2859 000021E3 E801000000          <1>   call CHKPRT		; check if command is progressed (demand!)
  2860 000021E8 C3                  <1> ret
  2861                              <1> 
  2862                              <1> ;***********************************************************************
  2863                              <1> ;Check if command is accepted. (not got stuck in inputbuffer)
  2864                              <1> ;***********************************************************************
  2865                              <1> CHKPRT:
  2866 000021E9 66B96400            <1>   mov  cx, 100
  2867                              <1>  .again:
  2868 000021ED E464                <1>   in   al, 0x64		; read from keyboardcontroller
  2869 000021EF A802                <1>   test al, 2		; Check if input buffer is empty
  2870 000021F1 7402                <1>   je .go
  2871 000021F3 E2F8                <1>   loop .again
  2872                              <1>  .go:
  2873 000021F5 C3                  <1> ret
  2874                              <1> 
  2875                              <1> ;***********************************************************************
  2876                              <1> ;Write to mouse
  2877                              <1> ;***********************************************************************
  2878                              <1> WMOUS:
  2879 000021F6 B0D4                <1>   mov  al, 0xd4		; write to mouse device instead of to keyboard
  2880 000021F8 E664                <1>   out  0x64, al		; write to keyboardcontroller
  2881 000021FA E8EAFFFFFF          <1>   call CHKPRT		; check if command is progressed (demand!)
  2882 000021FF C3                  <1> ret
  2883                              <1> 
  2884                              <1> 
  2885                              <1> 
  2886                              <1> ;***********************************************************************
  2887                              <1> ;mouse output buffer full
  2888                              <1> ;***********************************************************************
  2889                              <1> MBUFFUL:
  2890 00002200 66B96400            <1>   mov cx, 100
  2891                              <1>  .mn:
  2892 00002204 E464                <1>   in   al, 0x64		; read from keyboardcontroller
  2893 00002206 A820                <1>   test al, 0x20		; check if mouse output buffer is full
  2894 00002208 7402                <1>   jz  .mnn
  2895 0000220A E2F8                <1>   loop .mn
  2896                              <1>  .mnn:
  2897 0000220C C3                  <1> ret
  2898                              <1> 
  2899                              <1> 
  2900                              <1> ;***********************************************************************
  2901                              <1> ;Write activate Mouse HardWare
  2902                              <1> ;***********************************************************************
  2903                              <1> ACTMOUS:
  2904 0000220D E8E4FFFFFF          <1>   call WMOUS
  2905 00002212 B0F4                <1>   mov  al, 0xf4 	; Command to activate mouse itselve (Stream mode)
  2906 00002214 E660                <1>   out  0x60, al		; write ps/2 controller output port (activate mouse)
  2907 00002216 E8CEFFFFFF          <1>   call CHKPRT		; check if command is progressed (demand!)
  2908 0000221B E801000000          <1>   call CHKMOUS		; check if a byte is available
  2909 00002220 C3                  <1> ret
  2910                              <1> 
  2911                              <1> ;***********************************************************************
  2912                              <1> ;Check if mouse has info for us
  2913                              <1> ;***********************************************************************
  2914                              <1> CHKMOUS:
  2915 00002221 B300                <1>   mov  bl, 0
  2916 00002223 66B96400            <1>   mov cx, 100
  2917                              <1>  .vrd:
  2918 00002227 E464                <1>   in   al, 0x64		; read from keyboardcontroller
  2919 00002229 A801                <1>   test al, 1		; check if controller buffer (60h) has data
  2920 0000222B 7504                <1>   jnz .yy
  2921 0000222D E2F8                <1>   loop .vrd
  2922 0000222F B301                <1>   mov  bl, 1
  2923                              <1>  .yy:
  2924 00002231 C3                  <1> ret
  2925                              <1> 
  2926                              <1> ;***********************************************************************
  2927                              <1> ;Get Mouse Byte
  2928                              <1> ;***********************************************************************
  2929                              <1> GETB:
  2930                              <1>  .cagain:
  2931 00002232 E8EAFFFFFF          <1>   call CHKMOUS		; check if a byte is available
  2932 00002237 08DB                <1>   or bl, bl
  2933 00002239 75F7                <1>   jnz .cagain
  2934 0000223B B0AD                <1>   mov  al, 0xad		; Disable Keyboard
  2935 0000223D E664                <1>   out  0x64, al		; write to keyboardcontroller
  2936 0000223F E8A5FFFFFF          <1>   call CHKPRT		; check if command is progressed (demand!)
  2937 00002244 6631C0              <1>   xor  ax, ax
  2938 00002247 E460                <1>   in   al, 0x60		; read ps/2 controller output port (mousebyte)
  2939 00002249 88C2                <1>   mov  dl, al
  2940 0000224B B0AE                <1>   mov  al, 0xae		; Enable Keyboard
  2941 0000224D E664                <1>   out  0x64, al		; write to keyboardcontroller
  2942 0000224F E895FFFFFF          <1>   call CHKPRT		; check if command is progressed (demand!)
  2943 00002254 88D0                <1>   mov  al, dl
  2944 00002256 C3                  <1> ret
  2945                              <1> 
  2946 00002257 00                  <1> LBUTTON db 0x00	;	Left   button status 1=PRESSED 0=RELEASED
  2947 00002258 00                  <1> RBUTTON db 0x00	;	Right  button status 1=PRESSED 0=RELEASED
  2948 00002259 00                  <1> MBUTTON db 0x00	;	Middle button status 1=PRESSED 0=RELEASED
  2949 0000225A 00                  <1> XCOORD  db 0x00	;	the moved distance  (horizontal)
  2950 0000225B 00                  <1> YCOORD  db 0x00	;	the moved distance  (vertical)
  2951                              <1> 
  2952                              <1> 
  2953                              <1> 	guistartin:
  2954 0000225C B800000000          <1> 		mov eax, 0
  2955 00002261 66A3[D60A0000]      <1> 		mov [lastkey], ax
  2956 00002267 E464                <1> 		in al, 64h ; Status
  2957 00002269 A801                <1> 		test al, 1 ; output buffer full?
  2958 0000226B 74EF                <1> 		jz guistartin
  2959 0000226D A820                <1> 		test al, 20h ; PS2-Mouse?
  2960 0000226F 0F85E2000000        <1> 		jnz near maincall2
  2961 00002275 E460                <1> 		in al, 60h
  2962 00002277 88C4                <1> 		mov ah, al
  2963 00002279 B000                <1> 		mov al, 0
  2964 0000227B 8825[D70A0000]      <1> 		mov [lastkey + 1], ah
  2965 00002281 88E0                <1> 		mov al, ah
  2966 00002283 BF[8E250000]        <1> 		mov edi, scancode
  2967                              <1> 	guisearchscan: 
  2968 00002288 3C40                <1> 		cmp al, 40h
  2969 0000228A 7315                <1> 		jae guiscanother
  2970 0000228C B400                <1> 		mov ah, 0
  2971 0000228E D0E0                <1> 		shl al, 1
  2972 00002290 01C7                <1> 		add edi, eax
  2973 00002292 D0E8                <1> 		shr al, 1
  2974 00002294 8A27                <1> 		mov ah, [edi]
  2975 00002296 80FC00              <1> 		cmp ah, 0
  2976 00002299 7406                <1> 		je guiscanother
  2977 0000229B E964000000          <1> 		jmp guiscanfound
  2978 000022A0 00                  <1> guiupper db 0
  2979                              <1> guiscanother:
  2980 000022A1 88C4                <1> 		mov ah, al
  2981 000022A3 B000                <1> 		mov al, 0
  2982 000022A5 66A3[D60A0000]      <1> 		mov [lastkey], ax
  2983                              <1> 		;cmp ah, 4Dh
  2984                              <1> 		;je near nextimage
  2985 000022AB 80FC2A              <1> 		cmp ah, 2Ah
  2986 000022AE 0F8437000000        <1> 		je near guishifton
  2987 000022B4 80FC36              <1> 		cmp ah, 36h
  2988 000022B7 0F842E000000        <1> 		je near guishifton
  2989 000022BD 80FC1C              <1> 		cmp ah, 1Ch
  2990 000022C0 0F843D000000        <1> 		je near guientdown
  2991 000022C6 80FCAA              <1> 		cmp ah, 0AAh
  2992 000022C9 0F8428000000        <1> 		je near guishiftoff
  2993 000022CF 80FCB6              <1> 		cmp ah, 0B6h
  2994 000022D2 0F841F000000        <1> 		je near guishiftoff
  2995 000022D8 80FC3A              <1> 		cmp ah, 3Ah
  2996 000022DB 0F8401000000        <1> 		je near guishift
  2997 000022E1 C3                  <1> 		ret
  2998                              <1> 	guishift:
  2999 000022E2 A0[A0220000]        <1> 		mov al, [guiupper]
  3000 000022E7 3C01                <1> 		cmp al, 1
  3001 000022E9 730C                <1> 		jae guishiftoff
  3002                              <1> 	guishifton:
  3003 000022EB C605[A0220000]01    <1> 		mov byte [guiupper], 1
  3004 000022F2 E965FFFFFF          <1> 		jmp guistartin
  3005                              <1> 	guishiftoff:
  3006 000022F7 C605[A0220000]00    <1> 		mov byte [guiupper], 0
  3007 000022FE E959FFFFFF          <1> 		jmp guistartin
  3008                              <1> 	guientdown:
  3009 00002303 C3                  <1> 		ret
  3010                              <1> 	guiscanfound:
  3011 00002304 81C701000000        <1> 		add edi, 1
  3012 0000230A 803D[A0220000]01    <1> 		cmp byte [guiupper], 1
  3013 00002311 7306                <1> 		jae uppercasegui
  3014 00002313 81EF01000000        <1> 		sub edi, 1
  3015                              <1> uppercasegui:
  3016 00002319 8A07                <1> 		mov al,[edi]
  3017 0000231B A2[D60A0000]        <1> 		mov [lastkey], al
  3018 00002320 C3                  <1> 		ret
  3019                              <1> 		
  3020                              <1> 		
  3021                              <1> 	cursorgui:
  3022 00002321 803D[0E380000]01    <1> 		cmp byte [mouseon], 1
  3023 00002328 0F8429000000        <1> 		je near maincall2
  3024 0000232E 803D[9B270000]00    <1> 		cmp byte [guion], 0
  3025 00002335 0F84C8FFFFFF        <1> 		je near guientdown
  3026                              <1> 	initmouse:
  3027 0000233B E828050000          <1> 		call switchmousepos2
  3028 00002340 E89AFEFFFF          <1> 	  	call PS2SET
  3029 00002345 E8C3FEFFFF          <1> 		call ACTMOUS
  3030 0000234A C605[0E380000]01    <1> 		mov byte [mouseon],1
  3031 00002351 E8DCFEFFFF          <1> 		call GETB 	;;Get the responce byte of the mouse (like: Hey i am active)
  3032                              <1> 				;;If the bytes are mixed up,
  3033                              <1> 				;;remove this line or add another of this line.
  3034                              <1> 		;call GETB
  3035 00002356 C3                  <1> 		ret
  3036                              <1> 	maincall2:
  3037 00002357 803D[0E380000]01    <1> 		  cmp byte [mouseon], 1
  3038 0000235E 75DB                <1> 		  jne initmouse
  3039 00002360 E8CDFEFFFF          <1> 		  call GETB
  3040 00002365 88C3                <1> 		  mov  bl, al
  3041 00002367 80E301              <1> 		  and  bl, 1
  3042 0000236A 881D[57220000]      <1> 		  mov  BYTE [LBUTTON], bl
  3043 00002370 88C3                <1> 		  mov  bl, al
  3044 00002372 80E302              <1> 		  and  bl, 2
  3045 00002375 D0EB                <1> 		  shr  bl, 1
  3046 00002377 881D[58220000]      <1> 		  mov  BYTE [RBUTTON], bl
  3047 0000237D 88C3                <1> 		  mov  bl, al
  3048 0000237F 80E304              <1> 		  and  bl, 4
  3049 00002382 C0EB02              <1> 		  shr  bl, 2
  3050 00002385 881D[59220000]      <1> 		  mov  BYTE [MBUTTON], bl
  3051 0000238B E8A2FEFFFF          <1> 		  call GETB
  3052 00002390 A2[5A220000]        <1> 		  mov  BYTE [XCOORD], al
  3053 00002395 E898FEFFFF          <1> 		  call GETB
  3054 0000239A A2[5B220000]        <1> 		  mov  BYTE [YCOORD], al
  3055                              <1> 
  3056                              <1> 	showpixelcursor:
  3057 0000239F 668B15[EC240000]    <1> 		mov dx, [mousecursorposition]
  3058 000023A6 668B0D[EE240000]    <1> 		mov cx, [mousecursorposition + 2]
  3059 000023AD 668915[E8240000]    <1> 		mov [lastmouseposition], dx
  3060 000023B4 66890D[EA240000]    <1> 		mov [lastmouseposition + 2], cx
  3061 000023BB A0[5A220000]        <1> 		mov al, [XCOORD]
  3062 000023C0 3C80                <1> 		cmp al, 128
  3063 000023C2 730C                <1> 		jae subxcoord
  3064 000023C4 00C0                <1> 		add al, al
  3065 000023C6 B400                <1> 		mov ah, 0
  3066 000023C8 6601C2              <1> 		add dx, ax
  3067 000023CB E90B000000          <1> 		jmp subxcoorddn
  3068                              <1> 	subxcoord:
  3069 000023D0 00C0                <1> 		add al, al
  3070 000023D2 B300                <1> 		mov bl, 0
  3071 000023D4 28C3                <1> 		sub bl, al
  3072 000023D6 B700                <1> 		mov bh, 0
  3073 000023D8 6629DA              <1> 		sub dx, bx
  3074                              <1> 	subxcoorddn:
  3075 000023DB 8A1D[5B220000]      <1> 		mov bl, [YCOORD]
  3076 000023E1 B000                <1> 		mov al, 0
  3077 000023E3 28D8                <1> 		sub al, bl
  3078 000023E5 3C80                <1> 		cmp al, 128
  3079 000023E7 730A                <1> 		jae subycoord
  3080 000023E9 B400                <1> 		mov ah, 0
  3081 000023EB 6601C1              <1> 		add cx, ax
  3082 000023EE E909000000          <1> 		jmp subycoorddn
  3083                              <1> 	subycoord:
  3084 000023F3 B300                <1> 		mov bl, 0
  3085 000023F5 28C3                <1> 		sub bl, al
  3086 000023F7 B700                <1> 		mov bh, 0
  3087 000023F9 6629D9              <1> 		sub cx, bx
  3088                              <1> 	subycoorddn:
  3089 000023FC 6681FA204E          <1> 		cmp dx, 20000
  3090 00002401 7604                <1> 		jbe nooriginx2
  3091 00002403 66BA0000            <1> 		mov dx, 0
  3092                              <1> 	nooriginx2:
  3093 00002407 6681F9204E          <1> 		cmp cx, 20000
  3094 0000240C 7604                <1> 		jbe nooriginy2
  3095 0000240E 66B90000            <1> 		mov cx, 0
  3096                              <1> 	nooriginy2:
  3097 00002412 6681FA0000          <1> 		cmp dx, 0
  3098 00002417 7415                <1> 		je nofixxcolumn2
  3099 00002419 663B15[BB350000]    <1> 		cmp dx, [resolutionx2]
  3100 00002420 720C                <1> 		jb nofixxcolumn2
  3101 00002422 668B15[BB350000]    <1> 		mov dx, [resolutionx2]
  3102 00002429 6681EA0200          <1> 		sub dx, 2
  3103                              <1> 	nofixxcolumn2:
  3104 0000242E 6681F90000          <1> 		cmp cx, 0
  3105 00002433 7415                <1> 		je nofixyrow2
  3106 00002435 663B0D[B7350000]    <1> 		cmp cx, [resolutiony]
  3107 0000243C 720C                <1> 		jb nofixyrow2
  3108 0000243E 668B0D[B7350000]    <1> 		mov cx, [resolutiony]
  3109 00002445 6681E90100          <1> 		sub cx, 1
  3110                              <1> 	nofixyrow2:
  3111 0000244A 668915[EC240000]    <1> 		mov [mousecursorposition], dx
  3112 00002451 66890D[EE240000]    <1> 		mov [mousecursorposition + 2], cx
  3113 00002458 E8A2030000          <1> 		call switchmousepos ;;use dragging code to ensure proper icon drag
  3114 0000245D 803D[57220000]01    <1> 		cmp byte [LBUTTON], 1
  3115 00002464 0F847B040000        <1> 		je near clickicon
  3116 0000246A 803D[58220000]01    <1> 		cmp byte [RBUTTON], 1
  3117 00002471 0F846E040000        <1> 		je near clickicon
  3118 00002477 A0[D2280000]        <1> 		mov al, [pbutton]
  3119 0000247C C705[D5280000]0000- <1> 		mov dword [dragging], 0
  3120 00002484 0000                <1>
  3121 00002486 3C00                <1> 		cmp al, 0
  3122 00002488 740F                <1> 		je nopreviousbutton
  3123 0000248A E80D030000          <1> 		call clearmousecursor
  3124 0000248F E885090000          <1> 		call reloadallgraphics
  3125 00002494 E8CF030000          <1> 		call switchmousepos2
  3126                              <1> 	nopreviousbutton:
  3127 00002499 B000                <1> 		mov al, 0
  3128 0000249B A2[D2280000]        <1> 		mov [pbutton], al
  3129 000024A0 A0[57220000]        <1> 		mov al, [LBUTTON]
  3130 000024A5 A2[D3280000]        <1> 		mov [pLBUTTON], al
  3131 000024AA A0[58220000]        <1> 		mov al, [RBUTTON]
  3132 000024AF A2[D4280000]        <1> 		mov [pRBUTTON], al
  3133 000024B4 B900000000          <1> 		mov ecx, 0
  3134 000024B9 BA00000000          <1> 		mov edx, 0
  3135 000024BE 668B15[EC240000]    <1> 		mov dx, [mousecursorposition]
  3136 000024C5 668B0D[EE240000]    <1> 		mov cx, [mousecursorposition + 2]
  3137 000024CC 66BB9CE7            <1> 		mov bx, 1110011110011100b
  3138 000024D0 B400                <1> 		mov ah, 0
  3139 000024D2 B080                <1> 		mov al, 128
  3140 000024D4 C605[98270000]01    <1> 		mov byte [showcursorfonton], 1
  3141 000024DB E8EB100000          <1> 		call showfontvesa
  3142 000024E0 C605[98270000]00    <1> 		mov byte [showcursorfonton], 0
  3143 000024E7 C3                  <1> 		ret
  3144                              <1> 
  3145 000024E8 84008400            <1> lastmouseposition dw 132,132
  3146 000024EC 84008400            <1> mousecursorposition dw 132,132	
  3147                              <1> 
  3148                              <1> termmouse:
  3149 000024F0 C3                  <1> 	ret	;;lets try this later
  3150 000024F1 BE[851C0000]        <1> 		mov esi, videobuf2
  3151 000024F6 BA00000000          <1> 		mov edx, 0
  3152 000024FB 668B15[E8240000]    <1> 		mov dx, [lastmouseposition]
  3153 00002502 668B0D[EA240000]    <1> 		mov cx, [lastmouseposition + 2]
  3154 00002509 66A1[8C250000]      <1> 		mov ax, [cursorcache]
  3155 0000250F 663D0000            <1> 		cmp ax, 0
  3156 00002513 7426                <1> 		je nocopycursorcache
  3157 00002515 66C1E104            <1> 		shl cx, 4
  3158 00002519 66C1E203            <1> 		shl dx, 3
  3159 0000251D 01D6                <1> 		add esi, edx
  3160 0000251F 66BA0000            <1> 		mov dx, 0
  3161 00002523 8A15[47090000]      <1> 		mov dl, [charxy]
  3162 00002529 6641                <1> 		inc cx
  3163                              <1> termmousecplp1:
  3164 0000252B 01D6                <1> 		add esi, edx
  3165 0000252D 6649                <1> 		dec cx
  3166 0000252F 6681F90000          <1> 		cmp cx, 0
  3167 00002534 75F5                <1> 		jne termmousecplp1
  3168 00002536 29D6                <1> 		sub esi, edx
  3169 00002538 668906              <1> 		mov [esi], ax
  3170                              <1> nocopycursorcache:
  3171 0000253B BE[851C0000]        <1> 		mov esi, videobuf2
  3172 00002540 BA00000000          <1> 		mov edx, 0
  3173 00002545 668B15[EC240000]    <1> 		mov dx, [mousecursorposition]
  3174 0000254C 668B0D[EE240000]    <1> 		mov cx, [mousecursorposition + 2]
  3175 00002553 66C1E104            <1> 		shl cx, 4
  3176 00002557 66C1E203            <1> 		shl dx, 3
  3177 0000255B 01D6                <1> 		add esi, edx
  3178 0000255D 66BA0000            <1> 		mov dx, 0
  3179 00002561 8A15[47090000]      <1> 		mov dl, [charxy]
  3180 00002567 6641                <1> 		inc cx
  3181                              <1> termmousecplp2:
  3182 00002569 01D6                <1> 		add esi, edx
  3183 0000256B 6649                <1> 		dec cx
  3184 0000256D 6681F90000          <1> 		cmp cx, 0
  3185 00002572 75F5                <1> 		jne termmousecplp2
  3186 00002574 29D6                <1> 		sub esi, edx
  3187 00002576 668B06              <1> 		mov ax, [esi]
  3188 00002579 66A3[8C250000]      <1> 		mov [cursorcache], ax
  3189 0000257F B080                <1> 		mov al, 128
  3190 00002581 B407                <1> 		mov ah, 7
  3191 00002583 668906              <1> 		mov [esi], ax
  3192 00002586 E86EE6FFFF          <1> 		call termcopy
  3193 0000258B C3                  <1> 		ret
  3194 0000258C 0000                <1> cursorcache db 0,0
  3195                              <1> 	
  3196                              <1> scancode:
  3197 0000258E 0000                <1> 	db 0,0		;,0h
  3198 00002590 0000                <1> 	db 0,0		;,1h
  3199 00002592 3121                <1> 	db '1','!'	;,2h
  3200 00002594 3240                <1> 	db '2','@'	;,3h
  3201 00002596 3323                <1> 	db '3','#'	;,4h
  3202 00002598 3424                <1> 	db '4','$'	;,5h
  3203 0000259A 3525                <1> 	db '5','%'	;,6h
  3204 0000259C 365E                <1> 	db '6','^'	;,7h
  3205 0000259E 3726                <1> 	db '7','&'	;,8h
  3206 000025A0 382A                <1> 	db '8','*'	;,9h
  3207 000025A2 3928                <1> 	db '9','('	;,0Ah
  3208 000025A4 3029                <1> 	db '0',')'	;,0Bh
  3209 000025A6 2D5F                <1> 	db '-','_'	;,0Ch
  3210 000025A8 3D2B                <1> 	db '=','+'	;,0Dh
  3211 000025AA 0808                <1> 	db 8,8		;,0Eh
  3212 000025AC 0000                <1> 	db 0,0		;,0Fh
  3213 000025AE 7151                <1> 	db 'q','Q'	;,10h
  3214 000025B0 7757                <1> 	db 'w','W'	;,11h
  3215 000025B2 6545                <1> 	db 'e','E'	;,12h
  3216 000025B4 7252                <1> 	db 'r','R'	;,13h
  3217 000025B6 7454                <1> 	db 't','T'	;,14h
  3218 000025B8 7959                <1> 	db 'y','Y'	;,15h
  3219 000025BA 7555                <1> 	db 'u','U'	;,16h
  3220 000025BC 6949                <1> 	db 'i','I'	;,17h
  3221 000025BE 6F4F                <1> 	db 'o','O'	;,18h
  3222 000025C0 7050                <1> 	db 'p','P'	;,19h
  3223 000025C2 5B7B                <1> 	db '[','{'	;,1Ah
  3224 000025C4 5D7D                <1> 	db ']','}'	;,1Bh
  3225 000025C6 0000                <1> 	db 0,0		;,1Ch
  3226 000025C8 0000                <1> 	db 0,0		;,1Dh
  3227 000025CA 6141                <1> 	db 'a','A'	;,1Eh
  3228 000025CC 7353                <1> 	db 's','S'	;,1Fh
  3229 000025CE 6444                <1> 	db 'd','D'	;,20h
  3230 000025D0 6646                <1> 	db 'f','F'	;,21h
  3231 000025D2 6747                <1> 	db 'g','G'	;,22h
  3232 000025D4 6848                <1> 	db 'h','H'	;,23h
  3233 000025D6 6A4A                <1> 	db 'j','J'	;,24h
  3234 000025D8 6B4B                <1> 	db 'k','K'	;,25h
  3235 000025DA 6C4C                <1> 	db 'l','L'	;,26h
  3236 000025DC 3B3A                <1> 	db ';',':'	;,27h
  3237 000025DE 2722                <1> 	db 27h,22h	;,28h
  3238 000025E0 607E                <1> 	db '`','~'	;,29h
  3239 000025E2 0000                <1> 	db 0,0		;,2Ah
  3240 000025E4 5C7C                <1> 	db '\','|'	;,2Bh
  3241 000025E6 7A5A                <1> 	db 'z','Z'	;,2Ch
  3242 000025E8 7858                <1> 	db 'x','X'	;,2Dh
  3243 000025EA 6343                <1> 	db 'c','C'	;,2Eh
  3244 000025EC 7656                <1> 	db 'v','V'	;,2Fh
  3245 000025EE 6242                <1> 	db 'b','B'	;,30h
  3246 000025F0 6E4E                <1> 	db 'n','N'	;,31h
  3247 000025F2 6D4D                <1> 	db 'm','M'	;,32h
  3248 000025F4 2C3C                <1> 	db ',','<'	;,33h
  3249 000025F6 2E3E                <1> 	db '.','>'	;,34h
  3250 000025F8 2F3F                <1> 	db '/','?'	;,35h
  3251 000025FA 0000                <1> 	db 0,0		;,36h
  3252 000025FC 0000                <1> 	db 0,0		;,37h
  3253 000025FE 0000                <1> 	db 0,0		;,38h
  3254 00002600 2020                <1> 	db ' ',' '	;,39h
  3255                              <1> noscan:
  3256                                      %include 'source/gui.asm'
  3257                              <1> guiclear:
  3258 00002602 8B3D[084A0000]      <1> 	mov edi, [physbaseptr]
  3259 00002608 668B15[B9350000]    <1> 	mov dx, [resolutionx]
  3260 0000260F 668B0D[B7350000]    <1> 	mov cx, [resolutiony]
  3261 00002616 66A1[3F260000]      <1> 	mov ax, [background]
  3262                              <1> guiclearloop:
  3263 0000261C 668907              <1> 	mov [edi], ax
  3264 0000261F 81C702000000        <1> 	add edi, 2
  3265 00002625 664A                <1> 	dec dx
  3266 00002627 6681FA0000          <1> 	cmp dx, 0
  3267 0000262C 77EE                <1> 	ja guiclearloop
  3268 0000262E 6649                <1> 	dec cx
  3269 00002630 668B15[B9350000]    <1> 	mov dx, [resolutionx]
  3270 00002637 6681F90000          <1> 	cmp cx, 0
  3271 0000263C 77DE                <1> 	ja guiclearloop
  3272 0000263E C3                  <1> 	ret
  3273                              <1> 
  3274 0000263F CF7B                <1> background dw 0111101111001111b
  3275                              <1> 
  3276                              <1> gui:	;Let's see what I can do, I am going to try to make this as freestanding as possible
  3277 00002641 B800000000          <1> 	mov eax, 0
  3278 00002646 BB00000000          <1> 	mov ebx, 0
  3279 0000264B B900000000          <1> 	mov ecx, 0
  3280 00002650 BA00000000          <1> 	mov edx, 0
  3281 00002655 8B3D[084A0000]      <1> 	mov edi, [physbaseptr]
  3282 0000265B 668B15[B9350000]    <1> 	mov dx, [resolutionx]
  3283 00002662 668B0D[B7350000]    <1> 	mov cx, [resolutiony]
  3284 00002669 668B1D[3F260000]    <1> 	mov bx, [background]
  3285                              <1> guiclearloop2:
  3286 00002670 66891F              <1> 	mov [edi], bx
  3287 00002673 81C702000000        <1> 	add edi, 2
  3288 00002679 664A                <1> 	dec dx
  3289 0000267B 6681FA0000          <1> 	cmp dx, 0
  3290 00002680 0F85EAFFFFFF        <1> 	jne near guiclearloop2
  3291 00002686 6649                <1> 	dec cx
  3292 00002688 668B15[B9350000]    <1> 	mov dx, [resolutionx]
  3293 0000268F 6681F90000          <1> 	cmp cx, 0
  3294 00002694 0F85D6FFFFFF        <1> 	jne near guiclearloop2
  3295 0000269A C605[9B270000]01    <1> 	mov byte [guion], 1
  3296 000026A1 C605[9A270000]00    <1> 	mov byte [mouseselecton], 0
  3297 000026A8 B800000000          <1> 	mov eax, 0
  3298 000026AD BB00000000          <1> 	mov ebx, 0
  3299 000026B2 B900000000          <1> 	mov ecx, 0
  3300 000026B7 BA00000000          <1> 	mov edx, 0
  3301                              <1> 	
  3302 000026BC BE[23380000]        <1> 	mov esi, pacmsg
  3303 000026C1 66B80000            <1> 	mov ax, 0
  3304 000026C5 BB00000000          <1> 	mov ebx, 0
  3305 000026CA 66B90200            <1> 	mov cx, 2
  3306 000026CE 66BA0400            <1> 	mov dx, 4
  3307 000026D2 E8880A0000          <1> 	call showstring
  3308                              <1> 	
  3309 000026D7 BE[39390000]        <1> 	mov esi, interneticon
  3310 000026DC 66B80000            <1> 	mov ax, 0
  3311 000026E0 BB[98380000]        <1> 	mov ebx, noie
  3312 000026E5 66B91800            <1> 	mov cx, 24
  3313 000026E9 66BA0400            <1> 	mov dx, 4
  3314 000026ED E8EC0D0000          <1> 	call showicon
  3315                              <1> 	
  3316 000026F2 BE[BB390000]        <1> 	mov esi, wordicon
  3317 000026F7 66B80000            <1> 	mov ax, 0
  3318 000026FB BB00000000          <1> 	mov ebx, 0
  3319 00002700 66B91800            <1> 	mov cx, 24
  3320 00002704 66BA3000            <1> 	mov dx, 48
  3321 00002708 E8D10D0000          <1> 	call showicon
  3322                              <1> 	
  3323 0000270D BE[3D3A0000]        <1> 	mov esi, pacmanpellet
  3324 00002712 66B80000            <1> 	mov ax, 0
  3325 00002716 BB00000000          <1> 	mov ebx, 0
  3326 0000271B 66B94000            <1> 	mov cx, 64
  3327 0000271F 66BA0400            <1> 	mov dx, 4
  3328 00002723 E8B60D0000          <1> 	call showicon
  3329                              <1> 	
  3330 00002728 BE[413B0000]        <1> 	mov esi, pacman
  3331 0000272D 66B80000            <1> 	mov ax, 0
  3332 00002731 BB[7D380000]        <1> 	mov ebx, pacmannomnom
  3333 00002736 66B94000            <1> 	mov cx, 64
  3334 0000273A 66BA3000            <1> 	mov dx, 48
  3335 0000273E E89B0D0000          <1> 	call showicon
  3336                              <1> 	
  3337 00002743 BE[BF3A0000]        <1> 	mov esi, ghostie
  3338 00002748 66B80000            <1> 	mov ax, 0
  3339 0000274C BB[62380000]        <1> 	mov ebx, boo
  3340 00002751 66B96C00            <1> 	mov cx, 108
  3341 00002755 66BA0400            <1> 	mov dx, 4
  3342 00002759 E8800D0000          <1> 	call showicon
  3343                              <1> 
  3344 0000275E BE[0F380000]        <1> 	mov esi, start
  3345 00002763 668B0D[B7350000]    <1> 	mov cx, [resolutiony]
  3346 0000276A 6681E91000          <1> 	sub cx, 16
  3347 0000276F 66BA0200            <1> 	mov dx, 2
  3348 00002773 B400                <1> 	mov ah, 0
  3349 00002775 B010                <1> 	mov al, 00010000b
  3350 00002777 BB[E6380000]        <1> 	mov ebx, winblows
  3351 0000277C E8DE090000          <1> 	call showstring
  3352                              <1> 	
  3353 00002781 E89BFBFFFF          <1> 	call cursorgui
  3354                              <1> guistart:
  3355 00002786 E8D1FAFFFF          <1> 	call guistartin
  3356 0000278B C605[94270000]00    <1> 	mov byte [copygui], 0
  3357 00002792 EBF2                <1> 	jmp guistart
  3358                              <1> 	
  3359                              <1> ;guicopy:	;;for double buffering
  3360                              <1> ;	mov byte [copygui], 1
  3361                              <1> ;	mov edi, [offscreenmemoffset]
  3362                              <1> ;	mov edx, 0
  3363                              <1> ;	mov ecx, 0
  3364                              <1> ;	mov dx, [mousecursorposition]
  3365                              <1> ;	mov cx, [mousecursorposition + 2]
  3366                              <1> ;	add edi, edx
  3367                              <1> ;	mov dx, [resolutionx2]
  3368                              <1> ;	inc cx
  3369                              <1> ;guicp2:
  3370                              <1> ;	add edi, edx
  3371                              <1> ;	dec cx
  3372                              <1> ;	cmp cx, 0
  3373                              <1> ;	jne guicp2
  3374                              <1> ;	sub edi, edx
  3375                              <1> ;	mov [cursorloc], edi
  3376                              <1> ;	mov ebx, cursorbmp
  3377                              <1> ;	mov cx, [resolutiony]
  3378                              <1> ;	rol ecx, 16
  3379                              <1> ;	mov cx, [resolutionx]
  3380                              <1> ;	mov esi, [physbaseptr]
  3381                              <1> ;	mov edi, [offscreenmemoffset]
  3382                              <1> ;guicp1:
  3383                              <1> ;	mov ax, [esi]
  3384                              <1> ;	mov [edi], ax
  3385                              <1> ;	add esi, 2
  3386                              <1> ;	add edi, 2
  3387                              <1> ;	cmp edi, [cursorloc]
  3388                              <1> ;	je copycursor
  3389                              <1> ;dncopycursor:
  3390                              <1> ;	dec cx
  3391                              <1> ;	cmp cx, 0
  3392                              <1> ;	jne guicp1
  3393                              <1> ;	mov cx, [resolutionx]
  3394                              <1> ;	rol ecx, 16
  3395                              <1> ;	dec cx
  3396                              <1> ;	cmp cx, 0
  3397                              <1> ;	rol ecx, 16
  3398                              <1> ;	jne guicp1
  3399                              <1> ;	mov byte [copygui], 0
  3400                              <1> ;	ret
  3401                              <1> ;copycursor:
  3402                              <1> ;	cmp ebx, cursorbmpend
  3403                              <1> ;	jae dncopycursor
  3404                              <1> ;	mov dx, [resolutionx2]
  3405                              <1> ;	add edi, edx
  3406                              <1> ;	mov [cursorloc], edi
  3407                              <1> ;	sub edi, edx
  3408                              <1> ;	dec ebx
  3409                              <1> ;	sub edi, 2
  3410                              <1> ;	sub esi, 2
  3411                              <1> ;	mov dx, 9
  3412                              <1> ;curscplp:
  3413                              <1> ;	inc ebx
  3414                              <1> ;	add esi, 2
  3415                              <1> ;	add edi, 2
  3416                              <1> ;	mov ax, [esi]
  3417                              <1> ;	mov [edi], ax
  3418                              <1> ;	mov al, [ebx]
  3419                              <1> ;	cmp al, 0
  3420                              <1> ;	je curscplp2
  3421                              <1> ;	mov word [edi], 1110011110011100b
  3422                              <1> ;curscplp2:
  3423                              <1> ;	dec cx
  3424                              <1> ;	cmp cx, 0
  3425                              <1> ;	je dncopycursor
  3426                              <1> ;	dec dx
  3427                              <1> ;	cmp dx, 0
  3428                              <1> ;	jne curscplp
  3429                              <1> ;	jmp dncopycursor
  3430                              <1> 	
  3431                              <1> 	
  3432                              <1> ;cursorloc: dd 0
  3433                              <1> 		
  3434                              <1> ;nextimage:	
  3435                              <1> ;	call guiclear
  3436                              <1> ;	mov esi, [bmpend]
  3437                              <1> ;	mov eax, 0
  3438                              <1> ;	mov ebx, 0
  3439                              <1> ;	mov ecx, 0
  3440                              <1> ;	mov edx, 0
  3441                              <1> ;	call showbmp
  3442                              <1> ;	jmp guistartin
  3443                              <1> 		
  3444 00002794 00                  <1> copygui db 0
  3445 00002795 00                  <1> graphicsset db 0
  3446 00002796 0000                <1> graphicspos db 0,0
  3447 00002798 00                  <1> showcursorfonton db 0
  3448 00002799 00                  <1> savefonton db 0
  3449 0000279A 00                  <1> mouseselecton db 0
  3450 0000279B 00                  <1> guion db 0
  3451                              <1> 
  3452                              <1> 		
  3453                              <1> clearmousecursor:
  3454 0000279C BE[3F260000]        <1> 		mov esi, background
  3455 000027A1 8B3D[084A0000]      <1> 		mov edi, [physbaseptr]
  3456 000027A7 BA00000000          <1> 		mov edx, 0
  3457 000027AC B900000000          <1> 		mov ecx, 0
  3458 000027B1 668B15[E8240000]    <1> 		mov dx, [lastmouseposition]
  3459 000027B8 668B0D[EA240000]    <1> 		mov cx, [lastmouseposition + 2]
  3460 000027BF 01D7                <1> 		add edi, edx
  3461 000027C1 BA00000000          <1> 		mov edx, 0
  3462 000027C6 668B15[BB350000]    <1> 		mov dx, [resolutionx2]
  3463 000027CD 6681F90000          <1> 		cmp cx, 0
  3464 000027D2 740B                <1> 		je noyclr
  3465 000027D4 01D7                <1> yclr:	add edi, edx
  3466 000027D6 6649                <1> 		dec cx
  3467 000027D8 6681F90000          <1> 		cmp cx, 0
  3468 000027DD 75F5                <1> 		jne yclr
  3469 000027DF 668B06              <1> noyclr:	mov ax, [esi]
  3470 000027E2 C1C010              <1> 		rol eax, 16
  3471 000027E5 668B06              <1> 		mov ax, [esi]
  3472 000027E8 8907                <1> 		mov [edi], eax
  3473 000027EA 894704              <1> 		mov [edi + 4], eax
  3474 000027ED 894708              <1> 		mov [edi + 8], eax
  3475 000027F0 89470C              <1> 		mov [edi + 12], eax
  3476 000027F3 01D7                <1> 		add edi, edx
  3477 000027F5 6641                <1> 		inc cx
  3478 000027F7 6681F91000          <1> 		cmp cx, 16
  3479 000027FC 72E1                <1> 		jb noyclr
  3480 000027FE C3                  <1> 		ret
  3481                              <1> 
  3482                              <1> switchmousepos:		;;switch were the mouse is located
  3483 000027FF BE[00120000]        <1> 		mov esi, mousecolorbuf
  3484 00002804 8B3D[084A0000]      <1> 		mov edi, [physbaseptr]
  3485 0000280A BA00000000          <1> 		mov edx, 0
  3486 0000280F B900000000          <1> 		mov ecx, 0
  3487 00002814 668B15[E8240000]    <1> 		mov dx, [lastmouseposition]
  3488 0000281B 668B0D[EA240000]    <1> 		mov cx, [lastmouseposition + 2]
  3489 00002822 01D7                <1> 		add edi, edx
  3490 00002824 BA00000000          <1> 		mov edx, 0
  3491 00002829 668B15[BB350000]    <1> 		mov dx, [resolutionx2]
  3492 00002830 6681F90000          <1> 		cmp cx, 0
  3493 00002835 740B                <1> 		je noswmsy
  3494 00002837 01D7                <1> swmsy:		add edi, edx
  3495 00002839 6649                <1> 		dec cx
  3496 0000283B 6681F90000          <1> 		cmp cx, 0
  3497 00002840 75F5                <1> 		jne swmsy
  3498 00002842 8B06                <1> noswmsy:	mov eax, [esi]
  3499 00002844 8B5E04              <1> 		mov ebx, [esi + 4]
  3500 00002847 8907                <1> 		mov [edi], eax
  3501 00002849 895F04              <1> 		mov [edi + 4], ebx
  3502 0000284C 8B4608              <1> 		mov eax, [esi + 8]
  3503 0000284F 8B5E0C              <1> 		mov ebx, [esi + 12]
  3504 00002852 894708              <1> 		mov [edi + 8], eax
  3505 00002855 895F0C              <1> 		mov [edi + 12], ebx
  3506 00002858 01D7                <1> 		add edi, edx
  3507 0000285A 81C610000000        <1> 		add esi, 16
  3508 00002860 81FE[00130000]      <1> 		cmp esi, mcolorend
  3509 00002866 72DA                <1> 		jb noswmsy
  3510                              <1> 		
  3511                              <1> switchmousepos2:
  3512 00002868 BE[00120000]        <1> 		mov esi, mousecolorbuf
  3513 0000286D 8B3D[084A0000]      <1> 		mov edi, [physbaseptr]
  3514 00002873 BA00000000          <1> 		mov edx, 0
  3515 00002878 B900000000          <1> 		mov ecx, 0
  3516 0000287D 668B15[EC240000]    <1> 		mov dx, [mousecursorposition]
  3517 00002884 668B0D[EE240000]    <1> 		mov cx, [mousecursorposition + 2]
  3518 0000288B 01D7                <1> 		add edi, edx
  3519 0000288D BA00000000          <1> 		mov edx, 0
  3520 00002892 668B15[BB350000]    <1> 		mov dx, [resolutionx2]
  3521 00002899 6681F90000          <1> 		cmp cx, 0
  3522 0000289E 740B                <1> 		je noswmsy2
  3523 000028A0 01D7                <1> swmsy2:		add edi, edx
  3524 000028A2 6649                <1> 		dec cx
  3525 000028A4 6681F90000          <1> 		cmp cx, 0
  3526 000028A9 75F5                <1> 		jne swmsy2
  3527 000028AB 8B07                <1> noswmsy2:	mov eax, [edi]
  3528 000028AD 8B5F04              <1> 		mov ebx, [edi + 4]
  3529 000028B0 8906                <1> 		mov [esi], eax
  3530 000028B2 895E04              <1> 		mov [esi + 4], ebx
  3531 000028B5 8B4708              <1> 		mov eax, [edi + 8]
  3532 000028B8 8B5F0C              <1> 		mov ebx, [edi + 12]
  3533 000028BB 894608              <1> 		mov [esi + 8], eax
  3534 000028BE 895E0C              <1> 		mov [esi + 12], ebx
  3535 000028C1 01D7                <1> 		add edi, edx
  3536 000028C3 81C610000000        <1> 		add esi, 16
  3537 000028C9 81FE[00130000]      <1> 		cmp esi, mcolorend
  3538 000028CF 72DA                <1> 		jb noswmsy2
  3539 000028D1 C3                  <1> 		ret
  3540                              <1> 
  3541 000028D2 00                  <1> pbutton db 0
  3542 000028D3 00                  <1> pLBUTTON db 0
  3543 000028D4 00                  <1> pRBUTTON db 0
  3544 000028D5 00000000            <1> dragging dw 0,0
  3545 000028D9 0000000000000000    <1> lastpos dw 0,0,0,0
  3546 000028E1 00000000            <1> colorbuf dw 0,0
  3547                              <1> 	
  3548                              <1> 	clickicon:
  3549 000028E5 B001                <1> 		mov al, 1
  3550 000028E7 A2[D2280000]        <1> 		mov [pbutton], al
  3551 000028EC A0[D3280000]        <1> 		mov al, [pLBUTTON]
  3552 000028F1 2205[57220000]      <1> 		and al, [LBUTTON]
  3553 000028F7 8A25[D4280000]      <1> 		mov ah, [pRBUTTON]
  3554 000028FD 2225[58220000]      <1> 		and ah, [RBUTTON]
  3555 00002903 08E0                <1> 		or al, ah
  3556 00002905 3C00                <1> 		cmp al, 0
  3557 00002907 741B                <1> 		je nodragclick
  3558 00002909 813D[D5280000]0100- <1> 		cmp dword [dragging], 1
  3559 00002911 0000                <1>
  3560 00002913 732D                <1> 		jae dragclick
  3561 00002915 C705[D5280000]0100- <1> 		mov dword [dragging], 1
  3562 0000291D 0000                <1>
  3563 0000291F E91E000000          <1> 		jmp dragclick
  3564                              <1> 	nodragclick:
  3565 00002924 C705[D5280000]0000- <1> 		mov dword [dragging], 0
  3566 0000292C 0000                <1>
  3567 0000292E A0[57220000]        <1> 		mov al, [LBUTTON]
  3568 00002933 A2[D3280000]        <1> 		mov [pLBUTTON], al
  3569 00002938 A0[58220000]        <1> 		mov al, [RBUTTON]
  3570 0000293D A2[D4280000]        <1> 		mov [pRBUTTON], al
  3571                              <1> 	dragclick:
  3572 00002942 66B80000            <1> 		mov ax, 0
  3573 00002946 BE[00100000]        <1> 		mov esi, graphicstable
  3574 0000294B C705[5D380000]0000- <1> 		mov dword [codepointer], 0
  3575 00002953 0000                <1>
  3576                              <1> 	clicon2:
  3577 00002955 BA00000000          <1> 		mov edx, 0
  3578 0000295A B900000000          <1> 		mov ecx, 0
  3579 0000295F 66813E0100          <1> 		cmp word [esi], 1
  3580 00002964 0F841B000000        <1> 		je near iconselect
  3581 0000296A 66813E0200          <1> 		cmp word [esi], 2
  3582 0000296F 0F8472010000        <1> 		je near textselected
  3583 00002975 66813E0300          <1> 		cmp word [esi], 3
  3584 0000297A 0F84C7020000        <1> 		je near windowselect
  3585 00002980 E901040000          <1> 		jmp nexticonsel
  3586                              <1> 	iconselect:
  3587 00002985 668B5606            <1> 		mov dx, [esi + 6]
  3588 00002989 6689D0              <1> 		mov ax, dx
  3589 0000298C 668B4E08            <1> 		mov cx, [esi + 8]
  3590 00002990 6689CB              <1> 		mov bx, cx
  3591 00002993 6681C32000          <1> 		add bx, 32
  3592 00002998 6601D0              <1> 		add ax, dx
  3593 0000299B 813D[D5280000]0100- <1> 		cmp dword [dragging], 1
  3594 000029A3 0000                <1>
  3595 000029A5 746F                <1> 		je dragicon
  3596 000029A7 813D[D5280000]0000- <1> 		cmp dword [dragging], 0
  3597 000029AF 0000                <1>
  3598 000029B1 7411                <1> 		je nodragiconcheck
  3599 000029B3 3935[D5280000]      <1> 		cmp dword [dragging], esi
  3600 000029B9 0F85C7030000        <1> 		jne near nexticonsel
  3601 000029BF E952000000          <1> 		jmp dragicon
  3602                              <1> 	nodragiconcheck:
  3603 000029C4 663905[EC240000]    <1> 		cmp [mousecursorposition], ax
  3604 000029CB 0F82B5030000        <1> 		jb near nexticonsel
  3605 000029D1 66054000            <1> 		add ax, 64
  3606 000029D5 663905[EC240000]    <1> 		cmp [mousecursorposition], ax
  3607 000029DC 0F87A4030000        <1> 		ja near nexticonsel
  3608 000029E2 6629D0              <1> 		sub ax, dx
  3609 000029E5 66390D[EE240000]    <1> 		cmp [mousecursorposition + 2], cx
  3610 000029EC 0F8294030000        <1> 		jb near nexticonsel
  3611 000029F2 66391D[EE240000]    <1> 		cmp [mousecursorposition + 2], bx
  3612 000029F9 0F8787030000        <1> 		ja near nexticonsel
  3613 000029FF 668B460A            <1> 		mov ax, [esi + 10]
  3614 00002A03 66250100            <1> 		and ax, 1
  3615 00002A07 663D0100            <1> 		cmp ax, 1
  3616 00002A0B 0F84B6000000        <1> 		je near unselecticon
  3617 00002A11 E98D000000          <1> 		jmp nodragicon
  3618                              <1> 	dragicon:
  3619 00002A16 663905[E8240000]    <1> 		cmp [lastmouseposition], ax
  3620 00002A1D 0F8263030000        <1> 		jb near nexticonsel
  3621 00002A23 66054000            <1> 		add ax, 64
  3622 00002A27 663905[E8240000]    <1> 		cmp [lastmouseposition], ax
  3623 00002A2E 0F8752030000        <1> 		ja near nexticonsel
  3624 00002A34 6629D0              <1> 		sub ax, dx
  3625 00002A37 66390D[EA240000]    <1> 		cmp [lastmouseposition + 2], cx
  3626 00002A3E 0F8242030000        <1> 		jb near nexticonsel
  3627 00002A44 66391D[EA240000]    <1> 		cmp [lastmouseposition + 2], bx
  3628 00002A4B 0F8735030000        <1> 		ja near nexticonsel
  3629 00002A51 668B460A            <1> 		mov ax, [esi + 10]
  3630 00002A55 2410                <1> 		and al, 00010000b
  3631 00002A57 3C10                <1> 		cmp al, 00010000b
  3632 00002A59 7448                <1> 		je nodragicon
  3633 00002A5B 8935[D5280000]      <1> 		mov [dragging], esi
  3634 00002A61 66D1E2              <1> 		shl dx, 1
  3635 00002A64 662B15[E8240000]    <1> 		sub dx, [lastmouseposition]
  3636 00002A6B 660315[EC240000]    <1> 		add dx, [mousecursorposition]
  3637 00002A72 66D1EA              <1> 		shr dx, 1
  3638 00002A75 66030D[EE240000]    <1> 		add cx, [mousecursorposition + 2]
  3639 00002A7C 662B0D[EA240000]    <1> 		sub cx, [lastmouseposition + 2]
  3640 00002A83 663B15[BB350000]    <1> 		cmp dx, [resolutionx2]
  3641 00002A8A 7607                <1> 		jbe chkyresdrgicn
  3642 00002A8C 668B15[EC240000]    <1> 		mov dx, [mousecursorposition]
  3643                              <1> 	chkyresdrgicn:
  3644 00002A93 663B0D[B7350000]    <1> 		cmp cx, [resolutiony]
  3645 00002A9A 7607                <1> 		jbe nodragicon
  3646 00002A9C 668B0D[EE240000]    <1> 		mov cx, [mousecursorposition + 2]
  3647                              <1> 	nodragicon:
  3648 00002AA3 66814E0A0100        <1> 		or word [esi + 10], 1
  3649 00002AA9 8B5E0C              <1> 		mov ebx, [esi + 12]
  3650 00002AAC 668B460A            <1> 		mov ax, [esi + 10]
  3651 00002AB0 8B7602              <1> 		mov esi, [esi + 2]
  3652 00002AB3 C705[5D380000]0000- <1> 		mov dword [codepointer], 0
  3653 00002ABB 0000                <1>
  3654 00002ABD E81C0A0000          <1> 		call showicon
  3655 00002AC2 E9D8020000          <1> 		jmp doneiconsel
  3656                              <1> 	unselecticon:
  3657 00002AC7 6681660AFEFF        <1> 		and word [esi + 10], 0xFFFE
  3658 00002ACD 8B5E0C              <1> 		mov ebx, [esi + 12]
  3659 00002AD0 668B460A            <1> 		mov ax, [esi + 10]
  3660 00002AD4 8B7602              <1> 		mov esi, [esi + 2]
  3661 00002AD7 891D[5D380000]      <1> 		mov [codepointer], ebx
  3662 00002ADD E8FC090000          <1> 		call showicon
  3663 00002AE2 E9B8020000          <1> 		jmp doneiconsel
  3664                              <1> 	textselected:
  3665 00002AE7 8B5E02              <1> 		mov ebx, [esi + 2]
  3666 00002AEA 668B5606            <1> 		mov dx, [esi + 6]
  3667 00002AEE 6689D0              <1> 		mov ax, dx
  3668 00002AF1 668B4E08            <1> 		mov cx, [esi + 8]
  3669                              <1> 	lengthtesttext:
  3670 00002AF5 803B00              <1> 		cmp byte [ebx], 0
  3671 00002AF8 7407                <1> 		je donetesttextlength
  3672 00002AFA 43                  <1> 		inc ebx
  3673 00002AFB 66051000            <1> 		add ax, 16
  3674 00002AFF EBF4                <1> 		jmp lengthtesttext
  3675                              <1> 	donetesttextlength:
  3676 00002B01 6689CB              <1> 		mov bx, cx
  3677 00002B04 6681C30F00          <1> 		add bx, 15
  3678 00002B09 813D[D5280000]0100- <1> 		cmp dword [dragging], 1
  3679 00002B11 0000                <1>
  3680 00002B13 7468                <1> 		je dragtext
  3681 00002B15 813D[D5280000]0000- <1> 		cmp dword [dragging], 0
  3682 00002B1D 0000                <1>
  3683 00002B1F 7411                <1> 		je nodragtextcheck
  3684 00002B21 3935[D5280000]      <1> 		cmp dword [dragging], esi
  3685 00002B27 0F8559020000        <1> 		jne near nexticonsel
  3686 00002B2D E94B000000          <1> 		jmp dragtext
  3687                              <1> 	nodragtextcheck:
  3688 00002B32 663915[EC240000]    <1> 		cmp [mousecursorposition], dx
  3689 00002B39 0F8247020000        <1> 		jb near nexticonsel
  3690 00002B3F 663905[EC240000]    <1> 		cmp [mousecursorposition], ax
  3691 00002B46 0F873A020000        <1> 		ja near nexticonsel
  3692 00002B4C 66390D[EE240000]    <1> 		cmp [mousecursorposition + 2], cx
  3693 00002B53 0F822D020000        <1> 		jb near nexticonsel
  3694 00002B59 66391D[EE240000]    <1> 		cmp [mousecursorposition + 2], bx
  3695 00002B60 0F8720020000        <1> 		ja near nexticonsel
  3696 00002B66 668B460A            <1> 		mov ax, [esi + 10]
  3697 00002B6A 66250100            <1> 		and ax, 1
  3698 00002B6E 663D0100            <1> 		cmp ax, 1
  3699 00002B72 0F84AB000000        <1> 		je near unselecttext
  3700 00002B78 E986000000          <1> 		jmp nodragtext
  3701                              <1> 	dragtext:
  3702 00002B7D 663915[E8240000]    <1> 		cmp [lastmouseposition], dx
  3703 00002B84 0F82FC010000        <1> 		jb near nexticonsel
  3704 00002B8A 663905[E8240000]    <1> 		cmp [lastmouseposition], ax
  3705 00002B91 0F87EF010000        <1> 		ja near nexticonsel
  3706 00002B97 66390D[EA240000]    <1> 		cmp [lastmouseposition + 2], cx
  3707 00002B9E 0F82E2010000        <1> 		jb near nexticonsel
  3708 00002BA4 66391D[EA240000]    <1> 		cmp [lastmouseposition + 2], bx
  3709 00002BAB 0F87D5010000        <1> 		ja near nexticonsel
  3710 00002BB1 668B460A            <1> 		mov ax, [esi + 10]
  3711 00002BB5 2410                <1> 		and al, 00010000b
  3712 00002BB7 663D1000            <1> 		cmp ax, 00010000b
  3713 00002BBB 0F8442000000        <1> 		je near nodragtext
  3714 00002BC1 8935[D5280000]      <1> 		mov [dragging], esi
  3715 00002BC7 662B15[E8240000]    <1> 		sub dx, [lastmouseposition]
  3716 00002BCE 660315[EC240000]    <1> 		add dx, [mousecursorposition]
  3717 00002BD5 66030D[EE240000]    <1> 		add cx, [mousecursorposition + 2]
  3718 00002BDC 662B0D[EA240000]    <1> 		sub cx, [lastmouseposition + 2]
  3719 00002BE3 663B15[BB350000]    <1> 		cmp dx, [resolutionx2]
  3720 00002BEA 7607                <1> 		jbe chkyresdrgtxt
  3721 00002BEC 668B15[EC240000]    <1> 		mov dx, [mousecursorposition]
  3722                              <1> 	chkyresdrgtxt:
  3723 00002BF3 663B0D[B7350000]    <1> 		cmp cx, [resolutiony]
  3724 00002BFA 7607                <1> 		jbe nodragtext
  3725 00002BFC 668B0D[EE240000]    <1> 		mov cx, [mousecursorposition + 2]
  3726                              <1> 	nodragtext:
  3727 00002C03 66814E0A0100        <1> 		or word [esi + 10], 1
  3728 00002C09 8B5E0C              <1> 		mov ebx, [esi + 12]
  3729 00002C0C 891D[5D380000]      <1> 		mov [codepointer], ebx
  3730 00002C12 668B460A            <1> 		mov ax, [esi + 10]
  3731 00002C16 8B7602              <1> 		mov esi, [esi + 2]
  3732 00002C19 E841050000          <1> 		call showstring
  3733 00002C1E E97C010000          <1> 		jmp doneiconsel
  3734                              <1> 	unselecttext:
  3735 00002C23 6681660AFEFF        <1> 		and word [esi + 10], 0xFFFE
  3736 00002C29 8B5E0C              <1> 		mov ebx, [esi + 12]
  3737 00002C2C 668B460A            <1> 		mov ax, [esi + 10]
  3738 00002C30 8B7602              <1> 		mov esi, [esi + 2]
  3739 00002C33 C705[5D380000]0000- <1> 		mov dword [codepointer], 0
  3740 00002C3B 0000                <1>
  3741 00002C3D E81D050000          <1> 		call showstring
  3742 00002C42 E958010000          <1> 		jmp doneiconsel
  3743                              <1> windowselect:
  3744 00002C47 8B7E02              <1> 		mov edi, [esi + 2]
  3745 00002C4A 668B5606            <1> 		mov dx, [esi + 6]
  3746 00002C4E 6689D0              <1> 		mov ax, dx
  3747 00002C51 668B4E08            <1> 		mov cx, [esi + 8]
  3748 00002C55 6689CB              <1> 		mov bx, cx
  3749 00002C58 6681C31000          <1> 		add bx, 16
  3750 00002C5D 813D[D5280000]0100- <1> 		cmp dword [dragging], 1
  3751 00002C65 0000                <1>
  3752 00002C67 746D                <1> 		je dragwin
  3753 00002C69 813D[D5280000]0000- <1> 		cmp dword [dragging], 0
  3754 00002C71 0000                <1>
  3755 00002C73 7411                <1> 		je nodragwincheck
  3756 00002C75 3935[D5280000]      <1> 		cmp dword [dragging], esi
  3757 00002C7B 0F8505010000        <1> 		jne near nexticonsel
  3758 00002C81 E950000000          <1> 		jmp dragwin
  3759                              <1> 	nodragwincheck:
  3760 00002C86 663905[EC240000]    <1> 		cmp [mousecursorposition], ax
  3761 00002C8D 0F82F3000000        <1> 		jb near nexticonsel
  3762 00002C93 660307              <1> 		add ax, [edi]
  3763 00002C96 660307              <1> 		add ax, [edi]
  3764 00002C99 663905[EC240000]    <1> 		cmp [mousecursorposition], ax
  3765 00002CA0 0F87E0000000        <1> 		ja near nexticonsel
  3766 00002CA6 66390D[EE240000]    <1> 		cmp [mousecursorposition + 2], cx
  3767 00002CAD 0F82D3000000        <1> 		jb near nexticonsel
  3768 00002CB3 66391D[EE240000]    <1> 		cmp [mousecursorposition + 2], bx
  3769 00002CBA 0F87C6000000        <1> 		ja near nexticonsel
  3770 00002CC0 662D1400            <1> 		sub ax, 20
  3771 00002CC4 663905[EC240000]    <1> 		cmp [mousecursorposition], ax
  3772 00002CCB 0F8795000000        <1> 		ja near killwin
  3773 00002CD1 E97C000000          <1> 		jmp nodragwin
  3774                              <1> 	dragwin:
  3775 00002CD6 663905[E8240000]    <1> 		cmp [lastmouseposition], ax
  3776 00002CDD 0F82A3000000        <1> 		jb near nexticonsel
  3777 00002CE3 660307              <1> 		add ax, [edi]
  3778 00002CE6 660307              <1> 		add ax, [edi]
  3779 00002CE9 663905[E8240000]    <1> 		cmp [lastmouseposition], ax
  3780 00002CF0 0F8790000000        <1> 		ja near nexticonsel
  3781 00002CF6 66390D[EA240000]    <1> 		cmp [lastmouseposition + 2], cx
  3782 00002CFD 0F8283000000        <1> 		jb near nexticonsel
  3783 00002D03 66391D[EA240000]    <1> 		cmp [lastmouseposition + 2], bx
  3784 00002D0A 0F8776000000        <1> 		ja near nexticonsel
  3785 00002D10 8935[D5280000]      <1> 		mov [dragging], esi
  3786 00002D16 662B15[E8240000]    <1> 		sub dx, [lastmouseposition]
  3787 00002D1D 660315[EC240000]    <1> 		add dx, [mousecursorposition]
  3788 00002D24 66030D[EE240000]    <1> 		add cx, [mousecursorposition + 2]
  3789 00002D2B 662B0D[EA240000]    <1> 		sub cx, [lastmouseposition + 2]
  3790 00002D32 663B15[BB350000]    <1> 		cmp dx, [resolutionx2]
  3791 00002D39 7607                <1> 		jbe chkyresdrgwin
  3792 00002D3B 668B15[EC240000]    <1> 		mov dx, [mousecursorposition]
  3793                              <1> 	chkyresdrgwin:
  3794 00002D42 663B0D[B7350000]    <1> 		cmp cx, [resolutiony]
  3795 00002D49 7607                <1> 		jbe nodragwin
  3796 00002D4B 668B0D[EE240000]    <1> 		mov cx, [mousecursorposition + 2]
  3797                              <1> 	nodragwin:
  3798 00002D52 8B5E0C              <1> 		mov ebx, [esi + 12]
  3799 00002D55 668B460A            <1> 		mov ax, [esi + 10]
  3800 00002D59 8B7602              <1> 		mov esi, [esi + 2]
  3801 00002D5C E853040000          <1> 		call showwindow
  3802 00002D61 E939000000          <1> 		jmp doneiconsel
  3803                              <1> 	killwin:
  3804 00002D66 66C7060000          <1> 		mov word [esi], 0
  3805 00002D6B C705[2D030000]0000- <1> 		mov dword [user2codepoint], 0
  3806 00002D73 0000                <1>
  3807 00002D75 C605[55090000]00    <1> 		mov byte [termguion], 0
  3808 00002D7C E881F8FFFF          <1> 		call guiclear
  3809 00002D81 E939000000          <1> 		jmp doneiconsel2
  3810                              <1> 	nexticonsel:
  3811 00002D86 6681660AFEFF        <1> 		and word [esi + 10], 0xFFFE
  3812 00002D8C 81C610000000        <1> 		add esi, 16
  3813 00002D92 81FE[00120000]      <1> 		cmp esi, graphicstableend
  3814 00002D98 7305                <1> 		jae doneiconsel
  3815 00002D9A E9B6FBFFFF          <1> 		jmp clicon2
  3816                              <1> 	doneiconsel:
  3817 00002D9F 813D[D5280000]0100- <1> 		cmp dword [dragging], 1
  3818 00002DA7 0000                <1>
  3819 00002DA9 7314                <1> 		jae doneiconsel2
  3820 00002DAB 813D[5D380000]0000- <1> 		cmp dword [codepointer], 0
  3821 00002DB3 0000                <1>
  3822 00002DB5 7408                <1> 		je doneiconsel2
  3823 00002DB7 8B1D[5D380000]      <1> 		mov ebx, [codepointer]
  3824 00002DBD FFE3                <1> 		jmp ebx 
  3825                              <1> 	doneiconsel2:
  3826 00002DBF A0[57220000]        <1> 		mov al, [LBUTTON]
  3827 00002DC4 A2[D3280000]        <1> 		mov [pLBUTTON], al
  3828 00002DC9 A0[58220000]        <1> 		mov al, [RBUTTON]
  3829 00002DCE A2[D4280000]        <1> 		mov [pRBUTTON], al
  3830 00002DD3 E8C4F9FFFF          <1> call clearmousecursor
  3831 00002DD8 E83C000000          <1> call reloadallgraphics
  3832 00002DDD B900000000          <1> 		mov ecx, 0
  3833 00002DE2 BA00000000          <1> 		mov edx, 0
  3834 00002DE7 B400                <1> 		mov ah, 0
  3835 00002DE9 B080                <1> 		mov al, 128
  3836 00002DEB 668B15[EC240000]    <1> 		mov dx, [mousecursorposition]
  3837 00002DF2 668B0D[EE240000]    <1> 		mov cx, [mousecursorposition + 2]
  3838 00002DF9 66BBE738            <1> 		mov bx, 0011100011100111b
  3839 00002DFD C605[98270000]01    <1> 		mov byte [showcursorfonton], 1
  3840 00002E04 E8C2070000          <1> 		call showfontvesa
  3841 00002E09 C605[98270000]00    <1> 		mov byte [showcursorfonton], 0
  3842 00002E10 C3                  <1> 		ret
  3843 00002E11 00000000            <1> lastdrag dw 0,0
  3844 00002E15 00000000            <1> grpctblpos dw 0,0
  3845                              <1> 
  3846                              <1> reloadallgraphics:
  3847 00002E19 BF[00100000]        <1> 		mov edi, graphicstable
  3848                              <1> reloadgraphicsloop:
  3849 00002E1E 8B7702              <1> 		mov esi, [edi + 2]
  3850 00002E21 668B5706            <1> 		mov dx, [edi + 6]
  3851 00002E25 668B4F08            <1> 		mov cx, [edi + 8]
  3852 00002E29 668B07              <1> 		mov ax, [edi]
  3853 00002E2C 668B5F0A            <1> 		mov bx, [edi + 10]
  3854 00002E30 893D[152E0000]      <1> 		mov [grpctblpos], edi
  3855 00002E36 3B3D[D5280000]      <1> 		cmp edi, [dragging]
  3856 00002E3C 741E                <1> 		je loadedgraphic
  3857 00002E3E 663D0100            <1> 		cmp ax, 1
  3858 00002E42 0F8431000000        <1> 		je near icongraphic
  3859 00002E48 663D0200            <1> 		cmp ax, 2
  3860 00002E4C 0F8437000000        <1> 		je near stringgraphic
  3861 00002E52 663D0300            <1> 		cmp ax, 3
  3862 00002E56 0F8416000000        <1> 		je near windowgraphic
  3863 00002E5C 8B3D[152E0000]      <1> loadedgraphic:  mov edi, [grpctblpos]
  3864 00002E62 81C710000000        <1> 		add edi, 16
  3865 00002E68 81FF[00120000]      <1> 		cmp edi, graphicstableend
  3866 00002E6E 7329                <1> 		jae donereloadgraphics
  3867 00002E70 EBAC                <1> 		jmp reloadgraphicsloop
  3868 00002E72 E890030000          <1> windowgraphic:	call showwindow2
  3869 00002E77 EBE3                <1> 		jmp loadedgraphic
  3870 00002E79 80E301              <1> icongraphic:	and bl, 1
  3871 00002E7C 881D[61380000]      <1> 		mov [iconselected], bl
  3872 00002E82 E86A060000          <1> 		call showicon2
  3873 00002E87 EBD3                <1> 		jmp loadedgraphic
  3874 00002E89 80E301              <1> stringgraphic:  and bl, 1
  3875 00002E8C 881D[9A270000]      <1> 		mov [mouseselecton], bl
  3876 00002E92 E8DB020000          <1> 		call showstring2
  3877 00002E97 EBC3                <1> 		jmp loadedgraphic
  3878                              <1> donereloadgraphics:
  3879 00002E99 8B3D[D5280000]      <1> 		mov edi, [dragging]
  3880 00002E9F 81FF[00100000]      <1> 		cmp edi, graphicstable
  3881 00002EA5 723B                <1> 		jb notcorrectdrag
  3882 00002EA7 668B07              <1> 		mov ax, [edi]
  3883 00002EAA 8B7702              <1> 		mov esi, [edi + 2]
  3884 00002EAD 668B5706            <1> 		mov dx, [edi + 6]
  3885 00002EB1 668B4F08            <1> 		mov cx, [edi + 8]
  3886 00002EB5 668B5F0A            <1> 		mov bx, [edi + 10]
  3887 00002EB9 663D0100            <1> 		cmp ax, 1
  3888 00002EBD 750F                <1> 		jne noticondragging
  3889 00002EBF 80E301              <1> 		and bl, 1
  3890 00002EC2 881D[61380000]      <1> 		mov [iconselected], bl
  3891 00002EC8 E824060000          <1> 		call showicon2
  3892 00002ECD C3                  <1> 		ret
  3893                              <1> 
  3894                              <1> 	noticondragging:
  3895 00002ECE 663D0200            <1> 		cmp ax, 2
  3896 00002ED2 750E                <1> 		jne notcorrectdrag
  3897 00002ED4 80E301              <1> 		and bl, 1
  3898 00002ED7 881D[9A270000]      <1> 		mov [mouseselecton], bl
  3899 00002EDD E890020000          <1> 		call showstring2
  3900                              <1> 	notcorrectdrag:
  3901 00002EE2 C3                  <1> 		ret
  3902                              <1> 
  3903 00002EE3 00<rept>            <1> grphbuf times 16 db 0
  3904                              <1> 	graphicsadd:
  3905 00002EF3 BF[00100000]        <1> 		mov edi, graphicstable
  3906                              <1> 	shwgrph1:
  3907 00002EF8 397702              <1> 		cmp dword [edi + 2], esi
  3908 00002EFB 7414                <1> 		je showgraphicsreplace2
  3909 00002EFD 81C710000000        <1> 		add edi, 16
  3910 00002F03 81FF[00120000]      <1> 		cmp edi, graphicstableend
  3911 00002F09 0F8335020000        <1> 		jae near showgraphicsnew
  3912 00002F0F EBE7                <1> 		jmp shwgrph1
  3913                              <1> 	showgraphicsreplace2:
  3914 00002F11 8935[E52E0000]      <1> 		mov [grphbuf + 2], esi
  3915 00002F17 668915[E92E0000]    <1> 		mov [grphbuf + 6], dx
  3916 00002F1E 66890D[EB2E0000]    <1> 		mov [grphbuf + 8], cx
  3917 00002F25 891D[EF2E0000]      <1> 		mov [grphbuf + 12], ebx
  3918 00002F2B B700                <1> 		mov bh, 0
  3919 00002F2D 88E3                <1> 		mov bl, ah
  3920 00002F2F B400                <1> 		mov ah, 0
  3921 00002F31 66A3[ED2E0000]      <1> 		mov [grphbuf + 10], ax	
  3922 00002F37 66891D[E32E0000]    <1> 		mov [grphbuf], bx
  3923 00002F3E 66A1[E32E0000]      <1> 		mov ax, [grphbuf]
  3924 00002F44 663D0100            <1> 		cmp ax, 1
  3925 00002F48 0F8419000000        <1> 		je near replaceicon
  3926 00002F4E 663D0200            <1> 		cmp ax, 2
  3927 00002F52 0F8493000000        <1> 		je near replacestring
  3928 00002F58 663D0300            <1> 		cmp ax, 3
  3929 00002F5C 0F840F010000        <1> 		je near replacewindow
  3930 00002F62 E9BA010000          <1> 		jmp showgraphicsreplace
  3931                              <1> 	replaceicon:
  3932 00002F67 893D[D9280000]      <1> 		mov [lastpos], edi
  3933 00002F6D 8935[DD280000]      <1> 		mov [lastpos + 4], esi
  3934 00002F73 8B7702              <1> 		mov esi, [edi + 2]
  3935 00002F76 668B5F0C            <1> 		mov bx, [edi + 12]
  3936 00002F7A 668B5706            <1> 		mov dx, [edi + 6]
  3937 00002F7E 668B4F08            <1> 		mov cx, [edi + 8]
  3938 00002F82 668B06              <1> 		mov ax, [esi]
  3939 00002F85 66A3[E1280000]      <1> 		mov [colorbuf], ax
  3940 00002F8B 66A1[3F260000]      <1> 		mov ax, [background]
  3941 00002F91 668906              <1> 		mov [esi], ax
  3942 00002F94 8B5F0C              <1> 		mov ebx, [edi + 12]
  3943 00002F97 668B470A            <1> 		mov ax, [edi + 10]
  3944 00002F9B 2401                <1> 		and al, 1
  3945 00002F9D A2[61380000]        <1> 		mov [iconselected], al
  3946 00002FA2 668B470A            <1> 		mov ax, [edi + 10]
  3947 00002FA6 E846050000          <1> 		call showicon2
  3948 00002FAB 8B3D[D9280000]      <1> 		mov edi, [lastpos]
  3949 00002FB1 8B7702              <1> 		mov esi, [edi + 2]
  3950 00002FB4 66A1[E1280000]      <1> 		mov ax, [colorbuf]
  3951 00002FBA 668906              <1> 		mov [esi], ax
  3952 00002FBD 8B35[DD280000]      <1> 		mov esi, [lastpos + 4]
  3953 00002FC3 668B15[E92E0000]    <1> 		mov dx, [grphbuf + 6]
  3954 00002FCA 668B0D[EB2E0000]    <1> 		mov cx, [grphbuf + 8]
  3955 00002FD1 668B1D[E32E0000]    <1> 		mov bx, [grphbuf]
  3956 00002FD8 66A1[ED2E0000]      <1> 		mov ax, [grphbuf + 10]
  3957 00002FDE 88DC                <1> 		mov ah, bl
  3958 00002FE0 8B1D[EF2E0000]      <1> 		mov ebx, [grphbuf + 12]
  3959 00002FE6 E936010000          <1> 		jmp showgraphicsreplace
  3960                              <1> 	replacestring:
  3961 00002FEB 893D[D9280000]      <1> 		mov [lastpos], edi
  3962 00002FF1 8935[DD280000]      <1> 		mov [lastpos + 4], esi
  3963 00002FF7 8B5F0C              <1> 		mov ebx, [edi + 12]
  3964 00002FFA 8B7702              <1> 		mov esi, [edi + 2]
  3965 00002FFD 668B5706            <1> 		mov dx, [edi + 6]
  3966 00003001 668B4F08            <1> 		mov cx, [edi + 8]
  3967 00003005 66A1[A2310000]      <1> 		mov ax, [colorfont2]
  3968 0000300B 66A3[E1280000]      <1> 		mov [colorbuf], ax
  3969 00003011 66A1[3F260000]      <1> 		mov ax, [background]
  3970 00003017 66A3[A2310000]      <1> 		mov [colorfont2], ax		
  3971 0000301D 8B5F0C              <1> 		mov ebx, [edi + 12]
  3972 00003020 668B470A            <1> 		mov ax, [edi + 10]
  3973 00003024 2401                <1> 		and al, 1
  3974 00003026 A2[9A270000]        <1> 		mov [mouseselecton], al
  3975 0000302B 668B470A            <1> 		mov ax, [edi + 10]
  3976 0000302F E83E010000          <1> 		call showstring2
  3977 00003034 66A1[E1280000]      <1> 		mov ax, [colorbuf]
  3978 0000303A 66A3[A2310000]      <1> 		mov [colorfont2], ax
  3979 00003040 8B3D[D9280000]      <1> 		mov edi, [lastpos]
  3980 00003046 8B7702              <1> 		mov esi, [edi + 2]
  3981 00003049 668B15[E92E0000]    <1> 		mov dx, [grphbuf + 6]
  3982 00003050 668B0D[EB2E0000]    <1> 		mov cx, [grphbuf + 8]
  3983 00003057 668B1D[E32E0000]    <1> 		mov bx, [grphbuf]
  3984 0000305E 66A1[ED2E0000]      <1> 		mov ax, [grphbuf + 10]
  3985 00003064 88DC                <1> 		mov ah, bl
  3986 00003066 8B1D[EF2E0000]      <1> 		mov ebx, [grphbuf + 12]
  3987 0000306C E9B0000000          <1> 		jmp showgraphicsreplace
  3988                              <1> 	replacewindow:
  3989 00003071 893D[D9280000]      <1> 		mov [lastpos], edi
  3990 00003077 8935[DD280000]      <1> 		mov [lastpos + 4], esi
  3991 0000307D 8B7702              <1> 		mov esi, [edi + 2]
  3992 00003080 8B3D[B0310000]      <1> 		mov edi, [windowbufloc]
  3993 00003086 BA00000000          <1> 		mov edx, 0
  3994 0000308B 668B15[BB350000]    <1> 		mov dx, [resolutionx2]
  3995 00003092 C1E204              <1> 		shl edx, 4
  3996 00003095 29D7                <1> 		sub edi, edx
  3997 00003097 BA00000000          <1> 		mov edx, 0
  3998 0000309C 668B16              <1> 		mov dx, [esi]
  3999 0000309F 660316              <1> 		add dx, [esi]
  4000 000030A2 668B4E02            <1> 		mov cx, [esi + 2]
  4001 000030A6 6681C11000          <1> 		add cx, 16
  4002 000030AB 66A1[3F260000]      <1> 		mov ax, [background]
  4003                              <1> 	clearwindow:
  4004 000030B1 668907              <1> 		mov [edi], ax
  4005 000030B4 81C702000000        <1> 		add edi, 2
  4006 000030BA 81EA02000000        <1> 		sub edx, 2
  4007 000030C0 81FA00000000        <1> 		cmp edx, 0
  4008 000030C6 75E9                <1> 		jne clearwindow
  4009 000030C8 6649                <1> 		dec cx
  4010 000030CA 668B15[BB350000]    <1> 		mov dx, [resolutionx2]
  4011 000030D1 662B16              <1> 		sub dx, [esi]
  4012 000030D4 662B16              <1> 		sub dx, [esi]
  4013 000030D7 01D7                <1> 		add edi, edx
  4014 000030D9 668B16              <1> 		mov dx, [esi]
  4015 000030DC 660316              <1> 		add dx, [esi]
  4016 000030DF 6681F90000          <1> 		cmp cx, 0
  4017 000030E4 75CB                <1> 		jne clearwindow
  4018 000030E6 C605[56090000]00    <1> 		mov byte [termcopyon], 0
  4019 000030ED 8B3D[D9280000]      <1> 		mov edi, [lastpos]
  4020 000030F3 8B35[E52E0000]      <1> 		mov esi, [grphbuf + 2]
  4021 000030F9 668B15[E92E0000]    <1> 		mov dx, [grphbuf + 6]
  4022 00003100 668B0D[EB2E0000]    <1> 		mov cx, [grphbuf + 8]
  4023 00003107 668B1D[E32E0000]    <1> 		mov bx, [grphbuf]
  4024 0000310E 66A1[ED2E0000]      <1> 		mov ax, [grphbuf + 10]
  4025 00003114 88DC                <1> 		mov ah, bl
  4026 00003116 8B1D[EF2E0000]      <1> 		mov ebx, [grphbuf + 12]
  4027 0000311C E900000000          <1> 		jmp showgraphicsreplace
  4028                              <1> 	showgraphicsreplace:
  4029 00003121 897702              <1> 		mov [edi + 2], esi
  4030 00003124 66895706            <1> 		mov [edi + 6], dx
  4031 00003128 66894F08            <1> 		mov [edi + 8], cx
  4032 0000312C 895F0C              <1> 		mov [edi + 12], ebx
  4033 0000312F B700                <1> 		mov bh, 0
  4034 00003131 88E3                <1> 		mov bl, ah
  4035 00003133 B400                <1> 		mov ah, 0
  4036 00003135 6689470A            <1> 		mov [edi + 10], ax
  4037 00003139 66891F              <1> 		mov [edi], bx
  4038 0000313C 8B5F0C              <1> 		mov ebx, [edi + 12]
  4039 0000313F 668B470A            <1> 		mov ax, [edi + 10]
  4040 00003143 C3                  <1> 		ret
  4041                              <1> 	showgraphicsnew:
  4042 00003144 BF[00100000]        <1> 		mov edi, graphicstable
  4043                              <1> 	shwgrph2:
  4044 00003149 66813F0000          <1> 		cmp word [edi], 0
  4045 0000314E 74D1                <1> 		je showgraphicsreplace
  4046 00003150 81C710000000        <1> 		add edi, 16
  4047 00003156 81FF[00120000]      <1> 		cmp edi, graphicstableend
  4048 0000315C 72EB                <1> 		jb shwgrph2
  4049                              <1> 	showgraphicsdone:
  4050 0000315E C3                  <1> 		ret
  4051                              <1> 
  4052                              <1> 	showstring:
  4053 0000315F A2[9A270000]        <1> 		mov [mouseselecton], al
  4054 00003164 8025[9A270000]01    <1> 		and byte [mouseselecton], 1
  4055 0000316B B402                <1> 		mov ah, 2
  4056 0000316D E881FDFFFF          <1> 		call graphicsadd
  4057                              <1> 	showstring2:
  4058 00003172 B400                <1> 		mov ah, 0
  4059 00003174 8A06                <1> 		mov al, [esi]
  4060 00003176 3C00                <1> 		cmp al, 0
  4061 00003178 7420                <1> 		je doneshowstring
  4062 0000317A 46                  <1> 		inc esi
  4063 0000317B 8935[0A380000]      <1> 		mov [showstringesi], esi
  4064 00003181 668B1D[A2310000]    <1> 		mov bx, [colorfont2]
  4065 00003188 E83E040000          <1> 		call showfontvesa
  4066 0000318D 6681C20800          <1> 		add dx, 8
  4067 00003192 8B35[0A380000]      <1> 		mov esi, [showstringesi]
  4068 00003198 EBD8                <1> 		jmp showstring2
  4069                              <1> 	doneshowstring:
  4070 0000319A C605[9A270000]00    <1> 		mov byte [mouseselecton], 0
  4071 000031A1 C3                  <1> 		ret
  4072                              <1> 
  4073 000031A2 FFFF                <1> colorfont2 dw 0xFFFF
  4074 000031A4 0000                <1> winvcopystx dw 0
  4075 000031A6 0000                <1> winvcopysty dw 0
  4076 000031A8 0000                <1> winvcopydx dw 0
  4077 000031AA 0000                <1> winvcopycx dw 0
  4078 000031AC FFFF0000            <1> windowcolor dw 0xFFFF,0x0
  4079 000031B0 00000000            <1> windowbufloc: dw 0,0
  4080                              <1> 
  4081                              <1> 	showwindow:	;;windowstuff in si, position in (dx, cx), nothing in ax, code in bx
  4082 000031B4 C605[55090000]01    <1> 		mov byte [termguion], 1
  4083 000031BB 6681C11000          <1> 		add cx, 16
  4084 000031C0 668915[A4310000]    <1> 		mov [winvcopystx], dx
  4085 000031C7 66890D[A6310000]    <1> 		mov [winvcopysty], cx
  4086 000031CE 668B16              <1> 		mov dx, [esi]
  4087 000031D1 668B4E02            <1> 		mov cx, [esi + 2]
  4088 000031D5 6601D2              <1> 		add dx, dx
  4089 000031D8 668915[A8310000]    <1> 		mov [winvcopydx], dx
  4090 000031DF 66890D[AA310000]    <1> 		mov [winvcopycx], cx
  4091 000031E6 668B0D[A6310000]    <1> 		mov cx, [winvcopysty]
  4092 000031ED 6681E91000          <1> 		sub cx, 16
  4093 000031F2 668B15[A4310000]    <1> 		mov dx, [winvcopystx]
  4094 000031F9 C605[56090000]00    <1> 		mov byte [termcopyon], 0
  4095 00003200 B403                <1> 		mov ah, 3
  4096 00003202 E8ECFCFFFF          <1> 		call graphicsadd
  4097                              <1> 	showwindow2:
  4098 00003207 6681C11000          <1> 		add cx, 16
  4099 0000320C 668915[A4310000]    <1> 		mov [winvcopystx], dx
  4100 00003213 66890D[A6310000]    <1> 		mov [winvcopysty], cx
  4101 0000321A 668B16              <1> 		mov dx, [esi]
  4102 0000321D 668B4E02            <1> 		mov cx, [esi + 2]
  4103 00003221 6601D2              <1> 		add dx, dx
  4104 00003224 668915[A8310000]    <1> 		mov [winvcopydx], dx
  4105 0000322B 66890D[AA310000]    <1> 		mov [winvcopycx], cx
  4106 00003232 8B3D[B0310000]      <1> 		mov edi, [windowbufloc]
  4107 00003238 BA00000000          <1> 		mov edx, 0
  4108 0000323D 668B15[BB350000]    <1> 		mov dx, [resolutionx2]
  4109 00003244 C1E204              <1> 		shl edx, 4
  4110 00003247 29D7                <1> 		sub edi, edx
  4111 00003249 803D[56090000]00    <1> 		cmp byte [termcopyon], 0
  4112 00003250 753E                <1> 		jne nocleartitlebarpos
  4113 00003252 8B3D[084A0000]      <1> 		mov edi, [physbaseptr]
  4114 00003258 BA00000000          <1> 		mov edx, 0
  4115 0000325D 668B15[A4310000]    <1> 		mov dx, [winvcopystx]
  4116 00003264 01D7                <1> 		add edi, edx
  4117 00003266 668B0D[A6310000]    <1> 		mov cx, [winvcopysty]
  4118 0000326D 6681E91000          <1> 		sub cx, 16
  4119 00003272 6681F90000          <1> 		cmp cx, 0
  4120 00003277 7417                <1> 		je nocleartitlebarpos
  4121                              <1> 	cleartitlebarpos:
  4122 00003279 BA00000000          <1> 		mov edx, 0
  4123 0000327E 668B15[BB350000]    <1> 		mov dx, [resolutionx2]
  4124 00003285 01D7                <1> 		add edi, edx
  4125 00003287 6649                <1> 		dec cx
  4126 00003289 6681F90000          <1> 		cmp cx, 0
  4127 0000328E 75E9                <1> 		jne cleartitlebarpos
  4128                              <1> 	nocleartitlebarpos:
  4129 00003290 66B91000            <1> 		mov cx, 16
  4130 00003294 668B15[A8310000]    <1> 		mov dx, [winvcopydx]
  4131 0000329B 6681F90000          <1> 		cmp cx, 0
  4132 000032A0 0F844B000000        <1> 		je near canceltitlebarput
  4133 000032A6 6681FA0000          <1> 		cmp dx, 0
  4134 000032AB 0F8440000000        <1> 		je near canceltitlebarput
  4135                              <1> 	titlebarput:
  4136 000032B1 66A1[AC310000]      <1> 		mov ax, [windowcolor]
  4137 000032B7 668907              <1> 		mov [edi], ax
  4138 000032BA 6681EA0200          <1> 		sub dx, 2
  4139 000032BF 81C702000000        <1> 		add edi, 2
  4140 000032C5 6681FA0000          <1> 		cmp dx, 0
  4141 000032CA 75E5                <1> 		jne titlebarput
  4142 000032CC BA00000000          <1> 		mov edx, 0
  4143 000032D1 668B15[BB350000]    <1> 		mov dx, [resolutionx2]
  4144 000032D8 6649                <1> 		dec cx
  4145 000032DA 662B15[A8310000]    <1> 		sub dx, [winvcopydx]
  4146 000032E1 01D7                <1> 		add edi, edx
  4147 000032E3 668B15[A8310000]    <1> 		mov dx, [winvcopydx]
  4148 000032EA 6681F90000          <1> 		cmp cx, 0
  4149 000032EF 75C0                <1> 		jne titlebarput
  4150                              <1> 	canceltitlebarput:
  4151 000032F1 893D[B0310000]      <1> 		mov [windowbufloc], edi
  4152 000032F7 803D[56090000]02    <1> 		cmp byte [termcopyon], 2
  4153 000032FE 0F8463000000        <1> 		je near winvcpst
  4154 00003304 66B80000            <1> 		mov ax, 0
  4155 00003308 81C604000000        <1> 		add esi, 4
  4156 0000330E 668B15[A4310000]    <1> 		mov dx, [winvcopystx]
  4157 00003315 668B0D[A6310000]    <1> 		mov cx, [winvcopysty]
  4158 0000331C 6681E91000          <1> 		sub cx, 16
  4159 00003321 66BB0000            <1> 		mov bx, 0
  4160 00003325 C605[9A270000]01    <1> 		mov byte [mouseselecton], 1
  4161 0000332C E841FEFFFF          <1> 		call showstring2
  4162 00003331 B058                <1> 		mov al, "X"
  4163 00003333 B400                <1> 		mov ah, 0
  4164 00003335 668B1D[A2310000]    <1> 		mov bx, [colorfont2]
  4165 0000333C 668B15[A4310000]    <1> 		mov dx, [winvcopystx]
  4166 00003343 668B0D[A6310000]    <1> 		mov cx, [winvcopysty]
  4167 0000334A 6681E91000          <1> 		sub cx, 16
  4168 0000334F 6681EA1400          <1> 		sub dx, 20
  4169 00003354 660315[A8310000]    <1> 		add dx, [winvcopydx]
  4170 0000335B C605[9A270000]01    <1> 		mov byte [mouseselecton], 1
  4171 00003362 E864020000          <1> 		call showfontvesa
  4172                              <1> 	winvcpst:
  4173 00003367 8B3D[B0310000]      <1> 		mov edi, [windowbufloc]
  4174 0000336D E957000000          <1> 		jmp windowvideocopyset
  4175                              <1> 
  4176                              <1> 	windowvideocopy:
  4177 00003372 8B3D[B0310000]      <1> 		mov edi, [windowbufloc]
  4178 00003378 3B3D[084A0000]      <1> 		cmp edi, [physbaseptr]
  4179 0000337E 0F8345000000        <1> 		jae near windowvideocopyset
  4180 00003384 B900000000          <1> 		mov ecx, 0
  4181 00003389 BA00000000          <1> 		mov edx, 0
  4182 0000338E 668B15[A4310000]    <1> 		mov dx, [winvcopystx]
  4183 00003395 668B0D[A6310000]    <1> 		mov cx, [winvcopysty]
  4184 0000339C 8B3D[084A0000]      <1> 		mov edi, [physbaseptr]
  4185 000033A2 01D7                <1> 		add edi, edx
  4186 000033A4 81F900000000        <1> 		cmp ecx, 0
  4187 000033AA 741D                <1> 		je windowvideocopyset
  4188                              <1> 	yrescopylp:
  4189 000033AC BA00000000          <1> 		mov edx, 0
  4190 000033B1 668B15[BB350000]    <1> 		mov dx, [resolutionx2]
  4191 000033B8 01D7                <1> 		add edi, edx
  4192 000033BA 6649                <1> 		dec cx
  4193 000033BC 6681F90000          <1> 		cmp cx, 0
  4194 000033C1 75E9                <1> 		jne yrescopylp
  4195 000033C3 893D[B0310000]      <1> 		mov [windowbufloc], edi
  4196                              <1> 	windowvideocopyset:
  4197 000033C9 66B90000            <1> 		mov cx, 0
  4198 000033CD 66890D[D6340000]    <1> 		mov [charposline], cx
  4199 000033D4 BE[851C0000]        <1> 		mov esi, videobuf2
  4200 000033D9 8935[D8340000]      <1> 		mov [charposvbuf], esi
  4201 000033DF 8A1E                <1> 		mov bl, [esi]
  4202 000033E1 B700                <1> 		mov bh, 0
  4203 000033E3 66C1E304            <1> 		shl bx, 4
  4204 000033E7 678AB7[C03F]        <1> 		mov dh, [fonts + bx]
  4205 000033EC D0CE                <1> 		ror dh, 1
  4206 000033EE 89FE                <1> 		mov esi, edi
  4207                              <1> 	copywindow:
  4208 000033F0 B201                <1> 		mov dl, 1
  4209 000033F2 D0C6                <1> 		rol dh, 1
  4210 000033F4 20F2                <1> 		and dl, dh
  4211 000033F6 66A1[AE310000]      <1> 		mov ax, [windowcolor + 2]
  4212 000033FC 668907              <1> 		mov [edi], ax
  4213 000033FF 80FA00              <1> 		cmp dl, 0
  4214 00003402 7409                <1> 		je nowritewin
  4215 00003404 66A1[AC310000]      <1> 		mov ax, [windowcolor]
  4216 0000340A 668907              <1> 		mov [edi], ax
  4217                              <1> 	nowritewin:
  4218 0000340D 81C702000000        <1> 		add edi, 2
  4219 00003413 FEC1                <1> 		inc cl
  4220 00003415 80F908              <1> 		cmp cl, 8
  4221 00003418 75D6                <1> 		jne copywindow
  4222 0000341A 6643                <1> 		inc bx
  4223 0000341C B100                <1> 		mov cl, 0
  4224 0000341E BA00000000          <1> 		mov edx, 0
  4225 00003423 668B15[BB350000]    <1> 		mov dx, [resolutionx2]
  4226 0000342A 01D6                <1> 		add esi, edx
  4227 0000342C 89F7                <1> 		mov edi, esi
  4228 0000342E 678AB7[C03F]        <1> 		mov dh, [fonts + bx]
  4229 00003433 D0CE                <1> 		ror dh, 1
  4230 00003435 FEC5                <1> 		inc ch
  4231 00003437 80FD10              <1> 		cmp ch, 16
  4232 0000343A 75B4                <1> 		jne copywindow
  4233 0000343C 66B90000            <1> 		mov cx, 0
  4234 00003440 8B3D[D8340000]      <1> 		mov edi, [charposvbuf]
  4235 00003446 81C702000000        <1> 		add edi, 2
  4236 0000344C 81FF[452F0000]      <1> 		cmp edi, videobufend
  4237 00003452 7370                <1> 		jae donewincopynow
  4238 00003454 8A1F                <1> 		mov bl, [edi]
  4239 00003456 B700                <1> 		mov bh, 0
  4240 00003458 66C1E304            <1> 		shl bx, 4
  4241 0000345C 893D[D8340000]      <1> 		mov [charposvbuf], edi
  4242 00003462 BA00000000          <1> 		mov edx, 0
  4243 00003467 668B15[BB350000]    <1> 		mov dx, [resolutionx2]
  4244 0000346E C1E204              <1> 		shl edx, 4
  4245 00003471 29D6                <1> 		sub esi, edx
  4246 00003473 81C610000000        <1> 		add esi, 16
  4247 00003479 89F7                <1> 		mov edi, esi
  4248 0000347B 668B0D[D6340000]    <1> 		mov cx, [charposline]
  4249 00003482 6641                <1> 		inc cx
  4250 00003484 6681F95000          <1> 		cmp cx, 80
  4251 00003489 7317                <1> 		jae fixwindowcopy
  4252 0000348B 66890D[D6340000]    <1> 		mov [charposline], cx
  4253 00003492 66B90000            <1> 		mov cx, 0
  4254 00003496 678AB7[C03F]        <1> 		mov dh, [fonts + bx]
  4255 0000349B D0CE                <1> 		ror dh, 1
  4256 0000349D E94EFFFFFF          <1> 		jmp copywindow
  4257                              <1> fixwindowcopy:
  4258 000034A2 66B90000            <1> 		mov cx, 0
  4259 000034A6 66890D[D6340000]    <1> 		mov [charposline], cx
  4260 000034AD 662B15[A8310000]    <1> 		sub dx, [winvcopydx]
  4261 000034B4 01D6                <1> 		add esi, edx
  4262 000034B6 89F7                <1> 		mov edi, esi
  4263 000034B8 678AB7[C03F]        <1> 		mov dh, [fonts + bx]
  4264 000034BD D0CE                <1> 		ror dh, 1
  4265 000034BF E92CFFFFFF          <1> 		jmp copywindow
  4266                              <1> donewincopynow:
  4267 000034C4 803D[56090000]01    <1> 		cmp byte [termcopyon], 1
  4268 000034CB 7501                <1> 		jne forgetresetstuff
  4269 000034CD 61                  <1> 		popa
  4270                              <1> forgetresetstuff:
  4271 000034CE C605[56090000]00    <1> 		mov byte [termcopyon], 0
  4272 000034D5 C3                  <1> 		ret
  4273                              <1> 
  4274 000034D6 0000                <1> charposline dw 0
  4275 000034D8 00000000            <1> charposvbuf dw 0,0
  4276 000034DC 0000                <1> iconcolor dw 0
  4277                              <1> 	showicon:	;;icon in si, position in (dx,cx), selected in ax, code in bx
  4278 000034DE A2[61380000]        <1> 		mov [iconselected], al
  4279 000034E3 8025[61380000]01    <1> 		and byte [iconselected], 1
  4280 000034EA B401                <1> 		mov ah, 1
  4281 000034EC E802FAFFFF          <1> 		call graphicsadd
  4282                              <1> 	showicon2:
  4283 000034F1 8B3D[084A0000]      <1> 		mov edi, [physbaseptr]
  4284 000034F7 6601D2              <1> 		add dx, dx
  4285 000034FA 663B15[BB350000]    <1> 		cmp dx, [resolutionx2]
  4286 00003501 720C                <1> 		jb screenxgood
  4287 00003503 668B15[BB350000]    <1> 		mov dx, [resolutionx2]
  4288 0000350A 6681EA4000          <1> 		sub dx, 64
  4289                              <1> 	screenxgood:
  4290 0000350F 6681F90000          <1> 		cmp cx, 0
  4291 00003514 7425                <1> 		je noscreenygoodchk
  4292 00003516 663B0D[B7350000]    <1> 		cmp cx, [resolutiony]
  4293 0000351D 720C                <1> 		jb screenygood
  4294 0000351F 668B0D[B7350000]    <1> 		mov cx, [resolutiony]
  4295 00003526 6681E92000          <1> 		sub cx, 32
  4296                              <1> 	screenygood:
  4297 0000352B BB00000000          <1> 		mov ebx, 0
  4298 00003530 668B1D[BB350000]    <1> 		mov bx, [resolutionx2]
  4299 00003537 01DF                <1> 		add edi, ebx
  4300 00003539 E2F0                <1> 		loop screenygood
  4301                              <1> 	noscreenygoodchk:
  4302 0000353B BB00000000          <1> 		mov ebx, 0
  4303 00003540 6689D3              <1> 		mov bx, dx
  4304 00003543 01DF                <1> 		add edi, ebx
  4305 00003545 66B90000            <1> 		mov cx, 0
  4306 00003549 668B06              <1> 		mov ax, [esi]
  4307 0000354C 81C602000000        <1> 		add esi, 2
  4308 00003552 66A3[DC340000]      <1> 		mov [iconcolor], ax
  4309                              <1> 	writeicon:
  4310 00003558 8B06                <1> 		mov eax, [esi]
  4311 0000355A D1C0                <1> 		rol eax, 1
  4312 0000355C B100                <1> 		mov cl, 0
  4313                              <1> 	writeiconline:
  4314 0000355E B201                <1> 		mov dl, 1
  4315 00003560 20C2                <1> 		and dl, al
  4316 00003562 3215[61380000]      <1> 		xor dl, [iconselected]
  4317 00003568 668B1D[3F260000]    <1> 		mov bx, [background]
  4318 0000356F 66891F              <1> 		mov [edi], bx
  4319 00003572 80FA00              <1> 		cmp dl, 0
  4320 00003575 740A                <1> 		je noiconline
  4321 00003577 668B15[DC340000]    <1> 		mov dx, [iconcolor]
  4322 0000357E 668917              <1> 		mov [edi], dx
  4323                              <1> 	noiconline:
  4324 00003581 81C702000000        <1> 		add edi, 2
  4325 00003587 D1C0                <1> 		rol eax, 1
  4326 00003589 FEC1                <1> 		inc cl
  4327 0000358B 80F920              <1> 		cmp cl, 32
  4328 0000358E 72CE                <1> 		jb writeiconline
  4329 00003590 81C604000000        <1> 		add esi, 4
  4330 00003596 FEC5                <1> 		inc ch
  4331 00003598 BA00000000          <1> 		mov edx, 0
  4332 0000359D 668B15[BB350000]    <1> 		mov dx, [resolutionx2]
  4333 000035A4 01D7                <1> 		add edi, edx
  4334 000035A6 81EF40000000        <1> 		sub edi, 64
  4335 000035AC 80FD20              <1> 		cmp ch, 32
  4336 000035AF 72A7                <1> 		jb writeicon
  4337 000035B1 B800000000          <1> 		mov eax, 0
  4338 000035B6 C3                  <1> 		ret
  4339                              <1> 
  4340 000035B7 0000                <1> resolutiony dw 0
  4341 000035B9 0000                <1> resolutionx dw 0
  4342 000035BB 0000                <1> resolutionx2 dw 0
  4343 000035BD 02                  <1> resolutionbytes db 2
  4344 000035BE 0000                <1> posxvesa dw 0
  4345 000035C0 0000                <1> posyvesa dw 0
  4346 000035C2 FFFF                <1> colorfont dw 0xFFFF
  4347                              <1> savefontvesa:		;;same rules as showfontvesa
  4348 000035C4 C605[99270000]01    <1> 	mov byte [savefonton], 1
  4349                              <1> showfontvesa:		;;position in (dx,cx), color in bx, char in al
  4350 000035CB 66890D[C0350000]    <1> 	mov [posyvesa], cx
  4351 000035D2 668915[BE350000]    <1> 	mov [posxvesa], dx
  4352 000035D9 8B3D[084A0000]      <1> 	mov edi, [physbaseptr]
  4353 000035DF 66891D[C2350000]    <1> 	mov [colorfont], bx
  4354 000035E6 BB00000000          <1> 	mov ebx, 0
  4355 000035EB 88C3                <1> 	mov bl, al
  4356 000035ED B800000000          <1> 	mov eax, 0
  4357 000035F2 88D8                <1> 	mov al, bl
  4358 000035F4 6689D3              <1> 	mov bx, dx
  4359 000035F7 89DA                <1> 	mov edx, ebx
  4360 000035F9 BB00000000          <1> 	mov ebx, 0
  4361 000035FE 6681F90000          <1> 	cmp cx, 0
  4362 00003603 7415                <1> 	je vesaposloopdn
  4363 00003605 668B1D[BB350000]    <1> 	mov bx, [resolutionx2]
  4364                              <1> vesaposloop:
  4365 0000360C 01DA                <1> 	add edx, ebx
  4366 0000360E 6681E90100          <1> 	sub cx, 1
  4367 00003613 6681F90000          <1> 	cmp cx, 0
  4368 00003618 75F2                <1> 	jne vesaposloop
  4369                              <1> vesaposloopdn:
  4370 0000361A 01D7                <1> 	add edi, edx
  4371 0000361C BE[C03F0000]        <1> 	mov esi, fonts
  4372                              <1> findfontvesa:
  4373 00003621 B400                <1> 	mov ah, 0
  4374 00003623 C1E004              <1> 	shl eax, 4
  4375 00003626 01C6                <1> 	add esi, eax
  4376 00003628 C1E804              <1> 	shr eax, 4
  4377 0000362B 81FE[E0470000]      <1> 	cmp esi, fontend
  4378 00003631 0F83BF000000        <1> 	jae near donefontvesa
  4379 00003637 4E                  <1> 	dec esi
  4380                              <1> foundfontvesa:
  4381 00003638 46                  <1> 	inc esi
  4382 00003639 803D[99270000]01    <1> 	cmp byte [savefonton], 1
  4383 00003640 0F84E1000000        <1> 	je near vesafontsaver
  4384 00003646 B100                <1> 	mov cl, 0
  4385 00003648 8A06                <1> 	mov al, [esi]
  4386 0000364A 668B15[BB350000]    <1> 	mov dx, [resolutionx2]
  4387 00003651 662B15[BE350000]    <1> 	sub dx, [posxvesa]
  4388 00003658 6681FA1000          <1> 	cmp dx, 16
  4389 0000365D 7708                <1> 	ja paintfontvesa
  4390 0000365F D0EA                <1> 	shr dl, 1
  4391 00003661 8815[26370000]      <1> 	mov [charwidth], dl
  4392                              <1> paintfontvesa:
  4393 00003667 B201                <1> 	mov dl, 1
  4394 00003669 20C2                <1> 	and dl, al
  4395 0000366B 803D[98270000]01    <1> 	cmp byte [showcursorfonton], 1
  4396 00003672 0F8435000000        <1> 	je near nodelpaintedfont
  4397 00003678 803D[98270000]02    <1> 	cmp byte [showcursorfonton], 2
  4398 0000367F 0F8518000000        <1> 	jne near noswitchcursorfonton
  4399 00003685 80FA00              <1> 	cmp dl, 0
  4400 00003688 0F842E000000        <1> 	je near nopixelset
  4401 0000368E 668B1D[C2350000]    <1> 	mov bx, [colorfont]
  4402 00003695 66891F              <1> 	mov [edi], bx
  4403 00003698 E91F000000          <1> 	jmp nopixelset
  4404                              <1> noswitchcursorfonton:
  4405 0000369D 3215[9A270000]      <1> 	xor dl, [mouseselecton]
  4406 000036A3 668B1D[3F260000]    <1> 	mov bx, [background]
  4407 000036AA 66891F              <1> 	mov [edi], bx
  4408                              <1> nodelpaintedfont:
  4409 000036AD 80FA00              <1> 	cmp dl, 0
  4410 000036B0 740A                <1> 	je nopixelset
  4411 000036B2 668B15[C2350000]    <1> 	mov dx, [colorfont]
  4412 000036B9 668917              <1> 	mov [edi], dx
  4413                              <1> nopixelset:
  4414 000036BC 81C702000000        <1> 	add edi, 2
  4415 000036C2 D0C0                <1> 	rol al, 1
  4416 000036C4 FEC1                <1> 	inc cl
  4417 000036C6 3A0D[26370000]      <1> 	cmp cl, [charwidth]
  4418 000036CC 7299                <1> 	jb paintfontvesa
  4419 000036CE FEC5                <1> 	inc ch
  4420 000036D0 BA00000000          <1> 	mov edx, 0
  4421 000036D5 668B15[BB350000]    <1> 	mov dx, [resolutionx2]
  4422 000036DC 01D7                <1> 	add edi, edx
  4423 000036DE BA00000000          <1> 	mov edx, 0
  4424 000036E3 8A15[26370000]      <1> 	mov dl, [charwidth]
  4425 000036E9 00D2                <1> 	add dl, dl
  4426 000036EB 29D7                <1> 	sub edi, edx
  4427 000036ED 80FD10              <1> 	cmp ch, 16
  4428 000036F0 0F8242FFFFFF        <1> 	jb foundfontvesa
  4429                              <1> donefontvesa:
  4430 000036F6 B208                <1> 	mov dl, 8
  4431 000036F8 8815[26370000]      <1> 	mov [charwidth], dl
  4432 000036FE 668B15[BE350000]    <1> 	mov dx, [posxvesa]
  4433 00003705 8A1D[26370000]      <1> 	mov bl, [charwidth]
  4434 0000370B B700                <1> 	mov bh, 0
  4435 0000370D 6601DA              <1> 	add dx, bx
  4436 00003710 668B1D[C2350000]    <1> 	mov bx, [colorfont]
  4437 00003717 668B0D[C0350000]    <1> 	mov cx, [posyvesa]
  4438 0000371E C605[99270000]00    <1> 	mov byte [savefonton], 0
  4439 00003725 C3                  <1> 	ret
  4440 00003726 08                  <1> charwidth db 8
  4441                              <1> vesafontsaver:
  4442 00003727 B000                <1> 	mov al, 0
  4443 00003729 B100                <1> 	mov cl, 0
  4444                              <1> vesafontsaver2:
  4445 0000372B 668B17              <1> 	mov dx, [edi]
  4446 0000372E 663B15[C2350000]    <1> 	cmp dx, [colorfont]
  4447 00003735 742F                <1> 	je colorfontmatch
  4448                              <1> donecolormatch:
  4449 00003737 81C702000000        <1> 	add edi, 2
  4450 0000373D D0C0                <1> 	rol al, 1
  4451 0000373F FEC1                <1> 	inc cl
  4452 00003741 80F908              <1> 	cmp cl, 8
  4453 00003744 72E5                <1> 	jb vesafontsaver2
  4454 00003746 8806                <1> 	mov [esi], al
  4455 00003748 46                  <1> 	inc esi
  4456 00003749 FEC5                <1> 	inc ch
  4457 0000374B BA00000000          <1> 	mov edx, 0
  4458 00003750 668B15[BB350000]    <1> 	mov dx, [resolutionx2]
  4459 00003757 01D7                <1> 	add edi, edx
  4460 00003759 81EF10000000        <1> 	sub edi, 16
  4461 0000375F 80FD10              <1> 	cmp ch, 16
  4462 00003762 72C3                <1> 	jb vesafontsaver
  4463 00003764 EB90                <1> 	jmp donefontvesa
  4464                              <1> colorfontmatch:
  4465 00003766 0401                <1> 	add al, 1
  4466 00003768 EBCD                <1> 	jmp donecolormatch
  4467                              <1> 	
  4468                              <1> showbmp:
  4469 0000376A 668B06              <1> 	mov ax, [esi]
  4470 0000376D 663D424D            <1> 	cmp ax, "BM"
  4471 00003771 0F858E000000        <1> 	jne near endedbmp
  4472 00003777 8B3D[084A0000]      <1> 	mov edi, [physbaseptr]
  4473 0000377D 6689D0              <1> 	mov ax, dx
  4474 00003780 6689CB              <1> 	mov bx, cx
  4475 00003783 B900000000          <1> 	mov ecx, 0
  4476 00003788 BA00000000          <1> 	mov edx, 0
  4477 0000378D 6689D9              <1> 	mov cx, bx
  4478 00003790 6689C2              <1> 	mov dx, ax
  4479 00003793 01D7                <1> 	add edi, edx
  4480 00003795 01D7                <1> 	add edi, edx
  4481 00003797 BA00000000          <1> 	mov edx, 0
  4482 0000379C 668B15[BB350000]    <1> 	mov dx, [resolutionx2]
  4483 000037A3 41                  <1> 	inc ecx
  4484 000037A4 034E16              <1> 	add ecx, [esi + 22]
  4485                              <1> bmplocloop:
  4486 000037A7 01D7                <1> 	add edi, edx
  4487 000037A9 E2FC                <1> 	loop bmplocloop
  4488 000037AB 29D7                <1> 	sub edi, edx
  4489 000037AD 8B5612              <1> 	mov edx, [esi + 18]
  4490 000037B0 8B4E16              <1> 	mov ecx, [esi + 22]
  4491 000037B3 8B460A              <1> 	mov eax, [esi + 10]
  4492 000037B6 8B5E02              <1> 	mov ebx, [esi + 2]
  4493 000037B9 01F3                <1> 	add ebx, esi
  4494 000037BB 891D[06380000]      <1> 	mov [bmpend], ebx
  4495 000037C1 89D3                <1> 	mov ebx, edx
  4496 000037C3 01C6                <1> 	add esi, eax
  4497                              <1> ldxbmp:
  4498 000037C5 668B06              <1> 	mov ax, [esi]
  4499 000037C8 668907              <1> 	mov [edi], ax
  4500 000037CB 81C702000000        <1> 	add edi, 2
  4501 000037D1 81C602000000        <1> 	add esi, 2
  4502 000037D7 3B35[06380000]      <1> 	cmp esi, [bmpend]
  4503 000037DD 7726                <1> 	ja endedbmp
  4504 000037DF 4A                  <1> 	dec edx
  4505 000037E0 81FA00000000        <1> 	cmp edx, 0
  4506 000037E6 77DD                <1> 	ja ldxbmp
  4507 000037E8 BA00000000          <1> 	mov edx, 0
  4508 000037ED 668B15[BB350000]    <1> 	mov dx, [resolutionx2]
  4509 000037F4 29DF                <1> 	sub edi, ebx
  4510 000037F6 29DF                <1> 	sub edi, ebx
  4511 000037F8 29D7                <1> 	sub edi, edx
  4512 000037FA 49                  <1> 	dec ecx
  4513 000037FB 89DA                <1> 	mov edx, ebx
  4514 000037FD 81F900000000        <1> 	cmp ecx, 0
  4515 00003803 77C0                <1> 	ja ldxbmp
  4516                              <1> endedbmp:
  4517 00003805 C3                  <1> 	ret
  4518                              <1> 	
  4519 00003806 00000000            <1> 	bmpend dd 0
  4520                              <1> 
  4521                              <1> ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;Here are some vars;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
  4522 0000380A 00000000            <1> 	showstringesi dw 0,0
  4523 0000380E 00                  <1> 	mouseon db 0
  4524 0000380F 737461727400        <1> 	start	db "start",0
  4525 00003815 536F6C6C65724F5300  <1> 	gotomenu db "SollerOS",0
  4526 0000381E 426F6F2100          <1> 	boomsg db "Boo!",0
  4527 00003823 5061636D616E207761- <1> 	pacmsg	db "Pacman was easy to draw.",0
  4528 0000382C 73206561737920746F- <1>
  4529 00003835 20647261772E00      <1>
  4530 0000383C 4F6D206E6F6D206E6F- <1> 	pacnom  db "Om nom nom nom",0
  4531 00003845 6D206E6F6D00        <1>
  4532 0000384B 77696E646F77732073- <1> 	winmsg	db "windows sucks",0
  4533 00003854 75636B7300          <1>
  4534 00003859 5800                <1> 	xmsg db "X",0
  4535 0000385B 0000                <1> 	icon dw 0	;pointer to icon
  4536 0000385D 00000000            <1> 	codepointer dw 0,0 ;pointer to code
  4537 00003861 00                  <1> 	iconselected db 0
  4538                              <1> 	
  4539                              <1> 	boo:
  4540 00003862 BE[1E380000]        <1> 		mov esi, boomsg
  4541 00003867 66BA6400            <1> 		mov dx, 100
  4542 0000386B 66B94001            <1> 		mov cx, 320
  4543 0000386F BB00000000          <1> 		mov ebx, 0
  4544 00003874 66B80000            <1> 		mov ax, 0
  4545 00003878 E9E2F8FFFF          <1> 		jmp showstring
  4546                              <1> 
  4547                              <1> 	pacmannomnom:
  4548 0000387D BE[3C380000]        <1> 		mov esi, pacnom
  4549 00003882 66BA8200            <1> 		mov dx, 130
  4550 00003886 66B93C00            <1> 		mov cx, 60
  4551 0000388A BB00000000          <1> 		mov ebx, 0
  4552 0000388F 66B80000            <1> 		mov ax, 0
  4553 00003893 E9C7F8FFFF          <1> 		jmp showstring	
  4554                              <1> 	
  4555                              <1> 	noie:
  4556 00003898 BE[2C390000]        <1> 		mov esi, termwindow
  4557 0000389D 66BA0000            <1> 		mov dx, 0
  4558 000038A1 66B90000            <1> 		mov cx, 0
  4559 000038A5 BB[C10D0000]        <1> 		mov ebx, nwcmd
  4560                              <1> ;;		mov ebx, internettest
  4561 000038AA 891D[2D030000]      <1> 		mov [user2codepoint], ebx
  4562 000038B0 66B80000            <1> 		mov ax, 0
  4563 000038B4 E8FBF8FFFF          <1> 		call showwindow
  4564                              <1> ;;		jmp internettest
  4565 000038B9 E903D5FFFF          <1> 		jmp nwcmd
  4566 000038BE C3                  <1> 		ret
  4567                              <1> 
  4568                              <1> 	gotomenuboot:
  4569 000038BF BE[2C390000]        <1> 		mov esi, termwindow
  4570 000038C4 66BA0000            <1> 		mov dx, 0
  4571 000038C8 66B90000            <1> 		mov cx, 0
  4572 000038CC BB[B00C0000]        <1> 		mov ebx, os
  4573 000038D1 891D[2D030000]      <1> 		mov [user2codepoint], ebx
  4574 000038D7 66B80000            <1> 		mov ax, 0
  4575 000038DB E8D4F8FFFF          <1> 		call showwindow
  4576 000038E0 E9CBD3FFFF          <1> jmp os
  4577 000038E5 C3                  <1> 		ret
  4578                              <1> 
  4579                              <1> 	winblows:
  4580 000038E6 BE[4B380000]        <1> 		mov esi, winmsg
  4581 000038EB 66BA0000            <1> 		mov dx, 0
  4582 000038EF 668B0D[B7350000]    <1> 		mov cx, [resolutiony]
  4583 000038F6 6681E92000          <1> 		sub cx, 32
  4584 000038FB BB00000000          <1> 		mov ebx, 0
  4585 00003900 B400                <1> 		mov ah, 0
  4586 00003902 B011                <1> 		mov al, 00010001b
  4587 00003904 E856F8FFFF          <1> 		call showstring
  4588 00003909 BE[15380000]        <1> 		mov esi, gotomenu
  4589 0000390E 668B0D[B7350000]    <1> 		mov cx, [resolutiony]
  4590 00003915 6681E93000          <1> 		sub cx, 48
  4591 0000391A 66BA0000            <1> 		mov dx, 0
  4592 0000391E B400                <1> 		mov ah, 0
  4593 00003920 B010                <1> 		mov al, 00010000b
  4594 00003922 BB[BF380000]        <1> 		mov ebx, gotomenuboot
  4595 00003927 E933F8FFFF          <1> 		jmp showstring
  4596                              <1> 
  4597 0000392C 8002E001            <1> 	termwindow:	dw 640,480	;;window size
  4598 00003930 5445524D494E414C00  <1> 	termmsg:	db "TERMINAL",0	;;window title
  4599                              <1> 	
  4600 00003930 <incbin>            <1> interneticon: 	incbin 'source/precompiled/interneticon.pak'
  4601 00003930 <incbin>            <1> wordicon: 	incbin 'source/precompiled/wordicon.pak'
  4602 00003930 <incbin>            <1> pacmanpellet: incbin 'source/precompiled/pacmanpellet.pak'
  4603 00003930 <incbin>            <1> ghostie	incbin 'source/precompiled/ghostie.pak'
  4604 00003930 <incbin>            <1> pacman	incbin 'source/precompiled/pacman.pak'
  4605                                      ;%include 'source/network.asm'
  4606                                  	%include 'source/pci.asm'
  4607 00003BC3 00                  <1> pcibus		db 0
  4608 00003BC4 00                  <1> pcidevice	db 0
  4609 00003BC5 00                  <1> pcifunction	db 0
  4610 00003BC6 00                  <1> pciregister	db 0
  4611 00003BC7 00                  <1> pcireqtype db 0
  4612                              <1> 
  4613                              <1> getpciport:
  4614 00003BC8 B001                <1> 	mov al, 1
  4615 00003BCA A2[C73B0000]        <1> 	mov [pcireqtype], al
  4616 00003BCF E91E000000          <1> 	jmp searchpci
  4617                              <1> pcidump:
  4618 00003BD4 B800000000          <1> 	mov eax, 0
  4619 00003BD9 A2[C53B0000]        <1> 	mov [pcifunction], al
  4620 00003BDE A2[C33B0000]        <1> 	mov [pcibus], al
  4621 00003BE3 A2[C43B0000]        <1> 	mov [pcidevice], al
  4622 00003BE8 A2[C73B0000]        <1> 	mov [pcireqtype], al
  4623 00003BED E900000000          <1> 	jmp searchpci
  4624                              <1> searchpci:		;;return in ebx, start X in pciX
  4625 00003BF2 B000                <1> 	mov al, 0
  4626 00003BF4 A2[C63B0000]        <1> 	mov [pciregister], al
  4627 00003BF9 E84F010000          <1> 	call getpciaddr
  4628 00003BFE BAF80C0000          <1> 	mov edx, 0xCF8
  4629 00003C03 EF                  <1> 	out dx, eax	;;request pci config
  4630 00003C04 BAFC0C0000          <1> 	mov edx, 0xCFC
  4631 00003C09 ED                  <1> 	in eax, dx 	;;read in pci config
  4632 00003C0A 3D0000FFFF          <1> 	cmp eax, 0xFFFF0000
  4633 00003C0F 0F8237000000        <1> 	jb near checkpcidevice
  4634                              <1> searchpciret:
  4635                              <1> nextpcidevice:
  4636 00003C15 B000                <1> 	mov al, 0
  4637 00003C17 A2[C53B0000]        <1> 	mov [pcifunction], al
  4638 00003C1C A0[C43B0000]        <1> 	mov al, [pcidevice]
  4639 00003C21 3C1F                <1> 	cmp al, 11111b
  4640 00003C23 0F83B8000000        <1> 	jae near nextpcibus
  4641 00003C29 FEC0                <1> 	inc al
  4642 00003C2B A2[C43B0000]        <1> 	mov [pcidevice], al
  4643 00003C30 EBC0                <1> 	jmp searchpci
  4644 00003C32 A0[C53B0000]        <1> 	mov al, [pcifunction]
  4645 00003C37 3C07                <1> 	cmp al, 111b
  4646 00003C39 0F83D6FFFFFF        <1> 	jae near nextpcidevice
  4647 00003C3F FEC0                <1> 	inc al
  4648 00003C41 A2[C53B0000]        <1> 	mov [pcifunction], al
  4649 00003C46 EBAA                <1> 	jmp searchpci
  4650 00003C48 00000000            <1> pcitype: db 0,0,0,0
  4651                              <1> checkpcidevice:
  4652 00003C4C B000                <1> 	mov al, 0
  4653 00003C4E 3805[C73B0000]      <1> 	cmp [pcireqtype], al
  4654 00003C54 0F842B000000        <1> 	je near dumppcidevice
  4655 00003C5A B008                <1> 	mov al, 0x08
  4656 00003C5C A2[C63B0000]        <1> 	mov [pciregister], al	;;class code, subclass, revision id
  4657 00003C61 E8E7000000          <1> 	call getpciaddr
  4658 00003C66 BAF80C0000          <1> 	mov edx, 0xCF8
  4659 00003C6B EF                  <1> 	out dx, eax
  4660 00003C6C BAFC0C0000          <1> 	mov edx, 0xCFC
  4661 00003C71 ED                  <1> 	in eax, dx
  4662 00003C72 C1C008              <1> 	rol eax, 8
  4663 00003C75 8A1D[483C0000]      <1> 	mov bl, [pcitype]
  4664 00003C7B 38D8                <1> 	cmp al, bl
  4665 00003C7D 0F8480000000        <1> 	je near foundpciaddr
  4666 00003C83 EB90                <1> 	jmp searchpciret
  4667                              <1> dumppcidevice:
  4668 00003C85 B000                <1> 	mov al, 0
  4669 00003C87 A2[C63B0000]        <1> 	mov [pciregister], al
  4670 00003C8C E8BC000000          <1> 	call getpciaddr
  4671 00003C91 89C1                <1> 	mov ecx, eax
  4672 00003C93 C605[B4110000]03    <1> 	mov byte [firsthexshown],3
  4673 00003C9A E816D5FFFF          <1> 	call showhex
  4674                              <1> dumppcidevicelp:
  4675 00003C9F A2[C63B0000]        <1> 	mov [pciregister], al
  4676 00003CA4 E8A4000000          <1> 	call getpciaddr
  4677 00003CA9 BAF80C0000          <1> 	mov edx, 0xCF8
  4678 00003CAE EF                  <1> 	out dx, eax
  4679 00003CAF BAFC0C0000          <1> 	mov edx, 0xCFC
  4680 00003CB4 ED                  <1> 	in eax, dx
  4681 00003CB5 89C1                <1> 	mov ecx, eax
  4682 00003CB7 A0[C63B0000]        <1> 	mov al, [pciregister]
  4683 00003CBC 0404                <1> 	add al, 4
  4684 00003CBE 3C3C                <1> 	cmp al, 0x3C
  4685 00003CC0 730E                <1> 	jae dumppcidn
  4686 00003CC2 C605[B4110000]00    <1> 	mov byte [firsthexshown],0
  4687 00003CC9 E8E7D4FFFF          <1> 	call showhex
  4688 00003CCE EBCF                <1> 	jmp dumppcidevicelp
  4689                              <1> dumppcidn:
  4690 00003CD0 C605[B4110000]02    <1> 	mov byte [firsthexshown],2
  4691 00003CD7 E8D9D4FFFF          <1> 	call showhex
  4692 00003CDC E934FFFFFF          <1> 	jmp searchpciret
  4693                              <1> nextpcibus:
  4694 00003CE1 B000                <1> 	mov al, 0
  4695 00003CE3 A2[C43B0000]        <1> 	mov [pcidevice], al
  4696 00003CE8 A0[C33B0000]        <1> 	mov al, [pcibus]
  4697 00003CED 3C7F                <1> 	cmp al, 1111111b
  4698 00003CEF 730C                <1> 	jae donesearchpci
  4699 00003CF1 FEC0                <1> 	inc al
  4700 00003CF3 A2[C33B0000]        <1> 	mov [pcibus], al
  4701 00003CF8 E9F5FEFFFF          <1> 	jmp searchpci
  4702                              <1> donesearchpci:
  4703 00003CFD BA00000000          <1> 	mov edx, 0
  4704 00003D02 C3                  <1> 	ret
  4705                              <1> foundpciaddr:
  4706 00003D03 B010                <1> 	mov al, 0x10
  4707 00003D05 A2[C63B0000]        <1> 	mov [pciregister], al
  4708                              <1> findpciioaddr:
  4709 00003D0A E83E000000          <1> 	call getpciaddr
  4710 00003D0F BAF80C0000          <1> 	mov edx, 0xCF8
  4711 00003D14 EF                  <1> 	out dx, eax
  4712 00003D15 BAFC0C0000          <1> 	mov edx, 0xCFC
  4713 00003D1A ED                  <1> 	in eax, dx
  4714 00003D1B 89C3                <1> 	mov ebx, eax
  4715 00003D1D 81E301000000        <1> 	and ebx, 1
  4716 00003D23 81FB00000000        <1> 	cmp ebx, 0
  4717 00003D29 0F8408000000        <1> 	je near notpciioaddr
  4718 00003D2F 2D01000000          <1> 	sub eax, 1
  4719 00003D34 89C2                <1> 	mov edx, eax
  4720 00003D36 C3                  <1> 	ret
  4721                              <1> notpciioaddr:
  4722 00003D37 A0[C63B0000]        <1> 	mov al, [pciregister]
  4723 00003D3C 0404                <1> 	add al, 4
  4724 00003D3E 3C28                <1> 	cmp al, 0x28
  4725 00003D40 0F87CFFEFFFF        <1> 	ja near searchpciret
  4726 00003D46 A2[C63B0000]        <1> 	mov [pciregister], al
  4727 00003D4B EBBD                <1> 	jmp findpciioaddr
  4728                              <1> getpciaddr:		;;puts it in eax and ebx
  4729 00003D4D B800000000          <1> 			mov eax, 0
  4730 00003D52 BB00000080          <1> 			mov ebx, 0x80000000
  4731 00003D57 A0[C33B0000]        <1> 			mov al, [pcibus]
  4732 00003D5C C1E010              <1> 			shl eax, 16
  4733 00003D5F 01C3                <1> 			add ebx, eax
  4734 00003D61 B800000000          <1> 			mov eax, 0
  4735 00003D66 A0[C43B0000]        <1> 			mov al, [pcidevice]
  4736 00003D6B C1E00B              <1> 			shl eax, 11
  4737 00003D6E 01C3                <1> 			add ebx, eax
  4738 00003D70 B800000000          <1> 			mov eax, 0
  4739 00003D75 A0[C53B0000]        <1> 			mov al, [pcifunction]
  4740 00003D7A C1E008              <1> 			shl eax, 8
  4741 00003D7D 01C3                <1> 			add ebx, eax
  4742 00003D7F B800000000          <1> 			mov eax, 0
  4743 00003D84 A0[C63B0000]        <1> 			mov al, [pciregister]
  4744 00003D89 01C3                <1> 			add ebx, eax
  4745 00003D8B 89D8                <1> 			mov eax, ebx
  4746 00003D8D C3                  <1> 			ret
  4747                                  	;%include 'source/process.asm'
  4748                                      %include 'source/disk.asm'
  4749                              <1> ;;disk.asm - new - using lba
  4750                              <1> loadfile:	;;loads a file with the name buffer's location in edi into location in esi
  4751 00003D8E 803F00              <1> 	cmp byte [edi], 0
  4752 00003D91 0F8444000000        <1> 	je near nofileload
  4753 00003D97 89FA                <1> 	mov edx, edi
  4754 00003D99 BB[F83E0000]        <1> 	mov ebx, diskfileindex
  4755                              <1> nextnamechar:
  4756 00003D9E 8A07                <1> 	mov al, [edi]
  4757 00003DA0 8A23                <1> 	mov ah, [ebx]
  4758 00003DA2 47                  <1> 	inc edi
  4759 00003DA3 43                  <1> 	inc ebx
  4760 00003DA4 88C1                <1> 	mov cl, al
  4761 00003DA6 08E1                <1> 	or cl, ah
  4762 00003DA8 80F900              <1> 	cmp cl, 0
  4763 00003DAB 744E                <1> 	je equalfilenames
  4764 00003DAD 80F920              <1> 	cmp cl, ' '
  4765 00003DB0 7449                <1> 	je equalfilenames
  4766 00003DB2 3C2A                <1> 	cmp al, '*'
  4767 00003DB4 742B                <1> 	je equalfilenames2
  4768 00003DB6 80FC00              <1> 	cmp ah, 0
  4769 00003DB9 7410                <1> 	je nextfilename
  4770 00003DBB 3C00                <1> 	cmp al, 0
  4771 00003DBD 740C                <1> 	je nextfilename
  4772 00003DBF 38E0                <1> 	cmp al, ah
  4773 00003DC1 74DB                <1> 	je nextnamechar
  4774                              <1> getebxzero:
  4775 00003DC3 8A23                <1> 	mov ah, [ebx]
  4776 00003DC5 43                  <1> 	inc ebx
  4777 00003DC6 80FC00              <1> 	cmp ah, 0
  4778 00003DC9 75F8                <1> 	jne getebxzero
  4779                              <1> nextfilename:
  4780 00003DCB 81C308000000        <1> 	add ebx, 8		;;next descriptor
  4781 00003DD1 89D7                <1> 	mov edi, edx
  4782 00003DD3 81FB[5D3F0000]      <1> 	cmp ebx, enddiskfileindex
  4783 00003DD9 72C3                <1> 	jb nextnamechar
  4784                              <1> nofileload:
  4785 00003DDB BA94010000          <1> 	mov edx, 404	;;indicate not found error
  4786 00003DE0 C3                  <1> 	ret
  4787                              <1> equalfilenames2:
  4788 00003DE1 81EB02000000        <1> 	sub ebx, 2
  4789                              <1> eqfilefind:
  4790 00003DE7 43                  <1> 	inc ebx
  4791 00003DE8 81FB[5D3F0000]      <1> 	cmp ebx, enddiskfileindex
  4792 00003DEE 0F83E7FFFFFF        <1> 	jae near nofileload
  4793 00003DF4 8A03                <1> 	mov al, [ebx]
  4794 00003DF6 3C00                <1> 	cmp al, 0
  4795 00003DF8 75ED                <1> 	jne eqfilefind
  4796 00003DFA 43                  <1> 	inc ebx
  4797                              <1> equalfilenames:
  4798 00003DFB 8B4304              <1> 	mov eax, [ebx + 4] 	;;put file size in eax
  4799 00003DFE 8B1B                <1> 	mov ebx, [ebx]		;;put file beginning in ebx
  4800 00003E00 031D[2C000000]      <1> 	add ebx, [lbaad]	;;add offset to solleros
  4801 00003E06 B900000000          <1> 	mov ecx, 0
  4802 00003E0B 88C1                <1> 	mov cl, al			;;get excess number of sectors
  4803 00003E0D D0E1                <1> 	shl cl, 1
  4804 00003E0F D0E9                <1> 	shr cl, 1			;;cut off at 128
  4805 00003E11 29C8                <1> 	sub eax, ecx		;;get rid of excess sectors
  4806 00003E13 B500                <1> 	mov ch, 0			;;drive 0
  4807 00003E15 C1E807              <1> 	shr eax, 7			;;get number of 128 sector tracks
  4808                              <1> loaddiskfile:		;;tracks in eax, excess sectors in cl, drive in ch, buffer in esi, address in ebx
  4809 00003E18 A3[563E0000]        <1> 	mov [filetracks], eax
  4810 00003E1D 89F7                <1> 	mov edi, esi		;;just in case cl is 0
  4811 00003E1F 89DA                <1> 	mov edx, ebx
  4812 00003E21 80F900              <1> 	cmp cl, 0
  4813 00003E24 7405                <1> 	je copytracksforfile
  4814 00003E26 E831000000          <1> 	call diskr		;;take care of excess sectors
  4815                              <1> copytracksforfile:
  4816 00003E2B A1[563E0000]        <1> 	mov eax, [filetracks]
  4817 00003E30 3D00000000          <1> 	cmp eax, 0
  4818 00003E35 7419                <1> 	je donecopyfile
  4819 00003E37 48                  <1> 	dec eax
  4820 00003E38 A3[563E0000]        <1> 	mov [filetracks], eax
  4821 00003E3D 89D3                <1> 	mov ebx, edx	;;get end lba
  4822 00003E3F B180                <1> 	mov cl, 0x80
  4823 00003E41 8A2D[2B000000]      <1> 	mov ch, [DriveNumber]
  4824 00003E47 89FE                <1> 	mov esi, edi	;;reset buffer
  4825 00003E49 E80E000000          <1> 	call diskr
  4826 00003E4E EBDB                <1> 	jmp copytracksforfile
  4827                              <1> donecopyfile:
  4828 00003E50 BA00000000          <1> 	mov edx, 0	;;no error
  4829 00003E55 C3                  <1> 	ret
  4830                              <1> 	
  4831 00003E56 00000000            <1> filetracks dd 0
  4832                              <1> 	
  4833 00003E5A 6400                <1> segments dw 100
  4834                              <1> 
  4835                              <1> diskr:		;;sector count in cl, disk number in ch, 28 bit address in first 28 bits of ebx, buffer in esi, puts end buffer in edi and end lba in edx
  4836 00003E5C 8935[F43E0000]      <1> 	mov [bufferstartesi], esi
  4837 00003E62 891D[F03E0000]      <1> 	mov [lbaadstartebx], ebx
  4838 00003E68 BA00000000          <1> 	mov edx, 0
  4839 00003E6D 88CA                <1> 	mov dl, cl
  4840 00003E6F 01DA                <1> 	add edx, ebx
  4841 00003E71 8915[EC3E0000]      <1> 	mov [lbaadend], edx
  4842 00003E77 66B80000            <1> 	mov ax, 0
  4843 00003E7B 66BAF101            <1> 	mov dx, 0x1F1
  4844 00003E7F EE                  <1> 	out dx, al	;;send null byte to port
  4845 00003E80 6642                <1> 	inc dx	;;0x1F2
  4846 00003E82 88C8                <1> 	mov al, cl	;;get sector count
  4847 00003E84 EE                  <1> 	out dx, al	;;send sector count
  4848 00003E85 6642                <1> 	inc dx	;;0x1F3
  4849 00003E87 88D8                <1> 	mov al, bl	;;get first 8 bits of address
  4850 00003E89 EE                  <1> 	out dx, al	;;send them
  4851 00003E8A 6642                <1> 	inc dx	;;0x1F4
  4852 00003E8C C1CB08              <1> 	ror ebx, 8	;;get next 8 bits
  4853 00003E8F 88D8                <1> 	mov al, bl
  4854 00003E91 EE                  <1> 	out dx, al
  4855 00003E92 6642                <1> 	inc dx	;;0x1F5
  4856 00003E94 C1CB08              <1> 	ror ebx, 8	;;again
  4857 00003E97 88D8                <1> 	mov al, bl
  4858 00003E99 EE                  <1> 	out dx, al
  4859 00003E9A 6642                <1> 	inc dx	;;0x1F6
  4860 00003E9C C1CB08              <1> 	ror ebx, 8
  4861 00003E9F 88D8                <1> 	mov al, bl
  4862 00003EA1 240F                <1> 	and al, 00001111b	;;last 4 bits of address
  4863 00003EA3 0CE0                <1> 	or al, 0xE0			;;majic number
  4864 00003EA5 C0E504              <1> 	shl ch, 4
  4865 00003EA8 08E8                <1> 	or al, ch
  4866 00003EAA EE                  <1> 	out dx, al			;;send drive indicator, magic bits, and highest 4 bits of address
  4867 00003EAB 6642                <1> 	inc dx	;;0x1F7
  4868 00003EAD B020                <1> 	mov al, 0x20
  4869 00003EAF EE                  <1> 	out dx, al			;;execute read command
  4870                              <1> diskrwait:
  4871 00003EB0 66BAF701            <1> 	mov dx, 0x1F7
  4872 00003EB4 EC                  <1> 	in al, dx
  4873 00003EB5 2408                <1> 	and al, 0x08
  4874 00003EB7 3C08                <1> 	cmp al, 0x08
  4875 00003EB9 75F5                <1> 	jne diskrwait
  4876 00003EBB 88CD                <1> 	mov ch, cl	;;move sector data into ch, multiplying it by 256
  4877 00003EBD B100                <1> 	mov cl, 0
  4878                              <1> diskdataread:
  4879 00003EBF 66BAF001            <1> 	mov dx, 0x1F0
  4880 00003EC3 66ED                <1> 	in ax, dx
  4881 00003EC5 668906              <1> 	mov [esi], ax
  4882 00003EC8 81C602000000        <1> 	add esi, 2
  4883 00003ECE 6649                <1> 	dec cx
  4884 00003ED0 6681F90000          <1> 	cmp cx, 0
  4885 00003ED5 75E8                <1> 	jne diskdataread		;;read all sectors
  4886 00003ED7 89F7                <1> 	mov edi, esi
  4887 00003ED9 8B15[EC3E0000]      <1> 	mov edx, [lbaadend]
  4888 00003EDF 8B35[F43E0000]      <1> 	mov esi, [bufferstartesi]
  4889 00003EE5 8B1D[F03E0000]      <1> 	mov ebx, [lbaadstartebx]
  4890 00003EEB C3                  <1> 	ret
  4891                              <1> 	
  4892 00003EEC 00000000            <1> lbaadend dd 0
  4893 00003EF0 00000000            <1> lbaadstartebx dd 0
  4894 00003EF4 00000000            <1> bufferstartesi dd 0
  4895                                      %include 'fileindex.asm'
  4896                              <1> diskfileindex:
  4897 00003EF8 65787000            <1> db "exp",0
  4898 00003EFC 26000000            <1> dd (f0-$$)/512
  4899 00003F00 01000000            <1> dd (f1-f0)/512
  4900 00003F04 736F6C6C65726F732E- <1> db "solleros.bmp",0
  4901 00003F0D 626D7000            <1>
  4902 00003F11 27000000            <1> dd (f1-$$)/512
  4903 00003F15 B0020000            <1> dd (f2-f1)/512
  4904 00003F19 736F6C6C65726F732E- <1> db "solleros.txt",0
  4905 00003F22 74787400            <1>
  4906 00003F26 D7020000            <1> dd (f2-$$)/512
  4907 00003F2A 01000000            <1> dd (f3-f2)/512
  4908 00003F2E 74656C7900          <1> db "tely",0
  4909 00003F33 D8020000            <1> dd (f3-$$)/512
  4910 00003F37 01000000            <1> dd (f4-f3)/512
  4911 00003F3B 74696D6500          <1> db "time",0
  4912 00003F40 D9020000            <1> dd (f4-$$)/512
  4913 00003F44 01000000            <1> dd (f5-f4)/512
  4914 00003F48 7475746F7269616C2E- <1> db "tutorial.bat",0
  4915 00003F51 62617400            <1>
  4916 00003F55 DA020000            <1> dd (f5-$$)/512
  4917 00003F59 02000000            <1> dd (f6-f5)/512
  4918                              <1> enddiskfileindex:
  4919                              <1> 
  4920                                  	%include 'source/msg.asm'
  4921 00003F5D 6578697400          <1> 	exitmsg db	"exit",0
  4922 00003F62 50726F6772616D2022- <1> 	notfound1 db "Program ",34,0
  4923 00003F6B 00                  <1>
  4924 00003F6C 22206E6F7420666F75- <1> 	notfound2 db  34," not found.",13,10,0
  4925 00003F75 6E642E0D0A00        <1>
  4926 00003F7B 757365726E616D653A- <1> 	userask db "username:",0
  4927 00003F84 00                  <1>
  4928 00003F85 70617373776F72643A- <1> 	pwdask	db	"password:",0
  4929 00003F8E 00                  <1>
  4930 00003F8F 40536F6C6C65724F53- <1> 	location	db	"@SollerOS ",0
  4931 00003F98 2000                <1>
  4932 00003F9A 245D00              <1> 	cmd		db "$]",0
  4933 00003F9D 0D0A00              <1> 	line	db	13,10,0
  4934                              <1>     ;msg:       db "SollerOS Beta version 0.9.0 - compiled by Jeremy Soller.",13,10,0
  4935                              <1> 	userlst:
  4936 00003FA0 7573657200          <1> 			db "user",0
  4937 00003FA5 70617373776F726400  <1> 			db "password",0
  4938 00003FAE 726F6F7400          <1> 			db "root",0
  4939 00003FB3 617765736F6D65706F- <1> 			db "awesomepower",0
  4940 00003FBC 77657200            <1>
  4941                              <1> 	userlstend:
  4942                              <1> 	
  4943 00003FBC <incbin>            <1> fonts:	incbin 'source/precompiled/fonts.pak'
  4944                              <1> fontend2:
  4945                              <1> mcursor:
  4946 000047D0 01                  <1> 	db	00000001b
  4947 000047D1 81                  <1> 	db	10000001b
  4948 000047D2 C1                  <1> 	db	11000001b
  4949 000047D3 E1                  <1> 	db	11100001b
  4950 000047D4 F1                  <1> 	db	11110001b
  4951 000047D5 F9                  <1> 	db	11111001b
  4952 000047D6 FD                  <1> 	db	11111101b
  4953 000047D7 FF                  <1> 	db	11111111b
  4954 000047D8 F9                  <1> 	db	11111001b
  4955 000047D9 B9                  <1> 	db	10111001b
  4956 000047DA 39                  <1> 	db	00111001b
  4957 000047DB 1C                  <1> 	db	00011100b
  4958 000047DC 1C                  <1> 	db	00011100b
  4959 000047DD 0E                  <1> 	db	00001110b
  4960 000047DE 0E                  <1> 	db	00001110b
  4961 000047DF 0C                  <1> 	db	00001100b
  4962                              <1> fontend:
  4963                              <1> 
  4964                              <1> ;cursorbmp:
  4965                              <1> ;	db	1,0,0,0,0,0,0,0
  4966                              <1> ;	db	1,1,0,0,0,0,0,0
  4967                              <1> ;	db	1,1,1,0,0,0,0,0
  4968                              <1> ;	db	1,1,1,1,0,0,0,0
  4969                              <1> ;	db	1,1,1,1,1,0,0,0
  4970                              <1> ;	db	1,1,1,1,1,1,0,0
  4971                              <1> ;	db	1,1,1,1,1,1,1,0
  4972                              <1> ;	db	1,1,1,1,1,1,1,1
  4973                              <1> ;	db	1,1,1,1,1,1,0,0
  4974                              <1> ;	db	1,1,0,1,1,1,0,0
  4975                              <1> ;	db	1,0,0,1,1,1,0,0
  4976                              <1> ;	db	0,0,0,0,1,1,1,0
  4977                              <1> ;	db	0,0,0,0,1,1,1,0
  4978                              <1> ;	db	0,0,0,0,0,1,1,1
  4979                              <1> ;	db	0,0,0,0,0,1,1,1
  4980                              <1> ;	db	0,0,0,0,0,1,1,0
  4981                              <1> ;cursorbmpend:
  4982                              <1> 
  4983                              <1> 
  4984                              <1> VBEMODEBLOCK:
  4985 000047E0 00<rept>            <1> vbesignature 		times 4 db 0	;VBE Signature
  4986 000047E4 00<rept>            <1> vbeversion  		times 2 db 0	;VBE Version
  4987 000047E6 00<rept>            <1> oemstringptr  		times 4 db 0	;Pointer to OEM String
  4988 000047EA 00<rept>            <1> capabilities 		times 4 db 0	;Capabilities of graphics cont.
  4989 000047EE 00<rept>            <1> videomodeptr 		times 4 db 0	;Pointer to Video Mode List
  4990 000047F2 00<rept>            <1> totalmemory   		times 2 db 0	;number of 64Kb memory blocks
  4991 000047F4 00<rept>            <1> oemsoftwarerev  	times 2 db 0	;VBE implementation Software revision
  4992 000047F6 00<rept>            <1> oemvendornameptr 	times 4 db 0	;Pointer to Vendor Name String
  4993 000047FA 00<rept>            <1> oemproductnameptr 	times 4 db 0	;Pointer to Product Name String
  4994 000047FE 00<rept>            <1> oemproductrevptr 	times 4 db 0	;Pointer to Product Revision String
  4995 00004802 00<rept>            <1> reserved			times 222 db 0	;Reserved for VBE implementation scratch area
  4996 000048E0 00<rept>            <1> oemdata 			times 256 db 0	;Data Area for OEM Strings
  4997                              <1> 
  4998                              <1> 
  4999                              <1> VBEMODEINFOBLOCK:
  5000                              <1> ;Mandatory information for all VBE revision
  5001 000049E0 00<rept>            <1> modeattributes   	times 2 db 0	;Mode attributes
  5002 000049E2 00                  <1> winaattributes   	times 1 db 0	;Window A attributes
  5003 000049E3 00                  <1> winbattributes   	times 1 db 0	;Window B attributes
  5004 000049E4 00<rept>            <1> wingranularity   	times 2 db 0	;Window granularity
  5005 000049E6 00<rept>            <1> winsize          	times 2 db 0	;Window size
  5006 000049E8 00<rept>            <1> winasegment      	times 2 db 0	;Window A start segment
  5007 000049EA 00<rept>            <1> winbsegment      	times 2 db 0	;Window B start segment
  5008 000049EC 00<rept>            <1> winfuncptr       	times 4 db 0	;pointer to window function
  5009 000049F0 00<rept>            <1> bytesperscanline 	times 2 db 0	;Bytes per scan line
  5010                              <1> 
  5011                              <1> ;Mandatory information for VBE 1.2 and above
  5012 000049F2 00<rept>            <1> xresolution     	times 2 db 0	;Horizontal resolution in pixel or chars
  5013 000049F4 00<rept>            <1> yresolution	    	times 2 db 0	;Vertical resolution in pixel or chars
  5014 000049F6 00                  <1> xcharsize       	times 1 db 0	;Character cell width in pixel
  5015 000049F7 00                  <1> ycharsize       	times 1 db 0	;Character cell height in pixel
  5016 000049F8 00                  <1> numberofplanes  	times 1 db 0	;Number of memory planes
  5017 000049F9 00                  <1> bitsperpixel    	times 1 db 0	;Bits per pixel
  5018 000049FA 00                  <1> numberofbanks   	times 1 db 0	;Number of banks
  5019 000049FB 00                  <1> memorymodel     	times 1 db 0	;Memory model type
  5020 000049FC 00                  <1> banksize        	times 1 db 0	;Bank size in KB
  5021 000049FD 00                  <1> numberofimagepages	times 1 db 0	;Number of images
  5022 000049FE 00                  <1> reserved1       	times 1 db 0	;Reserved for page function
  5023                              <1> 
  5024                              <1> ;Direct Color fields (required for direct/6 and YUV/7 memory models)
  5025 000049FF 00                  <1> redmasksize			times 1 db 0	;Size of direct color red mask in bits
  5026 00004A00 00                  <1> redfieldposition	times 1 db 0	;Bit position of lsb of red bask
  5027 00004A01 00                  <1> greenmasksize   	times 1 db 0	;Size of direct color green mask in bits
  5028 00004A02 00                  <1> greenfieldposition	times 1 db 0	;Bit position of lsb of green bask
  5029 00004A03 00                  <1> bluemasksize		times 1 db 0	;Size of direct color blue mask in bits
  5030 00004A04 00                  <1> bluefieldposition	times 1 db 0	;Bit position of lsb of blue bask
  5031 00004A05 00                  <1> rsvdmasksize        times 1	db 0	;Size of direct color reserved mask in bits
  5032 00004A06 00                  <1> rsvdfieldposition	times 1	db 0	;Bit position of lsb of reserved bask
  5033 00004A07 00                  <1> directcolormodeinfo	times 1 db 0	;Direct color mode attributes
  5034                              <1> 
  5035                              <1> ;Mandatory information for VBE 2.0 and above
  5036 00004A08 00<rept>            <1> physbaseptr 		times 4 db 0	;Physical address for flat frame buffer
  5037 00004A0C 00<rept>            <1> offscreenmemoffset 	times 4 db 0	;Pointer to start of off screen memory
  5038 00004A10 00<rept>            <1> offscreenmemsize 	times 2 db 0    ;Amount of off screen memory in 1Kb units
  5039 00004A12 00<rept>            <1> reserved2 			times 206 db 0  ;Remainder of ModeInfoBlock
  5040                                  	;%include 'source/memory.asm'
  5041                                  	%include 'source/buf.asm'
  5042                              <1> [section .bss]
  5043                              <1> bssstart:
  5044                              <1> stack:
  5045 00000000 <res 00001000>      <1> 	resb 4096
  5046                              <1> stackend:
  5047                              <1> graphicstable: ;w type, dw datalocation, w locationx, w locationy, w selected, dw code
  5048 00001000 <res 00000200>      <1> 	resb 200h 
  5049                              <1> 	graphicstableend:
  5050                              <1> mousecolorbuf: ;where the gui under the mouse is stored
  5051 00001200 <res 00000100>      <1> 	resb 256 
  5052                              <1> mcolorend:
  5053 00001300 <res 00000001>      <1> IFON resb 1 
  5054 00001301 <res 00000064>      <1> IFTRUE resb 100 
  5055 00001365 <res 00000004>      <1> BATCHPOS resb 4 
  5056 00001369 <res 00000001>      <1> BATCHISON resb 1 
  5057 0000136A <res 00000001>      <1> LOOPON resb 1 
  5058 0000136B <res 00000004>      <1> LOOPPOS	resb 4 
  5059 0000136F <res 00000200>      <1> fileindex: resb 200h 
  5060                              <1> fileindexend:
  5061 0000156F <res 00000500>      <1> variables: 	resb 500h 
  5062 00001A6F <res 00000001>      <1> varend: resb 1 
  5063 00001A70 <res 00000200>      <1> buftxt: resb 200h 
  5064 00001C70 <res 00000014>      <1> buf2:	resb 20 
  5065 00001C84 <res 00000001>      <1> numbuf: resb 1 
  5066 00001C85 <res 000012C0>      <1> videobuf2 		resb 0x12C0 
  5067 00002F45 <res 000000C8>      <1> videobufend		resb 200 
  5068                              <1> ;processcache:	;;eip, eax, ebx, ecx, edx, edi, esi, esp, ebp-9*4=36 bytes each
  5069                              <1> ;processcacheend:
  5070                              <1> ;alignb 4096		;;align 4 kbytes
  5071                              <1> ;ospagedir:
  5072                              <1> ;	resb 4096
  5073                              <1> ;ospagedirend:
  5074                              <1> ;pagetables:
  5075                              <1> ;	resb 4096
  5076                              <1> bssend:
  5077                              <1> [section .text]
  5078                                      %include 'files.asm'
  5079 00004AE0 00<rept>            <1> align 512,db 0
  5080                              <1> f0:
  5081 00004AE0 <incbin>            <1> incbin "included/exp"
  5082 00004C22 00<rept>            <1> align 512,db 0
  5083                              <1> f1:
  5084 00004C22 <incbin>            <1> incbin "included/solleros.bmp"
  5085 0005ADE6 00<rept>            <1> align 512,db 0
  5086                              <1> f2:
  5087 0005ADE6 <incbin>            <1> incbin "included/solleros.txt"
  5088 0005AF77 00<rept>            <1> align 512,db 0
  5089                              <1> f3:
  5090 0005AF77 <incbin>            <1> incbin "included/tely"
  5091 0005B1BD 00<rept>            <1> align 512,db 0
  5092                              <1> f4:
  5093 0005B1BD <incbin>            <1> incbin "included/time"
  5094 0005B354 00<rept>            <1> align 512,db 0
  5095                              <1> f5:
  5096 0005B354 <incbin>            <1> incbin "included/tutorial.bat"
  5097 0005B778 00<rept>            <1> align 512,db 0
  5098                              <1> f6:
